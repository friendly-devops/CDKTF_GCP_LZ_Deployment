"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) HashiCorp, Inc
// SPDX-License-Identifier: MPL-2.0
const fs = __importStar(require("fs"));
const os = __importStar(require("os"));
const path = __importStar(require("path"));
const provider_generator_1 = require("../../generator/provider-generator");
const codemaker_1 = require("codemaker");
// this is a workaround for a bug introduced in TS 3.9.x and seems to be unlikely to get fixed.
// Since jsii relies on TS < 4 at the moment we can't use newer TS versions which have this fixed (^4.1).
// see https://github.com/hashicorp/terraform-cdk/pull/1248 for more context
test("shard exports across multiple files to avoid generating files with more than a 1000 exports", async () => {
    const code = new codemaker_1.CodeMaker();
    const workdir = fs.mkdtempSync(path.join(os.tmpdir(), "export-sharding.test"));
    const spec = JSON.parse(fs.readFileSync(path.join(__dirname, "fixtures", "aws_wafv2_web_acl.test.fixture.json"), "utf-8"));
    new provider_generator_1.TerraformProviderGenerator(code, spec).generateAll();
    await code.save(workdir);
    const output = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index.ts"), "utf-8");
    expect(output).toMatchSnapshot(`wafv2-web-acl-resource`);
    const outputStructsIndex = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/index.ts"), "utf-8");
    expect(outputStructsIndex).toMatchSnapshot(`structs-index`);
    const outputStructs0 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs0.ts"), "utf-8");
    expect(outputStructs0).toMatchSnapshot(`structs0`);
    const outputStructs400 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs400.ts"), "utf-8");
    expect(outputStructs400).toMatchSnapshot(`structs400`);
    const outputStructs800 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs800.ts"), "utf-8");
    expect(outputStructs800).toMatchSnapshot(`structs800`);
    const outputStructs1200 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs1200.ts"), "utf-8");
    expect(outputStructs1200).toMatchSnapshot(`structs1200`);
    const outputStructs1600 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs1600.ts"), "utf-8");
    expect(outputStructs1600).toMatchSnapshot(`structs1600`);
    const outputStructs2000 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs2000.ts"), "utf-8");
    expect(outputStructs2000).toMatchSnapshot(`structs2000`);
    const outputStructs2400 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs2400.ts"), "utf-8");
    expect(outputStructs2400).toMatchSnapshot(`structs2400`);
    const outputStructs2800 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs2800.ts"), "utf-8");
    expect(outputStructs2800).toMatchSnapshot(`structs2800`);
    const outputStructs3200 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs3200.ts"), "utf-8");
    expect(outputStructs3200).toMatchSnapshot(`structs3200`);
    const outputStructs3600 = fs.readFileSync(path.join(workdir, "providers/test/wafv2-web-acl/index-structs/structs3600.ts"), "utf-8");
    expect(outputStructs3600).toMatchSnapshot(`structs3600`);
});
test("shard exports across multiple files to avoid generating files with more than a 1000 exports in a provider without namespaces", async () => {
    const code = new codemaker_1.CodeMaker();
    const workdir = fs.mkdtempSync(path.join(os.tmpdir(), "export-sharding-no-namespace.test"));
    const spec = JSON.parse(fs.readFileSync(path.join(__dirname, "fixtures", "datadog_dashboard.test.fixture.json"), "utf-8"));
    new provider_generator_1.TerraformProviderGenerator(code, spec).generateAll();
    await code.save(workdir);
    const output = fs.readFileSync(path.join(workdir, "providers/datadog/dashboard/index.ts"), "utf-8");
    expect(output).toMatchSnapshot(`dashboard-resource`);
    const outputStructsIndex = fs.readFileSync(path.join(workdir, "providers/datadog/dashboard/index-structs/index.ts"), "utf-8");
    expect(outputStructsIndex).toMatchSnapshot(`structs-index`);
    const outputStructs0 = fs.readFileSync(path.join(workdir, "providers/datadog/dashboard/index-structs/structs0.ts"), "utf-8");
    expect(outputStructs0).toMatchSnapshot(`structs0`);
    const outputStructs400 = fs.readFileSync(path.join(workdir, "providers/datadog/dashboard/index-structs/structs400.ts"), "utf-8");
    expect(outputStructs400).toMatchSnapshot(`structs400`);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwb3J0LXNoYXJkaW5nLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJleHBvcnQtc2hhcmRpbmcudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsK0JBQStCO0FBQy9CLG1DQUFtQztBQUNuQyx1Q0FBeUI7QUFDekIsdUNBQXlCO0FBQ3pCLDJDQUE2QjtBQUM3QiwyRUFBZ0Y7QUFDaEYseUNBQXNDO0FBRXRDLCtGQUErRjtBQUMvRix5R0FBeUc7QUFDekcsNEVBQTRFO0FBQzVFLElBQUksQ0FBQyw2RkFBNkYsRUFBRSxLQUFLLElBQUksRUFBRTtJQUM3RyxNQUFNLElBQUksR0FBRyxJQUFJLHFCQUFTLEVBQUUsQ0FBQztJQUM3QixNQUFNLE9BQU8sR0FBRyxFQUFFLENBQUMsV0FBVyxDQUM1QixJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsRUFBRSxzQkFBc0IsQ0FBQyxDQUMvQyxDQUFDO0lBRUYsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FDckIsRUFBRSxDQUFDLFlBQVksQ0FDYixJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUscUNBQXFDLENBQUMsRUFDdkUsT0FBTyxDQUNSLENBQ0YsQ0FBQztJQUNGLElBQUksK0NBQTBCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3pELE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUV6QixNQUFNLE1BQU0sR0FBRyxFQUFFLENBQUMsWUFBWSxDQUM1QixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSx1Q0FBdUMsQ0FBQyxFQUMzRCxPQUFPLENBQ1IsQ0FBQztJQUNGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxlQUFlLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUV6RCxNQUFNLGtCQUFrQixH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QUFDLGVBQWUsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUVuRCxNQUFNLGdCQUFnQixHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQ3RDLElBQUksQ0FBQyxJQUFJLENBQ1AsT0FBTyxFQUNQLHlEQUF5RCxDQUMxRCxFQUNELE9BQU8sQ0FDUixDQUFDO0lBQ0YsTUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3pELENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSBIYXNoaUNvcnAsIEluY1xuLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1QTC0yLjBcbmltcG9ydCAqIGFzIGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0ICogYXMgb3MgZnJvbSBcIm9zXCI7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBUZXJyYWZvcm1Qcm92aWRlckdlbmVyYXRvciB9IGZyb20gXCIuLi8uLi9nZW5lcmF0b3IvcHJvdmlkZXItZ2VuZXJhdG9yXCI7XG5pbXBvcnQgeyBDb2RlTWFrZXIgfSBmcm9tIFwiY29kZW1ha2VyXCI7XG5cbi8vIHRoaXMgaXMgYSB3b3JrYXJvdW5kIGZvciBhIGJ1ZyBpbnRyb2R1Y2VkIGluIFRTIDMuOS54IGFuZCBzZWVtcyB0byBiZSB1bmxpa2VseSB0byBnZXQgZml4ZWQuXG4vLyBTaW5jZSBqc2lpIHJlbGllcyBvbiBUUyA8IDQgYXQgdGhlIG1vbWVudCB3ZSBjYW4ndCB1c2UgbmV3ZXIgVFMgdmVyc2lvbnMgd2hpY2ggaGF2ZSB0aGlzIGZpeGVkICheNC4xKS5cbi8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vaGFzaGljb3JwL3RlcnJhZm9ybS1jZGsvcHVsbC8xMjQ4IGZvciBtb3JlIGNvbnRleHRcbnRlc3QoXCJzaGFyZCBleHBvcnRzIGFjcm9zcyBtdWx0aXBsZSBmaWxlcyB0byBhdm9pZCBnZW5lcmF0aW5nIGZpbGVzIHdpdGggbW9yZSB0aGFuIGEgMTAwMCBleHBvcnRzXCIsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgY29kZSA9IG5ldyBDb2RlTWFrZXIoKTtcbiAgY29uc3Qgd29ya2RpciA9IGZzLm1rZHRlbXBTeW5jKFxuICAgIHBhdGguam9pbihvcy50bXBkaXIoKSwgXCJleHBvcnQtc2hhcmRpbmcudGVzdFwiKVxuICApO1xuXG4gIGNvbnN0IHNwZWMgPSBKU09OLnBhcnNlKFxuICAgIGZzLnJlYWRGaWxlU3luYyhcbiAgICAgIHBhdGguam9pbihfX2Rpcm5hbWUsIFwiZml4dHVyZXNcIiwgXCJhd3Nfd2FmdjJfd2ViX2FjbC50ZXN0LmZpeHR1cmUuanNvblwiKSxcbiAgICAgIFwidXRmLThcIlxuICAgIClcbiAgKTtcbiAgbmV3IFRlcnJhZm9ybVByb3ZpZGVyR2VuZXJhdG9yKGNvZGUsIHNwZWMpLmdlbmVyYXRlQWxsKCk7XG4gIGF3YWl0IGNvZGUuc2F2ZSh3b3JrZGlyKTtcblxuICBjb25zdCBvdXRwdXQgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKHdvcmtkaXIsIFwicHJvdmlkZXJzL3Rlc3Qvd2FmdjItd2ViLWFjbC9pbmRleC50c1wiKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dCkudG9NYXRjaFNuYXBzaG90KGB3YWZ2Mi13ZWItYWNsLXJlc291cmNlYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0c0luZGV4ID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbih3b3JrZGlyLCBcInByb3ZpZGVycy90ZXN0L3dhZnYyLXdlYi1hY2wvaW5kZXgtc3RydWN0cy9pbmRleC50c1wiKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHNJbmRleCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzLWluZGV4YCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czAgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKFxuICAgICAgd29ya2RpcixcbiAgICAgIFwicHJvdmlkZXJzL3Rlc3Qvd2FmdjItd2ViLWFjbC9pbmRleC1zdHJ1Y3RzL3N0cnVjdHMwLnRzXCJcbiAgICApLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0czApLnRvTWF0Y2hTbmFwc2hvdChgc3RydWN0czBgKTtcblxuICBjb25zdCBvdXRwdXRTdHJ1Y3RzNDAwID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbihcbiAgICAgIHdvcmtkaXIsXG4gICAgICBcInByb3ZpZGVycy90ZXN0L3dhZnYyLXdlYi1hY2wvaW5kZXgtc3RydWN0cy9zdHJ1Y3RzNDAwLnRzXCJcbiAgICApLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0czQwMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzNDAwYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czgwMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4oXG4gICAgICB3b3JrZGlyLFxuICAgICAgXCJwcm92aWRlcnMvdGVzdC93YWZ2Mi13ZWItYWNsL2luZGV4LXN0cnVjdHMvc3RydWN0czgwMC50c1wiXG4gICAgKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHM4MDApLnRvTWF0Y2hTbmFwc2hvdChgc3RydWN0czgwMGApO1xuXG4gIGNvbnN0IG91dHB1dFN0cnVjdHMxMjAwID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbihcbiAgICAgIHdvcmtkaXIsXG4gICAgICBcInByb3ZpZGVycy90ZXN0L3dhZnYyLXdlYi1hY2wvaW5kZXgtc3RydWN0cy9zdHJ1Y3RzMTIwMC50c1wiXG4gICAgKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHMxMjAwKS50b01hdGNoU25hcHNob3QoYHN0cnVjdHMxMjAwYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czE2MDAgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKFxuICAgICAgd29ya2RpcixcbiAgICAgIFwicHJvdmlkZXJzL3Rlc3Qvd2FmdjItd2ViLWFjbC9pbmRleC1zdHJ1Y3RzL3N0cnVjdHMxNjAwLnRzXCJcbiAgICApLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0czE2MDApLnRvTWF0Y2hTbmFwc2hvdChgc3RydWN0czE2MDBgKTtcblxuICBjb25zdCBvdXRwdXRTdHJ1Y3RzMjAwMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4oXG4gICAgICB3b3JrZGlyLFxuICAgICAgXCJwcm92aWRlcnMvdGVzdC93YWZ2Mi13ZWItYWNsL2luZGV4LXN0cnVjdHMvc3RydWN0czIwMDAudHNcIlxuICAgICksXG4gICAgXCJ1dGYtOFwiXG4gICk7XG4gIGV4cGVjdChvdXRwdXRTdHJ1Y3RzMjAwMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzMjAwMGApO1xuXG4gIGNvbnN0IG91dHB1dFN0cnVjdHMyNDAwID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbihcbiAgICAgIHdvcmtkaXIsXG4gICAgICBcInByb3ZpZGVycy90ZXN0L3dhZnYyLXdlYi1hY2wvaW5kZXgtc3RydWN0cy9zdHJ1Y3RzMjQwMC50c1wiXG4gICAgKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHMyNDAwKS50b01hdGNoU25hcHNob3QoYHN0cnVjdHMyNDAwYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czI4MDAgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKFxuICAgICAgd29ya2RpcixcbiAgICAgIFwicHJvdmlkZXJzL3Rlc3Qvd2FmdjItd2ViLWFjbC9pbmRleC1zdHJ1Y3RzL3N0cnVjdHMyODAwLnRzXCJcbiAgICApLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0czI4MDApLnRvTWF0Y2hTbmFwc2hvdChgc3RydWN0czI4MDBgKTtcblxuICBjb25zdCBvdXRwdXRTdHJ1Y3RzMzIwMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4oXG4gICAgICB3b3JrZGlyLFxuICAgICAgXCJwcm92aWRlcnMvdGVzdC93YWZ2Mi13ZWItYWNsL2luZGV4LXN0cnVjdHMvc3RydWN0czMyMDAudHNcIlxuICAgICksXG4gICAgXCJ1dGYtOFwiXG4gICk7XG4gIGV4cGVjdChvdXRwdXRTdHJ1Y3RzMzIwMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzMzIwMGApO1xuXG4gIGNvbnN0IG91dHB1dFN0cnVjdHMzNjAwID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbihcbiAgICAgIHdvcmtkaXIsXG4gICAgICBcInByb3ZpZGVycy90ZXN0L3dhZnYyLXdlYi1hY2wvaW5kZXgtc3RydWN0cy9zdHJ1Y3RzMzYwMC50c1wiXG4gICAgKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHMzNjAwKS50b01hdGNoU25hcHNob3QoYHN0cnVjdHMzNjAwYCk7XG59KTtcblxudGVzdChcInNoYXJkIGV4cG9ydHMgYWNyb3NzIG11bHRpcGxlIGZpbGVzIHRvIGF2b2lkIGdlbmVyYXRpbmcgZmlsZXMgd2l0aCBtb3JlIHRoYW4gYSAxMDAwIGV4cG9ydHMgaW4gYSBwcm92aWRlciB3aXRob3V0IG5hbWVzcGFjZXNcIiwgYXN5bmMgKCkgPT4ge1xuICBjb25zdCBjb2RlID0gbmV3IENvZGVNYWtlcigpO1xuICBjb25zdCB3b3JrZGlyID0gZnMubWtkdGVtcFN5bmMoXG4gICAgcGF0aC5qb2luKG9zLnRtcGRpcigpLCBcImV4cG9ydC1zaGFyZGluZy1uby1uYW1lc3BhY2UudGVzdFwiKVxuICApO1xuXG4gIGNvbnN0IHNwZWMgPSBKU09OLnBhcnNlKFxuICAgIGZzLnJlYWRGaWxlU3luYyhcbiAgICAgIHBhdGguam9pbihfX2Rpcm5hbWUsIFwiZml4dHVyZXNcIiwgXCJkYXRhZG9nX2Rhc2hib2FyZC50ZXN0LmZpeHR1cmUuanNvblwiKSxcbiAgICAgIFwidXRmLThcIlxuICAgIClcbiAgKTtcbiAgbmV3IFRlcnJhZm9ybVByb3ZpZGVyR2VuZXJhdG9yKGNvZGUsIHNwZWMpLmdlbmVyYXRlQWxsKCk7XG4gIGF3YWl0IGNvZGUuc2F2ZSh3b3JrZGlyKTtcblxuICBjb25zdCBvdXRwdXQgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKHdvcmtkaXIsIFwicHJvdmlkZXJzL2RhdGFkb2cvZGFzaGJvYXJkL2luZGV4LnRzXCIpLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0KS50b01hdGNoU25hcHNob3QoYGRhc2hib2FyZC1yZXNvdXJjZWApO1xuXG4gIGNvbnN0IG91dHB1dFN0cnVjdHNJbmRleCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4od29ya2RpciwgXCJwcm92aWRlcnMvZGF0YWRvZy9kYXNoYm9hcmQvaW5kZXgtc3RydWN0cy9pbmRleC50c1wiKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHNJbmRleCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzLWluZGV4YCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czAgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKHdvcmtkaXIsIFwicHJvdmlkZXJzL2RhdGFkb2cvZGFzaGJvYXJkL2luZGV4LXN0cnVjdHMvc3RydWN0czAudHNcIiksXG4gICAgXCJ1dGYtOFwiXG4gICk7XG4gIGV4cGVjdChvdXRwdXRTdHJ1Y3RzMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzMGApO1xuXG4gIGNvbnN0IG91dHB1dFN0cnVjdHM0MDAgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKFxuICAgICAgd29ya2RpcixcbiAgICAgIFwicHJvdmlkZXJzL2RhdGFkb2cvZGFzaGJvYXJkL2luZGV4LXN0cnVjdHMvc3RydWN0czQwMC50c1wiXG4gICAgKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHM0MDApLnRvTWF0Y2hTbmFwc2hvdChgc3RydWN0czQwMGApO1xufSk7XG4iXX0=