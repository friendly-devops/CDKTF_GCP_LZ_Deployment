"use strict";var sL=Object.create;var ou=Object.defineProperty;var aL=Object.getOwnPropertyDescriptor;var cL=Object.getOwnPropertyNames;var uL=Object.getPrototypeOf,lL=Object.prototype.hasOwnProperty;var We=(e,t)=>()=>(e&&(t=e(e=0)),t);var I=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ht=(e,t)=>{for(var n in t)ou(e,n,{get:t[n],enumerable:!0})},xG=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of cL(t))!lL.call(e,i)&&i!==n&&ou(e,i,{get:()=>t[i],enumerable:!(r=aL(t,i))||r.enumerable});return e};var J=(e,t,n)=>(n=e!=null?sL(uL(e)):{},xG(t||!e||!e.__esModule?ou(n,"default",{value:e,enumerable:!0}):n,e)),ht=e=>xG(ou({},"__esModule",{value:!0}),e);var Ct=I(FI=>{"use strict";FI.fromCallback=function(e){return Object.defineProperty(function(){if(typeof arguments[arguments.length-1]=="function")e.apply(this,arguments);else return new Promise((t,n)=>{arguments[arguments.length]=(r,i)=>{if(r)return n(r);t(i)},arguments.length++,e.apply(this,arguments)})},"name",{value:e.name})};FI.fromPromise=function(e){return Object.defineProperty(function(){let t=arguments[arguments.length-1];if(typeof t!="function")return e.apply(this,arguments);e.apply(this,arguments).then(n=>t(null,n),t)},"name",{value:e.name})}});var JG=I((Xle,LG)=>{"use strict";var Wr=require("constants"),gL=process.cwd,su=null,dL=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return su||(su=gL.call(process)),su};try{process.cwd()}catch{}typeof process.chdir=="function"&&(TI=process.chdir,process.chdir=function(e){su=null,TI.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,TI));var TI;LG.exports=IL;function IL(e){Wr.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||n(e),e.chown=o(e.chown),e.fchown=o(e.fchown),e.lchown=o(e.lchown),e.chmod=r(e.chmod),e.fchmod=r(e.fchmod),e.lchmod=r(e.lchmod),e.chownSync=s(e.chownSync),e.fchownSync=s(e.fchownSync),e.lchownSync=s(e.lchownSync),e.chmodSync=i(e.chmodSync),e.fchmodSync=i(e.fchmodSync),e.lchmodSync=i(e.lchmodSync),e.stat=a(e.stat),e.fstat=a(e.fstat),e.lstat=a(e.lstat),e.statSync=c(e.statSync),e.fstatSync=c(e.fstatSync),e.lstatSync=c(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(u,d,g){g&&process.nextTick(g)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(u,d,g,m){m&&process.nextTick(m)},e.lchownSync=function(){}),dL==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(u){function d(g,m,h){var b=Date.now(),y=0;u(g,m,function v(H){if(H&&(H.code==="EACCES"||H.code==="EPERM"||H.code==="EBUSY")&&Date.now()-b<6e4){setTimeout(function(){e.stat(m,function(F,Q){F&&F.code==="ENOENT"?u(g,m,v):h(H)})},y),y<100&&(y+=10);return}h&&h(H)})}return Object.setPrototypeOf&&Object.setPrototypeOf(d,u),d}(e.rename)),e.read=typeof e.read!="function"?e.read:function(u){function d(g,m,h,b,y,v){var H;if(v&&typeof v=="function"){var F=0;H=function(Q,te,V){if(Q&&Q.code==="EAGAIN"&&F<10)return F++,u.call(e,g,m,h,b,y,H);v.apply(this,arguments)}}return u.call(e,g,m,h,b,y,H)}return Object.setPrototypeOf&&Object.setPrototypeOf(d,u),d}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(u){return function(d,g,m,h,b){for(var y=0;;)try{return u.call(e,d,g,m,h,b)}catch(v){if(v.code==="EAGAIN"&&y<10){y++;continue}throw v}}}(e.readSync);function t(u){u.lchmod=function(d,g,m){u.open(d,Wr.O_WRONLY|Wr.O_SYMLINK,g,function(h,b){if(h){m&&m(h);return}u.fchmod(b,g,function(y){u.close(b,function(v){m&&m(y||v)})})})},u.lchmodSync=function(d,g){var m=u.openSync(d,Wr.O_WRONLY|Wr.O_SYMLINK,g),h=!0,b;try{b=u.fchmodSync(m,g),h=!1}finally{if(h)try{u.closeSync(m)}catch{}else u.closeSync(m)}return b}}function n(u){Wr.hasOwnProperty("O_SYMLINK")&&u.futimes?(u.lutimes=function(d,g,m,h){u.open(d,Wr.O_SYMLINK,function(b,y){if(b){h&&h(b);return}u.futimes(y,g,m,function(v){u.close(y,function(H){h&&h(v||H)})})})},u.lutimesSync=function(d,g,m){var h=u.openSync(d,Wr.O_SYMLINK),b,y=!0;try{b=u.futimesSync(h,g,m),y=!1}finally{if(y)try{u.closeSync(h)}catch{}else u.closeSync(h)}return b}):u.futimes&&(u.lutimes=function(d,g,m,h){h&&process.nextTick(h)},u.lutimesSync=function(){})}function r(u){return u&&function(d,g,m){return u.call(e,d,g,function(h){l(h)&&(h=null),m&&m.apply(this,arguments)})}}function i(u){return u&&function(d,g){try{return u.call(e,d,g)}catch(m){if(!l(m))throw m}}}function o(u){return u&&function(d,g,m,h){return u.call(e,d,g,m,function(b){l(b)&&(b=null),h&&h.apply(this,arguments)})}}function s(u){return u&&function(d,g,m){try{return u.call(e,d,g,m)}catch(h){if(!l(h))throw h}}}function a(u){return u&&function(d,g,m){typeof g=="function"&&(m=g,g=null);function h(b,y){y&&(y.uid<0&&(y.uid+=4294967296),y.gid<0&&(y.gid+=4294967296)),m&&m.apply(this,arguments)}return g?u.call(e,d,g,h):u.call(e,d,h)}}function c(u){return u&&function(d,g){var m=g?u.call(e,d,g):u.call(e,d);return m&&(m.uid<0&&(m.uid+=4294967296),m.gid<0&&(m.gid+=4294967296)),m}}function l(u){if(!u||u.code==="ENOSYS")return!0;var d=!process.getuid||process.getuid()!==0;return!!(d&&(u.code==="EINVAL"||u.code==="EPERM"))}}});var DG=I((_le,OG)=>{"use strict";var zG=require("stream").Stream;OG.exports=mL;function mL(e){return{ReadStream:t,WriteStream:n};function t(r,i){if(!(this instanceof t))return new t(r,i);zG.call(this);var o=this;this.path=r,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var s=Object.keys(i),a=0,c=s.length;a<c;a++){var l=s[a];this[l]=i[l]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){o._read()});return}e.open(this.path,this.flags,this.mode,function(u,d){if(u){o.emit("error",u),o.readable=!1;return}o.fd=d,o.emit("open",d),o._read()})}function n(r,i){if(!(this instanceof n))return new n(r,i);zG.call(this),this.path=r,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var o=Object.keys(i),s=0,a=o.length;s<a;s++){var c=o[s];this[c]=i[c]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var MG=I((Fle,qG)=>{"use strict";qG.exports=fL;var pL=Object.getPrototypeOf||function(e){return e.__proto__};function fL(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:pL(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}),t}});var z=I((Tle,UI)=>{"use strict";var ye=require("fs"),hL=JG(),CL=DG(),bL=MG(),au=require("util"),ze,uu;typeof Symbol=="function"&&typeof Symbol.for=="function"?(ze=Symbol.for("graceful-fs.queue"),uu=Symbol.for("graceful-fs.previous")):(ze="___graceful-fs.queue",uu="___graceful-fs.previous");function yL(){}function QG(e,t){Object.defineProperty(e,ze,{get:function(){return t}})}var pi=yL;au.debuglog?pi=au.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(pi=function(){var e=au.format.apply(au,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `),console.error(e)});ye[ze]||(jG=global[ze]||[],QG(ye,jG),ye.close=function(e){function t(n,r){return e.call(ye,n,function(i){i||PG(),typeof r=="function"&&r.apply(this,arguments)})}return Object.defineProperty(t,uu,{value:e}),t}(ye.close),ye.closeSync=function(e){function t(n){e.apply(ye,arguments),PG()}return Object.defineProperty(t,uu,{value:e}),t}(ye.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){pi(ye[ze]),require("assert").equal(ye[ze].length,0)}));var jG;global[ze]||QG(global,ye[ze]);UI.exports=kI(bL(ye));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!ye.__patched&&(UI.exports=kI(ye),ye.__patched=!0);function kI(e){hL(e),e.gracefulify=kI,e.createReadStream=te,e.createWriteStream=V;var t=e.readFile;e.readFile=n;function n(k,D,M){return typeof D=="function"&&(M=D,D=null),re(k,D,M);function re(ie,ue,X,K){return t(ie,ue,function(T){T&&(T.code==="EMFILE"||T.code==="ENFILE")?bo([re,[ie,ue,X],T,K||Date.now(),Date.now()]):typeof X=="function"&&X.apply(this,arguments)})}}var r=e.writeFile;e.writeFile=i;function i(k,D,M,re){return typeof M=="function"&&(re=M,M=null),ie(k,D,M,re);function ie(ue,X,K,T,P){return r(ue,X,K,function(q){q&&(q.code==="EMFILE"||q.code==="ENFILE")?bo([ie,[ue,X,K,T],q,P||Date.now(),Date.now()]):typeof T=="function"&&T.apply(this,arguments)})}}var o=e.appendFile;o&&(e.appendFile=s);function s(k,D,M,re){return typeof M=="function"&&(re=M,M=null),ie(k,D,M,re);function ie(ue,X,K,T,P){return o(ue,X,K,function(q){q&&(q.code==="EMFILE"||q.code==="ENFILE")?bo([ie,[ue,X,K,T],q,P||Date.now(),Date.now()]):typeof T=="function"&&T.apply(this,arguments)})}}var a=e.copyFile;a&&(e.copyFile=c);function c(k,D,M,re){return typeof M=="function"&&(re=M,M=0),ie(k,D,M,re);function ie(ue,X,K,T,P){return a(ue,X,K,function(q){q&&(q.code==="EMFILE"||q.code==="ENFILE")?bo([ie,[ue,X,K,T],q,P||Date.now(),Date.now()]):typeof T=="function"&&T.apply(this,arguments)})}}var l=e.readdir;e.readdir=d;var u=/^v[0-5]\./;function d(k,D,M){typeof D=="function"&&(M=D,D=null);var re=u.test(process.version)?function(X,K,T,P){return l(X,ie(X,K,T,P))}:function(X,K,T,P){return l(X,K,ie(X,K,T,P))};return re(k,D,M);function ie(ue,X,K,T){return function(P,q){P&&(P.code==="EMFILE"||P.code==="ENFILE")?bo([re,[ue,X,K],P,T||Date.now(),Date.now()]):(q&&q.sort&&q.sort(),typeof K=="function"&&K.call(this,P,q))}}}if(process.version.substr(0,4)==="v0.8"){var g=CL(e);v=g.ReadStream,F=g.WriteStream}var m=e.ReadStream;m&&(v.prototype=Object.create(m.prototype),v.prototype.open=H);var h=e.WriteStream;h&&(F.prototype=Object.create(h.prototype),F.prototype.open=Q),Object.defineProperty(e,"ReadStream",{get:function(){return v},set:function(k){v=k},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return F},set:function(k){F=k},enumerable:!0,configurable:!0});var b=v;Object.defineProperty(e,"FileReadStream",{get:function(){return b},set:function(k){b=k},enumerable:!0,configurable:!0});var y=F;Object.defineProperty(e,"FileWriteStream",{get:function(){return y},set:function(k){y=k},enumerable:!0,configurable:!0});function v(k,D){return this instanceof v?(m.apply(this,arguments),this):v.apply(Object.create(v.prototype),arguments)}function H(){var k=this;O(k.path,k.flags,k.mode,function(D,M){D?(k.autoClose&&k.destroy(),k.emit("error",D)):(k.fd=M,k.emit("open",M),k.read())})}function F(k,D){return this instanceof F?(h.apply(this,arguments),this):F.apply(Object.create(F.prototype),arguments)}function Q(){var k=this;O(k.path,k.flags,k.mode,function(D,M){D?(k.destroy(),k.emit("error",D)):(k.fd=M,k.emit("open",M))})}function te(k,D){return new e.ReadStream(k,D)}function V(k,D){return new e.WriteStream(k,D)}var x=e.open;e.open=O;function O(k,D,M,re){return typeof M=="function"&&(re=M,M=null),ie(k,D,M,re);function ie(ue,X,K,T,P){return x(ue,X,K,function(q,Bn){q&&(q.code==="EMFILE"||q.code==="ENFILE")?bo([ie,[ue,X,K,T],q,P||Date.now(),Date.now()]):typeof T=="function"&&T.apply(this,arguments)})}}return e}function bo(e){pi("ENQUEUE",e[0].name,e[1]),ye[ze].push(e),KI()}var cu;function PG(){for(var e=Date.now(),t=0;t<ye[ze].length;++t)ye[ze][t].length>2&&(ye[ze][t][3]=e,ye[ze][t][4]=e);KI()}function KI(){if(clearTimeout(cu),cu=void 0,ye[ze].length!==0){var e=ye[ze].shift(),t=e[0],n=e[1],r=e[2],i=e[3],o=e[4];if(i===void 0)pi("RETRY",t.name,n),t.apply(null,n);else if(Date.now()-i>=6e4){pi("TIMEOUT",t.name,n);var s=n.pop();typeof s=="function"&&s.call(null,r)}else{var a=Date.now()-o,c=Math.max(o-i,1),l=Math.min(c*1.2,100);a>=l?(pi("RETRY",t.name,n),t.apply(null,n.concat([i]))):ye[ze].push(e)}cu===void 0&&(cu=setTimeout(KI,0))}}});var xI=I(fi=>{"use strict";var $G=Ct().fromCallback,Ot=z(),GL=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","lchmod","link","lstat","mkdir","mkdtemp","open","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof Ot[e]=="function");Object.keys(Ot).forEach(e=>{e!=="promises"&&(fi[e]=Ot[e])});GL.forEach(e=>{fi[e]=$G(Ot[e])});fi.exists=function(e,t){return typeof t=="function"?Ot.exists(e,t):new Promise(n=>Ot.exists(e,n))};fi.read=function(e,t,n,r,i,o){return typeof o=="function"?Ot.read(e,t,n,r,i,o):new Promise((s,a)=>{Ot.read(e,t,n,r,i,(c,l,u)=>{if(c)return a(c);s({bytesRead:l,buffer:u})})})};fi.write=function(e,t,...n){return typeof n[n.length-1]=="function"?Ot.write(e,t,...n):new Promise((r,i)=>{Ot.write(e,t,...n,(o,s,a)=>{if(o)return i(o);r({bytesWritten:s,buffer:a})})})};typeof Ot.realpath.native=="function"&&(fi.realpath.native=$G(Ot.realpath.native))});var JI=I((Kle,tB)=>{"use strict";var LI=require("path");function eB(e){return e=LI.normalize(LI.resolve(e)).split(LI.sep),e.length>0?e[0]:null}var BL=/[<>:"|?*]/;function AL(e){let t=eB(e);return e=e.replace(t,""),BL.test(e)}tB.exports={getRootPath:eB,invalidWin32Path:AL}});var rB=I((Ule,nB)=>{"use strict";var ZL=z(),zI=require("path"),vL=JI().invalidWin32Path,SL=parseInt("0777",8);function OI(e,t,n,r){if(typeof t=="function"?(n=t,t={}):(!t||typeof t!="object")&&(t={mode:t}),process.platform==="win32"&&vL(e)){let s=new Error(e+" contains invalid WIN32 path characters.");return s.code="EINVAL",n(s)}let i=t.mode,o=t.fs||ZL;i===void 0&&(i=SL&~process.umask()),r||(r=null),n=n||function(){},e=zI.resolve(e),o.mkdir(e,i,s=>{if(!s)return r=r||e,n(null,r);switch(s.code){case"ENOENT":if(zI.dirname(e)===e)return n(s);OI(zI.dirname(e),t,(a,c)=>{a?n(a,c):OI(e,t,n,c)});break;default:o.stat(e,(a,c)=>{a||!c.isDirectory()?n(s,r):n(null,r)});break}})}nB.exports=OI});var oB=I((xle,iB)=>{"use strict";var WL=z(),DI=require("path"),RL=JI().invalidWin32Path,VL=parseInt("0777",8);function qI(e,t,n){(!t||typeof t!="object")&&(t={mode:t});let r=t.mode,i=t.fs||WL;if(process.platform==="win32"&&RL(e)){let o=new Error(e+" contains invalid WIN32 path characters.");throw o.code="EINVAL",o}r===void 0&&(r=VL&~process.umask()),n||(n=null),e=DI.resolve(e);try{i.mkdirSync(e,r),n=n||e}catch(o){if(o.code==="ENOENT"){if(DI.dirname(e)===e)throw o;n=qI(DI.dirname(e),t,n),qI(e,t,n)}else{let s;try{s=i.statSync(e)}catch{throw o}if(!s.isDirectory())throw o}}return n}iB.exports=qI});var Yt=I((Lle,sB)=>{"use strict";var NL=Ct().fromCallback,MI=NL(rB()),jI=oB();sB.exports={mkdirs:MI,mkdirsSync:jI,mkdirp:MI,mkdirpSync:jI,ensureDir:MI,ensureDirSync:jI}});var PI=I((Jle,cB)=>{"use strict";var je=z(),aB=require("os"),lu=require("path");function wL(){let e=lu.join("millis-test-sync"+Date.now().toString()+Math.random().toString().slice(2));e=lu.join(aB.tmpdir(),e);let t=new Date(1435410243862);je.writeFileSync(e,"https://github.com/jprichardson/node-fs-extra/pull/141");let n=je.openSync(e,"r+");return je.futimesSync(n,t,t),je.closeSync(n),je.statSync(e).mtime>1435410243e3}function EL(e){let t=lu.join("millis-test"+Date.now().toString()+Math.random().toString().slice(2));t=lu.join(aB.tmpdir(),t);let n=new Date(1435410243862);je.writeFile(t,"https://github.com/jprichardson/node-fs-extra/pull/141",r=>{if(r)return e(r);je.open(t,"r+",(i,o)=>{if(i)return e(i);je.futimes(o,n,n,s=>{if(s)return e(s);je.close(o,a=>{if(a)return e(a);je.stat(t,(c,l)=>{if(c)return e(c);e(null,l.mtime>1435410243e3)})})})})})}function HL(e){if(typeof e=="number")return Math.floor(e/1e3)*1e3;if(e instanceof Date)return new Date(Math.floor(e.getTime()/1e3)*1e3);throw new Error("fs-extra: timeRemoveMillis() unknown parameter type")}function YL(e,t,n,r){je.open(e,"r+",(i,o)=>{if(i)return r(i);je.futimes(o,t,n,s=>{je.close(o,a=>{r&&r(s||a)})})})}function XL(e,t,n){let r=je.openSync(e,"r+");return je.futimesSync(r,t,n),je.closeSync(r)}cB.exports={hasMillisRes:EL,hasMillisResSync:wL,timeRemoveMillis:HL,utimesMillis:YL,utimesMillisSync:XL}});var Ts=I((zle,mB)=>{"use strict";var Dt=z(),bt=require("path"),uB=10,lB=5,_L=0,$I=process.versions.node.split("."),gB=Number.parseInt($I[0],10),dB=Number.parseInt($I[1],10),FL=Number.parseInt($I[2],10);function _s(){if(gB>uB)return!0;if(gB===uB){if(dB>lB)return!0;if(dB===lB&&FL>=_L)return!0}return!1}function TL(e,t,n){_s()?Dt.stat(e,{bigint:!0},(r,i)=>{if(r)return n(r);Dt.stat(t,{bigint:!0},(o,s)=>o?o.code==="ENOENT"?n(null,{srcStat:i,destStat:null}):n(o):n(null,{srcStat:i,destStat:s}))}):Dt.stat(e,(r,i)=>{if(r)return n(r);Dt.stat(t,(o,s)=>o?o.code==="ENOENT"?n(null,{srcStat:i,destStat:null}):n(o):n(null,{srcStat:i,destStat:s}))})}function kL(e,t){let n,r;_s()?n=Dt.statSync(e,{bigint:!0}):n=Dt.statSync(e);try{_s()?r=Dt.statSync(t,{bigint:!0}):r=Dt.statSync(t)}catch(i){if(i.code==="ENOENT")return{srcStat:n,destStat:null};throw i}return{srcStat:n,destStat:r}}function KL(e,t,n,r){TL(e,t,(i,o)=>{if(i)return r(i);let{srcStat:s,destStat:a}=o;return a&&a.ino&&a.dev&&a.ino===s.ino&&a.dev===s.dev?r(new Error("Source and destination must not be the same.")):s.isDirectory()&&em(e,t)?r(new Error(Fs(e,t,n))):r(null,{srcStat:s,destStat:a})})}function UL(e,t,n){let{srcStat:r,destStat:i}=kL(e,t);if(i&&i.ino&&i.dev&&i.ino===r.ino&&i.dev===r.dev)throw new Error("Source and destination must not be the same.");if(r.isDirectory()&&em(e,t))throw new Error(Fs(e,t,n));return{srcStat:r,destStat:i}}function QI(e,t,n,r,i){let o=bt.resolve(bt.dirname(e)),s=bt.resolve(bt.dirname(n));if(s===o||s===bt.parse(s).root)return i();_s()?Dt.stat(s,{bigint:!0},(a,c)=>a?a.code==="ENOENT"?i():i(a):c.ino&&c.dev&&c.ino===t.ino&&c.dev===t.dev?i(new Error(Fs(e,n,r))):QI(e,t,s,r,i)):Dt.stat(s,(a,c)=>a?a.code==="ENOENT"?i():i(a):c.ino&&c.dev&&c.ino===t.ino&&c.dev===t.dev?i(new Error(Fs(e,n,r))):QI(e,t,s,r,i))}function IB(e,t,n,r){let i=bt.resolve(bt.dirname(e)),o=bt.resolve(bt.dirname(n));if(o===i||o===bt.parse(o).root)return;let s;try{_s()?s=Dt.statSync(o,{bigint:!0}):s=Dt.statSync(o)}catch(a){if(a.code==="ENOENT")return;throw a}if(s.ino&&s.dev&&s.ino===t.ino&&s.dev===t.dev)throw new Error(Fs(e,n,r));return IB(e,t,o,r)}function em(e,t){let n=bt.resolve(e).split(bt.sep).filter(i=>i),r=bt.resolve(t).split(bt.sep).filter(i=>i);return n.reduce((i,o,s)=>i&&r[s]===o,!0)}function Fs(e,t,n){return`Cannot ${n} '${e}' to a subdirectory of itself, '${t}'.`}mB.exports={checkPaths:KL,checkPathsSync:UL,checkParentPaths:QI,checkParentPathsSync:IB,isSrcSubdir:em}});var fB=I((Ole,pB)=>{"use strict";pB.exports=function(e){if(typeof Buffer.allocUnsafe=="function")try{return Buffer.allocUnsafe(e)}catch{return new Buffer(e)}return new Buffer(e)}});var GB=I((Dle,yB)=>{"use strict";var Ce=z(),ks=require("path"),xL=Yt().mkdirsSync,LL=PI().utimesMillisSync,Ks=Ts();function JL(e,t,n){typeof n=="function"&&(n={filter:n}),n=n||{},n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;

    see https://github.com/jprichardson/node-fs-extra/issues/269`);let{srcStat:r,destStat:i}=Ks.checkPathsSync(e,t,"copy");return Ks.checkParentPathsSync(e,r,t,"copy"),zL(i,e,t,n)}function zL(e,t,n,r){if(r.filter&&!r.filter(t,n))return;let i=ks.dirname(n);return Ce.existsSync(i)||xL(i),hB(e,t,n,r)}function hB(e,t,n,r){if(!(r.filter&&!r.filter(t,n)))return OL(e,t,n,r)}function OL(e,t,n,r){let o=(r.dereference?Ce.statSync:Ce.lstatSync)(t);if(o.isDirectory())return jL(o,e,t,n,r);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return DL(o,e,t,n,r);if(o.isSymbolicLink())return $L(e,t,n,r)}function DL(e,t,n,r,i){return t?qL(e,n,r,i):CB(e,n,r,i)}function qL(e,t,n,r){if(r.overwrite)return Ce.unlinkSync(n),CB(e,t,n,r);if(r.errorOnExist)throw new Error(`'${n}' already exists`)}function CB(e,t,n,r){return typeof Ce.copyFileSync=="function"?(Ce.copyFileSync(t,n),Ce.chmodSync(n,e.mode),r.preserveTimestamps?LL(n,e.atime,e.mtime):void 0):ML(e,t,n,r)}function ML(e,t,n,r){let o=fB()(65536),s=Ce.openSync(t,"r"),a=Ce.openSync(n,"w",e.mode),c=0;for(;c<e.size;){let l=Ce.readSync(s,o,0,65536,c);Ce.writeSync(a,o,0,l),c+=l}r.preserveTimestamps&&Ce.futimesSync(a,e.atime,e.mtime),Ce.closeSync(s),Ce.closeSync(a)}function jL(e,t,n,r,i){if(!t)return PL(e,n,r,i);if(t&&!t.isDirectory())throw new Error(`Cannot overwrite non-directory '${r}' with directory '${n}'.`);return bB(n,r,i)}function PL(e,t,n,r){return Ce.mkdirSync(n),bB(t,n,r),Ce.chmodSync(n,e.mode)}function bB(e,t,n){Ce.readdirSync(e).forEach(r=>QL(r,e,t,n))}function QL(e,t,n,r){let i=ks.join(t,e),o=ks.join(n,e),{destStat:s}=Ks.checkPathsSync(i,o,"copy");return hB(s,i,o,r)}function $L(e,t,n,r){let i=Ce.readlinkSync(t);if(r.dereference&&(i=ks.resolve(process.cwd(),i)),e){let o;try{o=Ce.readlinkSync(n)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return Ce.symlinkSync(i,n);throw s}if(r.dereference&&(o=ks.resolve(process.cwd(),o)),Ks.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(Ce.statSync(n).isDirectory()&&Ks.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return eJ(i,n)}else return Ce.symlinkSync(i,n)}function eJ(e,t){return Ce.unlinkSync(t),Ce.symlinkSync(e,t)}yB.exports=JL});var tm=I((qle,BB)=>{"use strict";BB.exports={copySync:GB()}});var An=I((Mle,ZB)=>{"use strict";var tJ=Ct().fromPromise,AB=xI();function nJ(e){return AB.access(e).then(()=>!0).catch(()=>!1)}ZB.exports={pathExists:tJ(nJ),pathExistsSync:AB.existsSync}});var HB=I((jle,EB)=>{"use strict";var Oe=z(),Us=require("path"),rJ=Yt().mkdirs,iJ=An().pathExists,oJ=PI().utimesMillis,xs=Ts();function sJ(e,t,n,r){typeof n=="function"&&!r?(r=n,n={}):typeof n=="function"&&(n={filter:n}),r=r||function(){},n=n||{},n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;

    see https://github.com/jprichardson/node-fs-extra/issues/269`),xs.checkPaths(e,t,"copy",(i,o)=>{if(i)return r(i);let{srcStat:s,destStat:a}=o;xs.checkParentPaths(e,s,t,"copy",c=>c?r(c):n.filter?WB(vB,a,e,t,n,r):vB(a,e,t,n,r))})}function vB(e,t,n,r,i){let o=Us.dirname(n);iJ(o,(s,a)=>{if(s)return i(s);if(a)return nm(e,t,n,r,i);rJ(o,c=>c?i(c):nm(e,t,n,r,i))})}function WB(e,t,n,r,i,o){Promise.resolve(i.filter(n,r)).then(s=>s?e(t,n,r,i,o):o(),s=>o(s))}function nm(e,t,n,r,i){return r.filter?WB(SB,e,t,n,r,i):SB(e,t,n,r,i)}function SB(e,t,n,r,i){(r.dereference?Oe.stat:Oe.lstat)(t,(s,a)=>{if(s)return i(s);if(a.isDirectory())return lJ(a,e,t,n,r,i);if(a.isFile()||a.isCharacterDevice()||a.isBlockDevice())return aJ(a,e,t,n,r,i);if(a.isSymbolicLink())return IJ(e,t,n,r,i)})}function aJ(e,t,n,r,i,o){return t?cJ(e,n,r,i,o):RB(e,n,r,i,o)}function cJ(e,t,n,r,i){if(r.overwrite)Oe.unlink(n,o=>o?i(o):RB(e,t,n,r,i));else return r.errorOnExist?i(new Error(`'${n}' already exists`)):i()}function RB(e,t,n,r,i){return typeof Oe.copyFile=="function"?Oe.copyFile(t,n,o=>o?i(o):VB(e,n,r,i)):uJ(e,t,n,r,i)}function uJ(e,t,n,r,i){let o=Oe.createReadStream(t);o.on("error",s=>i(s)).once("open",()=>{let s=Oe.createWriteStream(n,{mode:e.mode});s.on("error",a=>i(a)).on("open",()=>o.pipe(s)).once("close",()=>VB(e,n,r,i))})}function VB(e,t,n,r){Oe.chmod(t,e.mode,i=>i?r(i):n.preserveTimestamps?oJ(t,e.atime,e.mtime,r):r())}function lJ(e,t,n,r,i,o){return t?t&&!t.isDirectory()?o(new Error(`Cannot overwrite non-directory '${r}' with directory '${n}'.`)):NB(n,r,i,o):gJ(e,n,r,i,o)}function gJ(e,t,n,r,i){Oe.mkdir(n,o=>{if(o)return i(o);NB(t,n,r,s=>s?i(s):Oe.chmod(n,e.mode,i))})}function NB(e,t,n,r){Oe.readdir(e,(i,o)=>i?r(i):wB(o,e,t,n,r))}function wB(e,t,n,r,i){let o=e.pop();return o?dJ(e,o,t,n,r,i):i()}function dJ(e,t,n,r,i,o){let s=Us.join(n,t),a=Us.join(r,t);xs.checkPaths(s,a,"copy",(c,l)=>{if(c)return o(c);let{destStat:u}=l;nm(u,s,a,i,d=>d?o(d):wB(e,n,r,i,o))})}function IJ(e,t,n,r,i){Oe.readlink(t,(o,s)=>{if(o)return i(o);if(r.dereference&&(s=Us.resolve(process.cwd(),s)),e)Oe.readlink(n,(a,c)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?Oe.symlink(s,n,i):i(a):(r.dereference&&(c=Us.resolve(process.cwd(),c)),xs.isSrcSubdir(s,c)?i(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${c}'.`)):e.isDirectory()&&xs.isSrcSubdir(c,s)?i(new Error(`Cannot overwrite '${c}' with '${s}'.`)):mJ(s,n,i)));else return Oe.symlink(s,n,i)})}function mJ(e,t,n){Oe.unlink(t,r=>r?n(r):Oe.symlink(e,t,n))}EB.exports=sJ});var rm=I((Ple,YB)=>{"use strict";var pJ=Ct().fromCallback;YB.exports={copy:pJ(HB())}});var LB=I((Qle,xB)=>{"use strict";var XB=z(),kB=require("path"),ae=require("assert"),Ls=process.platform==="win32";function KB(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(n=>{e[n]=e[n]||XB[n],n=n+"Sync",e[n]=e[n]||XB[n]}),e.maxBusyTries=e.maxBusyTries||3}function im(e,t,n){let r=0;typeof t=="function"&&(n=t,t={}),ae(e,"rimraf: missing path"),ae.strictEqual(typeof e,"string","rimraf: path should be a string"),ae.strictEqual(typeof n,"function","rimraf: callback function required"),ae(t,"rimraf: invalid options argument provided"),ae.strictEqual(typeof t,"object","rimraf: options should be object"),KB(t),_B(e,t,function i(o){if(o){if((o.code==="EBUSY"||o.code==="ENOTEMPTY"||o.code==="EPERM")&&r<t.maxBusyTries){r++;let s=r*100;return setTimeout(()=>_B(e,t,i),s)}o.code==="ENOENT"&&(o=null)}n(o)})}function _B(e,t,n){ae(e),ae(t),ae(typeof n=="function"),t.lstat(e,(r,i)=>{if(r&&r.code==="ENOENT")return n(null);if(r&&r.code==="EPERM"&&Ls)return FB(e,t,r,n);if(i&&i.isDirectory())return gu(e,t,r,n);t.unlink(e,o=>{if(o){if(o.code==="ENOENT")return n(null);if(o.code==="EPERM")return Ls?FB(e,t,o,n):gu(e,t,o,n);if(o.code==="EISDIR")return gu(e,t,o,n)}return n(o)})})}function FB(e,t,n,r){ae(e),ae(t),ae(typeof r=="function"),n&&ae(n instanceof Error),t.chmod(e,438,i=>{i?r(i.code==="ENOENT"?null:n):t.stat(e,(o,s)=>{o?r(o.code==="ENOENT"?null:n):s.isDirectory()?gu(e,t,n,r):t.unlink(e,r)})})}function TB(e,t,n){let r;ae(e),ae(t),n&&ae(n instanceof Error);try{t.chmodSync(e,438)}catch(i){if(i.code==="ENOENT")return;throw n}try{r=t.statSync(e)}catch(i){if(i.code==="ENOENT")return;throw n}r.isDirectory()?du(e,t,n):t.unlinkSync(e)}function gu(e,t,n,r){ae(e),ae(t),n&&ae(n instanceof Error),ae(typeof r=="function"),t.rmdir(e,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?fJ(e,t,r):i&&i.code==="ENOTDIR"?r(n):r(i)})}function fJ(e,t,n){ae(e),ae(t),ae(typeof n=="function"),t.readdir(e,(r,i)=>{if(r)return n(r);let o=i.length,s;if(o===0)return t.rmdir(e,n);i.forEach(a=>{im(kB.join(e,a),t,c=>{if(!s){if(c)return n(s=c);--o===0&&t.rmdir(e,n)}})})})}function UB(e,t){let n;t=t||{},KB(t),ae(e,"rimraf: missing path"),ae.strictEqual(typeof e,"string","rimraf: path should be a string"),ae(t,"rimraf: missing options"),ae.strictEqual(typeof t,"object","rimraf: options should be object");try{n=t.lstatSync(e)}catch(r){if(r.code==="ENOENT")return;r.code==="EPERM"&&Ls&&TB(e,t,r)}try{n&&n.isDirectory()?du(e,t,null):t.unlinkSync(e)}catch(r){if(r.code==="ENOENT")return;if(r.code==="EPERM")return Ls?TB(e,t,r):du(e,t,r);if(r.code!=="EISDIR")throw r;du(e,t,r)}}function du(e,t,n){ae(e),ae(t),n&&ae(n instanceof Error);try{t.rmdirSync(e)}catch(r){if(r.code==="ENOTDIR")throw n;if(r.code==="ENOTEMPTY"||r.code==="EEXIST"||r.code==="EPERM")hJ(e,t);else if(r.code!=="ENOENT")throw r}}function hJ(e,t){if(ae(e),ae(t),t.readdirSync(e).forEach(n=>UB(kB.join(e,n),t)),Ls){let n=Date.now();do try{return t.rmdirSync(e,t)}catch{}while(Date.now()-n<500)}else return t.rmdirSync(e,t)}xB.exports=im;im.sync=UB});var Js=I(($le,zB)=>{"use strict";var CJ=Ct().fromCallback,JB=LB();zB.exports={remove:CJ(JB),removeSync:JB.sync}});var $B=I((ege,QB)=>{"use strict";var bJ=Ct().fromCallback,qB=z(),MB=require("path"),jB=Yt(),PB=Js(),OB=bJ(function(t,n){n=n||function(){},qB.readdir(t,(r,i)=>{if(r)return jB.mkdirs(t,n);i=i.map(s=>MB.join(t,s)),o();function o(){let s=i.pop();if(!s)return n();PB.remove(s,a=>{if(a)return n(a);o()})}})});function DB(e){let t;try{t=qB.readdirSync(e)}catch{return jB.mkdirsSync(e)}t.forEach(n=>{n=MB.join(e,n),PB.removeSync(n)})}QB.exports={emptyDirSync:DB,emptydirSync:DB,emptyDir:OB,emptydir:OB}});var rA=I((tge,nA)=>{"use strict";var yJ=Ct().fromCallback,eA=require("path"),zs=z(),tA=Yt(),GJ=An().pathExists;function BJ(e,t){function n(){zs.writeFile(e,"",r=>{if(r)return t(r);t()})}zs.stat(e,(r,i)=>{if(!r&&i.isFile())return t();let o=eA.dirname(e);GJ(o,(s,a)=>{if(s)return t(s);if(a)return n();tA.mkdirs(o,c=>{if(c)return t(c);n()})})})}function AJ(e){let t;try{t=zs.statSync(e)}catch{}if(t&&t.isFile())return;let n=eA.dirname(e);zs.existsSync(n)||tA.mkdirsSync(n),zs.writeFileSync(e,"")}nA.exports={createFile:yJ(BJ),createFileSync:AJ}});var cA=I((nge,aA)=>{"use strict";var ZJ=Ct().fromCallback,oA=require("path"),hi=z(),sA=Yt(),iA=An().pathExists;function vJ(e,t,n){function r(i,o){hi.link(i,o,s=>{if(s)return n(s);n(null)})}iA(t,(i,o)=>{if(i)return n(i);if(o)return n(null);hi.lstat(e,s=>{if(s)return s.message=s.message.replace("lstat","ensureLink"),n(s);let a=oA.dirname(t);iA(a,(c,l)=>{if(c)return n(c);if(l)return r(e,t);sA.mkdirs(a,u=>{if(u)return n(u);r(e,t)})})})})}function SJ(e,t){if(hi.existsSync(t))return;try{hi.lstatSync(e)}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let r=oA.dirname(t);return hi.existsSync(r)||sA.mkdirsSync(r),hi.linkSync(e,t)}aA.exports={createLink:ZJ(vJ),createLinkSync:SJ}});var lA=I((rge,uA)=>{"use strict";var Rr=require("path"),Os=z(),WJ=An().pathExists;function RJ(e,t,n){if(Rr.isAbsolute(e))return Os.lstat(e,r=>r?(r.message=r.message.replace("lstat","ensureSymlink"),n(r)):n(null,{toCwd:e,toDst:e}));{let r=Rr.dirname(t),i=Rr.join(r,e);return WJ(i,(o,s)=>o?n(o):s?n(null,{toCwd:i,toDst:e}):Os.lstat(e,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),n(a)):n(null,{toCwd:e,toDst:Rr.relative(r,e)})))}}function VJ(e,t){let n;if(Rr.isAbsolute(e)){if(n=Os.existsSync(e),!n)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}else{let r=Rr.dirname(t),i=Rr.join(r,e);if(n=Os.existsSync(i),n)return{toCwd:i,toDst:e};if(n=Os.existsSync(e),!n)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:Rr.relative(r,e)}}}uA.exports={symlinkPaths:RJ,symlinkPathsSync:VJ}});var IA=I((ige,dA)=>{"use strict";var gA=z();function NJ(e,t,n){if(n=typeof t=="function"?t:n,t=typeof t=="function"?!1:t,t)return n(null,t);gA.lstat(e,(r,i)=>{if(r)return n(null,"file");t=i&&i.isDirectory()?"dir":"file",n(null,t)})}function wJ(e,t){let n;if(t)return t;try{n=gA.lstatSync(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}dA.exports={symlinkType:NJ,symlinkTypeSync:wJ}});var yA=I((oge,bA)=>{"use strict";var EJ=Ct().fromCallback,pA=require("path"),yo=z(),fA=Yt(),HJ=fA.mkdirs,YJ=fA.mkdirsSync,hA=lA(),XJ=hA.symlinkPaths,_J=hA.symlinkPathsSync,CA=IA(),FJ=CA.symlinkType,TJ=CA.symlinkTypeSync,mA=An().pathExists;function kJ(e,t,n,r){r=typeof n=="function"?n:r,n=typeof n=="function"?!1:n,mA(t,(i,o)=>{if(i)return r(i);if(o)return r(null);XJ(e,t,(s,a)=>{if(s)return r(s);e=a.toDst,FJ(a.toCwd,n,(c,l)=>{if(c)return r(c);let u=pA.dirname(t);mA(u,(d,g)=>{if(d)return r(d);if(g)return yo.symlink(e,t,l,r);HJ(u,m=>{if(m)return r(m);yo.symlink(e,t,l,r)})})})})})}function KJ(e,t,n){if(yo.existsSync(t))return;let i=_J(e,t);e=i.toDst,n=TJ(i.toCwd,n);let o=pA.dirname(t);return yo.existsSync(o)||YJ(o),yo.symlinkSync(e,t,n)}bA.exports={createSymlink:EJ(kJ),createSymlinkSync:KJ}});var BA=I((sge,GA)=>{"use strict";var Iu=rA(),mu=cA(),pu=yA();GA.exports={createFile:Iu.createFile,createFileSync:Iu.createFileSync,ensureFile:Iu.createFile,ensureFileSync:Iu.createFileSync,createLink:mu.createLink,createLinkSync:mu.createLinkSync,ensureLink:mu.createLink,ensureLinkSync:mu.createLinkSync,createSymlink:pu.createSymlink,createSymlinkSync:pu.createSymlinkSync,ensureSymlink:pu.createSymlink,ensureSymlinkSync:pu.createSymlinkSync}});var SA=I((age,vA)=>{"use strict";var Go;try{Go=z()}catch{Go=require("fs")}function UJ(e,t,n){n==null&&(n=t,t={}),typeof t=="string"&&(t={encoding:t}),t=t||{};var r=t.fs||Go,i=!0;"throws"in t&&(i=t.throws),r.readFile(e,t,function(o,s){if(o)return n(o);s=ZA(s);var a;try{a=JSON.parse(s,t?t.reviver:null)}catch(c){return i?(c.message=e+": "+c.message,n(c)):n(null,null)}n(null,a)})}function xJ(e,t){t=t||{},typeof t=="string"&&(t={encoding:t});var n=t.fs||Go,r=!0;"throws"in t&&(r=t.throws);try{var i=n.readFileSync(e,t);return i=ZA(i),JSON.parse(i,t.reviver)}catch(o){if(r)throw o.message=e+": "+o.message,o;return null}}function AA(e,t){var n,r=`
`;typeof t=="object"&&t!==null&&(t.spaces&&(n=t.spaces),t.EOL&&(r=t.EOL));var i=JSON.stringify(e,t?t.replacer:null,n);return i.replace(/\n/g,r)+r}function LJ(e,t,n,r){r==null&&(r=n,n={}),n=n||{};var i=n.fs||Go,o="";try{o=AA(t,n)}catch(s){r&&r(s,null);return}i.writeFile(e,o,n,r)}function JJ(e,t,n){n=n||{};var r=n.fs||Go,i=AA(t,n);return r.writeFileSync(e,i,n)}function ZA(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e=e.replace(/^\uFEFF/,""),e}var zJ={readFile:UJ,readFileSync:xJ,writeFile:LJ,writeFileSync:JJ};vA.exports=zJ});var hu=I((cge,RA)=>{"use strict";var WA=Ct().fromCallback,fu=SA();RA.exports={readJson:WA(fu.readFile),readJsonSync:fu.readFileSync,writeJson:WA(fu.writeFile),writeJsonSync:fu.writeFileSync}});var wA=I((uge,NA)=>{"use strict";var OJ=require("path"),DJ=Yt(),qJ=An().pathExists,VA=hu();function MJ(e,t,n,r){typeof n=="function"&&(r=n,n={});let i=OJ.dirname(e);qJ(i,(o,s)=>{if(o)return r(o);if(s)return VA.writeJson(e,t,n,r);DJ.mkdirs(i,a=>{if(a)return r(a);VA.writeJson(e,t,n,r)})})}NA.exports=MJ});var HA=I((lge,EA)=>{"use strict";var jJ=z(),PJ=require("path"),QJ=Yt(),$J=hu();function e5(e,t,n){let r=PJ.dirname(e);jJ.existsSync(r)||QJ.mkdirsSync(r),$J.writeJsonSync(e,t,n)}EA.exports=e5});var XA=I((gge,YA)=>{"use strict";var t5=Ct().fromCallback,at=hu();at.outputJson=t5(wA());at.outputJsonSync=HA();at.outputJSON=at.outputJson;at.outputJSONSync=at.outputJsonSync;at.writeJSON=at.writeJson;at.writeJSONSync=at.writeJsonSync;at.readJSON=at.readJson;at.readJSONSync=at.readJsonSync;YA.exports=at});var UA=I((dge,KA)=>{"use strict";var TA=z(),n5=require("path"),r5=tm().copySync,kA=Js().removeSync,i5=Yt().mkdirpSync,_A=Ts();function o5(e,t,n){n=n||{};let r=n.overwrite||n.clobber||!1,{srcStat:i}=_A.checkPathsSync(e,t,"move");return _A.checkParentPathsSync(e,i,t,"move"),i5(n5.dirname(t)),s5(e,t,r)}function s5(e,t,n){if(n)return kA(t),FA(e,t,n);if(TA.existsSync(t))throw new Error("dest already exists.");return FA(e,t,n)}function FA(e,t,n){try{TA.renameSync(e,t)}catch(r){if(r.code!=="EXDEV")throw r;return a5(e,t,n)}}function a5(e,t,n){return r5(e,t,{overwrite:n,errorOnExist:!0}),kA(e)}KA.exports=o5});var LA=I((Ige,xA)=>{"use strict";xA.exports={moveSync:UA()}});var qA=I((mge,DA)=>{"use strict";var c5=z(),u5=require("path"),l5=rm().copy,OA=Js().remove,g5=Yt().mkdirp,d5=An().pathExists,JA=Ts();function I5(e,t,n,r){typeof n=="function"&&(r=n,n={});let i=n.overwrite||n.clobber||!1;JA.checkPaths(e,t,"move",(o,s)=>{if(o)return r(o);let{srcStat:a}=s;JA.checkParentPaths(e,a,t,"move",c=>{if(c)return r(c);g5(u5.dirname(t),l=>l?r(l):m5(e,t,i,r))})})}function m5(e,t,n,r){if(n)return OA(t,i=>i?r(i):zA(e,t,n,r));d5(t,(i,o)=>i?r(i):o?r(new Error("dest already exists.")):zA(e,t,n,r))}function zA(e,t,n,r){c5.rename(e,t,i=>i?i.code!=="EXDEV"?r(i):p5(e,t,n,r):r())}function p5(e,t,n,r){l5(e,t,{overwrite:n,errorOnExist:!0},o=>o?r(o):OA(e,r))}DA.exports=I5});var jA=I((pge,MA)=>{"use strict";var f5=Ct().fromCallback;MA.exports={move:f5(qA())}});var eZ=I((fge,$A)=>{"use strict";var h5=Ct().fromCallback,Ds=z(),PA=require("path"),QA=Yt(),C5=An().pathExists;function b5(e,t,n,r){typeof n=="function"&&(r=n,n="utf8");let i=PA.dirname(e);C5(i,(o,s)=>{if(o)return r(o);if(s)return Ds.writeFile(e,t,n,r);QA.mkdirs(i,a=>{if(a)return r(a);Ds.writeFile(e,t,n,r)})})}function y5(e,...t){let n=PA.dirname(e);if(Ds.existsSync(n))return Ds.writeFileSync(e,...t);QA.mkdirsSync(n),Ds.writeFileSync(e,...t)}$A.exports={outputFile:h5(b5),outputFileSync:y5}});var Cu=I((hge,om)=>{"use strict";om.exports=Object.assign({},xI(),tm(),rm(),$B(),BA(),XA(),Yt(),LA(),jA(),eZ(),An(),Js());var tZ=require("fs");Object.getOwnPropertyDescriptor(tZ,"promises")&&Object.defineProperty(om.exports,"promises",{get(){return tZ.promises}})});var qt=I(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});var nZ=Object.prototype.toString;function G5(e){switch(nZ.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return bu(e,Error)}}function Bo(e,t){return nZ.call(e)===`[object ${t}]`}function B5(e){return Bo(e,"ErrorEvent")}function A5(e){return Bo(e,"DOMError")}function Z5(e){return Bo(e,"DOMException")}function v5(e){return Bo(e,"String")}function rZ(e){return typeof e=="object"&&e!==null&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function S5(e){return e===null||rZ(e)||typeof e!="object"&&typeof e!="function"}function iZ(e){return Bo(e,"Object")}function W5(e){return typeof Event<"u"&&bu(e,Event)}function R5(e){return typeof Element<"u"&&bu(e,Element)}function V5(e){return Bo(e,"RegExp")}function N5(e){return!!(e&&e.then&&typeof e.then=="function")}function w5(e){return iZ(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function E5(e){return typeof e=="number"&&e!==e}function bu(e,t){try{return e instanceof t}catch{return!1}}function H5(e){return!!(typeof e=="object"&&e!==null&&(e.__isVue||e._isVue))}ke.isDOMError=A5;ke.isDOMException=Z5;ke.isElement=R5;ke.isError=G5;ke.isErrorEvent=B5;ke.isEvent=W5;ke.isInstanceOf=bu;ke.isNaN=E5;ke.isParameterizedString=rZ;ke.isPlainObject=iZ;ke.isPrimitive=S5;ke.isRegExp=V5;ke.isString=v5;ke.isSyntheticEvent=w5;ke.isThenable=N5;ke.isVueViewModel=H5});var qs=I(Ci=>{"use strict";Object.defineProperty(Ci,"__esModule",{value:!0});var yu=qt();function Y5(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function X5(e,t){let n=e,r=n.length;if(r<=150)return n;t>r&&(t=r);let i=Math.max(t-60,0);i<5&&(i=0);let o=Math.min(i+140,r);return o>r-5&&(o=r),o===r&&(i=Math.max(o-140,0)),n=n.slice(i,o),i>0&&(n=`'{snip} ${n}`),o<r&&(n+=" {snip}"),n}function _5(e,t){if(!Array.isArray(e))return"";let n=[];for(let r=0;r<e.length;r++){let i=e[r];try{yu.isVueViewModel(i)?n.push("[VueViewModel]"):n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function oZ(e,t,n=!1){return yu.isString(e)?yu.isRegExp(t)?t.test(e):yu.isString(t)?n?e===t:e.includes(t):!1:!1}function F5(e,t=[],n=!1){return t.some(r=>oZ(e,r,n))}Ci.isMatchingPattern=oZ;Ci.safeJoin=_5;Ci.snipLine=X5;Ci.stringMatchesSomePattern=F5;Ci.truncate=Y5});var cZ=I(cm=>{"use strict";Object.defineProperty(cm,"__esModule",{value:!0});var sm=qt(),T5=qs();function k5(e,t,n=250,r,i,o,s){if(!o.exception||!o.exception.values||!s||!sm.isInstanceOf(s.originalException,Error))return;let a=o.exception.values.length>0?o.exception.values[o.exception.values.length-1]:void 0;a&&(o.exception.values=K5(am(e,t,i,s.originalException,r,o.exception.values,a,0),n))}function am(e,t,n,r,i,o,s,a){if(o.length>=n+1)return o;let c=[...o];if(sm.isInstanceOf(r[i],Error)){sZ(s,a);let l=e(t,r[i]),u=c.length;aZ(l,i,u,a),c=am(e,t,n,r[i],i,[l,...c],l,u)}return Array.isArray(r.errors)&&r.errors.forEach((l,u)=>{if(sm.isInstanceOf(l,Error)){sZ(s,a);let d=e(t,l),g=c.length;aZ(d,`errors[${u}]`,g,a),c=am(e,t,n,l,i,[d,...c],d,g)}}),c}function sZ(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,...e.type==="AggregateError"&&{is_exception_group:!0},exception_id:t}}function aZ(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}function K5(e,t){return e.map(n=>(n.value&&(n.value=T5.truncate(n.value,t)),n))}cm.applyAggregateErrorsToEvent=k5});var Pe=I(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});function Gu(e){return e&&e.Math==Math?e:void 0}var um=typeof globalThis=="object"&&Gu(globalThis)||typeof window=="object"&&Gu(window)||typeof self=="object"&&Gu(self)||typeof global=="object"&&Gu(global)||function(){return this}()||{};function U5(){return um}function x5(e,t,n){let r=n||um,i=r.__SENTRY__=r.__SENTRY__||{};return i[e]||(i[e]=t())}Ms.GLOBAL_OBJ=um;Ms.getGlobalObject=U5;Ms.getGlobalSingleton=x5});var lm=I(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});var L5=qt(),J5=Pe(),Ao=J5.getGlobalObject(),z5=80;function O5(e,t={}){if(!e)return"<unknown>";try{let n=e,r=5,i=[],o=0,s=0,a=" > ",c=a.length,l,u=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||z5;for(;n&&o++<r&&(l=D5(n,u),!(l==="html"||o>1&&s+i.length*c+l.length>=d));)i.push(l),s+=l.length,n=n.parentNode;return i.reverse().join(a)}catch{return"<unknown>"}}function D5(e,t){let n=e,r=[],i,o,s,a,c;if(!n||!n.tagName)return"";if(Ao.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;r.push(n.tagName.toLowerCase());let l=t&&t.length?t.filter(d=>n.getAttribute(d)).map(d=>[d,n.getAttribute(d)]):null;if(l&&l.length)l.forEach(d=>{r.push(`[${d[0]}="${d[1]}"]`)});else if(n.id&&r.push(`#${n.id}`),i=n.className,i&&L5.isString(i))for(o=i.split(/\s+/),c=0;c<o.length;c++)r.push(`.${o[c]}`);let u=["aria-label","type","name","title","alt"];for(c=0;c<u.length;c++)s=u[c],a=n.getAttribute(s),a&&r.push(`[${s}="${a}"]`);return r.join("")}function q5(){try{return Ao.document.location.href}catch{return""}}function M5(e){return Ao.document&&Ao.document.querySelector?Ao.document.querySelector(e):null}function j5(e){if(!Ao.HTMLElement)return null;let t=e,n=5;for(let r=0;r<n;r++){if(!t)return null;if(t instanceof HTMLElement&&t.dataset.sentryComponent)return t.dataset.sentryComponent;t=t.parentNode}return null}Zo.getComponentName=j5;Zo.getDomElement=M5;Zo.getLocationHref=q5;Zo.htmlTreeAsString=O5});var Zn=I(gm=>{"use strict";Object.defineProperty(gm,"__esModule",{value:!0});var P5=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;gm.DEBUG_BUILD=P5});var gn=I(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});var Q5=Zn(),dm=Pe(),$5="Sentry Logger ",Im=["debug","info","warn","error","log","assert","trace"],mm={};function uZ(e){if(!("console"in dm.GLOBAL_OBJ))return e();let t=dm.GLOBAL_OBJ.console,n={},r=Object.keys(mm);r.forEach(i=>{let o=mm[i];n[i]=t[i],t[i]=o});try{return e()}finally{r.forEach(i=>{t[i]=n[i]})}}function e9(){let e=!1,t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return Q5.DEBUG_BUILD?Im.forEach(n=>{t[n]=(...r)=>{e&&uZ(()=>{dm.GLOBAL_OBJ.console[n](`${$5}[${n}]:`,...r)})}}):Im.forEach(n=>{t[n]=()=>{}}),t}var t9=e9();vo.CONSOLE_LEVELS=Im;vo.consoleSandbox=uZ;vo.logger=t9;vo.originalConsoleMethods=mm});var pm=I(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});var n9=Zn(),js=gn(),r9=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function i9(e){return e==="http"||e==="https"}function o9(e,t=!1){let{host:n,path:r,pass:i,port:o,projectId:s,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&i?`:${i}`:""}@${n}${o?`:${o}`:""}/${r&&`${r}/`}${s}`}function lZ(e){let t=r9.exec(e);if(!t){js.consoleSandbox(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});return}let[n,r,i="",o,s="",a]=t.slice(1),c="",l=a,u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){let d=l.match(/^\d+/);d&&(l=d[0])}return gZ({host:o,pass:i,path:c,projectId:l,port:s,protocol:n,publicKey:r})}function gZ(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function s9(e){if(!n9.DEBUG_BUILD)return!0;let{port:t,projectId:n,protocol:r}=e;return["protocol","publicKey","host","projectId"].find(s=>e[s]?!1:(js.logger.error(`Invalid Sentry Dsn: ${s} missing`),!0))?!1:n.match(/^\d+$/)?i9(r)?t&&isNaN(parseInt(t,10))?(js.logger.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(js.logger.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(js.logger.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function a9(e){let t=typeof e=="string"?lZ(e):gZ(e);if(!(!t||!s9(t)))return t}Ps.dsnFromString=lZ;Ps.dsnToString=o9;Ps.makeDsn=a9});var Cm=I(hm=>{"use strict";Object.defineProperty(hm,"__esModule",{value:!0});var fm=class extends Error{constructor(t,n="warn"){super(t),this.message=t,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}};hm.SentryError=fm});var Mt=I(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});var c9=lm(),u9=Zn(),So=qt(),l9=gn(),dZ=qs();function g9(e,t,n){if(!(t in e))return;let r=e[t],i=n(r);typeof i=="function"&&fZ(i,r),e[t]=i}function pZ(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{u9.DEBUG_BUILD&&l9.logger.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function fZ(e,t){try{let n=t.prototype||{};e.prototype=t.prototype=n,pZ(e,"__sentry_original__",t)}catch{}}function d9(e){return e.__sentry_original__}function I9(e){return Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}function hZ(e){if(So.isError(e))return{message:e.message,name:e.name,stack:e.stack,...mZ(e)};if(So.isEvent(e)){let t={type:e.type,target:IZ(e.target),currentTarget:IZ(e.currentTarget),...mZ(e)};return typeof CustomEvent<"u"&&So.isInstanceOf(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function IZ(e){try{return So.isElement(e)?c9.htmlTreeAsString(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function mZ(e){if(typeof e=="object"&&e!==null){let t={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}else return{}}function m9(e,t=40){let n=Object.keys(hZ(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return dZ.truncate(n[0],t);for(let r=n.length;r>0;r--){let i=n.slice(0,r).join(", ");if(!(i.length>t))return r===n.length?i:dZ.truncate(i,t)}return""}function p9(e){return bm(e,new Map)}function bm(e,t){if(f9(e)){let n=t.get(e);if(n!==void 0)return n;let r={};t.set(e,r);for(let i of Object.keys(e))typeof e[i]<"u"&&(r[i]=bm(e[i],t));return r}if(Array.isArray(e)){let n=t.get(e);if(n!==void 0)return n;let r=[];return t.set(e,r),e.forEach(i=>{r.push(bm(i,t))}),r}return e}function f9(e){if(!So.isPlainObject(e))return!1;try{let t=Object.getPrototypeOf(e).constructor.name;return!t||t==="Object"}catch{return!0}}function h9(e){let t;switch(!0){case e==null:t=new String(e);break;case(typeof e=="symbol"||typeof e=="bigint"):t=Object(e);break;case So.isPrimitive(e):t=new e.constructor(e);break;default:t=e;break}return t}dn.addNonEnumerableProperty=pZ;dn.convertToPlainObject=hZ;dn.dropUndefinedKeys=p9;dn.extractExceptionKeysForMessage=m9;dn.fill=g9;dn.getOriginalFunction=d9;dn.markFunctionWrapped=fZ;dn.objectify=h9;dn.urlEncode=I9});var Au=I(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});function CZ(e,t=!1){return!(t||e&&!e.startsWith("/")&&!e.match(/^[A-Z]:/)&&!e.startsWith(".")&&!e.match(/^[a-zA-Z]([a-zA-Z0-9.\-+])*:\/\//))&&e!==void 0&&!e.includes("node_modules/")}function C9(e){let t=/^\s*[-]{4,}$/,n=/at (?:async )?(?:(.+?)\s+\()?(?:(.+):(\d+):(\d+)?|([^)]+))\)?/;return r=>{let i=r.match(n);if(i){let o,s,a,c,l;if(i[1]){a=i[1];let g=a.lastIndexOf(".");if(a[g-1]==="."&&g--,g>0){o=a.slice(0,g),s=a.slice(g+1);let m=o.indexOf(".Module");m>0&&(a=a.slice(m+1),o=o.slice(0,m))}c=void 0}s&&(c=o,l=s),s==="<anonymous>"&&(l=void 0,a=void 0),a===void 0&&(l=l||"<anonymous>",a=c?`${c}.${l}`:l);let u=i[2]&&i[2].startsWith("file://")?i[2].slice(7):i[2],d=i[5]==="native";return u&&u.match(/\/[A-Z]:/)&&(u=u.slice(1)),!u&&i[5]&&!d&&(u=i[5]),{filename:u,module:e?e(u):void 0,function:a,lineno:parseInt(i[3],10)||void 0,colno:parseInt(i[4],10)||void 0,in_app:CZ(u,d)}}if(r.match(t))return{filename:r}}}Bu.filenameIsInApp=CZ;Bu.node=C9});var Zu=I(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});var GZ=Au(),BZ=50,bZ=/\(error: (.*)\)/,yZ=/captureMessage|captureException/;function AZ(...e){let t=e.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0)=>{let i=[],o=n.split(`
`);for(let s=r;s<o.length;s++){let a=o[s];if(a.length>1024)continue;let c=bZ.test(a)?a.replace(bZ,"$1"):a;if(!c.match(/\S*Error: /)){for(let l of t){let u=l(c);if(u){i.push(u);break}}if(i.length>=BZ)break}}return ZZ(i)}}function b9(e){return Array.isArray(e)?AZ(...e):e}function ZZ(e){if(!e.length)return[];let t=Array.from(e);return/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop(),t.reverse(),yZ.test(t[t.length-1].function||"")&&(t.pop(),yZ.test(t[t.length-1].function||"")&&t.pop()),t.slice(0,BZ).map(n=>({...n,filename:n.filename||t[t.length-1].filename,function:n.function||"?"}))}var ym="<anonymous>";function y9(e){try{return!e||typeof e!="function"?ym:e.name||ym}catch{return ym}}function G9(e){return[90,GZ.node(e)]}Vr.filenameIsInApp=GZ.filenameIsInApp;Vr.createStackParser=AZ;Vr.getFunctionName=y9;Vr.nodeStackLineParser=G9;Vr.stackParserFromStackParserOptions=b9;Vr.stripSentryFramesAndReverse=ZZ});var Pn=I(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});var B9=Zn(),A9=gn(),Z9=Zu(),Wo={},vZ={};function v9(e,t){Wo[e]=Wo[e]||[],Wo[e].push(t)}function S9(){Object.keys(Wo).forEach(e=>{Wo[e]=void 0})}function W9(e,t){vZ[e]||(t(),vZ[e]=!0)}function R9(e,t){let n=e&&Wo[e];if(n)for(let r of n)try{r(t)}catch(i){B9.DEBUG_BUILD&&A9.logger.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${Z9.getFunctionName(r)}
Error:`,i)}}Ro.addHandler=v9;Ro.maybeInstrument=W9;Ro.resetInstrumentationHandlers=S9;Ro.triggerHandlers=R9});var Zm=I(Am=>{"use strict";Object.defineProperty(Am,"__esModule",{value:!0});var Gm=gn(),V9=Mt(),vu=Pe(),Bm=Pn();function N9(e){let t="console";Bm.addHandler(t,e),Bm.maybeInstrument(t,w9)}function w9(){"console"in vu.GLOBAL_OBJ&&Gm.CONSOLE_LEVELS.forEach(function(e){e in vu.GLOBAL_OBJ.console&&V9.fill(vu.GLOBAL_OBJ.console,e,function(t){return Gm.originalConsoleMethods[e]=t,function(...n){let r={args:n,level:e};Bm.triggerHandlers("console",r);let i=Gm.originalConsoleMethods[e];i&&i.apply(vu.GLOBAL_OBJ.console,n)}})})}Am.addConsoleInstrumentationHandler=N9});var Qs=I(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});var E9=Mt(),vm=qs(),H9=Pe();function Y9(){let e=H9.GLOBAL_OBJ,t=e.crypto||e.msCrypto,n=()=>Math.random()*16;try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{let r=new Uint8Array(1);return t.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function SZ(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function X9(e){let{message:t,event_id:n}=e;if(t)return t;let r=SZ(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function _9(e,t,n){let r=e.exception=e.exception||{},i=r.values=r.values||[],o=i[0]=i[0]||{};o.value||(o.value=t||""),o.type||(o.type=n||"Error")}function F9(e,t){let n=SZ(e);if(!n)return;let r={type:"generic",handled:!0},i=n.mechanism;if(n.mechanism={...r,...i,...t},t&&"data"in t){let o={...i&&i.data,...t.data};n.mechanism.data=o}}var T9=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/;function k9(e){let t=e.match(T9)||[],n=parseInt(t[1],10),r=parseInt(t[2],10),i=parseInt(t[3],10);return{buildmetadata:t[5],major:isNaN(n)?void 0:n,minor:isNaN(r)?void 0:r,patch:isNaN(i)?void 0:i,prerelease:t[4]}}function K9(e,t,n=5){if(t.lineno===void 0)return;let r=e.length,i=Math.max(Math.min(r-1,t.lineno-1),0);t.pre_context=e.slice(Math.max(0,i-n),i).map(o=>vm.snipLine(o,0)),t.context_line=vm.snipLine(e[Math.min(r-1,i)],t.colno||0),t.post_context=e.slice(Math.min(i+1,r),i+1+n).map(o=>vm.snipLine(o,0))}function U9(e){if(e&&e.__sentry_captured__)return!0;try{E9.addNonEnumerableProperty(e,"__sentry_captured__",!0)}catch{}return!1}function x9(e){return Array.isArray(e)?e:[e]}vn.addContextToFrame=K9;vn.addExceptionMechanism=F9;vn.addExceptionTypeValue=_9;vn.arrayify=x9;vn.checkOrSetAlreadyCaught=U9;vn.getEventDescription=X9;vn.parseSemver=k9;vn.uuid4=Y9});var Vm=I(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});var L9=Qs(),Su=Mt(),J9=Pe(),Sm=Pn(),Vo=J9.GLOBAL_OBJ,z9=1e3,WZ,Wm,Rm;function O9(e){let t="dom";Sm.addHandler(t,e),Sm.maybeInstrument(t,VZ)}function VZ(){if(!Vo.document)return;let e=Sm.triggerHandlers.bind(null,"dom"),t=RZ(e,!0);Vo.document.addEventListener("click",t,!1),Vo.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(n=>{let r=Vo[n]&&Vo[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(Su.fill(r,"addEventListener",function(i){return function(o,s,a){if(o==="click"||o=="keypress")try{let c=this,l=c.__sentry_instrumentation_handlers__=c.__sentry_instrumentation_handlers__||{},u=l[o]=l[o]||{refCount:0};if(!u.handler){let d=RZ(e);u.handler=d,i.call(this,o,d,a)}u.refCount++}catch{}return i.call(this,o,s,a)}}),Su.fill(r,"removeEventListener",function(i){return function(o,s,a){if(o==="click"||o=="keypress")try{let c=this,l=c.__sentry_instrumentation_handlers__||{},u=l[o];u&&(u.refCount--,u.refCount<=0&&(i.call(this,o,u.handler,a),u.handler=void 0,delete l[o]),Object.keys(l).length===0&&delete c.__sentry_instrumentation_handlers__)}catch{}return i.call(this,o,s,a)}}))})}function D9(e){if(e.type!==Wm)return!1;try{if(!e.target||e.target._sentryId!==Rm)return!1}catch{}return!0}function q9(e,t){return e!=="keypress"?!1:!t||!t.tagName?!0:!(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)}function RZ(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;let r=M9(n);if(q9(n.type,r))return;Su.addNonEnumerableProperty(n,"_sentryCaptured",!0),r&&!r._sentryId&&Su.addNonEnumerableProperty(r,"_sentryId",L9.uuid4());let i=n.type==="keypress"?"input":n.type;D9(n)||(e({event:n,name:i,global:t}),Wm=n.type,Rm=r?r._sentryId:void 0),clearTimeout(WZ),WZ=Vo.setTimeout(()=>{Rm=void 0,Wm=void 0},z9)}}function M9(e){try{return e.target}catch{return null}}Wu.addClickKeypressInstrumentationHandler=O9;Wu.instrumentDOM=VZ});var Em=I(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});var j9=Zn(),P9=gn(),Q9=Pe(),Ru=Q9.getGlobalObject();function $9(){try{return new ErrorEvent(""),!0}catch{return!1}}function ez(){try{return new DOMError(""),!0}catch{return!1}}function tz(){try{return new DOMException(""),!0}catch{return!1}}function wm(){if(!("fetch"in Ru))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function Nm(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function nz(){if(typeof EdgeRuntime=="string")return!0;if(!wm())return!1;if(Nm(Ru.fetch))return!0;let e=!1,t=Ru.document;if(t&&typeof t.createElement=="function")try{let n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=Nm(n.contentWindow.fetch)),t.head.removeChild(n)}catch(n){j9.DEBUG_BUILD&&P9.logger.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return e}function rz(){return"ReportingObserver"in Ru}function iz(){if(!wm())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch{return!1}}Sn.isNativeFetch=Nm;Sn.supportsDOMError=ez;Sn.supportsDOMException=tz;Sn.supportsErrorEvent=$9;Sn.supportsFetch=wm;Sn.supportsNativeFetch=nz;Sn.supportsReferrerPolicy=iz;Sn.supportsReportingObserver=rz});var Ym=I(Vu=>{"use strict";Object.defineProperty(Vu,"__esModule",{value:!0});var oz=Mt(),sz=Em(),NZ=Pe(),$s=Pn();function az(e){let t="fetch";$s.addHandler(t,e),$s.maybeInstrument(t,cz)}function cz(){sz.supportsNativeFetch()&&oz.fill(NZ.GLOBAL_OBJ,"fetch",function(e){return function(...t){let{method:n,url:r}=EZ(t),i={args:t,fetchData:{method:n,url:r},startTimestamp:Date.now()};return $s.triggerHandlers("fetch",{...i}),e.apply(NZ.GLOBAL_OBJ,t).then(o=>{let s={...i,endTimestamp:Date.now(),response:o};return $s.triggerHandlers("fetch",s),o},o=>{let s={...i,endTimestamp:Date.now(),error:o};throw $s.triggerHandlers("fetch",s),o})}})}function Hm(e,t){return!!e&&typeof e=="object"&&!!e[t]}function wZ(e){return typeof e=="string"?e:e?Hm(e,"url")?e.url:e.toString?e.toString():"":""}function EZ(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){let[n,r]=e;return{url:wZ(n),method:Hm(r,"method")?String(r.method).toUpperCase():"GET"}}let t=e[0];return{url:wZ(t),method:Hm(t,"method")?String(t.method).toUpperCase():"GET"}}Vu.addFetchInstrumentationHandler=az;Vu.parseFetchArgs=EZ});var Tm=I(Fm=>{"use strict";Object.defineProperty(Fm,"__esModule",{value:!0});var Xm=Pe(),_m=Pn(),Nu=null;function uz(e){let t="error";_m.addHandler(t,e),_m.maybeInstrument(t,lz)}function lz(){Nu=Xm.GLOBAL_OBJ.onerror,Xm.GLOBAL_OBJ.onerror=function(e,t,n,r,i){let o={column:r,error:i,line:n,msg:e,url:t};return _m.triggerHandlers("error",o),Nu&&!Nu.__SENTRY_LOADER__?Nu.apply(this,arguments):!1},Xm.GLOBAL_OBJ.onerror.__SENTRY_INSTRUMENTED__=!0}Fm.addGlobalErrorInstrumentationHandler=uz});var xm=I(Um=>{"use strict";Object.defineProperty(Um,"__esModule",{value:!0});var km=Pe(),Km=Pn(),wu=null;function gz(e){let t="unhandledrejection";Km.addHandler(t,e),Km.maybeInstrument(t,dz)}function dz(){wu=km.GLOBAL_OBJ.onunhandledrejection,km.GLOBAL_OBJ.onunhandledrejection=function(e){let t=e;return Km.triggerHandlers("unhandledrejection",t),wu&&!wu.__SENTRY_LOADER__?wu.apply(this,arguments):!0},km.GLOBAL_OBJ.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}Um.addGlobalUnhandledRejectionInstrumentationHandler=gz});var Jm=I(Lm=>{"use strict";Object.defineProperty(Lm,"__esModule",{value:!0});var Iz=Pe(),Eu=Iz.getGlobalObject();function mz(){let e=Eu.chrome,t=e&&e.app&&e.app.runtime,n="history"in Eu&&!!Eu.history.pushState&&!!Eu.history.replaceState;return!t&&n}Lm.supportsHistory=mz});var Om=I(zm=>{"use strict";Object.defineProperty(zm,"__esModule",{value:!0});var HZ=Mt();Zn();gn();var pz=Pe(),fz=Jm(),Yu=Pn(),ea=pz.GLOBAL_OBJ,Hu;function hz(e){let t="history";Yu.addHandler(t,e),Yu.maybeInstrument(t,Cz)}function Cz(){if(!fz.supportsHistory())return;let e=ea.onpopstate;ea.onpopstate=function(...n){let r=ea.location.href,i=Hu;Hu=r;let o={from:i,to:r};if(Yu.triggerHandlers("history",o),e)try{return e.apply(this,n)}catch{}};function t(n){return function(...r){let i=r.length>2?r[2]:void 0;if(i){let o=Hu,s=String(i);Hu=s;let a={from:o,to:s};Yu.triggerHandlers("history",a)}return n.apply(this,r)}}HZ.fill(ea.history,"pushState",t),HZ.fill(ea.history,"replaceState",t)}zm.addHistoryInstrumentationHandler=hz});var Dm=I(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});var _u=qt(),Xu=Mt(),bz=Pe(),Fu=Pn(),yz=bz.GLOBAL_OBJ,ta="__sentry_xhr_v3__";function Gz(e){let t="xhr";Fu.addHandler(t,e),Fu.maybeInstrument(t,YZ)}function YZ(){if(!yz.XMLHttpRequest)return;let e=XMLHttpRequest.prototype;Xu.fill(e,"open",function(t){return function(...n){let r=Date.now(),i=_u.isString(n[0])?n[0].toUpperCase():void 0,o=Bz(n[1]);if(!i||!o)return t.apply(this,n);this[ta]={method:i,url:o,request_headers:{}},i==="POST"&&o.match(/sentry_key/)&&(this.__sentry_own_request__=!0);let s=()=>{let a=this[ta];if(a&&this.readyState===4){try{a.status_code=this.status}catch{}let c={args:[i,o],endTimestamp:Date.now(),startTimestamp:r,xhr:this};Fu.triggerHandlers("xhr",c)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?Xu.fill(this,"onreadystatechange",function(a){return function(...c){return s(),a.apply(this,c)}}):this.addEventListener("readystatechange",s),Xu.fill(this,"setRequestHeader",function(a){return function(...c){let[l,u]=c,d=this[ta];return d&&_u.isString(l)&&_u.isString(u)&&(d.request_headers[l.toLowerCase()]=u),a.apply(this,c)}}),t.apply(this,n)}}),Xu.fill(e,"send",function(t){return function(...n){let r=this[ta];if(!r)return t.apply(this,n);n[0]!==void 0&&(r.body=n[0]);let i={args:[r.method,r.url],startTimestamp:Date.now(),xhr:this};return Fu.triggerHandlers("xhr",i),t.apply(this,n)}})}function Bz(e){if(_u.isString(e))return e;try{return e.toString()}catch{}}na.SENTRY_XHR_DATA_KEY=ta;na.addXhrInstrumentationHandler=Gz;na.instrumentXHR=YZ});var UZ=I(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});var Az=Zn(),Zz=gn(),XZ=Zm(),_Z=Vm(),FZ=Ym(),TZ=Tm(),kZ=xm(),KZ=Om(),qm=Dm();function vz(e,t){switch(e){case"console":return XZ.addConsoleInstrumentationHandler(t);case"dom":return _Z.addClickKeypressInstrumentationHandler(t);case"xhr":return qm.addXhrInstrumentationHandler(t);case"fetch":return FZ.addFetchInstrumentationHandler(t);case"history":return KZ.addHistoryInstrumentationHandler(t);case"error":return TZ.addGlobalErrorInstrumentationHandler(t);case"unhandledrejection":return kZ.addGlobalUnhandledRejectionInstrumentationHandler(t);default:Az.DEBUG_BUILD&&Zz.logger.warn("unknown instrumentation type:",e)}}In.addConsoleInstrumentationHandler=XZ.addConsoleInstrumentationHandler;In.addClickKeypressInstrumentationHandler=_Z.addClickKeypressInstrumentationHandler;In.addFetchInstrumentationHandler=FZ.addFetchInstrumentationHandler;In.addGlobalErrorInstrumentationHandler=TZ.addGlobalErrorInstrumentationHandler;In.addGlobalUnhandledRejectionInstrumentationHandler=kZ.addGlobalUnhandledRejectionInstrumentationHandler;In.addHistoryInstrumentationHandler=KZ.addHistoryInstrumentationHandler;In.SENTRY_XHR_DATA_KEY=qm.SENTRY_XHR_DATA_KEY;In.addXhrInstrumentationHandler=qm.addXhrInstrumentationHandler;In.addInstrumentationHandler=vz});var Mm=I(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});function Sz(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function Wz(){return"npm"}Tu.getSDKSource=Wz;Tu.isBrowserBundle=Sz});var jm=I((ra,Ku)=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});var Rz=Mm();function Vz(){return!Rz.isBrowserBundle()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function ku(e,t){return e.require(t)}function Nz(e){let t;try{t=ku(Ku,e)}catch{}try{let{cwd:n}=ku(Ku,"process");t=ku(Ku,`${n()}/node_modules/${e}`)}catch{}return t}ra.dynamicRequire=ku;ra.isNodeEnv=Vz;ra.loadModule=Nz});var LZ=I(Pm=>{"use strict";Object.defineProperty(Pm,"__esModule",{value:!0});var wz=jm(),xZ=Pe();function Ez(){return typeof window<"u"&&(!wz.isNodeEnv()||Hz())}function Hz(){return xZ.GLOBAL_OBJ.process!==void 0&&xZ.GLOBAL_OBJ.process.type==="renderer"}Pm.isBrowser=Ez});var $m=I(Qm=>{"use strict";Object.defineProperty(Qm,"__esModule",{value:!0});function Yz(){let e=typeof WeakSet=="function",t=e?new WeakSet:[];function n(i){if(e)return t.has(i)?!0:(t.add(i),!1);for(let o=0;o<t.length;o++)if(t[o]===i)return!0;return t.push(i),!1}function r(i){if(e)t.delete(i);else for(let o=0;o<t.length;o++)if(t[o]===i){t.splice(o,1);break}}return[n,r]}Qm.memoBuilder=Yz});var ia=I(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});var ep=qt(),Xz=$m(),_z=Mt(),Fz=Zu();function JZ(e,t=100,n=1/0){try{return Uu("",e,t,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function zZ(e,t=3,n=100*1024){let r=JZ(e,t);return Uz(r)>n?zZ(e,t-1,n):r}function Uu(e,t,n=1/0,r=1/0,i=Xz.memoBuilder()){let[o,s]=i;if(t==null||["number","boolean","string"].includes(typeof t)&&!ep.isNaN(t))return t;let a=Tz(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;let c=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(o(t))return"[Circular ~]";let l=t;if(l&&typeof l.toJSON=="function")try{let m=l.toJSON();return Uu("",m,c-1,r,i)}catch{}let u=Array.isArray(t)?[]:{},d=0,g=_z.convertToPlainObject(t);for(let m in g){if(!Object.prototype.hasOwnProperty.call(g,m))continue;if(d>=r){u[m]="[MaxProperties ~]";break}let h=g[m];u[m]=Uu(m,h,c-1,r,i),d++}return s(t),u}function Tz(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(ep.isVueViewModel(t))return"[VueViewModel]";if(ep.isSyntheticEvent(t))return"[SyntheticEvent]";if(typeof t=="number"&&t!==t)return"[NaN]";if(typeof t=="function")return`[Function: ${Fz.getFunctionName(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;let n=kz(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function kz(e){let t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function Kz(e){return~-encodeURI(e).split(/%..|./).length}function Uz(e){return Kz(JSON.stringify(e))}function xz(e,t){let n=t.replace(/\\/g,"/").replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),r=e;try{r=decodeURI(e)}catch{}return r.replace(/\\/g,"/").replace(/webpack:\/?/g,"").replace(new RegExp(`(file://)?/*${n}/*`,"ig"),"app:///")}No.normalize=JZ;No.normalizeToSize=zZ;No.normalizeUrlToBase=xz;No.walk=Uu});var PZ=I(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});function DZ(e,t){let n=0;for(let r=e.length-1;r>=0;r--){let i=e[r];i==="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var Lz=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function qZ(e){let t=e.length>1024?`<truncated>${e.slice(-1024)}`:e,n=Lz.exec(t);return n?n.slice(1):[]}function tp(...e){let t="",n=!1;for(let r=e.length-1;r>=-1&&!n;r--){let i=r>=0?e[r]:"/";i&&(t=`${i}/${t}`,n=i.charAt(0)==="/")}return t=DZ(t.split("/").filter(r=>!!r),!n).join("/"),(n?"/":"")+t||"."}function OZ(e){let t=0;for(;t<e.length&&e[t]==="";t++);let n=e.length-1;for(;n>=0&&e[n]==="";n--);return t>n?[]:e.slice(t,n-t+1)}function Jz(e,t){e=tp(e).slice(1),t=tp(t).slice(1);let n=OZ(e.split("/")),r=OZ(t.split("/")),i=Math.min(n.length,r.length),o=i;for(let a=0;a<i;a++)if(n[a]!==r[a]){o=a;break}let s=[];for(let a=o;a<n.length;a++)s.push("..");return s=s.concat(r.slice(o)),s.join("/")}function MZ(e){let t=jZ(e),n=e.slice(-1)==="/",r=DZ(e.split("/").filter(i=>!!i),!t).join("/");return!r&&!t&&(r="."),r&&n&&(r+="/"),(t?"/":"")+r}function jZ(e){return e.charAt(0)==="/"}function zz(...e){return MZ(e.join("/"))}function Oz(e){let t=qZ(e),n=t[0],r=t[1];return!n&&!r?".":(r&&(r=r.slice(0,r.length-1)),n+r)}function Dz(e,t){let n=qZ(e)[2];return t&&n.slice(t.length*-1)===t&&(n=n.slice(0,n.length-t.length)),n}Qn.basename=Dz;Qn.dirname=Oz;Qn.isAbsolute=jZ;Qn.join=zz;Qn.normalizePath=MZ;Qn.relative=Jz;Qn.resolve=tp});var np=I(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});var qz=qt(),$n;(function(e){e[e.PENDING=0]="PENDING";let n=1;e[e.RESOLVED=n]="RESOLVED";let r=2;e[e.REJECTED=r]="REJECTED"})($n||($n={}));function Mz(e){return new oa(t=>{t(e)})}function jz(e){return new oa((t,n)=>{n(e)})}var oa=class e{constructor(t){e.prototype.__init.call(this),e.prototype.__init2.call(this),e.prototype.__init3.call(this),e.prototype.__init4.call(this),this._state=$n.PENDING,this._handlers=[];try{t(this._resolve,this._reject)}catch(n){this._reject(n)}}then(t,n){return new e((r,i)=>{this._handlers.push([!1,o=>{if(!t)r(o);else try{r(t(o))}catch(s){i(s)}},o=>{if(!n)i(o);else try{r(n(o))}catch(s){i(s)}}]),this._executeHandlers()})}catch(t){return this.then(n=>n,t)}finally(t){return new e((n,r)=>{let i,o;return this.then(s=>{o=!1,i=s,t&&t()},s=>{o=!0,i=s,t&&t()}).then(()=>{if(o){r(i);return}n(i)})})}__init(){this._resolve=t=>{this._setResult($n.RESOLVED,t)}}__init2(){this._reject=t=>{this._setResult($n.REJECTED,t)}}__init3(){this._setResult=(t,n)=>{if(this._state===$n.PENDING){if(qz.isThenable(n)){n.then(this._resolve,this._reject);return}this._state=t,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===$n.PENDING)return;let t=this._handlers.slice();this._handlers=[],t.forEach(n=>{n[0]||(this._state===$n.RESOLVED&&n[1](this._value),this._state===$n.REJECTED&&n[2](this._value),n[0]=!0)})}}};sa.SyncPromise=oa;sa.rejectedSyncPromise=jz;sa.resolvedSyncPromise=Mz});var QZ=I(ip=>{"use strict";Object.defineProperty(ip,"__esModule",{value:!0});var Pz=Cm(),rp=np();function Qz(e){let t=[];function n(){return e===void 0||t.length<e}function r(s){return t.splice(t.indexOf(s),1)[0]}function i(s){if(!n())return rp.rejectedSyncPromise(new Pz.SentryError("Not adding Promise because buffer limit was reached."));let a=s();return t.indexOf(a)===-1&&t.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function o(s){return new rp.SyncPromise((a,c)=>{let l=t.length;if(!l)return a(!0);let u=setTimeout(()=>{s&&s>0&&a(!1)},s);t.forEach(d=>{rp.resolvedSyncPromise(d).then(()=>{--l||(clearTimeout(u),a(!0))},c)})})}return{$:t,add:i,drain:o}}ip.makePromiseBuffer=Qz});var $Z=I(op=>{"use strict";Object.defineProperty(op,"__esModule",{value:!0});function $z(e){let t={},n=0;for(;n<e.length;){let r=e.indexOf("=",n);if(r===-1)break;let i=e.indexOf(";",n);if(i===-1)i=e.length;else if(i<r){n=e.lastIndexOf(";",r-1)+1;continue}let o=e.slice(n,r).trim();if(t[o]===void 0){let s=e.slice(r+1,i).trim();s.charCodeAt(0)===34&&(s=s.slice(1,-1));try{t[o]=s.indexOf("%")!==-1?decodeURIComponent(s):s}catch{t[o]=s}}n=i+1}return t}op.parseCookie=$z});var sp=I(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});function eO(e){if(!e)return{};let t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};let n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}function tO(e){return e.split(/[\?#]/,1)[0]}function nO(e){return e.split(/\\?\//).filter(t=>t.length>0&&t!==",").length}function rO(e){let{protocol:t,host:n,path:r}=e,i=n&&n.replace(/^.*@/,"[filtered]:[filtered]@").replace(/(:80)$/,"").replace(/(:443)$/,"")||"";return`${t?`${t}://`:""}${i}${r}`}wo.getNumberOfUrlSegments=nO;wo.getSanitizedUrlString=rO;wo.parseUrl=eO;wo.stripUrlQueryAndFragment=tO});var iv=I(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});var iO=$Z(),oO=Zn(),ev=qt(),sO=gn(),aO=ia(),cO=sp(),uO={ip:!1,request:!0,transaction:!0,user:!0},lO=["cookies","data","headers","method","query_string","url"],tv=["id","username","email"];function gO(e,t,n){if(e){if(!e.metadata.source||e.metadata.source==="url"){let[r,i]=xu(t,{path:!0,method:!0});e.updateName(r),e.setMetadata({source:i})}e.setAttribute("url",t.originalUrl||t.url),t.baseUrl&&e.setAttribute("baseUrl",t.baseUrl),e.setData("query",nv(t,n))}}function xu(e,t={}){let n=e.method&&e.method.toUpperCase(),r="",i="url";t.customRoute||e.route?(r=t.customRoute||`${e.baseUrl||""}${e.route&&e.route.path}`,i="route"):(e.originalUrl||e.url)&&(r=cO.stripUrlQueryAndFragment(e.originalUrl||e.url||""));let o="";return t.method&&n&&(o+=n),t.method&&t.path&&(o+=" "),t.path&&r&&(o+=r),[o,i]}function dO(e,t){switch(t){case"path":return xu(e,{path:!0})[0];case"handler":return e.route&&e.route.stack&&e.route.stack[0]&&e.route.stack[0].name||"<anonymous>";case"methodPath":default:{let n=e._reconstructedRoute?e._reconstructedRoute:void 0;return xu(e,{path:!0,method:!0,customRoute:n})[0]}}}function IO(e,t){let n={};return(Array.isArray(t)?t:tv).forEach(i=>{e&&i in e&&(n[i]=e[i])}),n}function ap(e,t){let{include:n=lO,deps:r}=t||{},i={},o=e.headers||{},s=e.method,a=o.host||e.hostname||e.host||"<no host>",c=e.protocol==="https"||e.socket&&e.socket.encrypted?"https":"http",l=e.originalUrl||e.url||"",u=l.startsWith(c)?l:`${c}://${a}${l}`;return n.forEach(d=>{switch(d){case"headers":{i.headers=o,n.includes("cookies")||delete i.headers.cookie;break}case"method":{i.method=s;break}case"url":{i.url=u;break}case"cookies":{i.cookies=e.cookies||o.cookie&&iO.parseCookie(o.cookie)||{};break}case"query_string":{i.query_string=nv(e,r);break}case"data":{if(s==="GET"||s==="HEAD")break;e.body!==void 0&&(i.data=ev.isString(e.body)?e.body:JSON.stringify(aO.normalize(e.body)));break}default:({}).hasOwnProperty.call(e,d)&&(i[d]=e[d])}}),i}function mO(e,t,n){let r={...uO,...n&&n.include};if(r.request){let i=Array.isArray(r.request)?ap(t,{include:r.request,deps:n&&n.deps}):ap(t,{deps:n&&n.deps});e.request={...e.request,...i}}if(r.user){let i=t.user&&ev.isPlainObject(t.user)?IO(t.user,r.user):{};Object.keys(i).length&&(e.user={...e.user,...i})}if(r.ip){let i=t.ip||t.socket&&t.socket.remoteAddress;i&&(e.user={...e.user,ip_address:i})}return r.transaction&&!e.transaction&&(e.transaction=dO(t,r.transaction)),e}function nv(e,t){let n=e.originalUrl||e.url||"";if(n){n.startsWith("/")&&(n=`http://dogs.are.great${n}`);try{return e.query||typeof URL<"u"&&new URL(n).search.slice(1)||t&&t.url&&t.url.parse(n).query||void 0}catch{return}}}function rv(e){let t={};try{e.forEach((n,r)=>{typeof n=="string"&&(t[r]=n)})}catch{oO.DEBUG_BUILD&&sO.logger.warn("Sentry failed extracting headers from a request object. If you see this, please file an issue.")}return t}function pO(e){let t=rv(e.headers);return{method:e.method,url:e.url,headers:t}}er.DEFAULT_USER_INCLUDES=tv;er.addRequestDataToEvent=mO;er.addRequestDataToTransaction=gO;er.extractPathForTransaction=xu;er.extractRequestData=ap;er.winterCGHeadersToDict=rv;er.winterCGRequestToRequestData=pO});var av=I(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});var ov=["fatal","error","warning","log","info","debug"];function fO(e){return sv(e)}function sv(e){return e==="warn"?"warning":ov.includes(e)?e:"log"}aa.severityFromString=fO;aa.severityLevelFromString=sv;aa.validSeverityLevels=ov});var cp=I(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});var cv=Pe(),uv=1e3;function lv(){return Date.now()/uv}function hO(){let{performance:e}=cv.GLOBAL_OBJ;if(!e||!e.now)return lv;let t=Date.now()-e.now(),n=e.timeOrigin==null?t:e.timeOrigin;return()=>(n+e.now())/uv}var gv=hO(),CO=gv;mn._browserPerformanceTimeOriginMode=void 0;var bO=(()=>{let{performance:e}=cv.GLOBAL_OBJ;if(!e||!e.now){mn._browserPerformanceTimeOriginMode="none";return}let t=3600*1e3,n=e.now(),r=Date.now(),i=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,o=i<t,s=e.timing&&e.timing.navigationStart,c=typeof s=="number"?Math.abs(s+n-r):t,l=c<t;return o||l?i<=c?(mn._browserPerformanceTimeOriginMode="timeOrigin",e.timeOrigin):(mn._browserPerformanceTimeOriginMode="navigationStart",s):(mn._browserPerformanceTimeOriginMode="dateNow",r)})();mn.browserPerformanceTimeOrigin=bO;mn.dateTimestampInSeconds=lv;mn.timestampInSeconds=gv;mn.timestampWithMs=CO});var lp=I(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});var yO=Zn(),GO=qt(),BO=gn(),AO="baggage",up="sentry-",Iv=/^sentry-/,mv=8192;function ZO(e){if(!GO.isString(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce((r,i)=>{let o=dv(i);for(let s of Object.keys(o))r[s]=o[s];return r},{});else{if(!e)return;t=dv(e)}let n=Object.entries(t).reduce((r,[i,o])=>{if(i.match(Iv)){let s=i.slice(up.length);r[s]=o}return r},{});if(Object.keys(n).length>0)return n}function vO(e){if(!e)return;let t=Object.entries(e).reduce((n,[r,i])=>(i&&(n[`${up}${r}`]=i),n),{});return SO(t)}function dv(e){return e.split(",").map(t=>t.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((t,[n,r])=>(t[n]=r,t),{})}function SO(e){if(Object.keys(e).length!==0)return Object.entries(e).reduce((t,[n,r],i)=>{let o=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,s=i===0?o:`${t},${o}`;return s.length>mv?(yO.DEBUG_BUILD&&BO.logger.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),t):s},"")}Nr.BAGGAGE_HEADER_NAME=AO;Nr.MAX_BAGGAGE_STRING_LENGTH=mv;Nr.SENTRY_BAGGAGE_KEY_PREFIX=up;Nr.SENTRY_BAGGAGE_KEY_PREFIX_REGEX=Iv;Nr.baggageHeaderToDynamicSamplingContext=ZO;Nr.dynamicSamplingContextToSentryBaggageHeader=vO});var hv=I(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});var pv=lp(),jt=Qs(),fv=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function gp(e){if(!e)return;let t=e.match(fv);if(!t)return;let n;return t[3]==="1"?n=!0:t[3]==="0"&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}function WO(e,t){let n=gp(e),r=pv.baggageHeaderToDynamicSamplingContext(t),{traceId:i,parentSpanId:o,parentSampled:s}=n||{};return n?{traceparentData:n,dynamicSamplingContext:r||{},propagationContext:{traceId:i||jt.uuid4(),parentSpanId:o||jt.uuid4().substring(16),spanId:jt.uuid4().substring(16),sampled:s,dsc:r||{}}}:{traceparentData:n,dynamicSamplingContext:void 0,propagationContext:{traceId:i||jt.uuid4(),spanId:jt.uuid4().substring(16)}}}function RO(e,t){let n=gp(e),r=pv.baggageHeaderToDynamicSamplingContext(t),{traceId:i,parentSpanId:o,parentSampled:s}=n||{};return n?{traceId:i||jt.uuid4(),parentSpanId:o||jt.uuid4().substring(16),spanId:jt.uuid4().substring(16),sampled:s,dsc:r||{}}:{traceId:i||jt.uuid4(),spanId:jt.uuid4().substring(16)}}function VO(e=jt.uuid4(),t=jt.uuid4().substring(16),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${e}-${t}${r}`}bi.TRACEPARENT_REGEXP=fv;bi.extractTraceparentData=gp;bi.generateSentryTraceHeader=VO;bi.propagationContextFromHeaders=RO;bi.tracingContextFromHeaders=WO});var Ip=I(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});var NO=pm(),wO=ia(),Cv=Mt();function EO(e,t=[]){return[e,t]}function HO(e,t){let[n,r]=e;return[n,[...r,t]]}function bv(e,t){let n=e[1];for(let r of n){let i=r[0].type;if(t(r,i))return!0}return!1}function YO(e,t){return bv(e,(n,r)=>t.includes(r))}function dp(e,t){return(t||new TextEncoder).encode(e)}function XO(e,t){let[n,r]=e,i=JSON.stringify(n);function o(s){typeof i=="string"?i=typeof s=="string"?i+s:[dp(i,t),s]:i.push(typeof s=="string"?dp(s,t):s)}for(let s of r){let[a,c]=s;if(o(`
${JSON.stringify(a)}
`),typeof c=="string"||c instanceof Uint8Array)o(c);else{let l;try{l=JSON.stringify(c)}catch{l=JSON.stringify(wO.normalize(c))}o(l)}}return typeof i=="string"?i:_O(i)}function _O(e){let t=e.reduce((i,o)=>i+o.length,0),n=new Uint8Array(t),r=0;for(let i of e)n.set(i,r),r+=i.length;return n}function FO(e,t,n){let r=typeof e=="string"?t.encode(e):e;function i(c){let l=r.subarray(0,c);return r=r.subarray(c+1),l}function o(){let c=r.indexOf(10);return c<0&&(c=r.length),JSON.parse(n.decode(i(c)))}let s=o(),a=[];for(;r.length;){let c=o(),l=typeof c.length=="number"?c.length:void 0;a.push([c,l?i(l):o()])}return[s,a]}function TO(e,t){let n=typeof e.data=="string"?dp(e.data,t):e.data;return[Cv.dropUndefinedKeys({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}var kO={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function KO(e){return kO[e]}function UO(e){if(!e||!e.sdk)return;let{name:t,version:n}=e.sdk;return{name:t,version:n}}function xO(e,t,n,r){let i=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:NO.dsnToString(r)},...i&&{trace:Cv.dropUndefinedKeys({...i})}}}Pt.addItemToEnvelope=HO;Pt.createAttachmentEnvelopeItem=TO;Pt.createEnvelope=EO;Pt.createEventEnvelopeHeaders=xO;Pt.envelopeContainsItemType=YO;Pt.envelopeItemTypeToDataCategory=KO;Pt.forEachEnvelopeItem=bv;Pt.getSdkMetadataForEnvelopeHeader=UO;Pt.parseEnvelope=FO;Pt.serializeEnvelope=XO});var yv=I(mp=>{"use strict";Object.defineProperty(mp,"__esModule",{value:!0});var LO=Ip(),JO=cp();function zO(e,t,n){let r=[{type:"client_report"},{timestamp:n||JO.dateTimestampInSeconds(),discarded_events:e}];return LO.createEnvelope(t?{dsn:t}:{},[r])}mp.createClientReportEnvelope=zO});var Zv=I(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});var Gv=60*1e3;function Bv(e,t=Date.now()){let n=parseInt(`${e}`,10);if(!isNaN(n))return n*1e3;let r=Date.parse(`${e}`);return isNaN(r)?Gv:r-t}function Av(e,t){return e[t]||e.all||0}function OO(e,t,n=Date.now()){return Av(e,t)>n}function DO(e,{statusCode:t,headers:n},r=Date.now()){let i={...e},o=n&&n["x-sentry-rate-limits"],s=n&&n["retry-after"];if(o)for(let a of o.trim().split(",")){let[c,l,,,u]=a.split(":",5),d=parseInt(c,10),g=(isNaN(d)?60:d)*1e3;if(!l)i.all=r+g;else for(let m of l.split(";"))m==="metric_bucket"?(!u||u.split(";").includes("custom"))&&(i[m]=r+g):i[m]=r+g}else s?i.all=r+Bv(s,r):t===429&&(i.all=r+60*1e3);return i}yi.DEFAULT_RETRY_AFTER=Gv;yi.disabledUntil=Av;yi.isRateLimited=OO;yi.parseRetryAfterHeader=Bv;yi.updateRateLimits=DO});var Wv=I(pp=>{"use strict";Object.defineProperty(pp,"__esModule",{value:!0});function vv(e,t,n){let r=t.match(/([a-z_]+)\.(.*)/i);if(r===null)e[t]=n;else{let i=e[r[1]];vv(i,r[2],n)}}function qO(e,t,n={}){return Array.isArray(t)?Sv(e,t,n):MO(e,t,n)}function Sv(e,t,n){let r=t.find(i=>i.name===e.name);if(r){for(let[i,o]of Object.entries(n))vv(r,i,o);return t}return[...t,e]}function MO(e,t,n){return i=>{let o=t(i);return e.allowExclusionByUser&&!o.find(a=>a.name===e.name)?o:Sv(e,o,n)}}pp.addOrUpdateIntegration=qO});var Rv=I(fp=>{"use strict";Object.defineProperty(fp,"__esModule",{value:!0});function jO(e){let t=[],n={};return{add(r,i){for(;t.length>=e;){let o=t.shift();o!==void 0&&delete n[o]}n[r]&&this.delete(r),t.push(r),n[r]=i},clear(){n={},t=[]},get(r){return n[r]},size(){return t.length},delete(r){if(!n[r])return!1;delete n[r];for(let i=0;i<t.length;i++)if(t[i]===r){t.splice(i,1);break}return!0}}}fp.makeFifoCache=jO});var wv=I(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});var hp=qt(),Vv=Qs(),PO=ia(),QO=Mt();function Cp(e,t){return e(t.stack||"",1)}function Nv(e,t){let n={type:t.name||t.constructor.name,value:t.message},r=Cp(e,t);return r.length&&(n.stacktrace={frames:r}),n}function $O(e){if("name"in e&&typeof e.name=="string"){let t=`'${e.name}' captured as exception`;return"message"in e&&typeof e.message=="string"&&(t+=` with message '${e.message}'`),t}else return"message"in e&&typeof e.message=="string"?e.message:`Object captured as exception with keys: ${QO.extractExceptionKeysForMessage(e)}`}function e1(e,t,n,r){let i=typeof e=="function"?e().getClient():e,o=n,a=r&&r.data&&r.data.mechanism||{handled:!0,type:"generic"},c;if(!hp.isError(n)){if(hp.isPlainObject(n)){let u=i&&i.getOptions().normalizeDepth;c={__serialized__:PO.normalizeToSize(n,u)};let d=$O(n);o=r&&r.syntheticException||new Error(d),o.message=d}else o=r&&r.syntheticException||new Error(n),o.message=n;a.synthetic=!0}let l={exception:{values:[Nv(t,o)]}};return c&&(l.extra=c),Vv.addExceptionTypeValue(l,void 0,void 0),Vv.addExceptionMechanism(l,a),{...l,event_id:r&&r.event_id}}function t1(e,t,n="info",r,i){let o={event_id:r&&r.event_id,level:n};if(i&&r&&r.syntheticException){let s=Cp(e,r.syntheticException);s.length&&(o.exception={values:[{value:t,stacktrace:{frames:s}}]})}if(hp.isParameterizedString(t)){let{__sentry_template_string__:s,__sentry_template_values__:a}=t;return o.logentry={message:s,params:a},o}return o.message=t,o}Eo.eventFromMessage=t1;Eo.eventFromUnknownInput=e1;Eo.exceptionFromError=Nv;Eo.parseStackFrames=Cp});var Ev=I(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});var n1=Mt(),r1=Au();function i1(e,t,n,r){let i=e(),o=!1,s=!0;return setInterval(()=>{let a=i.getTimeMs();o===!1&&a>t+n&&(o=!0,s&&r()),a<t+n&&(o=!1)},20),{poll:()=>{i.reset()},enabled:a=>{s=a}}}function o1(e,t,n){let r=t?t.replace(/^file:\/\//,""):void 0,i=e.location.columnNumber?e.location.columnNumber+1:void 0,o=e.location.lineNumber?e.location.lineNumber+1:void 0;return n1.dropUndefinedKeys({filename:r,module:n(r),function:e.functionName||"?",colno:i,lineno:o,in_app:r?r1.filenameIsInApp(r):void 0})}Lu.callFrameToStackFrame=o1;Lu.watchdogTimer=i1});var Hv=I(yp=>{"use strict";Object.defineProperty(yp,"__esModule",{value:!0});var bp=class{constructor(t){this._maxSize=t,this._cache=new Map}get size(){return this._cache.size}get(t){let n=this._cache.get(t);if(n!==void 0)return this._cache.delete(t),this._cache.set(t,n),n}set(t,n){this._cache.size>=this._maxSize&&this._cache.delete(this._cache.keys().next().value),this._cache.set(t,n)}remove(t){let n=this._cache.get(t);return n&&this._cache.delete(t),n}clear(){this._cache.clear()}keys(){return Array.from(this._cache.keys())}values(){let t=[];return this._cache.forEach(n=>t.push(n)),t}};yp.LRUMap=bp});var Bp=I(Gp=>{"use strict";Object.defineProperty(Gp,"__esModule",{value:!0});function s1(e,t){return e??t()}Gp._nullishCoalesce=s1});var Yv=I(Ap=>{"use strict";Object.defineProperty(Ap,"__esModule",{value:!0});var a1=Bp();async function c1(e,t){return a1._nullishCoalesce(e,t)}Ap._asyncNullishCoalesce=c1});var vp=I(Zp=>{"use strict";Object.defineProperty(Zp,"__esModule",{value:!0});async function u1(e){let t,n=e[0],r=1;for(;r<e.length;){let i=e[r],o=e[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(t=n,n=await o(n)):(i==="call"||i==="optionalCall")&&(n=await o((...s)=>n.call(t,...s)),t=void 0)}return n}Zp._asyncOptionalChain=u1});var Xv=I(Sp=>{"use strict";Object.defineProperty(Sp,"__esModule",{value:!0});var l1=vp();async function g1(e){let t=await l1._asyncOptionalChain(e);return t??!0}Sp._asyncOptionalChainDelete=g1});var Rp=I(Wp=>{"use strict";Object.defineProperty(Wp,"__esModule",{value:!0});function d1(e){let t,n=e[0],r=1;for(;r<e.length;){let i=e[r],o=e[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(t=n,n=o(n)):(i==="call"||i==="optionalCall")&&(n=o((...s)=>n.call(t,...s)),t=void 0)}return n}Wp._optionalChain=d1});var _v=I(Vp=>{"use strict";Object.defineProperty(Vp,"__esModule",{value:!0});var I1=Rp();function m1(e){let t=I1._optionalChain(e);return t??!0}Vp._optionalChainDelete=m1});var Fv=I(Np=>{"use strict";Object.defineProperty(Np,"__esModule",{value:!0});function p1(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}Np.escapeStringForRegex=p1});var R=I(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});var f1=cZ(),Ju=lm(),wp=pm(),h1=Cm(),Ep=Pe(),C1=UZ(),Qe=qt(),b1=LZ(),zu=gn(),y1=$m(),wr=Qs(),Hp=jm(),Ou=ia(),tr=Mt(),Gi=PZ(),G1=QZ(),Bi=iv(),Yp=av(),ca=Zu(),ua=qs(),Er=Em(),Xp=np(),la=cp(),ga=hv(),Tv=Mm(),Wn=Ip(),B1=yv(),da=Zv(),Ho=lp(),Du=sp(),A1=Wv(),Z1=Rv(),qu=wv(),kv=Ev(),v1=Hv(),S1=Yv(),W1=vp(),R1=Xv(),V1=Bp(),N1=Rp(),w1=_v(),E1=Zm(),H1=Vm(),Kv=Dm(),Y1=Ym(),X1=Om(),_1=Tm(),F1=xm(),T1=Pn(),k1=Au(),K1=Fv(),U1=Jm();Z.applyAggregateErrorsToEvent=f1.applyAggregateErrorsToEvent;Z.getComponentName=Ju.getComponentName;Z.getDomElement=Ju.getDomElement;Z.getLocationHref=Ju.getLocationHref;Z.htmlTreeAsString=Ju.htmlTreeAsString;Z.dsnFromString=wp.dsnFromString;Z.dsnToString=wp.dsnToString;Z.makeDsn=wp.makeDsn;Z.SentryError=h1.SentryError;Z.GLOBAL_OBJ=Ep.GLOBAL_OBJ;Z.getGlobalObject=Ep.getGlobalObject;Z.getGlobalSingleton=Ep.getGlobalSingleton;Z.addInstrumentationHandler=C1.addInstrumentationHandler;Z.isDOMError=Qe.isDOMError;Z.isDOMException=Qe.isDOMException;Z.isElement=Qe.isElement;Z.isError=Qe.isError;Z.isErrorEvent=Qe.isErrorEvent;Z.isEvent=Qe.isEvent;Z.isInstanceOf=Qe.isInstanceOf;Z.isNaN=Qe.isNaN;Z.isParameterizedString=Qe.isParameterizedString;Z.isPlainObject=Qe.isPlainObject;Z.isPrimitive=Qe.isPrimitive;Z.isRegExp=Qe.isRegExp;Z.isString=Qe.isString;Z.isSyntheticEvent=Qe.isSyntheticEvent;Z.isThenable=Qe.isThenable;Z.isVueViewModel=Qe.isVueViewModel;Z.isBrowser=b1.isBrowser;Z.CONSOLE_LEVELS=zu.CONSOLE_LEVELS;Z.consoleSandbox=zu.consoleSandbox;Z.logger=zu.logger;Z.originalConsoleMethods=zu.originalConsoleMethods;Z.memoBuilder=y1.memoBuilder;Z.addContextToFrame=wr.addContextToFrame;Z.addExceptionMechanism=wr.addExceptionMechanism;Z.addExceptionTypeValue=wr.addExceptionTypeValue;Z.arrayify=wr.arrayify;Z.checkOrSetAlreadyCaught=wr.checkOrSetAlreadyCaught;Z.getEventDescription=wr.getEventDescription;Z.parseSemver=wr.parseSemver;Z.uuid4=wr.uuid4;Z.dynamicRequire=Hp.dynamicRequire;Z.isNodeEnv=Hp.isNodeEnv;Z.loadModule=Hp.loadModule;Z.normalize=Ou.normalize;Z.normalizeToSize=Ou.normalizeToSize;Z.normalizeUrlToBase=Ou.normalizeUrlToBase;Z.walk=Ou.walk;Z.addNonEnumerableProperty=tr.addNonEnumerableProperty;Z.convertToPlainObject=tr.convertToPlainObject;Z.dropUndefinedKeys=tr.dropUndefinedKeys;Z.extractExceptionKeysForMessage=tr.extractExceptionKeysForMessage;Z.fill=tr.fill;Z.getOriginalFunction=tr.getOriginalFunction;Z.markFunctionWrapped=tr.markFunctionWrapped;Z.objectify=tr.objectify;Z.urlEncode=tr.urlEncode;Z.basename=Gi.basename;Z.dirname=Gi.dirname;Z.isAbsolute=Gi.isAbsolute;Z.join=Gi.join;Z.normalizePath=Gi.normalizePath;Z.relative=Gi.relative;Z.resolve=Gi.resolve;Z.makePromiseBuffer=G1.makePromiseBuffer;Z.DEFAULT_USER_INCLUDES=Bi.DEFAULT_USER_INCLUDES;Z.addRequestDataToEvent=Bi.addRequestDataToEvent;Z.addRequestDataToTransaction=Bi.addRequestDataToTransaction;Z.extractPathForTransaction=Bi.extractPathForTransaction;Z.extractRequestData=Bi.extractRequestData;Z.winterCGHeadersToDict=Bi.winterCGHeadersToDict;Z.winterCGRequestToRequestData=Bi.winterCGRequestToRequestData;Z.severityFromString=Yp.severityFromString;Z.severityLevelFromString=Yp.severityLevelFromString;Z.validSeverityLevels=Yp.validSeverityLevels;Z.createStackParser=ca.createStackParser;Z.getFunctionName=ca.getFunctionName;Z.nodeStackLineParser=ca.nodeStackLineParser;Z.stackParserFromStackParserOptions=ca.stackParserFromStackParserOptions;Z.stripSentryFramesAndReverse=ca.stripSentryFramesAndReverse;Z.isMatchingPattern=ua.isMatchingPattern;Z.safeJoin=ua.safeJoin;Z.snipLine=ua.snipLine;Z.stringMatchesSomePattern=ua.stringMatchesSomePattern;Z.truncate=ua.truncate;Z.isNativeFetch=Er.isNativeFetch;Z.supportsDOMError=Er.supportsDOMError;Z.supportsDOMException=Er.supportsDOMException;Z.supportsErrorEvent=Er.supportsErrorEvent;Z.supportsFetch=Er.supportsFetch;Z.supportsNativeFetch=Er.supportsNativeFetch;Z.supportsReferrerPolicy=Er.supportsReferrerPolicy;Z.supportsReportingObserver=Er.supportsReportingObserver;Z.SyncPromise=Xp.SyncPromise;Z.rejectedSyncPromise=Xp.rejectedSyncPromise;Z.resolvedSyncPromise=Xp.resolvedSyncPromise;Object.defineProperty(Z,"_browserPerformanceTimeOriginMode",{enumerable:!0,get:()=>la._browserPerformanceTimeOriginMode});Z.browserPerformanceTimeOrigin=la.browserPerformanceTimeOrigin;Z.dateTimestampInSeconds=la.dateTimestampInSeconds;Z.timestampInSeconds=la.timestampInSeconds;Z.timestampWithMs=la.timestampWithMs;Z.TRACEPARENT_REGEXP=ga.TRACEPARENT_REGEXP;Z.extractTraceparentData=ga.extractTraceparentData;Z.generateSentryTraceHeader=ga.generateSentryTraceHeader;Z.propagationContextFromHeaders=ga.propagationContextFromHeaders;Z.tracingContextFromHeaders=ga.tracingContextFromHeaders;Z.getSDKSource=Tv.getSDKSource;Z.isBrowserBundle=Tv.isBrowserBundle;Z.addItemToEnvelope=Wn.addItemToEnvelope;Z.createAttachmentEnvelopeItem=Wn.createAttachmentEnvelopeItem;Z.createEnvelope=Wn.createEnvelope;Z.createEventEnvelopeHeaders=Wn.createEventEnvelopeHeaders;Z.envelopeContainsItemType=Wn.envelopeContainsItemType;Z.envelopeItemTypeToDataCategory=Wn.envelopeItemTypeToDataCategory;Z.forEachEnvelopeItem=Wn.forEachEnvelopeItem;Z.getSdkMetadataForEnvelopeHeader=Wn.getSdkMetadataForEnvelopeHeader;Z.parseEnvelope=Wn.parseEnvelope;Z.serializeEnvelope=Wn.serializeEnvelope;Z.createClientReportEnvelope=B1.createClientReportEnvelope;Z.DEFAULT_RETRY_AFTER=da.DEFAULT_RETRY_AFTER;Z.disabledUntil=da.disabledUntil;Z.isRateLimited=da.isRateLimited;Z.parseRetryAfterHeader=da.parseRetryAfterHeader;Z.updateRateLimits=da.updateRateLimits;Z.BAGGAGE_HEADER_NAME=Ho.BAGGAGE_HEADER_NAME;Z.MAX_BAGGAGE_STRING_LENGTH=Ho.MAX_BAGGAGE_STRING_LENGTH;Z.SENTRY_BAGGAGE_KEY_PREFIX=Ho.SENTRY_BAGGAGE_KEY_PREFIX;Z.SENTRY_BAGGAGE_KEY_PREFIX_REGEX=Ho.SENTRY_BAGGAGE_KEY_PREFIX_REGEX;Z.baggageHeaderToDynamicSamplingContext=Ho.baggageHeaderToDynamicSamplingContext;Z.dynamicSamplingContextToSentryBaggageHeader=Ho.dynamicSamplingContextToSentryBaggageHeader;Z.getNumberOfUrlSegments=Du.getNumberOfUrlSegments;Z.getSanitizedUrlString=Du.getSanitizedUrlString;Z.parseUrl=Du.parseUrl;Z.stripUrlQueryAndFragment=Du.stripUrlQueryAndFragment;Z.addOrUpdateIntegration=A1.addOrUpdateIntegration;Z.makeFifoCache=Z1.makeFifoCache;Z.eventFromMessage=qu.eventFromMessage;Z.eventFromUnknownInput=qu.eventFromUnknownInput;Z.exceptionFromError=qu.exceptionFromError;Z.parseStackFrames=qu.parseStackFrames;Z.callFrameToStackFrame=kv.callFrameToStackFrame;Z.watchdogTimer=kv.watchdogTimer;Z.LRUMap=v1.LRUMap;Z._asyncNullishCoalesce=S1._asyncNullishCoalesce;Z._asyncOptionalChain=W1._asyncOptionalChain;Z._asyncOptionalChainDelete=R1._asyncOptionalChainDelete;Z._nullishCoalesce=V1._nullishCoalesce;Z._optionalChain=N1._optionalChain;Z._optionalChainDelete=w1._optionalChainDelete;Z.addConsoleInstrumentationHandler=E1.addConsoleInstrumentationHandler;Z.addClickKeypressInstrumentationHandler=H1.addClickKeypressInstrumentationHandler;Z.SENTRY_XHR_DATA_KEY=Kv.SENTRY_XHR_DATA_KEY;Z.addXhrInstrumentationHandler=Kv.addXhrInstrumentationHandler;Z.addFetchInstrumentationHandler=Y1.addFetchInstrumentationHandler;Z.addHistoryInstrumentationHandler=X1.addHistoryInstrumentationHandler;Z.addGlobalErrorInstrumentationHandler=_1.addGlobalErrorInstrumentationHandler;Z.addGlobalUnhandledRejectionInstrumentationHandler=F1.addGlobalUnhandledRejectionInstrumentationHandler;Z.resetInstrumentationHandlers=T1.resetInstrumentationHandlers;Z.filenameIsInApp=k1.filenameIsInApp;Z.escapeStringForRegex=K1.escapeStringForRegex;Z.supportsHistory=U1.supportsHistory});var we=I(_p=>{"use strict";Object.defineProperty(_p,"__esModule",{value:!0});var x1=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;_p.DEBUG_BUILD=x1});var Yo=I(Fp=>{"use strict";Object.defineProperty(Fp,"__esModule",{value:!0});var L1="production";Fp.DEFAULT_ENVIRONMENT=L1});var ma=I(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});var Mu=R(),J1=we();function Uv(){return Mu.getGlobalSingleton("globalEventProcessors",()=>[])}function z1(e){Uv().push(e)}function Tp(e,t,n,r=0){return new Mu.SyncPromise((i,o)=>{let s=e[r];if(t===null||typeof s!="function")i(t);else{let a=s({...t},n);J1.DEBUG_BUILD&&s.id&&a===null&&Mu.logger.log(`Event processor "${s.id}" dropped event`),Mu.isThenable(a)?a.then(c=>Tp(e,c,n,r+1).then(i)).then(null,o):Tp(e,a,n,r+1).then(i).then(null,o)}})}Ia.addGlobalEventProcessor=z1;Ia.getGlobalEventProcessors=Uv;Ia.notifyEventProcessors=Tp});var Xo=I(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});var pa=R();function O1(e){let t=pa.timestampInSeconds(),n={sid:pa.uuid4(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>q1(n)};return e&&kp(n,e),n}function kp(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||pa.timestampInSeconds(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:pa.uuid4()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{let n=e.timestamp-e.started;e.duration=n>=0?n:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function D1(e,t){let n={};t?n={status:t}:e.status==="ok"&&(n={status:"exited"}),kp(e,n)}function q1(e){return pa.dropUndefinedKeys({sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}fa.closeSession=D1;fa.makeSession=O1;fa.updateSession=kp});var yt=I(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});var Kp=R(),M1=0,Lv=1;function j1(e){let{spanId:t,traceId:n}=e.spanContext(),{data:r,op:i,parent_span_id:o,status:s,tags:a,origin:c}=Jv(e);return Kp.dropUndefinedKeys({data:r,op:i,parent_span_id:o,span_id:t,status:s,tags:a,trace_id:n,origin:c})}function P1(e){let{traceId:t,spanId:n}=e.spanContext(),r=zv(e);return Kp.generateSentryTraceHeader(t,n,r)}function Q1(e){return typeof e=="number"?xv(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?xv(e.getTime()):Kp.timestampInSeconds()}function xv(e){return e>9999999999?e/1e3:e}function Jv(e){return $1(e)?e.getSpanJSON():typeof e.toJSON=="function"?e.toJSON():{}}function $1(e){return typeof e.getSpanJSON=="function"}function zv(e){let{traceFlags:t}=e.spanContext();return!!(t&Lv)}nr.TRACE_FLAG_NONE=M1;nr.TRACE_FLAG_SAMPLED=Lv;nr.spanIsSampled=zv;nr.spanTimeInputToSeconds=Q1;nr.spanToJSON=Jv;nr.spanToTraceContext=j1;nr.spanToTraceHeader=P1});var ju=I(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});var Xt=R(),e3=Yo(),Ov=ma(),xp=Qu(),Up=Pu(),t3=yt();function n3(e,t,n,r,i,o){let{normalizeDepth:s=3,normalizeMaxBreadth:a=1e3}=e,c={...t,event_id:t.event_id||n.event_id||Xt.uuid4(),timestamp:t.timestamp||Xt.dateTimestampInSeconds()},l=n.integrations||e.integrations.map(y=>y.name);r3(c,e),i3(c,l),t.type===void 0&&qv(c,e.stackParser);let u=s3(r,n.captureContext);n.mechanism&&Xt.addExceptionMechanism(c,n.mechanism);let d=i&&i.getEventProcessors?i.getEventProcessors():[],g=xp.getGlobalScope().getScopeData();if(o){let y=o.getScopeData();Up.mergeScopeData(g,y)}if(u){let y=u.getScopeData();Up.mergeScopeData(g,y)}let m=[...n.attachments||[],...g.attachments];m.length&&(n.attachments=m),Up.applyScopeDataToEvent(c,g);let h=[...d,...Ov.getGlobalEventProcessors(),...g.eventProcessors];return Ov.notifyEventProcessors(h,c,n).then(y=>(y&&Mv(y),typeof s=="number"&&s>0?o3(y,s,a):y))}function r3(e,t){let{environment:n,release:r,dist:i,maxValueLength:o=250}=t;"environment"in e||(e.environment="environment"in t?n:e3.DEFAULT_ENVIRONMENT),e.release===void 0&&r!==void 0&&(e.release=r),e.dist===void 0&&i!==void 0&&(e.dist=i),e.message&&(e.message=Xt.truncate(e.message,o));let s=e.exception&&e.exception.values&&e.exception.values[0];s&&s.value&&(s.value=Xt.truncate(s.value,o));let a=e.request;a&&a.url&&(a.url=Xt.truncate(a.url,o))}var Dv=new WeakMap;function qv(e,t){let n=Xt.GLOBAL_OBJ._sentryDebugIds;if(!n)return;let r,i=Dv.get(t);i?r=i:(r=new Map,Dv.set(t,r));let o=Object.keys(n).reduce((s,a)=>{let c,l=r.get(a);l?c=l:(c=t(a),r.set(a,c));for(let u=c.length-1;u>=0;u--){let d=c[u];if(d.filename){s[d.filename]=n[a];break}}return s},{});try{e.exception.values.forEach(s=>{s.stacktrace.frames.forEach(a=>{a.filename&&(a.debug_id=o[a.filename])})})}catch{}}function Mv(e){let t={};try{e.exception.values.forEach(r=>{r.stacktrace.frames.forEach(i=>{i.debug_id&&(i.abs_path?t[i.abs_path]=i.debug_id:i.filename&&(t[i.filename]=i.debug_id),delete i.debug_id)})})}catch{}if(Object.keys(t).length===0)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];let n=e.debug_meta.images;Object.keys(t).forEach(r=>{n.push({type:"sourcemap",code_file:r,debug_id:t[r]})})}function i3(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function o3(e,t,n){if(!e)return null;let r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(i=>({...i,...i.data&&{data:Xt.normalize(i.data,t,n)}}))},...e.user&&{user:Xt.normalize(e.user,t,n)},...e.contexts&&{contexts:Xt.normalize(e.contexts,t,n)},...e.extra&&{extra:Xt.normalize(e.extra,t,n)}};return e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=Xt.normalize(e.contexts.trace.data,t,n))),e.spans&&(r.spans=e.spans.map(i=>{let o=t3.spanToJSON(i).data;return o&&(i.data=Xt.normalize(o,t,n)),i})),r}function s3(e,t){if(!t)return e;let n=e?e.clone():new xp.Scope;return n.update(t),n}function a3(e){if(e)return c3(e)?{captureContext:e}:l3(e)?{captureContext:e}:e}function c3(e){return e instanceof xp.Scope||typeof e=="function"}var u3=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function l3(e){return Object.keys(e).some(t=>u3.includes(t))}_o.applyDebugIds=qv;_o.applyDebugMeta=Mv;_o.parseEventHintOrCaptureContext=a3;_o.prepareEvent=n3});var Qt=I(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});var rr=R(),g3=Yo(),$u=we(),Re=Rn(),Lp=Xo(),d3=ju();function I3(e,t){return Re.getCurrentHub().captureException(e,d3.parseEventHintOrCaptureContext(t))}function m3(e,t){let n=typeof t=="string"?t:void 0,r=typeof t!="string"?{captureContext:t}:void 0;return Re.getCurrentHub().captureMessage(e,n,r)}function p3(e,t){return Re.getCurrentHub().captureEvent(e,t)}function f3(e){Re.getCurrentHub().configureScope(e)}function h3(e,t){Re.getCurrentHub().addBreadcrumb(e,t)}function C3(e,t){Re.getCurrentHub().setContext(e,t)}function b3(e){Re.getCurrentHub().setExtras(e)}function y3(e,t){Re.getCurrentHub().setExtra(e,t)}function G3(e){Re.getCurrentHub().setTags(e)}function B3(e,t){Re.getCurrentHub().setTag(e,t)}function A3(e){Re.getCurrentHub().setUser(e)}function jv(...e){let t=Re.getCurrentHub();if(e.length===2){let[n,r]=e;return n?t.withScope(()=>(t.getStackTop().scope=n,r(n))):t.withScope(r)}return t.withScope(e[0])}function Z3(e){return Re.runWithAsyncContext(()=>e(Re.getIsolationScope()))}function v3(e,t){return jv(n=>(n.setSpan(e),t(n)))}function S3(e,t){return Re.getCurrentHub().startTransaction({...e},t)}function Jp(e,t){let n=ha(),r=Ai();if(!r)$u.DEBUG_BUILD&&rr.logger.warn("Cannot capture check-in. No client defined.");else if(!r.captureCheckIn)$u.DEBUG_BUILD&&rr.logger.warn("Cannot capture check-in. Client does not support sending check-ins.");else return r.captureCheckIn(e,t,n);return rr.uuid4()}function W3(e,t,n){let r=Jp({monitorSlug:e,status:"in_progress"},n),i=rr.timestampInSeconds();function o(a){Jp({monitorSlug:e,status:a,checkInId:r,duration:rr.timestampInSeconds()-i})}let s;try{s=t()}catch(a){throw o("error"),a}return rr.isThenable(s)?Promise.resolve(s).then(()=>{o("ok")},()=>{o("error")}):o("ok"),s}async function R3(e){let t=Ai();return t?t.flush(e):($u.DEBUG_BUILD&&rr.logger.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function V3(e){let t=Ai();return t?t.close(e):($u.DEBUG_BUILD&&rr.logger.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function N3(){return Re.getCurrentHub().lastEventId()}function Ai(){return Re.getCurrentHub().getClient()}function w3(){return!!Ai()}function ha(){return Re.getCurrentHub().getScope()}function E3(e){let t=Ai(),n=Re.getIsolationScope(),r=ha(),{release:i,environment:o=g3.DEFAULT_ENVIRONMENT}=t&&t.getOptions()||{},{userAgent:s}=rr.GLOBAL_OBJ.navigator||{},a=Lp.makeSession({release:i,environment:o,user:r.getUser()||n.getUser(),...s&&{userAgent:s},...e}),c=n.getSession();return c&&c.status==="ok"&&Lp.updateSession(c,{status:"exited"}),zp(),n.setSession(a),r.setSession(a),a}function zp(){let e=Re.getIsolationScope(),t=ha(),n=t.getSession()||e.getSession();n&&Lp.closeSession(n),Pv(),e.setSession(),t.setSession()}function Pv(){let e=Re.getIsolationScope(),t=ha(),n=Ai(),r=t.getSession()||e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}function H3(e=!1){if(e){zp();return}Pv()}me.addBreadcrumb=h3;me.captureCheckIn=Jp;me.captureEvent=p3;me.captureException=I3;me.captureMessage=m3;me.captureSession=H3;me.close=V3;me.configureScope=f3;me.endSession=zp;me.flush=R3;me.getClient=Ai;me.getCurrentScope=ha;me.isInitialized=w3;me.lastEventId=N3;me.setContext=C3;me.setExtra=y3;me.setExtras=b3;me.setTag=B3;me.setTags=G3;me.setUser=A3;me.startSession=E3;me.startTransaction=S3;me.withActiveSpan=v3;me.withIsolationScope=Z3;me.withMonitor=W3;me.withScope=jv});var Fo=I(Op=>{"use strict";Object.defineProperty(Op,"__esModule",{value:!0});function Y3(e){return e.transaction}Op.getRootSpan=Y3});var Zi=I(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});var X3=R(),_3=Yo(),Qv=Qt(),F3=Fo(),Dp=yt();function $v(e,t,n){let r=t.getOptions(),{publicKey:i}=t.getDsn()||{},{segment:o}=n&&n.getUser()||{},s=X3.dropUndefinedKeys({environment:r.environment||_3.DEFAULT_ENVIRONMENT,release:r.release,user_segment:o,public_key:i,trace_id:e});return t.emit&&t.emit("createDsc",s),s}function T3(e){let t=Qv.getClient();if(!t)return{};let n=$v(Dp.spanToJSON(e).trace_id||"",t,Qv.getCurrentScope()),r=F3.getRootSpan(e);if(!r)return n;let i=r&&r._frozenDynamicSamplingContext;if(i)return i;let{sampleRate:o,source:s}=r.metadata;o!=null&&(n.sample_rate=`${o}`);let a=Dp.spanToJSON(r);return s&&s!=="url"&&(n.transaction=a.description),n.sampled=String(Dp.spanIsSampled(r)),t.emit&&t.emit("createDsc",n),n}el.getDynamicSamplingContextFromClient=$v;el.getDynamicSamplingContextFromSpan=T3});var Pu=I(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});var Ca=R(),k3=Zi(),K3=Fo(),eS=yt();function U3(e,t){let{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:o}=t;L3(e,t),r&&O3(e,r),D3(e,n),J3(e,i),z3(e,o)}function x3(e,t){let{extra:n,tags:r,user:i,contexts:o,level:s,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:l,eventProcessors:u,attachments:d,propagationContext:g,transactionName:m,span:h}=t;To(e,"extra",n),To(e,"tags",r),To(e,"user",i),To(e,"contexts",o),To(e,"sdkProcessingMetadata",a),s&&(e.level=s),m&&(e.transactionName=m),h&&(e.span=h),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),l.length&&(e.fingerprint=[...e.fingerprint,...l]),u.length&&(e.eventProcessors=[...e.eventProcessors,...u]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...g}}function To(e,t,n){if(n&&Object.keys(n).length){e[t]={...e[t]};for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[t][r]=n[r])}}function L3(e,t){let{extra:n,tags:r,user:i,contexts:o,level:s,transactionName:a}=t,c=Ca.dropUndefinedKeys(n);c&&Object.keys(c).length&&(e.extra={...c,...e.extra});let l=Ca.dropUndefinedKeys(r);l&&Object.keys(l).length&&(e.tags={...l,...e.tags});let u=Ca.dropUndefinedKeys(i);u&&Object.keys(u).length&&(e.user={...u,...e.user});let d=Ca.dropUndefinedKeys(o);d&&Object.keys(d).length&&(e.contexts={...d,...e.contexts}),s&&(e.level=s),a&&(e.transaction=a)}function J3(e,t){let n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}function z3(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}function O3(e,t){e.contexts={trace:eS.spanToTraceContext(t),...e.contexts};let n=K3.getRootSpan(t);if(n){e.sdkProcessingMetadata={dynamicSamplingContext:k3.getDynamicSamplingContextFromSpan(t),...e.sdkProcessingMetadata};let r=eS.spanToJSON(n).description;r&&(e.tags={transaction:r,...e.tags})}}function D3(e,t){e.fingerprint=e.fingerprint?Ca.arrayify(e.fingerprint):[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}ba.applyScopeDataToEvent=U3;ba.mergeAndOverwriteScopeData=To;ba.mergeScopeData=x3});var Qu=I(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});var Vn=R(),tS=ma(),q3=Xo(),M3=Pu(),j3=100,tl,nl=class e{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=nS()}static clone(t){return t?t.clone():new e}clone(){let t=new e;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},t._user=this._user,t._level=this._level,t._span=this._span,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._requestSession=this._requestSession,t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t}setClient(t){this._client=t}getClient(){return this._client}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&q3.updateSession(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,n){return this._tags={...this._tags,[t]:n},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,n){return this._extra={...this._extra,[t]:n},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,n){return n===null?delete this._contexts[t]:this._contexts[t]=n,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){let t=this._span;return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;let n=typeof t=="function"?t(this):t;if(n instanceof e){let r=n.getScopeData();this._tags={...this._tags,...r.tags},this._extra={...this._extra,...r.extra},this._contexts={...this._contexts,...r.contexts},r.user&&Object.keys(r.user).length&&(this._user=r.user),r.level&&(this._level=r.level),r.fingerprint.length&&(this._fingerprint=r.fingerprint),n.getRequestSession()&&(this._requestSession=n.getRequestSession()),r.propagationContext&&(this._propagationContext=r.propagationContext)}else if(Vn.isPlainObject(n)){let r=t;this._tags={...this._tags,...r.tags},this._extra={...this._extra,...r.extra},this._contexts={...this._contexts,...r.contexts},r.user&&(this._user=r.user),r.level&&(this._level=r.level),r.fingerprint&&(this._fingerprint=r.fingerprint),r.requestSession&&(this._requestSession=r.requestSession),r.propagationContext&&(this._propagationContext=r.propagationContext)}return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=nS(),this}addBreadcrumb(t,n){let r=typeof n=="number"?n:j3;if(r<=0)return this;let i={timestamp:Vn.dateTimestampInSeconds(),...t},o=this._breadcrumbs;return o.push(i),this._breadcrumbs=o.length>r?o.slice(-r):o,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){let{_breadcrumbs:t,_attachments:n,_contexts:r,_tags:i,_extra:o,_user:s,_level:a,_fingerprint:c,_eventProcessors:l,_propagationContext:u,_sdkProcessingMetadata:d,_transactionName:g,_span:m}=this;return{breadcrumbs:t,attachments:n,contexts:r,tags:i,extra:o,user:s,level:a,fingerprint:c||[],eventProcessors:l,propagationContext:u,sdkProcessingMetadata:d,transactionName:g,span:m}}applyToEvent(t,n={},r=[]){M3.applyScopeDataToEvent(t,this.getScopeData());let i=[...r,...tS.getGlobalEventProcessors(),...this._eventProcessors];return tS.notifyEventProcessors(i,t,n)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...t},this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,n){let r=n&&n.event_id?n.event_id:Vn.uuid4();if(!this._client)return Vn.logger.warn("No client configured on scope - will not capture exception!"),r;let i=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:i,...n,event_id:r},this),r}captureMessage(t,n,r){let i=r&&r.event_id?r.event_id:Vn.uuid4();if(!this._client)return Vn.logger.warn("No client configured on scope - will not capture message!"),i;let o=new Error(t);return this._client.captureMessage(t,n,{originalException:t,syntheticException:o,...r,event_id:i},this),i}captureEvent(t,n){let r=n&&n.event_id?n.event_id:Vn.uuid4();return this._client?(this._client.captureEvent(t,{...n,event_id:r},this),r):(Vn.logger.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}};function P3(){return tl||(tl=new nl),tl}function Q3(e){tl=e}function nS(){return{traceId:Vn.uuid4(),spanId:Vn.uuid4().substring(16)}}ya.Scope=nl;ya.getGlobalScope=P3;ya.setGlobalScope=Q3});var rl=I(qp=>{"use strict";Object.defineProperty(qp,"__esModule",{value:!0});var $3="7.119.2";qp.SDK_VERSION=$3});var Rn=I(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});var ct=R(),eD=Yo(),Mp=we(),rS=Qu(),jp=Xo(),tD=rl(),il=parseFloat(tD.SDK_VERSION),nD=100,ko=class{constructor(t,n,r,i=il){this._version=i;let o;n?o=n:(o=new rS.Scope,o.setClient(t));let s;r?s=r:(s=new rS.Scope,s.setClient(t)),this._stack=[{scope:o}],t&&this.bindClient(t),this._isolationScope=s}isOlderThan(t){return this._version<t}bindClient(t){let n=this.getStackTop();n.client=t,n.scope.setClient(t),t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){let t=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(t){let n=this.pushScope(),r;try{r=t(n)}catch(i){throw this.popScope(),i}return ct.isThenable(r)?r.then(i=>(this.popScope(),i),i=>{throw this.popScope(),i}):(this.popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,n){let r=this._lastEventId=n&&n.event_id?n.event_id:ct.uuid4(),i=new Error("Sentry syntheticException");return this.getScope().captureException(t,{originalException:t,syntheticException:i,...n,event_id:r}),r}captureMessage(t,n,r){let i=this._lastEventId=r&&r.event_id?r.event_id:ct.uuid4(),o=new Error(t);return this.getScope().captureMessage(t,n,{originalException:t,syntheticException:o,...r,event_id:i}),i}captureEvent(t,n){let r=n&&n.event_id?n.event_id:ct.uuid4();return t.type||(this._lastEventId=r),this.getScope().captureEvent(t,{...n,event_id:r}),r}lastEventId(){return this._lastEventId}addBreadcrumb(t,n){let{scope:r,client:i}=this.getStackTop();if(!i)return;let{beforeBreadcrumb:o=null,maxBreadcrumbs:s=nD}=i.getOptions&&i.getOptions()||{};if(s<=0)return;let c={timestamp:ct.dateTimestampInSeconds(),...t},l=o?ct.consoleSandbox(()=>o(c,n)):c;l!==null&&(i.emit&&i.emit("beforeAddBreadcrumb",l,n),r.addBreadcrumb(l,s))}setUser(t){this.getScope().setUser(t),this.getIsolationScope().setUser(t)}setTags(t){this.getScope().setTags(t),this.getIsolationScope().setTags(t)}setExtras(t){this.getScope().setExtras(t),this.getIsolationScope().setExtras(t)}setTag(t,n){this.getScope().setTag(t,n),this.getIsolationScope().setTag(t,n)}setExtra(t,n){this.getScope().setExtra(t,n),this.getIsolationScope().setExtra(t,n)}setContext(t,n){this.getScope().setContext(t,n),this.getIsolationScope().setContext(t,n)}configureScope(t){let{scope:n,client:r}=this.getStackTop();r&&t(n)}run(t){let n=Pp(this);try{t(this)}finally{Pp(n)}}getIntegration(t){let n=this.getClient();if(!n)return null;try{return n.getIntegration(t)}catch{return Mp.DEBUG_BUILD&&ct.logger.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,n){let r=this._callExtensionMethod("startTransaction",t,n);return Mp.DEBUG_BUILD&&!r&&(this.getClient()?ct.logger.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):ct.logger.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){let n=this.getStackTop().scope,r=n.getSession();r&&jp.closeSession(r),this._sendSessionUpdate(),n.setSession()}startSession(t){let{scope:n,client:r}=this.getStackTop(),{release:i,environment:o=eD.DEFAULT_ENVIRONMENT}=r&&r.getOptions()||{},{userAgent:s}=ct.GLOBAL_OBJ.navigator||{},a=jp.makeSession({release:i,environment:o,user:n.getUser(),...s&&{userAgent:s},...t}),c=n.getSession&&n.getSession();return c&&c.status==="ok"&&jp.updateSession(c,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){let t=this.getClient(),n=t&&t.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){let{scope:t,client:n}=this.getStackTop(),r=t.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_callExtensionMethod(t,...n){let i=vi().__SENTRY__;if(i&&i.extensions&&typeof i.extensions[t]=="function")return i.extensions[t].apply(this,n);Mp.DEBUG_BUILD&&ct.logger.warn(`Extension method ${t} couldn't be found, doing nothing.`)}};function vi(){return ct.GLOBAL_OBJ.__SENTRY__=ct.GLOBAL_OBJ.__SENTRY__||{extensions:{},hub:void 0},ct.GLOBAL_OBJ}function Pp(e){let t=vi(),n=Ga(t);return ol(t,e),n}function iS(){let e=vi();if(e.__SENTRY__&&e.__SENTRY__.acs){let t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return oS(e)}function rD(){return iS().getIsolationScope()}function oS(e=vi()){return(!sS(e)||Ga(e).isOlderThan(il))&&ol(e,new ko),Ga(e)}function iD(e,t=oS()){if(!sS(e)||Ga(e).isOlderThan(il)){let n=t.getClient(),r=t.getScope(),i=t.getIsolationScope();ol(e,new ko(n,r.clone(),i.clone()))}}function oD(e){let t=vi();t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.acs=e}function sD(e,t={}){let n=vi();return n.__SENTRY__&&n.__SENTRY__.acs?n.__SENTRY__.acs.runWithAsyncContext(e,t):e()}function sS(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function Ga(e){return ct.getGlobalSingleton("hub",()=>new ko,e)}function ol(e,t){if(!e)return!1;let n=e.__SENTRY__=e.__SENTRY__||{};return n.hub=t,!0}_t.API_VERSION=il;_t.Hub=ko;_t.ensureHubOnCarrier=iD;_t.getCurrentHub=iS;_t.getHubFromCarrier=Ga;_t.getIsolationScope=rD;_t.getMainCarrier=vi;_t.makeMain=Pp;_t.runWithAsyncContext=sD;_t.setAsyncContextStrategy=oD;_t.setHubOnCarrier=ol});var sl=I(Ba=>{"use strict";Object.defineProperty(Ba,"__esModule",{value:!0});var aS=R(),aD=Rn();function cD(e){return(e||aD.getCurrentHub()).getScope().getTransaction()}var uD=aS.extractTraceparentData;Ba.stripUrlQueryAndFragment=aS.stripUrlQueryAndFragment;Ba.extractTraceparentData=uD;Ba.getActiveTransaction=cD});var al=I(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});var Qp=R(),lD=we(),gD=sl(),cS=!1;function dD(){cS||(cS=!0,Qp.addGlobalErrorInstrumentationHandler($p),Qp.addGlobalUnhandledRejectionInstrumentationHandler($p))}function $p(){let e=gD.getActiveTransaction();if(e){let t="internal_error";lD.DEBUG_BUILD&&Qp.logger.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}$p.tag="sentry_tracingErrorCallback";ef.registerErrorInstrumentation=dD});var Ko=I(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.SpanStatus=void 0;(function(e){let t="ok";e.Ok=t;let n="deadline_exceeded";e.DeadlineExceeded=n;let r="unauthenticated";e.Unauthenticated=r;let i="permission_denied";e.PermissionDenied=i;let o="not_found";e.NotFound=o;let s="resource_exhausted";e.ResourceExhausted=s;let a="invalid_argument";e.InvalidArgument=a;let c="unimplemented";e.Unimplemented=c;let l="unavailable";e.Unavailable=l;let u="internal_error";e.InternalError=u;let d="unknown_error";e.UnknownError=d;let g="cancelled";e.Cancelled=g;let m="already_exists";e.AlreadyExists=m;let h="failed_precondition";e.FailedPrecondition=h;let b="aborted";e.Aborted=b;let y="out_of_range";e.OutOfRange=y;let v="data_loss";e.DataLoss=v})(Hr.SpanStatus||(Hr.SpanStatus={}));function tf(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}var ID=tf;function mD(e,t){e.setTag("http.status_code",String(t)),e.setData("http.response.status_code",t);let n=tf(t);n!=="unknown_error"&&e.setStatus(n)}Hr.getSpanStatusFromHttpCode=tf;Hr.setHttpStatus=mD;Hr.spanStatusfromHttpCode=ID});var rf=I(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});var pD=R();function fD(e,t,n=()=>{}){let r;try{r=e()}catch(i){throw t(i),n(),i}return hD(r,t,n)}function hD(e,t,n){return pD.isThenable(e)?e.then(r=>(n(),r),r=>{throw t(r),n(),r}):(n(),e)}nf.handleCallbackErrors=fD});var cl=I(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});var CD=Qt();function bD(e){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;let t=CD.getClient(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}of.hasTracingEnabled=bD});var dl=I(Nn=>{"use strict";Object.defineProperty(Nn,"__esModule",{value:!0});var Aa=R(),yD=we(),Yr=Rn(),ul=yt();al();Ko();var GD=Zi(),Uo=Qt(),sf=rf(),uS=cl();function BD(e,t,n=()=>{},r=()=>{}){let i=Yr.getCurrentHub(),o=Uo.getCurrentScope(),s=o.getSpan(),a=gl(e),c=ll(i,{parentSpan:s,spanContext:a,forceTransaction:!1,scope:o});return o.setSpan(c),sf.handleCallbackErrors(()=>t(c),l=>{c&&c.setStatus("internal_error"),n(l,c)},()=>{c&&c.end(),o.setSpan(s),r()})}function lS(e,t){let n=gl(e);return Yr.runWithAsyncContext(()=>Uo.withScope(e.scope,r=>{let i=Yr.getCurrentHub(),o=r.getSpan(),a=e.onlyIfParent&&!o?void 0:ll(i,{parentSpan:o,spanContext:n,forceTransaction:e.forceTransaction,scope:r});return sf.handleCallbackErrors(()=>t(a),()=>{if(a){let{status:c}=ul.spanToJSON(a);(!c||c==="ok")&&a.setStatus("internal_error")}},()=>a&&a.end())}))}var AD=lS;function ZD(e,t){let n=gl(e);return Yr.runWithAsyncContext(()=>Uo.withScope(e.scope,r=>{let i=Yr.getCurrentHub(),o=r.getSpan(),a=e.onlyIfParent&&!o?void 0:ll(i,{parentSpan:o,spanContext:n,forceTransaction:e.forceTransaction,scope:r});function c(){a&&a.end()}return sf.handleCallbackErrors(()=>t(a,c),()=>{if(a&&a.isRecording()){let{status:l}=ul.spanToJSON(a);(!l||l==="ok")&&a.setStatus("internal_error")}})}))}function vD(e){if(!uS.hasTracingEnabled())return;let t=gl(e),n=Yr.getCurrentHub(),r=e.scope?e.scope.getSpan():gS();if(e.onlyIfParent&&!r)return;let s=(e.scope||Uo.getCurrentScope()).clone();return ll(n,{parentSpan:r,spanContext:t,forceTransaction:e.forceTransaction,scope:s})}function gS(){return Uo.getCurrentScope().getSpan()}var SD=({sentryTrace:e,baggage:t},n)=>{let r=Uo.getCurrentScope(),{traceparentData:i,dynamicSamplingContext:o,propagationContext:s}=Aa.tracingContextFromHeaders(e,t);r.setPropagationContext(s),yD.DEBUG_BUILD&&i&&Aa.logger.log(`[Tracing] Continuing trace ${i.traceId}.`);let a={...i,metadata:Aa.dropUndefinedKeys({dynamicSamplingContext:o})};return n?Yr.runWithAsyncContext(()=>n(a)):a};function ll(e,{parentSpan:t,spanContext:n,forceTransaction:r,scope:i}){if(!uS.hasTracingEnabled())return;let o=Yr.getIsolationScope(),s;if(t&&!r)s=t.startChild(n);else if(t){let a=GD.getDynamicSamplingContextFromSpan(t),{traceId:c,spanId:l}=t.spanContext(),u=ul.spanIsSampled(t);s=e.startTransaction({traceId:c,parentSpanId:l,parentSampled:u,...n,metadata:{dynamicSamplingContext:a,...n.metadata}})}else{let{traceId:a,dsc:c,parentSpanId:l,sampled:u}={...o.getPropagationContext(),...i.getPropagationContext()};s=e.startTransaction({traceId:a,parentSpanId:l,parentSampled:u,...n,metadata:{dynamicSamplingContext:c,...n.metadata}})}return i.setSpan(s),WD(s,i,o),s}function gl(e){if(e.startTime){let t={...e};return t.startTimestamp=ul.spanTimeInputToSeconds(e.startTime),delete t.startTime,t}return e}var dS="_sentryScope",IS="_sentryIsolationScope";function WD(e,t,n){e&&(Aa.addNonEnumerableProperty(e,IS,n),Aa.addNonEnumerableProperty(e,dS,t))}function RD(e){return{scope:e[dS],isolationScope:e[IS]}}Nn.continueTrace=SD;Nn.getActiveSpan=gS;Nn.getCapturedScopesOnSpan=RD;Nn.startActiveSpan=AD;Nn.startInactiveSpan=vD;Nn.startSpan=lS;Nn.startSpanManual=ZD;Nn.trace=BD});var va=I(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});var VD=R();we();al();Ko();var ND=dl(),Za;function mS(e){return Za?Za.get(e):void 0}function wD(e){let t=mS(e);if(!t)return;let n={};for(let[,[r,i]]of t)n[r]||(n[r]=[]),n[r].push(VD.dropUndefinedKeys(i));return n}function ED(e,t,n,r,i,o){let s=ND.getActiveSpan();if(s){let a=mS(s)||new Map,c=`${e}:${t}@${r}`,l=a.get(o);if(l){let[,u]=l;a.set(o,[c,{min:Math.min(u.min,n),max:Math.max(u.max,n),count:u.count+=1,sum:u.sum+=n,tags:u.tags}])}else a.set(o,[c,{min:n,max:n,count:1,sum:n,tags:i}]);Za||(Za=new WeakMap),Za.set(s,a)}}Il.getMetricSummaryJsonForSpan=wD;Il.updateMetricSummaryOnActiveSpan=ED});var Sa=I(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});var HD="sentry.source",YD="sentry.sample_rate",XD="sentry.op",_D="sentry.origin",FD="profile_id";Si.SEMANTIC_ATTRIBUTE_PROFILE_ID=FD;Si.SEMANTIC_ATTRIBUTE_SENTRY_OP=XD;Si.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=_D;Si.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=YD;Si.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=HD});var pl=I(ml=>{"use strict";Object.defineProperty(ml,"__esModule",{value:!0});var Wi=R(),pS=we(),TD=va(),ir=Sa(),fS=Fo(),xo=yt(),kD=Ko(),af=class{constructor(t=1e3){this._maxlen=t,this.spans=[]}add(t){this.spans.length>this._maxlen?t.spanRecorder=void 0:this.spans.push(t)}},cf=class e{constructor(t={}){this._traceId=t.traceId||Wi.uuid4(),this._spanId=t.spanId||Wi.uuid4().substring(16),this._startTime=t.startTimestamp||Wi.timestampInSeconds(),this.tags=t.tags?{...t.tags}:{},this.data=t.data?{...t.data}:{},this.instrumenter=t.instrumenter||"sentry",this._attributes={},this.setAttributes({[ir.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:t.origin||"manual",[ir.SEMANTIC_ATTRIBUTE_SENTRY_OP]:t.op,...t.attributes}),this._name=t.name||t.description,t.parentSpanId&&(this._parentSpanId=t.parentSpanId),"sampled"in t&&(this._sampled=t.sampled),t.status&&(this._status=t.status),t.endTimestamp&&(this._endTime=t.endTimestamp),t.exclusiveTime!==void 0&&(this._exclusiveTime=t.exclusiveTime),this._measurements=t.measurements?{...t.measurements}:{}}get name(){return this._name||""}set name(t){this.updateName(t)}get description(){return this._name}set description(t){this._name=t}get traceId(){return this._traceId}set traceId(t){this._traceId=t}get spanId(){return this._spanId}set spanId(t){this._spanId=t}set parentSpanId(t){this._parentSpanId=t}get parentSpanId(){return this._parentSpanId}get sampled(){return this._sampled}set sampled(t){this._sampled=t}get attributes(){return this._attributes}set attributes(t){this._attributes=t}get startTimestamp(){return this._startTime}set startTimestamp(t){this._startTime=t}get endTimestamp(){return this._endTime}set endTimestamp(t){this._endTime=t}get status(){return this._status}set status(t){this._status=t}get op(){return this._attributes[ir.SEMANTIC_ATTRIBUTE_SENTRY_OP]}set op(t){this.setAttribute(ir.SEMANTIC_ATTRIBUTE_SENTRY_OP,t)}get origin(){return this._attributes[ir.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]}set origin(t){this.setAttribute(ir.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN,t)}spanContext(){let{_spanId:t,_traceId:n,_sampled:r}=this;return{spanId:t,traceId:n,traceFlags:r?xo.TRACE_FLAG_SAMPLED:xo.TRACE_FLAG_NONE}}startChild(t){let n=new e({...t,parentSpanId:this._spanId,sampled:this._sampled,traceId:this._traceId});n.spanRecorder=this.spanRecorder,n.spanRecorder&&n.spanRecorder.add(n);let r=fS.getRootSpan(this);if(n.transaction=r,pS.DEBUG_BUILD&&r){let i=t&&t.op||"< unknown op >",o=xo.spanToJSON(n).description||"< unknown name >",s=r.spanContext().spanId,a=`[Tracing] Starting '${i}' span on transaction '${o}' (${s}).`;Wi.logger.log(a),this._logMessage=a}return n}setTag(t,n){return this.tags={...this.tags,[t]:n},this}setData(t,n){return this.data={...this.data,[t]:n},this}setAttribute(t,n){n===void 0?delete this._attributes[t]:this._attributes[t]=n}setAttributes(t){Object.keys(t).forEach(n=>this.setAttribute(n,t[n]))}setStatus(t){return this._status=t,this}setHttpStatus(t){return kD.setHttpStatus(this,t),this}setName(t){this.updateName(t)}updateName(t){return this._name=t,this}isSuccess(){return this._status==="ok"}finish(t){return this.end(t)}end(t){if(this._endTime)return;let n=fS.getRootSpan(this);if(pS.DEBUG_BUILD&&n&&n.spanContext().spanId!==this._spanId){let r=this._logMessage;r&&Wi.logger.log(r.replace("Starting","Finishing"))}this._endTime=xo.spanTimeInputToSeconds(t)}toTraceparent(){return xo.spanToTraceHeader(this)}toContext(){return Wi.dropUndefinedKeys({data:this._getData(),description:this._name,endTimestamp:this._endTime,op:this.op,parentSpanId:this._parentSpanId,sampled:this._sampled,spanId:this._spanId,startTimestamp:this._startTime,status:this._status,tags:this.tags,traceId:this._traceId})}updateWithContext(t){return this.data=t.data||{},this._name=t.name||t.description,this._endTime=t.endTimestamp,this.op=t.op,this._parentSpanId=t.parentSpanId,this._sampled=t.sampled,this._spanId=t.spanId||this._spanId,this._startTime=t.startTimestamp||this._startTime,this._status=t.status,this.tags=t.tags||{},this._traceId=t.traceId||this._traceId,this}getTraceContext(){return xo.spanToTraceContext(this)}getSpanJSON(){return Wi.dropUndefinedKeys({data:this._getData(),description:this._name,op:this._attributes[ir.SEMANTIC_ATTRIBUTE_SENTRY_OP],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:this._status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[ir.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN],_metrics_summary:TD.getMetricSummaryJsonForSpan(this),profile_id:this._attributes[ir.SEMANTIC_ATTRIBUTE_PROFILE_ID],exclusive_time:this._exclusiveTime,measurements:Object.keys(this._measurements).length>0?this._measurements:void 0})}isRecording(){return!this._endTime&&!!this._sampled}toJSON(){return this.getSpanJSON()}_getData(){let{data:t,_attributes:n}=this,r=Object.keys(t).length>0,i=Object.keys(n).length>0;if(!(!r&&!i))return r&&i?{...t,...n}:r?t:n}};ml.Span=cf;ml.SpanRecorder=af});var Cl=I(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});var Lo=R(),fl=we(),KD=Rn(),UD=va(),Wa=Sa(),hl=yt(),hS=Zi(),CS=pl(),xD=dl(),uf=class extends CS.Span{constructor(t,n){super(t),this._contexts={},this._hub=n||KD.getCurrentHub(),this._name=t.name||"",this._metadata={...t.metadata},this._trimEnd=t.trimEnd,this.transaction=this;let r=this._metadata.dynamicSamplingContext;r&&(this._frozenDynamicSamplingContext={...r})}get name(){return this._name}set name(t){this.setName(t)}get metadata(){return{source:"custom",spanMetadata:{},...this._metadata,...this._attributes[Wa.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]&&{source:this._attributes[Wa.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]},...this._attributes[Wa.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE]&&{sampleRate:this._attributes[Wa.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE]}}}set metadata(t){this._metadata=t}setName(t,n="custom"){this._name=t,this.setAttribute(Wa.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,n)}updateName(t){return this._name=t,this}initSpanRecorder(t=1e3){this.spanRecorder||(this.spanRecorder=new CS.SpanRecorder(t)),this.spanRecorder.add(this)}setContext(t,n){n===null?delete this._contexts[t]:this._contexts[t]=n}setMeasurement(t,n,r=""){this._measurements[t]={value:n,unit:r}}setMetadata(t){this._metadata={...this._metadata,...t}}end(t){let n=hl.spanTimeInputToSeconds(t),r=this._finishTransaction(n);if(r)return this._hub.captureEvent(r)}toContext(){let t=super.toContext();return Lo.dropUndefinedKeys({...t,name:this._name,trimEnd:this._trimEnd})}updateWithContext(t){return super.updateWithContext(t),this._name=t.name||"",this._trimEnd=t.trimEnd,this}getDynamicSamplingContext(){return hS.getDynamicSamplingContextFromSpan(this)}setHub(t){this._hub=t}getProfileId(){if(this._contexts!==void 0&&this._contexts.profile!==void 0)return this._contexts.profile.profile_id}_finishTransaction(t){if(this._endTime!==void 0)return;this._name||(fl.DEBUG_BUILD&&Lo.logger.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>"),super.end(t);let n=this._hub.getClient();if(n&&n.emit&&n.emit("finishTransaction",this),this._sampled!==!0){fl.DEBUG_BUILD&&Lo.logger.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),n&&n.recordDroppedEvent("sample_rate","transaction");return}let r=this.spanRecorder?this.spanRecorder.spans.filter(u=>u!==this&&hl.spanToJSON(u).timestamp):[];if(this._trimEnd&&r.length>0){let u=r.map(d=>hl.spanToJSON(d).timestamp).filter(Boolean);this._endTime=u.reduce((d,g)=>d>g?d:g)}let{scope:i,isolationScope:o}=xD.getCapturedScopesOnSpan(this),{metadata:s}=this,{source:a}=s,c={contexts:{...this._contexts,trace:hl.spanToTraceContext(this)},spans:r,start_timestamp:this._startTime,tags:this.tags,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{...s,capturedSpanScope:i,capturedSpanIsolationScope:o,...Lo.dropUndefinedKeys({dynamicSamplingContext:hS.getDynamicSamplingContextFromSpan(this)})},_metrics_summary:UD.getMetricSummaryJsonForSpan(this),...a&&{transaction_info:{source:a}}};return Object.keys(this._measurements).length>0&&(fl.DEBUG_BUILD&&Lo.logger.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),c.measurements=this._measurements),fl.DEBUG_BUILD&&Lo.logger.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`),c}};lf.Transaction=uf});var df=I(Ra=>{"use strict";Object.defineProperty(Ra,"__esModule",{value:!0});var $e=R(),Gt=we(),bl=yt(),LD=pl(),JD=Cl(),yl={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},zD="finishReason",Jo=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"],Gl=class extends LD.SpanRecorder{constructor(t,n,r,i){super(i),this._pushActivity=t,this._popActivity=n,this.transactionSpanId=r}add(t){if(t.spanContext().spanId!==this.transactionSpanId){let n=t.end;t.end=(...r)=>(this._popActivity(t.spanContext().spanId),n.apply(t,r)),bl.spanToJSON(t).timestamp===void 0&&this._pushActivity(t.spanContext().spanId)}super.add(t)}},gf=class extends JD.Transaction{constructor(t,n,r=yl.idleTimeout,i=yl.finalTimeout,o=yl.heartbeatInterval,s=!1,a=!1){super(t,n),this._idleHub=n,this._idleTimeout=r,this._finalTimeout=i,this._heartbeatInterval=o,this._onScope=s,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=Jo[4],this._autoFinishAllowed=!a,s&&(Gt.DEBUG_BUILD&&$e.logger.log(`Setting idle transaction on scope. Span ID: ${this.spanContext().spanId}`),n.getScope().setSpan(this)),a||this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=Jo[3],this.end())},this._finalTimeout)}end(t){let n=bl.spanTimeInputToSeconds(t);if(this._finished=!0,this.activities={},this.op==="ui.action.click"&&this.setAttribute(zD,this._finishReason),this.spanRecorder){Gt.DEBUG_BUILD&&$e.logger.log("[Tracing] finishing IdleTransaction",new Date(n*1e3).toISOString(),this.op);for(let r of this._beforeFinishCallbacks)r(this,n);this.spanRecorder.spans=this.spanRecorder.spans.filter(r=>{if(r.spanContext().spanId===this.spanContext().spanId)return!0;bl.spanToJSON(r).timestamp||(r.setStatus("cancelled"),r.end(n),Gt.DEBUG_BUILD&&$e.logger.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(r,void 0,2)));let{start_timestamp:i,timestamp:o}=bl.spanToJSON(r),s=i&&i<n,a=(this._finalTimeout+this._idleTimeout)/1e3,c=o&&i&&o-i<a;if(Gt.DEBUG_BUILD){let l=JSON.stringify(r,void 0,2);s?c||$e.logger.log("[Tracing] discarding Span since it finished after Transaction final timeout",l):$e.logger.log("[Tracing] discarding Span since it happened after Transaction was finished",l)}return s&&c}),Gt.DEBUG_BUILD&&$e.logger.log("[Tracing] flushing IdleTransaction")}else Gt.DEBUG_BUILD&&$e.logger.log("[Tracing] No active IdleTransaction");if(this._onScope){let r=this._idleHub.getScope();r.getTransaction()===this&&r.setSpan(void 0)}return super.end(t)}registerBeforeFinishCallback(t){this._beforeFinishCallbacks.push(t)}initSpanRecorder(t){if(!this.spanRecorder){let n=i=>{this._finished||this._pushActivity(i)},r=i=>{this._finished||this._popActivity(i)};this.spanRecorder=new Gl(n,r,this.spanContext().spanId,t),Gt.DEBUG_BUILD&&$e.logger.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(t,{restartOnChildSpanChange:n}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=n===!1,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,Object.keys(this.activities).length===0&&this._idleTimeoutCanceledPermanently&&(this._finishReason=Jo[5],this.end(t)))}setFinishReason(t){this._finishReason=t}sendAutoFinishSignal(){this._autoFinishAllowed||(Gt.DEBUG_BUILD&&$e.logger.log("[Tracing] Received finish signal for idle transaction."),this._restartIdleTimeout(),this._autoFinishAllowed=!0)}_restartIdleTimeout(t){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{!this._finished&&Object.keys(this.activities).length===0&&(this._finishReason=Jo[1],this.end(t))},this._idleTimeout)}_pushActivity(t){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),Gt.DEBUG_BUILD&&$e.logger.log(`[Tracing] pushActivity: ${t}`),this.activities[t]=!0,Gt.DEBUG_BUILD&&$e.logger.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(t){if(this.activities[t]&&(Gt.DEBUG_BUILD&&$e.logger.log(`[Tracing] popActivity ${t}`),delete this.activities[t],Gt.DEBUG_BUILD&&$e.logger.log("[Tracing] new activities count",Object.keys(this.activities).length)),Object.keys(this.activities).length===0){let n=$e.timestampInSeconds();this._idleTimeoutCanceledPermanently?this._autoFinishAllowed&&(this._finishReason=Jo[5],this.end(n)):this._restartIdleTimeout(n+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;let t=Object.keys(this.activities).join("");t===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=t,this._heartbeatCounter>=3?this._autoFinishAllowed&&(Gt.DEBUG_BUILD&&$e.logger.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=Jo[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){Gt.DEBUG_BUILD&&$e.logger.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}};Ra.IdleTransaction=gf;Ra.IdleTransactionSpanRecorder=Gl;Ra.TRACING_DEFAULTS=yl});var If=I(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});var Ri=R(),zo=we(),Bl=Sa(),OD=cl(),DD=yt();function qD(e,t,n){if(!OD.hasTracingEnabled(t))return e.sampled=!1,e;if(e.sampled!==void 0)return e.setAttribute(Bl.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,Number(e.sampled)),e;let r;return typeof t.tracesSampler=="function"?(r=t.tracesSampler(n),e.setAttribute(Bl.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,Number(r))):n.parentSampled!==void 0?r=n.parentSampled:typeof t.tracesSampleRate<"u"?(r=t.tracesSampleRate,e.setAttribute(Bl.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,Number(r))):(r=1,e.setAttribute(Bl.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,r)),bS(r)?r?(e.sampled=Math.random()<r,e.sampled?(zo.DEBUG_BUILD&&Ri.logger.log(`[Tracing] starting ${e.op} transaction - ${DD.spanToJSON(e).description}`),e):(zo.DEBUG_BUILD&&Ri.logger.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(r)})`),e)):(zo.DEBUG_BUILD&&Ri.logger.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),e.sampled=!1,e):(zo.DEBUG_BUILD&&Ri.logger.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e)}function bS(e){return Ri.isNaN(e)||!(typeof e=="number"||typeof e=="boolean")?(zo.DEBUG_BUILD&&Ri.logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`),!1):e<0||e>1?(zo.DEBUG_BUILD&&Ri.logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${e}.`),!1):!0}Al.isValidSampleRate=bS;Al.sampleTransaction=qD});var mf=I(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});var MD=R(),jD=we(),PD=Rn(),QD=yt(),$D=al(),eq=df(),yS=If(),tq=Cl();function nq(){let t=this.getScope().getSpan();return t?{"sentry-trace":QD.spanToTraceHeader(t)}:{}}function rq(e,t){let n=this.getClient(),r=n&&n.getOptions()||{},i=r.instrumenter||"sentry",o=e.instrumenter||"sentry";i!==o&&(jD.DEBUG_BUILD&&MD.logger.error(`A transaction was started with instrumenter=\`${o}\`, but the SDK is configured with the \`${i}\` instrumenter.
The transaction will not be sampled. Please use the ${i} instrumentation to start transactions.`),e.sampled=!1);let s=new tq.Transaction(e,this);return s=yS.sampleTransaction(s,r,{name:e.name,parentSampled:e.parentSampled,transactionContext:e,attributes:{...e.data,...e.attributes},...t}),s.isRecording()&&s.initSpanRecorder(r._experiments&&r._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",s),s}function iq(e,t,n,r,i,o,s,a=!1){let c=e.getClient(),l=c&&c.getOptions()||{},u=new eq.IdleTransaction(t,e,n,r,s,i,a);return u=yS.sampleTransaction(u,l,{name:t.name,parentSampled:t.parentSampled,transactionContext:t,attributes:{...t.data,...t.attributes},...o}),u.isRecording()&&u.initSpanRecorder(l._experiments&&l._experiments.maxSpans),c&&c.emit&&c.emit("startTransaction",u),u}function oq(){let e=PD.getMainCarrier();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=rq),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=nq),$D.registerErrorInstrumentation())}Zl.addTracingExtensions=oq;Zl.startIdleTransaction=iq});var GS=I(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});var sq=sl();function aq(e,t,n){let r=sq.getActiveTransaction();r&&r.setMeasurement(e,t,n)}pf.setMeasurement=aq});var ff=I(vl=>{"use strict";Object.defineProperty(vl,"__esModule",{value:!0});var Oo=R();function cq(e,t){return t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]]),e}function uq(e,t,n,r){let i=Oo.getSdkMetadataForEnvelopeHeader(n),o={sent_at:new Date().toISOString(),...i&&{sdk:i},...!!r&&t&&{dsn:Oo.dsnToString(t)}},s="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return Oo.createEnvelope(o,[s])}function lq(e,t,n,r){let i=Oo.getSdkMetadataForEnvelopeHeader(n),o=e.type&&e.type!=="replay_event"?e.type:"event";cq(e,n&&n.sdk);let s=Oo.createEventEnvelopeHeaders(e,i,r,t);delete e.sdkProcessingMetadata;let a=[{type:o},e];return Oo.createEnvelope(s,[a])}vl.createEventEnvelope=lq;vl.createSessionEnvelope=uq});var bf=I(Cf=>{"use strict";Object.defineProperty(Cf,"__esModule",{value:!0});var gq=R(),dq=Qt(),hf=class{constructor(t,n){this._client=t,this.flushTimeout=60,this._pendingAggregates={},this._isEnabled=!0,this._intervalId=setInterval(()=>this.flush(),this.flushTimeout*1e3),this._intervalId.unref&&this._intervalId.unref(),this._sessionAttrs=n}flush(){let t=this.getSessionAggregates();t.aggregates.length!==0&&(this._pendingAggregates={},this._client.sendSession(t))}getSessionAggregates(){let t=Object.keys(this._pendingAggregates).map(r=>this._pendingAggregates[parseInt(r)]),n={attrs:this._sessionAttrs,aggregates:t};return gq.dropUndefinedKeys(n)}close(){clearInterval(this._intervalId),this._isEnabled=!1,this.flush()}incrementSessionStatusCount(){if(!this._isEnabled)return;let t=dq.getCurrentScope(),n=t.getRequestSession();n&&n.status&&(this._incrementSessionStatusCount(n.status,new Date),t.setRequestSession(void 0))}_incrementSessionStatusCount(t,n){let r=new Date(n).setSeconds(0,0);this._pendingAggregates[r]=this._pendingAggregates[r]||{};let i=this._pendingAggregates[r];switch(i.started||(i.started=new Date(r).toISOString()),t){case"errored":return i.errored=(i.errored||0)+1,i.errored;case"ok":return i.exited=(i.exited||0)+1,i.exited;default:return i.crashed=(i.crashed||0)+1,i.crashed}}};Cf.SessionFlusher=hf});var Wl=I(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});var yf=R(),Iq="7";function BS(e){let t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function mq(e){return`${BS(e)}${e.projectId}/envelope/`}function pq(e,t){return yf.urlEncode({sentry_key:e.publicKey,sentry_version:Iq,...t&&{sentry_client:`${t.name}/${t.version}`}})}function fq(e,t={}){let n=typeof t=="string"?t:t.tunnel,r=typeof t=="string"||!t._metadata?void 0:t._metadata.sdk;return n||`${mq(e)}?${pq(e,r)}`}function hq(e,t){let n=yf.makeDsn(e);if(!n)return"";let r=`${BS(n)}embed/error-page/`,i=`dsn=${yf.dsnToString(n)}`;for(let o in t)if(o!=="dsn"&&o!=="onClose")if(o==="user"){let s=t.user;if(!s)continue;s.name&&(i+=`&name=${encodeURIComponent(s.name)}`),s.email&&(i+=`&email=${encodeURIComponent(s.email)}`)}else i+=`&${encodeURIComponent(o)}=${encodeURIComponent(t[o])}`;return`${r}?${i}`}Sl.getEnvelopeEndpointWithUrlEncodedAuth=fq;Sl.getReportDialogEndpoint=hq});var or=I(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});var Rl=R(),Gf=we(),Cq=ma(),bq=Qt(),yq=Rn(),Bf=[];function Gq(e){let t={};return e.forEach(n=>{let{name:r}=n,i=t[r];i&&!i.isDefaultInstance&&n.isDefaultInstance||(t[r]=n)}),Object.keys(t).map(n=>t[n])}function Bq(e){let t=e.defaultIntegrations||[],n=e.integrations;t.forEach(s=>{s.isDefaultInstance=!0});let r;Array.isArray(n)?r=[...t,...n]:typeof n=="function"?r=Rl.arrayify(n(t)):r=t;let i=Gq(r),o=Sq(i,s=>s.name==="Debug");if(o!==-1){let[s]=i.splice(o,1);i.push(s)}return i}function Aq(e,t){let n={};return t.forEach(r=>{r&&AS(e,r,n)}),n}function Zq(e,t){for(let n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function AS(e,t,n){if(n[t.name]){Gf.DEBUG_BUILD&&Rl.logger.log(`Integration skipped because it was already installed: ${t.name}`);return}if(n[t.name]=t,Bf.indexOf(t.name)===-1&&(t.setupOnce(Cq.addGlobalEventProcessor,yq.getCurrentHub),Bf.push(t.name)),t.setup&&typeof t.setup=="function"&&t.setup(e),e.on&&typeof t.preprocessEvent=="function"){let r=t.preprocessEvent.bind(t);e.on("preprocessEvent",(i,o)=>r(i,o,e))}if(e.addEventProcessor&&typeof t.processEvent=="function"){let r=t.processEvent.bind(t),i=Object.assign((o,s)=>r(o,s,e),{id:t.name});e.addEventProcessor(i)}Gf.DEBUG_BUILD&&Rl.logger.log(`Integration installed: ${t.name}`)}function vq(e){let t=bq.getClient();if(!t||!t.addIntegration){Gf.DEBUG_BUILD&&Rl.logger.warn(`Cannot add integration "${e.name}" because no SDK Client is available.`);return}t.addIntegration(e)}function Sq(e,t){for(let n=0;n<e.length;n++)if(t(e[n])===!0)return n;return-1}function Wq(e,t){return Object.assign(function(...r){return t(...r)},{id:e})}function Rq(e){return e}wn.addIntegration=vq;wn.afterSetupIntegrations=Zq;wn.convertIntegrationFnToClass=Wq;wn.defineIntegration=Rq;wn.getIntegrationsToSetup=Bq;wn.installedIntegrations=Bf;wn.setupIntegration=AS;wn.setupIntegrations=Aq});var Va=I(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});var Vq=R();function Nq(e,t,n,r){let i=Object.entries(Vq.dropUndefinedKeys(r)).sort((o,s)=>o[0].localeCompare(s[0]));return`${e}${t}${n}${i}`}function wq(e){let t=0;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);t=(t<<5)-t+r,t&=t}return t>>>0}function Eq(e){let t="";for(let n of e){let r=Object.entries(n.tags),i=r.length>0?`|#${r.map(([o,s])=>`${o}:${s}`).join(",")}`:"";t+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${i}|T${n.timestamp}
`}return t}function Hq(e){return e.replace(/[^\w]+/gi,"_")}function Yq(e){return e.replace(/[^\w\-.]+/gi,"_")}function Xq(e){return e.replace(/[^\w\-./]+/gi,"")}var _q=[[`
`,"\\n"],["\r","\\r"],["	","\\t"],["\\","\\\\"],["|","\\u{7c}"],[",","\\u{2c}"]];function Fq(e){for(let[t,n]of _q)if(e===t)return n;return e}function Tq(e){return[...e].reduce((t,n)=>t+Fq(n),"")}function kq(e){let t={};for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let r=Xq(n);t[r]=Tq(String(e[n]))}return t}Xr.getBucketKey=Nq;Xr.sanitizeMetricKey=Yq;Xr.sanitizeTags=kq;Xr.sanitizeUnit=Hq;Xr.serializeMetricBuckets=Eq;Xr.simpleHash=wq});var vS=I(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});var ZS=R(),Kq=Va();function Uq(e,t,n,r){let i={sent_at:new Date().toISOString()};n&&n.sdk&&(i.sdk={name:n.sdk.name,version:n.sdk.version}),r&&t&&(i.dsn=ZS.dsnToString(t));let o=xq(e);return ZS.createEnvelope(i,[o])}function xq(e){let t=Kq.serializeMetricBuckets(e);return[{type:"statsd",length:t.length},t]}Af.createMetricEnvelope=Uq});var vf=I(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});var oe=R(),Lq=Wl(),En=we(),SS=ff(),Jq=Qt(),zq=Rn(),Vl=or(),Oq=vS(),WS=Xo(),Dq=Zi(),qq=ju(),RS="Not capturing exception because it's already been captured.",Zf=class{constructor(t){if(this._options=t,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],t.dsn?this._dsn=oe.makeDsn(t.dsn):En.DEBUG_BUILD&&oe.logger.warn("No DSN provided, client will not send events."),this._dsn){let n=Lq.getEnvelopeEndpointWithUrlEncodedAuth(this._dsn,t);this._transport=t.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:n})}}captureException(t,n,r){if(oe.checkOrSetAlreadyCaught(t)){En.DEBUG_BUILD&&oe.logger.log(RS);return}let i=n&&n.event_id;return this._process(this.eventFromException(t,n).then(o=>this._captureEvent(o,n,r)).then(o=>{i=o})),i}captureMessage(t,n,r,i){let o=r&&r.event_id,s=oe.isParameterizedString(t)?t:String(t),a=oe.isPrimitive(t)?this.eventFromMessage(s,n,r):this.eventFromException(t,r);return this._process(a.then(c=>this._captureEvent(c,r,i)).then(c=>{o=c})),o}captureEvent(t,n,r){if(n&&n.originalException&&oe.checkOrSetAlreadyCaught(n.originalException)){En.DEBUG_BUILD&&oe.logger.log(RS);return}let i=n&&n.event_id,s=(t.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(t,n,s||r).then(a=>{i=a})),i}captureSession(t){typeof t.release!="string"?En.DEBUG_BUILD&&oe.logger.warn("Discarded session because of missing or non-string release"):(this.sendSession(t),WS.updateSession(t,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){let n=this._transport;return n?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(t).then(r=>n.flush(t).then(i=>r&&i))):oe.resolvedSyncPromise(!0)}close(t){return this.flush(t).then(n=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}setupIntegrations(t){(t&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(t){return this.getIntegrationByName(t)}getIntegrationByName(t){return this._integrations[t]}getIntegration(t){try{return this._integrations[t.id]||null}catch{return En.DEBUG_BUILD&&oe.logger.warn(`Cannot retrieve integration ${t.id} from the current Client`),null}}addIntegration(t){let n=this._integrations[t.name];Vl.setupIntegration(this,t,this._integrations),n||Vl.afterSetupIntegrations(this,[t])}sendEvent(t,n={}){this.emit("beforeSendEvent",t,n);let r=SS.createEventEnvelope(t,this._dsn,this._options._metadata,this._options.tunnel);for(let o of n.attachments||[])r=oe.addItemToEnvelope(r,oe.createAttachmentEnvelopeItem(o,this._options.transportOptions&&this._options.transportOptions.textEncoder));let i=this._sendEnvelope(r);i&&i.then(o=>this.emit("afterSendEvent",t,o),null)}sendSession(t){let n=SS.createSessionEnvelope(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(t,n,r){if(this._options.sendClientReports){let i=typeof r=="number"?r:1,o=`${t}:${n}`;En.DEBUG_BUILD&&oe.logger.log(`Recording outcome: "${o}"${i>1?` (${i} times)`:""}`),this._outcomes[o]=(this._outcomes[o]||0)+i}}captureAggregateMetrics(t){En.DEBUG_BUILD&&oe.logger.log(`Flushing aggregated metrics, number of metrics: ${t.length}`);let n=Oq.createMetricEnvelope(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}on(t,n){this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(n)}emit(t,...n){this._hooks[t]&&this._hooks[t].forEach(r=>r(...n))}_setupIntegrations(){let{integrations:t}=this._options;this._integrations=Vl.setupIntegrations(this,t),Vl.afterSetupIntegrations(this,t),this._integrationsInitialized=!0}_updateSessionFromEvent(t,n){let r=!1,i=!1,o=n.exception&&n.exception.values;if(o){i=!0;for(let c of o){let l=c.mechanism;if(l&&l.handled===!1){r=!0;break}}}let s=t.status==="ok";(s&&t.errors===0||s&&r)&&(WS.updateSession(t,{...r&&{status:"crashed"},errors:t.errors||Number(i||r)}),this.captureSession(t))}_isClientDoneProcessing(t){return new oe.SyncPromise(n=>{let r=0,i=1,o=setInterval(()=>{this._numProcessing==0?(clearInterval(o),n(!0)):(r+=i,t&&r>=t&&(clearInterval(o),n(!1)))},i)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(t,n,r,i=zq.getIsolationScope()){let o=this.getOptions(),s=Object.keys(this._integrations);return!n.integrations&&s.length>0&&(n.integrations=s),this.emit("preprocessEvent",t,n),qq.prepareEvent(o,t,n,r,this,i).then(a=>{if(a===null)return a;let c={...i.getPropagationContext(),...r?r.getPropagationContext():void 0};if(!(a.contexts&&a.contexts.trace)&&c){let{traceId:u,spanId:d,parentSpanId:g,dsc:m}=c;a.contexts={trace:{trace_id:u,span_id:d,parent_span_id:g},...a.contexts};let h=m||Dq.getDynamicSamplingContextFromClient(u,this,r);a.sdkProcessingMetadata={dynamicSamplingContext:h,...a.sdkProcessingMetadata}}return a})}_captureEvent(t,n={},r){return this._processEvent(t,n,r).then(i=>i.event_id,i=>{if(En.DEBUG_BUILD){let o=i;o.logLevel==="log"?oe.logger.log(o.message):oe.logger.warn(o)}})}_processEvent(t,n,r){let i=this.getOptions(),{sampleRate:o}=i,s=NS(t),a=VS(t),c=t.type||"error",l=`before send for type \`${c}\``;if(a&&typeof o=="number"&&Math.random()>o)return this.recordDroppedEvent("sample_rate","error",t),oe.rejectedSyncPromise(new oe.SentryError(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));let u=c==="replay_event"?"replay":c,g=(t.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(t,n,r,g).then(m=>{if(m===null)throw this.recordDroppedEvent("event_processor",u,t),new oe.SentryError("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return m;let b=jq(i,m,n);return Mq(b,l)}).then(m=>{if(m===null){if(this.recordDroppedEvent("before_send",u,t),s){let v=1+(t.spans||[]).length;this.recordDroppedEvent("before_send","span",v)}throw new oe.SentryError(`${l} returned \`null\`, will not send event.`,"log")}let h=r&&r.getSession();if(!s&&h&&this._updateSessionFromEvent(h,m),s){let y=m.sdkProcessingMetadata&&m.sdkProcessingMetadata.spanCountBeforeProcessing||0,v=m.spans?m.spans.length:0,H=y-v;H>0&&this.recordDroppedEvent("before_send","span",H)}let b=m.transaction_info;if(s&&b&&m.transaction!==t.transaction){let y="custom";m.transaction_info={...b,source:y}}return this.sendEvent(m,n),m}).then(null,m=>{throw m instanceof oe.SentryError?m:(this.captureException(m,{data:{__sentry__:!0},originalException:m}),new oe.SentryError(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${m}`))})}_process(t){this._numProcessing++,t.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_sendEnvelope(t){if(this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport)return this._transport.send(t).then(null,n=>{En.DEBUG_BUILD&&oe.logger.error("Error while sending event:",n)});En.DEBUG_BUILD&&oe.logger.error("Transport disabled")}_clearOutcomes(){let t=this._outcomes;return this._outcomes={},Object.keys(t).map(n=>{let[r,i]=n.split(":");return{reason:r,category:i,quantity:t[n]}})}};function Mq(e,t){let n=`${t} must return \`null\` or a valid event.`;if(oe.isThenable(e))return e.then(r=>{if(!oe.isPlainObject(r)&&r!==null)throw new oe.SentryError(n);return r},r=>{throw new oe.SentryError(`${t} rejected with ${r}`)});if(!oe.isPlainObject(e)&&e!==null)throw new oe.SentryError(n);return e}function jq(e,t,n){let{beforeSend:r,beforeSendTransaction:i}=e;if(VS(t)&&r)return r(t,n);if(NS(t)&&i){if(t.spans){let o=t.spans.length;t.sdkProcessingMetadata={...t.sdkProcessingMetadata,spanCountBeforeProcessing:o}}return i(t,n)}return t}function VS(e){return e.type===void 0}function NS(e){return e.type==="transaction"}function Pq(e){let t=Jq.getClient();!t||!t.addEventProcessor||t.addEventProcessor(e)}Nl.BaseClient=Zf;Nl.addEventProcessor=Pq});var Rf=I(Wf=>{"use strict";Object.defineProperty(Wf,"__esModule",{value:!0});var Sf=R();function Qq(e,t,n,r,i){let o={sent_at:new Date().toISOString()};n&&n.sdk&&(o.sdk={name:n.sdk.name,version:n.sdk.version}),r&&i&&(o.dsn=Sf.dsnToString(i)),t&&(o.trace=Sf.dropUndefinedKeys(t));let s=$q(e);return Sf.createEnvelope(o,[s])}function $q(e){return[{type:"check_in"},e]}Wf.createCheckInEnvelope=Qq});var Na=I(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});var eM="c",tM="g",nM="s",rM="d",iM=5e3,oM=1e4,sM=1e4;sr.COUNTER_METRIC_TYPE=eM;sr.DEFAULT_BROWSER_FLUSH_INTERVAL=iM;sr.DEFAULT_FLUSH_INTERVAL=oM;sr.DISTRIBUTION_METRIC_TYPE=rM;sr.GAUGE_METRIC_TYPE=tM;sr.MAX_WEIGHT=sM;sr.SET_METRIC_TYPE=nM});var Vf=I(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});var wl=Na(),aM=Va(),El=class{constructor(t){this._value=t}get weight(){return 1}add(t){this._value+=t}toString(){return`${this._value}`}},Hl=class{constructor(t){this._last=t,this._min=t,this._max=t,this._sum=t,this._count=1}get weight(){return 5}add(t){this._last=t,t<this._min&&(this._min=t),t>this._max&&(this._max=t),this._sum+=t,this._count++}toString(){return`${this._last}:${this._min}:${this._max}:${this._sum}:${this._count}`}},Yl=class{constructor(t){this._value=[t]}get weight(){return this._value.length}add(t){this._value.push(t)}toString(){return this._value.join(":")}},Xl=class{constructor(t){this.first=t,this._value=new Set([t])}get weight(){return this._value.size}add(t){this._value.add(t)}toString(){return Array.from(this._value).map(t=>typeof t=="string"?aM.simpleHash(t):t).join(":")}},cM={[wl.COUNTER_METRIC_TYPE]:El,[wl.GAUGE_METRIC_TYPE]:Hl,[wl.DISTRIBUTION_METRIC_TYPE]:Yl,[wl.SET_METRIC_TYPE]:Xl};Vi.CounterMetric=El;Vi.DistributionMetric=Yl;Vi.GaugeMetric=Hl;Vi.METRIC_MAP=cM;Vi.SetMetric=Xl});var ES=I(wf=>{"use strict";Object.defineProperty(wf,"__esModule",{value:!0});var wS=R(),wa=Na(),uM=Vf(),lM=va(),_l=Va(),Nf=class{constructor(t){this._client=t,this._buckets=new Map,this._bucketsTotalWeight=0,this._interval=setInterval(()=>this._flush(),wa.DEFAULT_FLUSH_INTERVAL),this._interval.unref&&this._interval.unref(),this._flushShift=Math.floor(Math.random()*wa.DEFAULT_FLUSH_INTERVAL/1e3),this._forceFlush=!1}add(t,n,r,i="none",o={},s=wS.timestampInSeconds()){let a=Math.floor(s),c=_l.sanitizeMetricKey(n),l=_l.sanitizeTags(o),u=_l.sanitizeUnit(i),d=_l.getBucketKey(t,c,u,l),g=this._buckets.get(d),m=g&&t===wa.SET_METRIC_TYPE?g.metric.weight:0;g?(g.metric.add(r),g.timestamp<a&&(g.timestamp=a)):(g={metric:new uM.METRIC_MAP[t](r),timestamp:a,metricType:t,name:c,unit:u,tags:l},this._buckets.set(d,g));let h=typeof r=="string"?g.metric.weight-m:r;lM.updateMetricSummaryOnActiveSpan(t,c,h,u,o,d),this._bucketsTotalWeight+=g.metric.weight,this._bucketsTotalWeight>=wa.MAX_WEIGHT&&this.flush()}flush(){this._forceFlush=!0,this._flush()}close(){this._forceFlush=!0,clearInterval(this._interval),this._flush()}_flush(){if(this._forceFlush){this._forceFlush=!1,this._bucketsTotalWeight=0,this._captureMetrics(this._buckets),this._buckets.clear();return}let t=Math.floor(wS.timestampInSeconds())-wa.DEFAULT_FLUSH_INTERVAL/1e3-this._flushShift,n=new Map;for(let[r,i]of this._buckets)i.timestamp<=t&&(n.set(r,i),this._bucketsTotalWeight-=i.metric.weight);for(let[r]of n)this._buckets.delete(r);this._captureMetrics(n)}_captureMetrics(t){if(t.size>0&&this._client.captureAggregateMetrics){let n=Array.from(t).map(([,r])=>r);this._client.captureAggregateMetrics(n)}}};wf.MetricsAggregator=Nf});var YS=I(Hf=>{"use strict";Object.defineProperty(Hf,"__esModule",{value:!0});var ar=R(),gM=vf(),dM=Rf(),Fl=we(),IM=Qt(),mM=ES(),pM=bf(),fM=mf(),hM=yt(),CM=Fo();Ko();var HS=Zi(),Ef=class extends gM.BaseClient{constructor(t){fM.addTracingExtensions(),super(t),t._experiments&&t._experiments.metricsAggregator&&(this.metricsAggregator=new mM.MetricsAggregator(this))}eventFromException(t,n){return ar.resolvedSyncPromise(ar.eventFromUnknownInput(IM.getClient(),this._options.stackParser,t,n))}eventFromMessage(t,n="info",r){return ar.resolvedSyncPromise(ar.eventFromMessage(this._options.stackParser,t,n,r,this._options.attachStacktrace))}captureException(t,n,r){if(this._options.autoSessionTracking&&this._sessionFlusher&&r){let i=r.getRequestSession();i&&i.status==="ok"&&(i.status="errored")}return super.captureException(t,n,r)}captureEvent(t,n,r){if(this._options.autoSessionTracking&&this._sessionFlusher&&r&&(t.type||"exception")==="exception"&&t.exception&&t.exception.values&&t.exception.values.length>0){let s=r.getRequestSession();s&&s.status==="ok"&&(s.status="errored")}return super.captureEvent(t,n,r)}close(t){return this._sessionFlusher&&this._sessionFlusher.close(),super.close(t)}initSessionFlusher(){let{release:t,environment:n}=this._options;t?this._sessionFlusher=new pM.SessionFlusher(this,{release:t,environment:n}):Fl.DEBUG_BUILD&&ar.logger.warn("Cannot initialise an instance of SessionFlusher if no release is provided!")}captureCheckIn(t,n,r){let i="checkInId"in t&&t.checkInId?t.checkInId:ar.uuid4();if(!this._isEnabled())return Fl.DEBUG_BUILD&&ar.logger.warn("SDK not enabled, will not capture checkin."),i;let o=this.getOptions(),{release:s,environment:a,tunnel:c}=o,l={check_in_id:i,monitor_slug:t.monitorSlug,status:t.status,release:s,environment:a};"duration"in t&&(l.duration=t.duration),n&&(l.monitor_config={schedule:n.schedule,checkin_margin:n.checkinMargin,max_runtime:n.maxRuntime,timezone:n.timezone});let[u,d]=this._getTraceInfoFromScope(r);d&&(l.contexts={trace:d});let g=dM.createCheckInEnvelope(l,u,this.getSdkMetadata(),c,this.getDsn());return Fl.DEBUG_BUILD&&ar.logger.info("Sending checkin:",t.monitorSlug,t.status),this._sendEnvelope(g),i}_captureRequestSession(){this._sessionFlusher?this._sessionFlusher.incrementSessionStatusCount():Fl.DEBUG_BUILD&&ar.logger.warn("Discarded request mode session because autoSessionTracking option was disabled")}_prepareEvent(t,n,r,i){return this._options.platform&&(t.platform=t.platform||this._options.platform),this._options.runtime&&(t.contexts={...t.contexts,runtime:(t.contexts||{}).runtime||this._options.runtime}),this._options.serverName&&(t.server_name=t.server_name||this._options.serverName),super._prepareEvent(t,n,r,i)}_getTraceInfoFromScope(t){if(!t)return[void 0,void 0];let n=t.getSpan();if(n)return[CM.getRootSpan(n)?HS.getDynamicSamplingContextFromSpan(n):void 0,hM.spanToTraceContext(n)];let{traceId:r,spanId:i,parentSpanId:o,dsc:s}=t.getPropagationContext(),a={trace_id:r,span_id:i,parent_span_id:o};return s?[s,a]:[HS.getDynamicSamplingContextFromClient(r,this,t),a]}};Hf.ServerRuntimeClient=Ef});var FS=I(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});var XS=R(),bM=we(),yM=Qt(),GM=Rn();function BM(e,t){t.debug===!0&&(bM.DEBUG_BUILD?XS.logger.enable():XS.consoleSandbox(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),yM.getCurrentScope().update(t.initialScope);let r=new e(t);_S(r),AM(r)}function _S(e){let n=GM.getCurrentHub().getStackTop();n.client=e,n.scope.setClient(e)}function AM(e){e.init?e.init():e.setupIntegrations&&e.setupIntegrations()}Tl.initAndBind=BM;Tl.setCurrentClient=_S});var US=I(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});var Bt=R(),TS=we(),KS=30;function ZM(e,t,n=Bt.makePromiseBuffer(e.bufferSize||KS)){let r={},i=s=>n.drain(s);function o(s){let a=[];if(Bt.forEachEnvelopeItem(s,(d,g)=>{let m=Bt.envelopeItemTypeToDataCategory(g);if(Bt.isRateLimited(r,m)){let h=kS(d,g);e.recordDroppedEvent("ratelimit_backoff",m,h)}else a.push(d)}),a.length===0)return Bt.resolvedSyncPromise();let c=Bt.createEnvelope(s[0],a),l=d=>{Bt.forEachEnvelopeItem(c,(g,m)=>{let h=kS(g,m);e.recordDroppedEvent(d,Bt.envelopeItemTypeToDataCategory(m),h)})},u=()=>t({body:Bt.serializeEnvelope(c,e.textEncoder)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&TS.DEBUG_BUILD&&Bt.logger.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=Bt.updateRateLimits(r,d),d),d=>{throw l("network_error"),d});return n.add(u).then(d=>d,d=>{if(d instanceof Bt.SentryError)return TS.DEBUG_BUILD&&Bt.logger.error("Skipped sending event because buffer is full."),l("queue_overflow"),Bt.resolvedSyncPromise();throw d})}return o.__sentry__baseTransport__=!0,{send:o,flush:i}}function kS(e,t){if(!(t!=="event"&&t!=="transaction"))return Array.isArray(e)?e[1]:void 0}kl.DEFAULT_TRANSPORT_BUFFER_SIZE=KS;kl.createTransport=ZM});var LS=I(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});var Xf=R(),vM=we(),xS=100,_f=5e3,SM=36e5;function Yf(e,t){vM.DEBUG_BUILD&&Xf.logger.info(`[Offline]: ${e}`,t)}function WM(e){return t=>{let n=e(t),r=t.createStore?t.createStore(t):void 0,i=_f,o;function s(u,d,g){return Xf.envelopeContainsItemType(u,["replay_event","replay_recording","client_report"])?!1:t.shouldStore?t.shouldStore(u,d,g):!0}function a(u){r&&(o&&clearTimeout(o),o=setTimeout(async()=>{o=void 0;let d=await r.pop();d&&(Yf("Attempting to send previously queued event"),l(d).catch(g=>{Yf("Failed to retry sending",g)}))},u),typeof o!="number"&&o.unref&&o.unref())}function c(){o||(a(i),i=Math.min(i*2,SM))}async function l(u){try{let d=await n.send(u),g=xS;if(d){if(d.headers&&d.headers["retry-after"])g=Xf.parseRetryAfterHeader(d.headers["retry-after"]);else if((d.statusCode||0)>=400)return d}return a(g),i=_f,d}catch(d){if(r&&await s(u,d,i))return await r.insert(u),c(),Yf("Error sending. Event queued",d),{};throw d}}return t.flushAtStartup&&c(),{send:l,flush:u=>n.flush(u)}}}Ea.MIN_DELAY=xS;Ea.START_DELAY=_f;Ea.makeOfflineTransport=WM});var JS=I(Kl=>{"use strict";Object.defineProperty(Kl,"__esModule",{value:!0});var Ff=R(),RM=Wl();function Tf(e,t){let n;return Ff.forEachEnvelopeItem(e,(r,i)=>(t.includes(i)&&(n=Array.isArray(r)?r[1]:void 0),!!n)),n}function VM(e,t){return n=>{let r=e(n);return{...r,send:async i=>{let o=Tf(i,["event","transaction","profile","replay_event"]);return o&&(o.release=t),r.send(i)}}}}function NM(e,t){return Ff.createEnvelope(t?{...e[0],dsn:t}:e[0],e[1])}function wM(e,t){return n=>{let r=e(n),i=new Map;function o(c,l){let u=l?`${c}:${l}`:c,d=i.get(u);if(!d){let g=Ff.dsnFromString(c);if(!g)return;let m=RM.getEnvelopeEndpointWithUrlEncodedAuth(g,n.tunnel);d=l?VM(e,l)({...n,url:m}):e({...n,url:m}),i.set(u,d)}return[c,d]}async function s(c){function l(g){let m=g&&g.length?g:["event"];return Tf(c,m)}let u=t({envelope:c,getEvent:l}).map(g=>typeof g=="string"?o(g,void 0):o(g.dsn,g.release)).filter(g=>!!g);return u.length===0&&u.push(["",r]),(await Promise.all(u.map(([g,m])=>m.send(NM(c,g)))))[0]}async function a(c){let l=[await r.flush(c)];for(let[,u]of i)l.push(await u.flush(c));return l.every(u=>u)}return{send:s,flush:a}}}Kl.eventFromEnvelope=Tf;Kl.makeMultiplexedTransport=wM});var OS=I(kf=>{"use strict";Object.defineProperty(kf,"__esModule",{value:!0});var zS=R();function EM(e,t){let n={sent_at:new Date().toISOString()};t&&(n.dsn=zS.dsnToString(t));let r=e.map(HM);return zS.createEnvelope(n,r)}function HM(e){return[{type:"span"},e]}kf.createSpanEnvelope=EM});var qS=I(Kf=>{"use strict";Object.defineProperty(Kf,"__esModule",{value:!0});function YM(e,t){let n=t&&FM(t)?t.getClient():t,r=n&&n.getDsn(),i=n&&n.getOptions().tunnel;return _M(e,r)||XM(e,i)}function XM(e,t){return t?DS(e)===DS(t):!1}function _M(e,t){return t?e.includes(t.host):!1}function DS(e){return e[e.length-1]==="/"?e.slice(0,-1):e}function FM(e){return e.getClient!==void 0}Kf.isSentryRequestUrl=YM});var MS=I(Uf=>{"use strict";Object.defineProperty(Uf,"__esModule",{value:!0});function TM(e,...t){let n=new String(String.raw(e,...t));return n.__sentry_template_string__=e.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),n.__sentry_template_values__=t,n}Uf.parameterize=TM});var PS=I(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});var jS=rl();function kM(e,t,n=[t],r="npm"){let i=e._metadata||{};i.sdk||(i.sdk={name:`sentry.javascript.${t}`,packages:n.map(o=>({name:`${r}:@sentry/${o}`,version:jS.SDK_VERSION})),version:jS.SDK_VERSION}),e._metadata=i}xf.applySdkMetadata=kM});var t0=I(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});var Lf=R(),$S=new Map,QS=new Set;function KM(e){if(Lf.GLOBAL_OBJ._sentryModuleMetadata)for(let t of Object.keys(Lf.GLOBAL_OBJ._sentryModuleMetadata)){let n=Lf.GLOBAL_OBJ._sentryModuleMetadata[t];if(QS.has(t))continue;QS.add(t);let r=e(t);for(let i of r.reverse())if(i.filename){$S.set(i.filename,n);break}}}function e0(e,t){return KM(e),$S.get(t)}function UM(e,t){try{t.exception.values.forEach(n=>{if(n.stacktrace)for(let r of n.stacktrace.frames||[]){if(!r.filename)continue;let i=e0(e,r.filename);i&&(r.module_metadata=i)}})}catch{}}function xM(e){try{e.exception.values.forEach(t=>{if(t.stacktrace)for(let n of t.stacktrace.frames||[])delete n.module_metadata})}catch{}}Ha.addMetadataToStackFrames=UM;Ha.getMetadataForUrl=e0;Ha.stripMetadataFromStackFrames=xM});var s0=I(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});var LM=R(),r0=or(),n0=t0(),i0="ModuleMetadata",JM=()=>({name:i0,setupOnce(){},setup(e){typeof e.on=="function"&&e.on("beforeEnvelope",t=>{LM.forEachEnvelopeItem(t,(n,r)=>{if(r==="event"){let i=Array.isArray(n)?n[1]:void 0;i&&(n0.stripMetadataFromStackFrames(i),n[1]=i)}})})},processEvent(e,t,n){let r=n.getOptions().stackParser;return n0.addMetadataToStackFrames(r,e),e}}),o0=r0.defineIntegration(JM),zM=r0.convertIntegrationFnToClass(i0,o0);Ul.ModuleMetadata=zM;Ul.moduleMetadataIntegration=o0});var g0=I(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});var a0=R(),c0=or(),OM=yt(),Jf={include:{cookies:!0,data:!0,headers:!0,ip:!1,query_string:!0,url:!0,user:{id:!0,username:!0,email:!0}},transactionNamingScheme:"methodPath"},u0="RequestData",DM=(e={})=>{let t=a0.addRequestDataToEvent,n={...Jf,...e,include:{method:!0,...Jf.include,...e.include,user:e.include&&typeof e.include.user=="boolean"?e.include.user:{...Jf.include.user,...(e.include||{}).user}}};return{name:u0,setupOnce(){},processEvent(r,i,o){let{transactionNamingScheme:s}=n,{sdkProcessingMetadata:a={}}=r,c=a.request;if(!c)return r;let l=a.requestDataOptionsFromExpressHandler||a.requestDataOptionsFromGCPWrapper||MM(n),u=t(r,c,l);if(r.type==="transaction"||s==="handler")return u;let g=c._sentryTransaction;if(g){let m=OM.spanToJSON(g).description||"",h=jM(o)==="sentry.javascript.nextjs"?m.startsWith("/api"):s!=="path",[b]=a0.extractPathForTransaction(c,{path:!0,method:h,customRoute:m});u.transaction=b}return u}}},l0=c0.defineIntegration(DM),qM=c0.convertIntegrationFnToClass(u0,l0);function MM(e){let{transactionNamingScheme:t,include:{ip:n,user:r,...i}}=e,o=[];for(let[a,c]of Object.entries(i))c&&o.push(a);let s;if(r===void 0)s=!0;else if(typeof r=="boolean")s=r;else{let a=[];for(let[c,l]of Object.entries(r))l&&a.push(c);s=a}return{include:{ip:n,user:s,request:o.length!==0?o:void 0,transaction:t}}}function jM(e){try{return e.getOptions()._metadata.sdk.name}catch{return}}xl.RequestData=qM;xl.requestDataIntegration=l0});var zf=I(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});var Ke=R(),Ni=we(),d0=or(),PM=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/],QM=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],I0="InboundFilters",$M=(e={})=>({name:I0,setupOnce(){},processEvent(t,n,r){let i=r.getOptions(),o=tj(e,i);return nj(t,o)?null:t}}),m0=d0.defineIntegration($M),ej=d0.convertIntegrationFnToClass(I0,m0);function tj(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:PM],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:QM],ignoreInternal:e.ignoreInternal!==void 0?e.ignoreInternal:!0}}function nj(e,t){return t.ignoreInternal&&cj(e)?(Ni.DEBUG_BUILD&&Ke.logger.warn(`Event dropped due to being internal Sentry Error.
Event: ${Ke.getEventDescription(e)}`),!0):rj(e,t.ignoreErrors)?(Ni.DEBUG_BUILD&&Ke.logger.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Ke.getEventDescription(e)}`),!0):ij(e,t.ignoreTransactions)?(Ni.DEBUG_BUILD&&Ke.logger.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Ke.getEventDescription(e)}`),!0):oj(e,t.denyUrls)?(Ni.DEBUG_BUILD&&Ke.logger.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Ke.getEventDescription(e)}.
Url: ${Ll(e)}`),!0):sj(e,t.allowUrls)?!1:(Ni.DEBUG_BUILD&&Ke.logger.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Ke.getEventDescription(e)}.
Url: ${Ll(e)}`),!0)}function rj(e,t){return e.type||!t||!t.length?!1:aj(e).some(n=>Ke.stringMatchesSomePattern(n,t))}function ij(e,t){if(e.type!=="transaction"||!t||!t.length)return!1;let n=e.transaction;return n?Ke.stringMatchesSomePattern(n,t):!1}function oj(e,t){if(!t||!t.length)return!1;let n=Ll(e);return n?Ke.stringMatchesSomePattern(n,t):!1}function sj(e,t){if(!t||!t.length)return!0;let n=Ll(e);return n?Ke.stringMatchesSomePattern(n,t):!0}function aj(e){let t=[];e.message&&t.push(e.message);let n;try{n=e.exception.values[e.exception.values.length-1]}catch{}return n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`)),Ni.DEBUG_BUILD&&t.length===0&&Ke.logger.error(`Could not extract message for event ${Ke.getEventDescription(e)}`),t}function cj(e){try{return e.exception.values[0].type==="SentryError"}catch{}return!1}function uj(e=[]){for(let t=e.length-1;t>=0;t--){let n=e[t];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Ll(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch{}return t?uj(t):null}catch{return Ni.DEBUG_BUILD&&Ke.logger.error(`Cannot extract url for event ${Ke.getEventDescription(e)}`),null}}Jl.InboundFilters=ej;Jl.inboundFiltersIntegration=m0});var Of=I(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});var lj=R(),gj=Qt(),h0=or(),p0,C0="FunctionToString",f0=new WeakMap,dj=()=>({name:C0,setupOnce(){p0=Function.prototype.toString;try{Function.prototype.toString=function(...e){let t=lj.getOriginalFunction(this),n=f0.has(gj.getClient())&&t!==void 0?t:this;return p0.apply(n,e)}}catch{}},setup(e){f0.set(e,!0)}}),b0=h0.defineIntegration(dj),Ij=h0.convertIntegrationFnToClass(C0,b0);zl.FunctionToString=Ij;zl.functionToStringIntegration=b0});var Df=I(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});var y0=R(),G0=or(),mj="cause",pj=5,B0="LinkedErrors",fj=(e={})=>{let t=e.limit||pj,n=e.key||mj;return{name:B0,setupOnce(){},preprocessEvent(r,i,o){let s=o.getOptions();y0.applyAggregateErrorsToEvent(y0.exceptionFromError,s.stackParser,s.maxValueLength,n,t,r,i)}}},A0=G0.defineIntegration(fj),hj=G0.convertIntegrationFnToClass(B0,A0);Ol.LinkedErrors=hj;Ol.linkedErrorsIntegration=A0});var Z0=I(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});var Cj=Of(),bj=zf(),yj=Df();Ya.FunctionToString=Cj.FunctionToString;Ya.InboundFilters=bj.InboundFilters;Ya.LinkedErrors=yj.LinkedErrors});var S0=I(Mf=>{"use strict";Object.defineProperty(Mf,"__esModule",{value:!0});var Gj=R(),v0=Na(),Bj=Vf(),Aj=va(),Dl=Va(),qf=class{constructor(t){this._client=t,this._buckets=new Map,this._interval=setInterval(()=>this.flush(),v0.DEFAULT_BROWSER_FLUSH_INTERVAL)}add(t,n,r,i="none",o={},s=Gj.timestampInSeconds()){let a=Math.floor(s),c=Dl.sanitizeMetricKey(n),l=Dl.sanitizeTags(o),u=Dl.sanitizeUnit(i),d=Dl.getBucketKey(t,c,u,l),g=this._buckets.get(d),m=g&&t===v0.SET_METRIC_TYPE?g.metric.weight:0;g?(g.metric.add(r),g.timestamp<a&&(g.timestamp=a)):(g={metric:new Bj.METRIC_MAP[t](r),timestamp:a,metricType:t,name:c,unit:u,tags:l},this._buckets.set(d,g));let h=typeof r=="string"?g.metric.weight-m:r;Aj.updateMetricSummaryOnActiveSpan(t,c,h,u,o,d)}flush(){if(this._buckets.size!==0){if(this._client.captureAggregateMetrics){let t=Array.from(this._buckets).map(([,n])=>n);this._client.captureAggregateMetrics(t)}this._buckets.clear()}}close(){clearInterval(this._interval),this.flush()}};Mf.BrowserMetricsAggregator=qf});var N0=I(ql=>{"use strict";Object.defineProperty(ql,"__esModule",{value:!0});var W0=or(),Zj=S0(),R0="MetricsAggregator",vj=()=>({name:R0,setupOnce(){},setup(e){e.metricsAggregator=new Zj.BrowserMetricsAggregator(e)}}),V0=W0.defineIntegration(vj),Sj=W0.convertIntegrationFnToClass(R0,V0);ql.MetricsAggregator=Sj;ql.metricsAggregatorIntegration=V0});var k0=I(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});var w0=R(),E0=we(),H0=Qt(),Wj=yt(),Ml=Na(),Y0=N0();function jl(e,t,n,r={}){let i=H0.getClient(),o=H0.getCurrentScope();if(i){if(!i.metricsAggregator){E0.DEBUG_BUILD&&w0.logger.warn("No metrics aggregator enabled. Please add the MetricsAggregator integration to use metrics APIs");return}let{unit:s,tags:a,timestamp:c}=r,{release:l,environment:u}=i.getOptions(),d=o.getTransaction(),g={};l&&(g.release=l),u&&(g.environment=u),d&&(g.transaction=Wj.spanToJSON(d).description||""),E0.DEBUG_BUILD&&w0.logger.log(`Adding value of ${n} to ${e} metric ${t}`),i.metricsAggregator.add(e,t,n,s,{...g,...a},c)}}function X0(e,t=1,n){jl(Ml.COUNTER_METRIC_TYPE,e,t,n)}function _0(e,t,n){jl(Ml.DISTRIBUTION_METRIC_TYPE,e,t,n)}function F0(e,t,n){jl(Ml.SET_METRIC_TYPE,e,t,n)}function T0(e,t,n){jl(Ml.GAUGE_METRIC_TYPE,e,t,n)}var Rj={increment:X0,distribution:_0,set:F0,gauge:T0,MetricsAggregator:Y0.MetricsAggregator,metricsAggregatorIntegration:Y0.metricsAggregatorIntegration};wi.distribution=_0;wi.gauge=T0;wi.increment=X0;wi.metrics=Rj;wi.set=F0});var j=I(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});var K0=mf(),U0=df(),Vj=pl(),Nj=Cl(),x0=sl(),Pl=Ko(),Ei=dl(),L0=Zi(),wj=GS(),Ej=If(),Xa=Sa(),J0=ff(),he=Qt(),Hn=Rn(),jf=Xo(),Hj=bf(),Pf=Qu(),z0=ma(),O0=Wl(),D0=vf(),Yj=YS(),q0=FS(),Xj=US(),_j=LS(),Fj=JS(),Tj=rl(),Ql=or(),M0=Pu(),kj=ju(),Kj=Rf(),Uj=OS(),xj=cl(),Lj=qS(),Jj=rf(),zj=MS(),$l=yt(),Oj=Fo(),Dj=PS(),qj=Yo(),j0=s0(),P0=g0(),Q0=zf(),$0=Of(),eW=Df(),Mj=Z0(),jj=k0(),Pj=Mj;S.addTracingExtensions=K0.addTracingExtensions;S.startIdleTransaction=K0.startIdleTransaction;S.IdleTransaction=U0.IdleTransaction;S.TRACING_DEFAULTS=U0.TRACING_DEFAULTS;S.Span=Vj.Span;S.Transaction=Nj.Transaction;S.extractTraceparentData=x0.extractTraceparentData;S.getActiveTransaction=x0.getActiveTransaction;Object.defineProperty(S,"SpanStatus",{enumerable:!0,get:()=>Pl.SpanStatus});S.getSpanStatusFromHttpCode=Pl.getSpanStatusFromHttpCode;S.setHttpStatus=Pl.setHttpStatus;S.spanStatusfromHttpCode=Pl.spanStatusfromHttpCode;S.continueTrace=Ei.continueTrace;S.getActiveSpan=Ei.getActiveSpan;S.startActiveSpan=Ei.startActiveSpan;S.startInactiveSpan=Ei.startInactiveSpan;S.startSpan=Ei.startSpan;S.startSpanManual=Ei.startSpanManual;S.trace=Ei.trace;S.getDynamicSamplingContextFromClient=L0.getDynamicSamplingContextFromClient;S.getDynamicSamplingContextFromSpan=L0.getDynamicSamplingContextFromSpan;S.setMeasurement=wj.setMeasurement;S.isValidSampleRate=Ej.isValidSampleRate;S.SEMANTIC_ATTRIBUTE_PROFILE_ID=Xa.SEMANTIC_ATTRIBUTE_PROFILE_ID;S.SEMANTIC_ATTRIBUTE_SENTRY_OP=Xa.SEMANTIC_ATTRIBUTE_SENTRY_OP;S.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=Xa.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN;S.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=Xa.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE;S.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=Xa.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE;S.createEventEnvelope=J0.createEventEnvelope;S.createSessionEnvelope=J0.createSessionEnvelope;S.addBreadcrumb=he.addBreadcrumb;S.captureCheckIn=he.captureCheckIn;S.captureEvent=he.captureEvent;S.captureException=he.captureException;S.captureMessage=he.captureMessage;S.captureSession=he.captureSession;S.close=he.close;S.configureScope=he.configureScope;S.endSession=he.endSession;S.flush=he.flush;S.getClient=he.getClient;S.getCurrentScope=he.getCurrentScope;S.isInitialized=he.isInitialized;S.lastEventId=he.lastEventId;S.setContext=he.setContext;S.setExtra=he.setExtra;S.setExtras=he.setExtras;S.setTag=he.setTag;S.setTags=he.setTags;S.setUser=he.setUser;S.startSession=he.startSession;S.startTransaction=he.startTransaction;S.withActiveSpan=he.withActiveSpan;S.withIsolationScope=he.withIsolationScope;S.withMonitor=he.withMonitor;S.withScope=he.withScope;S.Hub=Hn.Hub;S.ensureHubOnCarrier=Hn.ensureHubOnCarrier;S.getCurrentHub=Hn.getCurrentHub;S.getHubFromCarrier=Hn.getHubFromCarrier;S.getIsolationScope=Hn.getIsolationScope;S.getMainCarrier=Hn.getMainCarrier;S.makeMain=Hn.makeMain;S.runWithAsyncContext=Hn.runWithAsyncContext;S.setAsyncContextStrategy=Hn.setAsyncContextStrategy;S.setHubOnCarrier=Hn.setHubOnCarrier;S.closeSession=jf.closeSession;S.makeSession=jf.makeSession;S.updateSession=jf.updateSession;S.SessionFlusher=Hj.SessionFlusher;S.Scope=Pf.Scope;S.getGlobalScope=Pf.getGlobalScope;S.setGlobalScope=Pf.setGlobalScope;S.addGlobalEventProcessor=z0.addGlobalEventProcessor;S.notifyEventProcessors=z0.notifyEventProcessors;S.getEnvelopeEndpointWithUrlEncodedAuth=O0.getEnvelopeEndpointWithUrlEncodedAuth;S.getReportDialogEndpoint=O0.getReportDialogEndpoint;S.BaseClient=D0.BaseClient;S.addEventProcessor=D0.addEventProcessor;S.ServerRuntimeClient=Yj.ServerRuntimeClient;S.initAndBind=q0.initAndBind;S.setCurrentClient=q0.setCurrentClient;S.createTransport=Xj.createTransport;S.makeOfflineTransport=_j.makeOfflineTransport;S.makeMultiplexedTransport=Fj.makeMultiplexedTransport;S.SDK_VERSION=Tj.SDK_VERSION;S.addIntegration=Ql.addIntegration;S.convertIntegrationFnToClass=Ql.convertIntegrationFnToClass;S.defineIntegration=Ql.defineIntegration;S.getIntegrationsToSetup=Ql.getIntegrationsToSetup;S.applyScopeDataToEvent=M0.applyScopeDataToEvent;S.mergeScopeData=M0.mergeScopeData;S.prepareEvent=kj.prepareEvent;S.createCheckInEnvelope=Kj.createCheckInEnvelope;S.createSpanEnvelope=Uj.createSpanEnvelope;S.hasTracingEnabled=xj.hasTracingEnabled;S.isSentryRequestUrl=Lj.isSentryRequestUrl;S.handleCallbackErrors=Jj.handleCallbackErrors;S.parameterize=zj.parameterize;S.spanIsSampled=$l.spanIsSampled;S.spanToJSON=$l.spanToJSON;S.spanToTraceContext=$l.spanToTraceContext;S.spanToTraceHeader=$l.spanToTraceHeader;S.getRootSpan=Oj.getRootSpan;S.applySdkMetadata=Dj.applySdkMetadata;S.DEFAULT_ENVIRONMENT=qj.DEFAULT_ENVIRONMENT;S.ModuleMetadata=j0.ModuleMetadata;S.moduleMetadataIntegration=j0.moduleMetadataIntegration;S.RequestData=P0.RequestData;S.requestDataIntegration=P0.requestDataIntegration;S.InboundFilters=Q0.InboundFilters;S.inboundFiltersIntegration=Q0.inboundFiltersIntegration;S.FunctionToString=$0.FunctionToString;S.functionToStringIntegration=$0.functionToStringIntegration;S.LinkedErrors=eW.LinkedErrors;S.linkedErrorsIntegration=eW.linkedErrorsIntegration;S.metrics=jj.metrics;S.Integrations=Pj});var At=I(Qf=>{"use strict";Object.defineProperty(Qf,"__esModule",{value:!0});var Qj=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;Qf.DEBUG_BUILD=Qj});var _r=I($f=>{"use strict";var{_optionalChain:tW}=R();Object.defineProperty($f,"__esModule",{value:!0});function $j(e){let t=tW([e,"call",r=>r(),"access",r=>r.getClient,"call",r=>r(),"optionalAccess",r=>r.getOptions,"call",r=>r()]);return(tW([t,"optionalAccess",r=>r.instrumenter])||"sentry")!=="sentry"}$f.shouldDisableAutoInstrumentation=$j});var oW=I(_a=>{"use strict";var{_optionalChain:Yn}=R();Object.defineProperty(_a,"__esModule",{value:!0});var eh=j(),Zt=R(),eg=At(),eP=_r(),tg=class e{static __initStatic(){this.id="Express"}constructor(t={}){this.name=e.id,this._router=t.router||t.app,this._methods=(Array.isArray(t.methods)?t.methods:[]).concat("use")}setupOnce(t,n){if(!this._router){eg.DEBUG_BUILD&&Zt.logger.error("ExpressIntegration is missing an Express instance");return}if(eP.shouldDisableAutoInstrumentation(n)){eg.DEBUG_BUILD&&Zt.logger.log("Express Integration is skipped because of instrumenter configuration.");return}rP(this._router,this._methods),iP(this._router)}};tg.__initStatic();function nW(e,t){let n=e.length;switch(n){case 2:return function(r,i){let o=i.__sentry_transaction;if(o){let s=o.startChild({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"});i.once("finish",()=>{s.end()})}return e.call(this,r,i)};case 3:return function(r,i,o){let s=i.__sentry_transaction,a=Yn([s,"optionalAccess",c=>c.startChild,"call",c=>c({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,r,i,function(...c){Yn([a,"optionalAccess",l=>l.end,"call",l=>l()]),o.call(this,...c)})};case 4:return function(r,i,o,s){let a=o.__sentry_transaction,c=Yn([a,"optionalAccess",l=>l.startChild,"call",l=>l({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,r,i,o,function(...l){Yn([c,"optionalAccess",u=>u.end,"call",u=>u()]),s.call(this,...l)})};default:throw new Error(`Express middleware takes 2-4 arguments. Got: ${n}`)}}function tP(e,t){return e.map(n=>typeof n=="function"?nW(n,t):Array.isArray(n)?n.map(r=>typeof r=="function"?nW(r,t):r):n)}function nP(e,t){let n=e[t];return e[t]=function(...r){return n.call(this,...tP(r,t))},e}function rP(e,t=[]){t.forEach(n=>nP(e,n))}function iP(e){let t="settings"in e;t&&e._router===void 0&&e.lazyrouter&&e.lazyrouter();let n=t?e._router:e;if(!n){eg.DEBUG_BUILD&&Zt.logger.debug("Cannot instrument router for URL Parameterization (did not find a valid router)."),eg.DEBUG_BUILD&&Zt.logger.debug("Routing instrumentation is currently only supported in Express 4.");return}let r=Object.getPrototypeOf(n),i=r.process_params;r.process_params=function(s,a,c,l,u){c._reconstructedRoute||(c._reconstructedRoute="");let{layerRoutePath:d,isRegex:g,isArray:m,numExtraSegments:h}=oP(s);(d||g||m)&&(c._hasParameters=!0);let b;d?b=d:b=iW(c.originalUrl,c._reconstructedRoute,s.path)||"";let y=b.split("/").filter(F=>F.length>0&&(g||m||!F.includes("*"))).join("/");y&&y.length>0&&(c._reconstructedRoute+=`/${y}${g?"/":""}`);let v=Zt.getNumberOfUrlSegments(Zt.stripUrlQueryAndFragment(c.originalUrl||""))+h,H=Zt.getNumberOfUrlSegments(c._reconstructedRoute);if(v===H){c._hasParameters||c._reconstructedRoute!==c.originalUrl&&(c._reconstructedRoute=c.originalUrl?Zt.stripUrlQueryAndFragment(c.originalUrl):c.originalUrl);let F=l.__sentry_transaction,Q=F&&eh.spanToJSON(F).data||{};if(F&&Q[eh.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]!=="custom"){let te=c._reconstructedRoute||"/",[V,x]=Zt.extractPathForTransaction(c,{path:!0,method:!0,customRoute:te});F.updateName(V),F.setAttribute(eh.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,x)}}return i.call(this,s,a,c,l,u)}}var rW=(e,t,n)=>{if(!e||!t||!n||Object.keys(n).length===0||!Yn([n,"access",l=>l[0],"optionalAccess",l=>l.offset]))return;let r=n.sort((l,u)=>l.offset-u.offset),o=new RegExp(t,`${t.flags}d`).exec(e);if(!o||!o.indices)return;let[,...s]=o.indices;if(s.length!==r.length)return;let a=e,c=0;return s.forEach((l,u)=>{if(l){let[d,g]=l,m=a.substring(0,d-c),h=`:${r[u].name}`,b=a.substring(g-c);a=m+h+b,c=c+(g-d-h.length)}}),a};function oP(e){let t=Yn([e,"access",s=>s.route,"optionalAccess",s=>s.path]),n=Zt.isRegExp(t),r=Array.isArray(t);if(!t){let[s]=Zt.GLOBAL_OBJ.process.versions.node.split(".").map(Number);s>=16&&(t=rW(e.path,e.regexp,e.keys))}if(!t)return{isRegex:n,isArray:r,numExtraSegments:0};let i=r?Math.max(sP(t)-Zt.getNumberOfUrlSegments(e.path||""),0):0;return{layerRoutePath:aP(r,t),isRegex:n,isArray:r,numExtraSegments:i}}function sP(e){return e.reduce((t,n)=>t+Zt.getNumberOfUrlSegments(n.toString()),0)}function aP(e,t){return e?t.map(n=>n.toString()).join(","):t&&t.toString()}function iW(e,t,n){let r=Zt.stripUrlQueryAndFragment(e||""),i=Yn([r,"optionalAccess",c=>c.split,"call",c=>c("/"),"access",c=>c.filter,"call",c=>c(l=>!!l)]),o=0,s=Yn([t,"optionalAccess",c=>c.split,"call",c=>c("/"),"access",c=>c.filter,"call",c=>c(l=>!!l),"access",c=>c.length])||0;return Yn([n,"optionalAccess",c=>c.split,"call",c=>c("/"),"access",c=>c.filter,"call",c=>c(l=>Yn([i,"optionalAccess",u=>u[s+o]])===l?(o+=1,!0):!1),"access",c=>c.join,"call",c=>c("/")])}_a.Express=tg;_a.extractOriginalRoute=rW;_a.preventDuplicateSegments=iW});var sW=I(nh=>{"use strict";var{_optionalChain:Do}=R();Object.defineProperty(nh,"__esModule",{value:!0});var qo=R(),th=At(),cP=_r(),ng=class e{static __initStatic(){this.id="Postgres"}constructor(t={}){this.name=e.id,this._usePgNative=!!t.usePgNative,this._module=t.module}loadDependency(){return this._module=this._module||qo.loadModule("pg")}setupOnce(t,n){if(cP.shouldDisableAutoInstrumentation(n)){th.DEBUG_BUILD&&qo.logger.log("Postgres Integration is skipped because of instrumenter configuration.");return}let r=this.loadDependency();if(!r){th.DEBUG_BUILD&&qo.logger.error("Postgres Integration was unable to require `pg` package.");return}let i=this._usePgNative?Do([r,"access",o=>o.native,"optionalAccess",o=>o.Client]):r.Client;if(!i){th.DEBUG_BUILD&&qo.logger.error("Postgres Integration was unable to access 'pg-native' bindings.");return}qo.fill(i.prototype,"query",function(o){return function(s,a,c){let u=n().getScope().getSpan(),d={"db.system":"postgresql"};try{this.database&&(d["db.name"]=this.database),this.host&&(d["server.address"]=this.host),this.port&&(d["server.port"]=this.port),this.user&&(d["db.user"]=this.user)}catch{}let g=Do([u,"optionalAccess",h=>h.startChild,"call",h=>h({description:typeof s=="string"?s:s.text,op:"db",origin:"auto.db.postgres",data:d})]);if(typeof c=="function")return o.call(this,s,a,function(h,b){Do([g,"optionalAccess",y=>y.end,"call",y=>y()]),c(h,b)});if(typeof a=="function")return o.call(this,s,function(h,b){Do([g,"optionalAccess",y=>y.end,"call",y=>y()]),a(h,b)});let m=typeof a<"u"?o.call(this,s,a):o.call(this,s);return qo.isThenable(m)?m.then(h=>(Do([g,"optionalAccess",b=>b.end,"call",b=>b()]),h)):(Do([g,"optionalAccess",h=>h.end,"call",h=>h()]),m)}})}};ng.__initStatic();nh.Postgres=ng});var aW=I(ih=>{"use strict";var{_optionalChain:uP}=R();Object.defineProperty(ih,"__esModule",{value:!0});var Fa=R(),rh=At(),lP=_r(),rg=class e{static __initStatic(){this.id="Mysql"}constructor(){this.name=e.id}loadDependency(){return this._module=this._module||Fa.loadModule("mysql/lib/Connection.js")}setupOnce(t,n){if(lP.shouldDisableAutoInstrumentation(n)){rh.DEBUG_BUILD&&Fa.logger.log("Mysql Integration is skipped because of instrumenter configuration.");return}let r=this.loadDependency();if(!r){rh.DEBUG_BUILD&&Fa.logger.error("Mysql Integration was unable to require `mysql` package.");return}let i;try{r.prototype.connect=new Proxy(r.prototype.connect,{apply(a,c,l){return i||(i=c.config),a.apply(c,l)}})}catch{rh.DEBUG_BUILD&&Fa.logger.error("Mysql Integration was unable to instrument `mysql` config.")}function o(){return i?{"server.address":i.host,"server.port":i.port,"db.user":i.user}:{}}function s(a){if(!a)return;let c=o();Object.keys(c).forEach(l=>{a.setAttribute(l,c[l])}),a.end()}Fa.fill(r,"createQuery",function(a){return function(c,l,u){let g=n().getScope().getSpan(),m=uP([g,"optionalAccess",b=>b.startChild,"call",b=>b({description:typeof c=="string"?c:c.sql,op:"db",origin:"auto.db.mysql",data:{"db.system":"mysql"}})]);if(typeof u=="function")return a.call(this,c,l,function(b,y,v){s(m),u(b,y,v)});if(typeof l=="function")return a.call(this,c,function(b,y,v){s(m),l(b,y,v)});let h=a.call(this,c,l);return h.on("end",()=>{s(m)}),h}})}};rg.__initStatic();ih.Mysql=rg});var uW=I(oh=>{"use strict";var{_optionalChain:Fr}=R();Object.defineProperty(oh,"__esModule",{value:!0});var Ta=R(),cW=At(),gP=_r(),dP=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],IP={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]};function mP(e){return e&&typeof e=="object"&&e.once&&typeof e.once=="function"}var ig=class e{static __initStatic(){this.id="Mongo"}constructor(t={}){this.name=e.id,this._operations=Array.isArray(t.operations)?t.operations:dP,this._describeOperations="describeOperations"in t?t.describeOperations:!0,this._useMongoose=!!t.useMongoose}loadDependency(){let t=this._useMongoose?"mongoose":"mongodb";return this._module=this._module||Ta.loadModule(t)}setupOnce(t,n){if(gP.shouldDisableAutoInstrumentation(n)){cW.DEBUG_BUILD&&Ta.logger.log("Mongo Integration is skipped because of instrumenter configuration.");return}let r=this.loadDependency();if(!r){let i=this._useMongoose?"mongoose":"mongodb";cW.DEBUG_BUILD&&Ta.logger.error(`Mongo Integration was unable to require \`${i}\` package.`);return}this._instrumentOperations(r.Collection,this._operations,n)}_instrumentOperations(t,n,r){n.forEach(i=>this._patchOperation(t,i,r))}_patchOperation(t,n,r){if(!(n in t.prototype))return;let i=this._getSpanContextFromOperationArguments.bind(this);Ta.fill(t.prototype,n,function(o){return function(...s){let a=s[s.length-1],c=r(),l=c.getScope(),u=c.getClient(),d=l.getSpan(),g=Fr([u,"optionalAccess",h=>h.getOptions,"call",h=>h(),"access",h=>h.sendDefaultPii]);if(typeof a!="function"||n==="mapReduce"&&s.length===2){let h=Fr([d,"optionalAccess",y=>y.startChild,"call",y=>y(i(this,n,s,g))]),b=o.call(this,...s);if(Ta.isThenable(b))return b.then(y=>(Fr([h,"optionalAccess",v=>v.end,"call",v=>v()]),y));if(mP(b)){let y=b;try{y.once("close",()=>{Fr([h,"optionalAccess",v=>v.end,"call",v=>v()])})}catch{Fr([h,"optionalAccess",H=>H.end,"call",H=>H()])}return y}else return Fr([h,"optionalAccess",y=>y.end,"call",y=>y()]),b}let m=Fr([d,"optionalAccess",h=>h.startChild,"call",h=>h(i(this,n,s.slice(0,-1)))]);return o.call(this,...s.slice(0,-1),function(h,b){Fr([m,"optionalAccess",y=>y.end,"call",y=>y()]),a(h,b)})}})}_getSpanContextFromOperationArguments(t,n,r,i=!1){let o={"db.system":"mongodb","db.name":t.dbName,"db.operation":n,"db.mongodb.collection":t.collectionName},s={op:"db",origin:"auto.db.mongo",description:n,data:o},a=IP[n],c=Array.isArray(this._describeOperations)?this._describeOperations.includes(n):this._describeOperations;if(!a||!c||!i)return s;try{if(n==="mapReduce"){let[l,u]=r;o[a[0]]=typeof l=="string"?l:l.name||"<anonymous>",o[a[1]]=typeof u=="string"?u:u.name||"<anonymous>"}else for(let l=0;l<a.length;l++)o[`db.mongodb.${a[l]}`]=JSON.stringify(r[l])}catch{}return s}};ig.__initStatic();oh.Mongo=ig});var gW=I(ah=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});var sh=j(),lW=R(),pP=At(),fP=_r();function hP(e){return!!e&&!!e.$use}var og=class e{static __initStatic(){this.id="Prisma"}constructor(t={}){if(this.name=e.id,hP(t.client)&&!t.client._sentryInstrumented){lW.addNonEnumerableProperty(t.client,"_sentryInstrumented",!0);let n={};try{let r=t.client._engineConfig;if(r){let{activeProvider:i,clientVersion:o}=r;i&&(n["db.system"]=i),o&&(n["db.prisma.version"]=o)}}catch{}t.client.$use((r,i)=>{if(fP.shouldDisableAutoInstrumentation(sh.getCurrentHub))return i(r);let o=r.action,s=r.model;return sh.startSpan({name:s?`${s} ${o}`:o,onlyIfParent:!0,op:"db.prisma",attributes:{[sh.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.db.prisma"},data:{...n,"db.operation":o}},()=>i(r))})}else pP.DEBUG_BUILD&&lW.logger.warn("Unsupported Prisma client provided to PrismaIntegration. Provided client:",t.client)}setupOnce(){}};og.__initStatic();ah.Prisma=og});var IW=I(ch=>{"use strict";var{_optionalChain:Mo}=R();Object.defineProperty(ch,"__esModule",{value:!0});var ka=R(),dW=At(),CP=_r(),sg=class e{static __initStatic(){this.id="GraphQL"}constructor(){this.name=e.id}loadDependency(){return this._module=this._module||ka.loadModule("graphql/execution/execute.js")}setupOnce(t,n){if(CP.shouldDisableAutoInstrumentation(n)){dW.DEBUG_BUILD&&ka.logger.log("GraphQL Integration is skipped because of instrumenter configuration.");return}let r=this.loadDependency();if(!r){dW.DEBUG_BUILD&&ka.logger.error("GraphQL Integration was unable to require graphql/execution package.");return}ka.fill(r,"execute",function(i){return function(...o){let s=n().getScope(),a=s.getSpan(),c=Mo([a,"optionalAccess",u=>u.startChild,"call",u=>u({description:"execute",op:"graphql.execute",origin:"auto.graphql.graphql"})]);Mo([s,"optionalAccess",u=>u.setSpan,"call",u=>u(c)]);let l=i.call(this,...o);return ka.isThenable(l)?l.then(u=>(Mo([c,"optionalAccess",d=>d.end,"call",d=>d()]),Mo([s,"optionalAccess",d=>d.setSpan,"call",d=>d(a)]),u)):(Mo([c,"optionalAccess",u=>u.end,"call",u=>u()]),Mo([s,"optionalAccess",u=>u.setSpan,"call",u=>u(a)]),l)}})}};sg.__initStatic();ch.GraphQL=sg});var pW=I(lh=>{"use strict";var{_optionalChain:uh}=R();Object.defineProperty(lh,"__esModule",{value:!0});var et=R(),ag=At(),bP=_r(),cg=class e{static __initStatic(){this.id="Apollo"}constructor(t={useNestjs:!1}){this.name=e.id,this._useNest=!!t.useNestjs}loadDependency(){return this._useNest?this._module=this._module||et.loadModule("@nestjs/graphql"):this._module=this._module||et.loadModule("apollo-server-core"),this._module}setupOnce(t,n){if(bP.shouldDisableAutoInstrumentation(n)){ag.DEBUG_BUILD&&et.logger.log("Apollo Integration is skipped because of instrumenter configuration.");return}if(this._useNest){let r=this.loadDependency();if(!r){ag.DEBUG_BUILD&&et.logger.error("Apollo-NestJS Integration was unable to require @nestjs/graphql package.");return}et.fill(r.GraphQLFactory.prototype,"mergeWithSchema",function(i){return function(...o){return et.fill(this.resolversExplorerService,"explore",function(s){return function(){let a=et.arrayify(s.call(this));return mW(a,n)}}),i.call(this,...o)}})}else{let r=this.loadDependency();if(!r){ag.DEBUG_BUILD&&et.logger.error("Apollo Integration was unable to require apollo-server-core package.");return}et.fill(r.ApolloServerBase.prototype,"constructSchema",function(i){return function(){if(!this.config.resolvers)return ag.DEBUG_BUILD&&(this.config.schema?(et.logger.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `schema` property.If you are using NestJS with Apollo, please use `Sentry.Integrations.Apollo({ useNestjs: true })` instead."),et.logger.warn()):this.config.modules&&et.logger.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `modules` property."),et.logger.error("Skipping tracing as no resolvers found on the `ApolloServer` instance.")),i.call(this);let o=et.arrayify(this.config.resolvers);return this.config.resolvers=mW(o,n),i.call(this)}})}}};cg.__initStatic();function mW(e,t){return e.map(n=>(Object.keys(n).forEach(r=>{Object.keys(n[r]).forEach(i=>{typeof n[r][i]=="function"&&yP(n,r,i,t)})}),n))}function yP(e,t,n,r){et.fill(e[t],n,function(i){return function(...o){let a=r().getScope().getSpan(),c=uh([a,"optionalAccess",u=>u.startChild,"call",u=>u({description:`${t}.${n}`,op:"graphql.resolve",origin:"auto.graphql.apollo"})]),l=i.call(this,...o);return et.isThenable(l)?l.then(u=>(uh([c,"optionalAccess",d=>d.end,"call",d=>d()]),u)):(uh([c,"optionalAccess",u=>u.end,"call",u=>u()]),l)}})}lh.Apollo=cg});var fW=I((gh,Tr)=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});var Hi=R(),GP=[()=>{let e=Hi.dynamicRequire(Tr,"./apollo");return new e.Apollo},()=>{let e=Hi.dynamicRequire(Tr,"./apollo");return new e.Apollo({useNestjs:!0})},()=>{let e=Hi.dynamicRequire(Tr,"./graphql");return new e.GraphQL},()=>{let e=Hi.dynamicRequire(Tr,"./mongo");return new e.Mongo},()=>{let e=Hi.dynamicRequire(Tr,"./mongo");return new e.Mongo({mongoose:!0})},()=>{let e=Hi.dynamicRequire(Tr,"./mysql");return new e.Mysql},()=>{let e=Hi.dynamicRequire(Tr,"./postgres");return new e.Postgres}];gh.lazyLoadedNodePerformanceMonitoringIntegrations=GP});var Ft=I(dh=>{"use strict";Object.defineProperty(dh,"__esModule",{value:!0});var BP=R(),AP=BP.GLOBAL_OBJ;dh.WINDOW=AP});var ph=I(mh=>{"use strict";Object.defineProperty(mh,"__esModule",{value:!0});var hW=j(),CW=R(),bW=At(),Ih=Ft();function ZP(){Ih.WINDOW.document?Ih.WINDOW.document.addEventListener("visibilitychange",()=>{let e=hW.getActiveTransaction();if(Ih.WINDOW.document.hidden&&e){let t="cancelled",{op:n,status:r}=hW.spanToJSON(e);bW.DEBUG_BUILD&&CW.logger.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${n}`),r||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.end()}}):bW.DEBUG_BUILD&&CW.logger.warn("[Tracing] Could not set up background tab detection due to lack of global document")}mh.registerBackgroundTabDetection=ZP});var jo=I(fh=>{"use strict";Object.defineProperty(fh,"__esModule",{value:!0});var vP=(e,t,n)=>{let r,i;return o=>{t.value>=0&&(o||n)&&(i=t.value-(r||0),(i||r===void 0)&&(r=t.value,t.delta=i,e(t)))}};fh.bindReporter=vP});var yW=I(hh=>{"use strict";Object.defineProperty(hh,"__esModule",{value:!0});var SP=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`;hh.generateUniqueID=SP});var Ua=I(Ch=>{"use strict";Object.defineProperty(Ch,"__esModule",{value:!0});var Ka=Ft(),WP=()=>{let e=Ka.WINDOW.performance.timing,t=Ka.WINDOW.performance.navigation.type,n={entryType:"navigation",startTime:0,type:t==2?"back_forward":t===1?"reload":"navigate"};for(let r in e)r!=="navigationStart"&&r!=="toJSON"&&(n[r]=Math.max(e[r]-e.navigationStart,0));return n},RP=()=>Ka.WINDOW.__WEB_VITALS_POLYFILL__?Ka.WINDOW.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||WP()):Ka.WINDOW.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];Ch.getNavigationEntry=RP});var ug=I(bh=>{"use strict";Object.defineProperty(bh,"__esModule",{value:!0});var VP=Ua(),NP=()=>{let e=VP.getNavigationEntry();return e&&e.activationStart||0};bh.getActivationStart=NP});var Po=I(yh=>{"use strict";Object.defineProperty(yh,"__esModule",{value:!0});var GW=Ft(),wP=yW(),EP=ug(),HP=Ua(),YP=(e,t)=>{let n=HP.getNavigationEntry(),r="navigate";return n&&(GW.WINDOW.document&&GW.WINDOW.document.prerendering||EP.getActivationStart()>0?r="prerender":r=n.type.replace(/_/g,"-")),{name:e,value:typeof t>"u"?-1:t,rating:"good",delta:0,entries:[],id:wP.generateUniqueID(),navigationType:r}};yh.initMetric=YP});var Yi=I(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});var XP=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){let r=new PerformanceObserver(i=>{t(i.getEntries())});return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch{}};Gh.observe=XP});var Qo=I(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});var BW=Ft(),_P=(e,t)=>{let n=r=>{(r.type==="pagehide"||BW.WINDOW.document.visibilityState==="hidden")&&(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};BW.WINDOW.document&&(addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0))};Bh.onHidden=_P});var AW=I(Ah=>{"use strict";Object.defineProperty(Ah,"__esModule",{value:!0});var FP=jo(),TP=Po(),kP=Yi(),KP=Qo(),UP=(e,t={})=>{let n=TP.initMetric("CLS",0),r,i=0,o=[],s=c=>{c.forEach(l=>{if(!l.hadRecentInput){let u=o[0],d=o[o.length-1];i&&o.length!==0&&l.startTime-d.startTime<1e3&&l.startTime-u.startTime<5e3?(i+=l.value,o.push(l)):(i=l.value,o=[l]),i>n.value&&(n.value=i,n.entries=o,r&&r())}})},a=kP.observe("layout-shift",s);if(a){r=FP.bindReporter(e,n,t.reportAllChanges);let c=()=>{s(a.takeRecords()),r(!0)};return KP.onHidden(c),c}};Ah.onCLS=UP});var dg=I(Zh=>{"use strict";Object.defineProperty(Zh,"__esModule",{value:!0});var lg=Ft(),xP=Qo(),gg=-1,LP=()=>{lg.WINDOW.document&&lg.WINDOW.document.visibilityState&&(gg=lg.WINDOW.document.visibilityState==="hidden"&&!lg.WINDOW.document.prerendering?0:1/0)},JP=()=>{xP.onHidden(({timeStamp:e})=>{gg=e},!0)},zP=()=>(gg<0&&(LP(),JP()),{get firstHiddenTime(){return gg}});Zh.getVisibilityWatcher=zP});var ZW=I(vh=>{"use strict";Object.defineProperty(vh,"__esModule",{value:!0});var OP=jo(),DP=dg(),qP=Po(),MP=Yi(),jP=Qo(),PP=e=>{let t=DP.getVisibilityWatcher(),n=qP.initMetric("FID"),r,i=a=>{a.startTime<t.firstHiddenTime&&(n.value=a.processingStart-a.startTime,n.entries.push(a),r(!0))},o=a=>{a.forEach(i)},s=MP.observe("first-input",o);r=OP.bindReporter(e,n),s&&jP.onHidden(()=>{o(s.takeRecords()),s.disconnect()},!0)};vh.onFID=PP});var SW=I(mg=>{"use strict";Object.defineProperty(mg,"__esModule",{value:!0});var QP=Yi(),vW=0,Sh=1/0,Ig=0,$P=e=>{e.forEach(t=>{t.interactionId&&(Sh=Math.min(Sh,t.interactionId),Ig=Math.max(Ig,t.interactionId),vW=Ig?(Ig-Sh)/7+1:0)})},Wh,eQ=()=>Wh?vW:performance.interactionCount||0,tQ=()=>{"interactionCount"in performance||Wh||(Wh=QP.observe("event",$P,{type:"event",buffered:!0,durationThreshold:0}))};mg.getInteractionCount=eQ;mg.initInteractionCountPolyfill=tQ});var wW=I(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});var nQ=jo(),rQ=Po(),iQ=Yi(),oQ=Qo(),VW=SW(),NW=()=>VW.getInteractionCount(),WW=10,cr=[],Rh={},RW=e=>{let t=cr[cr.length-1],n=Rh[e.interactionId];if(n||cr.length<WW||e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{let r={id:e.interactionId,latency:e.duration,entries:[e]};Rh[r.id]=r,cr.push(r)}cr.sort((r,i)=>i.latency-r.latency),cr.splice(WW).forEach(r=>{delete Rh[r.id]})}},sQ=()=>{let e=Math.min(cr.length-1,Math.floor(NW()/50));return cr[e]},aQ=(e,t)=>{t=t||{},VW.initInteractionCountPolyfill();let n=rQ.initMetric("INP"),r,i=s=>{s.forEach(c=>{c.interactionId&&RW(c),c.entryType==="first-input"&&!cr.some(u=>u.entries.some(d=>c.duration===d.duration&&c.startTime===d.startTime))&&RW(c)});let a=sQ();a&&a.latency!==n.value&&(n.value=a.latency,n.entries=a.entries,r())},o=iQ.observe("event",i,{durationThreshold:t.durationThreshold||40});r=nQ.bindReporter(e,n,t.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),oQ.onHidden(()=>{i(o.takeRecords()),n.value<0&&NW()>0&&(n.value=0,n.entries=[]),r(!0)}))};Vh.onINP=aQ});var HW=I(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});var cQ=Ft(),uQ=jo(),lQ=ug(),gQ=dg(),dQ=Po(),IQ=Yi(),mQ=Qo(),EW={},pQ=e=>{let t=gQ.getVisibilityWatcher(),n=dQ.initMetric("LCP"),r,i=s=>{let a=s[s.length-1];if(a){let c=Math.max(a.startTime-lQ.getActivationStart(),0);c<t.firstHiddenTime&&(n.value=c,n.entries=[a],r())}},o=IQ.observe("largest-contentful-paint",i);if(o){r=uQ.bindReporter(e,n);let s=()=>{EW[n.id]||(i(o.takeRecords()),o.disconnect(),EW[n.id]=!0,r(!0))};return["keydown","click"].forEach(a=>{cQ.WINDOW.document&&addEventListener(a,s,{once:!0,capture:!0})}),mQ.onHidden(s,!0),s}};Nh.onLCP=pQ});var YW=I(Hh=>{"use strict";Object.defineProperty(Hh,"__esModule",{value:!0});var wh=Ft(),fQ=jo(),hQ=ug(),CQ=Ua(),bQ=Po(),Eh=e=>{wh.WINDOW.document&&(wh.WINDOW.document.prerendering?addEventListener("prerenderingchange",()=>Eh(e),!0):wh.WINDOW.document.readyState!=="complete"?addEventListener("load",()=>Eh(e),!0):setTimeout(e,0))},yQ=(e,t)=>{t=t||{};let n=bQ.initMetric("TTFB"),r=fQ.bindReporter(e,n,t.reportAllChanges);Eh(()=>{let i=CQ.getNavigationEntry();if(i){if(n.value=Math.max(i.responseStart-hQ.getActivationStart(),0),n.value<0||n.value>performance.now())return;n.entries=[i],r(!0)}})};Hh.onTTFB=yQ});var es=I(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});var XW=R(),GQ=At(),BQ=AW(),AQ=ZW(),ZQ=wW(),vQ=HW(),SQ=Yi(),WQ=YW(),xa={},pg={},_W,FW,TW,kW,KW;function RQ(e,t=!1){return La("cls",e,YQ,_W,t)}function VQ(e,t=!1){return La("lcp",e,_Q,TW,t)}function NQ(e){return La("ttfb",e,FQ,kW)}function wQ(e){return La("fid",e,XQ,FW)}function EQ(e){return La("inp",e,TQ,KW)}function HQ(e,t){return UW(e,t),pg[e]||(kQ(e),pg[e]=!0),xW(e,t)}function $o(e,t){let n=xa[e];if(!(!n||!n.length))for(let r of n)try{r(t)}catch(i){GQ.DEBUG_BUILD&&XW.logger.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${XW.getFunctionName(r)}
Error:`,i)}}function YQ(){return BQ.onCLS(e=>{$o("cls",{metric:e}),_W=e},{reportAllChanges:!0})}function XQ(){return AQ.onFID(e=>{$o("fid",{metric:e}),FW=e})}function _Q(){return vQ.onLCP(e=>{$o("lcp",{metric:e}),TW=e})}function FQ(){return WQ.onTTFB(e=>{$o("ttfb",{metric:e}),kW=e})}function TQ(){return ZQ.onINP(e=>{$o("inp",{metric:e}),KW=e})}function La(e,t,n,r,i=!1){UW(e,t);let o;return pg[e]||(o=n(),pg[e]=!0),r&&t({metric:r}),xW(e,t,i?o:void 0)}function kQ(e){let t={};e==="event"&&(t.durationThreshold=0),SQ.observe(e,n=>{$o(e,{entries:n})},t)}function UW(e,t){xa[e]=xa[e]||[],xa[e].push(t)}function xW(e,t,n){return()=>{n&&n();let r=xa[e];if(!r)return;let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}kr.addClsInstrumentationHandler=RQ;kr.addFidInstrumentationHandler=wQ;kr.addInpInstrumentationHandler=EQ;kr.addLcpInstrumentationHandler=VQ;kr.addPerformanceInstrumentationHandler=HQ;kr.addTtfbInstrumentationHandler=NQ});var LW=I(fg=>{"use strict";Object.defineProperty(fg,"__esModule",{value:!0});function KQ(e){return typeof e=="number"&&isFinite(e)}function UQ(e,{startTimestamp:t,...n}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...n})}fg._startChild=UQ;fg.isMeasurementValue=KQ});var _h=I(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});var ur=j(),pe=R(),Tt=At(),Xi=es(),lr=Ft(),xQ=dg(),gr=LW(),LQ=Ua(),JQ=2147483647;function Xe(e){return e/1e3}function Xh(){return lr.WINDOW&&lr.WINDOW.addEventListener&&lr.WINDOW.performance}var JW=0,Ge={},Xn,Ja;function zQ(){let e=Xh();if(e&&pe.browserPerformanceTimeOrigin){e.mark&&lr.WINDOW.performance.mark("sentry-tracing-init");let t=PQ(),n=MQ(),r=jQ(),i=QQ();return()=>{t(),n(),r(),i()}}return()=>{}}function OQ(){Xi.addPerformanceInstrumentationHandler("longtask",({entries:e})=>{for(let t of e){let n=ur.getActiveTransaction();if(!n)return;let r=Xe(pe.browserPerformanceTimeOrigin+t.startTime),i=Xe(t.duration);n.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i})}})}function DQ(){Xi.addPerformanceInstrumentationHandler("event",({entries:e})=>{for(let t of e){let n=ur.getActiveTransaction();if(!n)return;if(t.name==="click"){let r=Xe(pe.browserPerformanceTimeOrigin+t.startTime),i=Xe(t.duration),o={description:pe.htmlTreeAsString(t.target),op:`ui.interaction.${t.name}`,origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i},s=pe.getComponentName(t.target);s&&(o.attributes={"ui.component_name":s}),n.startChild(o)}}})}function qQ(e,t){if(Xh()&&pe.browserPerformanceTimeOrigin){let r=$Q(e,t);return()=>{r()}}return()=>{}}function MQ(){return Xi.addClsInstrumentationHandler(({metric:e})=>{let t=e.entries[e.entries.length-1];t&&(Tt.DEBUG_BUILD&&pe.logger.log("[Measurements] Adding CLS"),Ge.cls={value:e.value,unit:""},Ja=t)},!0)}function jQ(){return Xi.addLcpInstrumentationHandler(({metric:e})=>{let t=e.entries[e.entries.length-1];t&&(Tt.DEBUG_BUILD&&pe.logger.log("[Measurements] Adding LCP"),Ge.lcp={value:e.value,unit:"millisecond"},Xn=t)},!0)}function PQ(){return Xi.addFidInstrumentationHandler(({metric:e})=>{let t=e.entries[e.entries.length-1];if(!t)return;let n=Xe(pe.browserPerformanceTimeOrigin),r=Xe(t.startTime);Tt.DEBUG_BUILD&&pe.logger.log("[Measurements] Adding FID"),Ge.fid={value:e.value,unit:"millisecond"},Ge["mark.fid"]={value:n+r,unit:"second"}})}function QQ(){return Xi.addTtfbInstrumentationHandler(({metric:e})=>{e.entries[e.entries.length-1]&&(Tt.DEBUG_BUILD&&pe.logger.log("[Measurements] Adding TTFB"),Ge.ttfb={value:e.value,unit:"millisecond"})})}var zW={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function $Q(e,t){return Xi.addInpInstrumentationHandler(({metric:n})=>{if(n.value===void 0)return;let r=n.entries.find(F=>F.duration===n.value&&zW[F.name]!==void 0),i=ur.getClient();if(!r||!i)return;let o=zW[r.name],s=i.getOptions(),a=Xe(pe.browserPerformanceTimeOrigin+r.startTime),c=Xe(n.value),l=r.interactionId!==void 0?e[r.interactionId]:void 0;if(l===void 0)return;let{routeName:u,parentContext:d,activeTransaction:g,user:m,replayId:h}=l,b=m!==void 0?m.email||m.id||m.ip_address:void 0,y=g!==void 0?g.getProfileId():void 0,v=new ur.Span({startTimestamp:a,endTimestamp:a+c,op:`ui.interaction.${o}`,name:pe.htmlTreeAsString(r.target),attributes:{release:s.release,environment:s.environment,transaction:u,...b!==void 0&&b!==""?{user:b}:{},...y!==void 0?{profile_id:y}:{},...h!==void 0?{replay_id:h}:{}},exclusiveTime:n.value,measurements:{inp:{value:n.value,unit:"millisecond"}}}),H=s4(d,s,t);if(H&&Math.random()<H){let F=v?ur.createSpanEnvelope([v],i.getDsn()):void 0,Q=i&&i.getTransport();Q&&F&&Q.send(F).then(null,te=>{Tt.DEBUG_BUILD&&pe.logger.error("Error while sending interaction:",te)});return}})}function e4(e){let t=Xh();if(!t||!lr.WINDOW.performance.getEntries||!pe.browserPerformanceTimeOrigin)return;Tt.DEBUG_BUILD&&pe.logger.log("[Tracing] Adding & adjusting spans using Performance API");let n=Xe(pe.browserPerformanceTimeOrigin),r=t.getEntries(),{op:i,start_timestamp:o}=ur.spanToJSON(e);if(r.slice(JW).forEach(s=>{let a=Xe(s.startTime),c=Xe(s.duration);if(!(e.op==="navigation"&&o&&n+a<o))switch(s.entryType){case"navigation":{t4(e,s,n);break}case"mark":case"paint":case"measure":{OW(e,s,a,c,n);let l=xQ.getVisibilityWatcher(),u=s.startTime<l.firstHiddenTime;s.name==="first-paint"&&u&&(Tt.DEBUG_BUILD&&pe.logger.log("[Measurements] Adding FP"),Ge.fp={value:s.startTime,unit:"millisecond"}),s.name==="first-contentful-paint"&&u&&(Tt.DEBUG_BUILD&&pe.logger.log("[Measurements] Adding FCP"),Ge.fcp={value:s.startTime,unit:"millisecond"});break}case"resource":{DW(e,s,s.name,a,c,n);break}}}),JW=Math.max(r.length-1,0),r4(e),i==="pageload"){o4(Ge),["fcp","fp","lcp"].forEach(a=>{if(!Ge[a]||!o||n>=o)return;let c=Ge[a].value,l=n+Xe(c),u=Math.abs((l-o)*1e3),d=u-c;Tt.DEBUG_BUILD&&pe.logger.log(`[Measurements] Normalized ${a} from ${c} to ${u} (${d})`),Ge[a].value=u});let s=Ge["mark.fid"];s&&Ge.fid&&(gr._startChild(e,{description:"first input delay",endTimestamp:s.value+Xe(Ge.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:s.value}),delete Ge["mark.fid"]),"fcp"in Ge||delete Ge.cls,Object.keys(Ge).forEach(a=>{ur.setMeasurement(a,Ge[a].value,Ge[a].unit)}),i4(e)}Xn=void 0,Ja=void 0,Ge={}}function OW(e,t,n,r,i){let o=i+n,s=o+r;return gr._startChild(e,{description:t.name,endTimestamp:s,op:t.entryType,origin:"auto.resource.browser.metrics",startTimestamp:o}),o}function t4(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{hg(e,t,r,n)}),hg(e,t,"secureConnection",n,"TLS/SSL","connectEnd"),hg(e,t,"fetch",n,"cache","domainLookupStart"),hg(e,t,"domainLookup",n,"DNS"),n4(e,t,n)}function hg(e,t,n,r,i,o){let s=o?t[o]:t[`${n}End`],a=t[`${n}Start`];!a||!s||gr._startChild(e,{op:"browser",origin:"auto.browser.browser.metrics",description:i||n,startTimestamp:r+Xe(a),endTimestamp:r+Xe(s)})}function n4(e,t,n){t.responseEnd&&(gr._startChild(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:n+Xe(t.requestStart),endTimestamp:n+Xe(t.responseEnd)}),gr._startChild(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:n+Xe(t.responseStart),endTimestamp:n+Xe(t.responseEnd)}))}function DW(e,t,n,r,i,o){if(t.initiatorType==="xmlhttprequest"||t.initiatorType==="fetch")return;let s=pe.parseUrl(n),a={};Yh(a,t,"transferSize","http.response_transfer_size"),Yh(a,t,"encodedBodySize","http.response_content_length"),Yh(a,t,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in t&&(a["resource.render_blocking_status"]=t.renderBlockingStatus),s.protocol&&(a["url.scheme"]=s.protocol.split(":").pop()),s.host&&(a["server.address"]=s.host),a["url.same_origin"]=n.includes(lr.WINDOW.location.origin);let c=o+r,l=c+i;gr._startChild(e,{description:n.replace(lr.WINDOW.location.origin,""),endTimestamp:l,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:c,data:a})}function r4(e){let t=lr.WINDOW.navigator;if(!t)return;let n=t.connection;n&&(n.effectiveType&&e.setTag("effectiveConnectionType",n.effectiveType),n.type&&e.setTag("connectionType",n.type),gr.isMeasurementValue(n.rtt)&&(Ge["connection.rtt"]={value:n.rtt,unit:"millisecond"})),gr.isMeasurementValue(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`),gr.isMeasurementValue(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}function i4(e){Xn&&(Tt.DEBUG_BUILD&&pe.logger.log("[Measurements] Adding LCP Data"),Xn.element&&e.setTag("lcp.element",pe.htmlTreeAsString(Xn.element)),Xn.id&&e.setTag("lcp.id",Xn.id),Xn.url&&e.setTag("lcp.url",Xn.url.trim().slice(0,200)),e.setTag("lcp.size",Xn.size)),Ja&&Ja.sources&&(Tt.DEBUG_BUILD&&pe.logger.log("[Measurements] Adding CLS Data"),Ja.sources.forEach((t,n)=>e.setTag(`cls.source.${n+1}`,pe.htmlTreeAsString(t.node))))}function Yh(e,t,n,r){let i=t[n];i!=null&&i<JQ&&(e[r]=i)}function o4(e){let t=LQ.getNavigationEntry();if(!t)return;let{responseStart:n,requestStart:r}=t;r<=n&&(Tt.DEBUG_BUILD&&pe.logger.log("[Measurements] Adding TTFB Request Time"),e["ttfb.requestTime"]={value:n-r,unit:"millisecond"})}function s4(e,t,n){if(!ur.hasTracingEnabled(t))return!1;let r;return e!==void 0&&typeof t.tracesSampler=="function"?r=t.tracesSampler({transactionContext:e,name:e.name,parentSampled:e.parentSampled,attributes:{...e.data,...e.attributes},location:lr.WINDOW.location}):e!==void 0&&e.sampled!==void 0?r=e.sampled:typeof t.tracesSampleRate<"u"?r=t.tracesSampleRate:r=1,ur.isValidSampleRate(r)?r===!0?n:r===!1?0:r*n:(Tt.DEBUG_BUILD&&pe.logger.warn("[Tracing] Discarding interaction span because of invalid sample rate."),!1)}dr._addMeasureSpans=OW;dr._addResourceSpans=DW;dr.addPerformanceEntries=e4;dr.startTrackingINP=qQ;dr.startTrackingInteractions=DQ;dr.startTrackingLongTasks=OQ;dr.startTrackingWebVitals=zQ});var Fh=I(Cg=>{"use strict";Object.defineProperty(Cg,"__esModule",{value:!0});var _n=j(),_i=R();function a4(e,t,n,r,i="auto.http.browser"){if(!_n.hasTracingEnabled()||!e.fetchData)return;let o=t(e.fetchData.url);if(e.endTimestamp&&o){let m=e.fetchData.__span;if(!m)return;let h=r[m];h&&(u4(h,e),delete r[m]);return}let s=_n.getCurrentScope(),a=_n.getClient(),{method:c,url:l}=e.fetchData,u=c4(l),d=u?_i.parseUrl(u).host:void 0,g=o?_n.startInactiveSpan({name:`${c} ${l}`,onlyIfParent:!0,attributes:{url:l,type:"fetch","http.method":c,"http.url":u,"server.address":d,[_n.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:i},op:"http.client"}):void 0;if(g&&(e.fetchData.__span=g.spanContext().spanId,r[g.spanContext().spanId]=g),n(e.fetchData.url)&&a){let m=e.args[0];e.args[1]=e.args[1]||{};let h=e.args[1];h.headers=qW(m,a,s,h,g)}return g}function qW(e,t,n,r,i){let o=i||n.getSpan(),s=_n.getIsolationScope(),{traceId:a,spanId:c,sampled:l,dsc:u}={...s.getPropagationContext(),...n.getPropagationContext()},d=o?_n.spanToTraceHeader(o):_i.generateSentryTraceHeader(a,c,l),g=_i.dynamicSamplingContextToSentryBaggageHeader(u||(o?_n.getDynamicSamplingContextFromSpan(o):_n.getDynamicSamplingContextFromClient(a,t,n))),m=r.headers||(typeof Request<"u"&&_i.isInstanceOf(e,Request)?e.headers:void 0);if(m)if(typeof Headers<"u"&&_i.isInstanceOf(m,Headers)){let h=new Headers(m);return h.append("sentry-trace",d),g&&h.append(_i.BAGGAGE_HEADER_NAME,g),h}else if(Array.isArray(m)){let h=[...m,["sentry-trace",d]];return g&&h.push([_i.BAGGAGE_HEADER_NAME,g]),h}else{let h="baggage"in m?m.baggage:void 0,b=[];return Array.isArray(h)?b.push(...h):h&&b.push(h),g&&b.push(g),{...m,"sentry-trace":d,baggage:b.length>0?b.join(","):void 0}}else return{"sentry-trace":d,baggage:g}}function c4(e){try{return new URL(e).href}catch{return}}function u4(e,t){if(t.response){_n.setHttpStatus(e,t.response.status);let n=t.response&&t.response.headers&&t.response.headers.get("content-length");if(n){let r=parseInt(n);r>0&&e.setAttribute("http.response_content_length",r)}}else t.error&&e.setStatus("internal_error");e.end()}Cg.addTracingHeadersToFetchRequest=qW;Cg.instrumentFetchRequest=a4});var yg=I(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});var pn=j(),fn=R(),l4=Fh(),g4=es(),d4=Ft(),bg=["localhost",/^\/(?!\/)/],Th={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:bg,tracePropagationTargets:bg};function I4(e){let{traceFetch:t,traceXHR:n,tracePropagationTargets:r,tracingOrigins:i,shouldCreateSpanForRequest:o,enableHTTPTimings:s}={traceFetch:Th.traceFetch,traceXHR:Th.traceXHR,...e},a=typeof o=="function"?o:u=>!0,c=u=>PW(u,r||i),l={};t&&fn.addFetchInstrumentationHandler(u=>{let d=l4.instrumentFetchRequest(u,a,c,l);if(d){let g=$W(u.fetchData.url),m=g?fn.parseUrl(g).host:void 0;d.setAttributes({"http.url":g,"server.address":m})}s&&d&&MW(d)}),n&&fn.addXhrInstrumentationHandler(u=>{let d=QW(u,a,c,l);s&&d&&MW(d)})}function m4(e){return e.entryType==="resource"&&"initiatorType"in e&&typeof e.nextHopProtocol=="string"&&(e.initiatorType==="fetch"||e.initiatorType==="xmlhttprequest")}function MW(e){let{url:t}=pn.spanToJSON(e).data||{};if(!t||typeof t!="string")return;let n=g4.addPerformanceInstrumentationHandler("resource",({entries:r})=>{r.forEach(i=>{m4(i)&&i.name.endsWith(t)&&(p4(i).forEach(s=>e.setAttribute(...s)),setTimeout(n))})})}function jW(e){let t="unknown",n="unknown",r="";for(let i of e){if(i==="/"){[t,n]=e.split("/");break}if(!isNaN(Number(i))){t=r==="h"?"http":r,n=e.split(r)[1];break}r+=i}return r===e&&(t=r),{name:t,version:n}}function Fn(e=0){return((fn.browserPerformanceTimeOrigin||performance.timeOrigin)+e)/1e3}function p4(e){let{name:t,version:n}=jW(e.nextHopProtocol),r=[];return r.push(["network.protocol.version",n],["network.protocol.name",t]),fn.browserPerformanceTimeOrigin?[...r,["http.request.redirect_start",Fn(e.redirectStart)],["http.request.fetch_start",Fn(e.fetchStart)],["http.request.domain_lookup_start",Fn(e.domainLookupStart)],["http.request.domain_lookup_end",Fn(e.domainLookupEnd)],["http.request.connect_start",Fn(e.connectStart)],["http.request.secure_connection_start",Fn(e.secureConnectionStart)],["http.request.connection_end",Fn(e.connectEnd)],["http.request.request_start",Fn(e.requestStart)],["http.request.response_start",Fn(e.responseStart)],["http.request.response_end",Fn(e.responseEnd)]]:r}function PW(e,t){return fn.stringMatchesSomePattern(e,t||bg)}function QW(e,t,n,r){let i=e.xhr,o=i&&i[fn.SENTRY_XHR_DATA_KEY];if(!pn.hasTracingEnabled()||!i||i.__sentry_own_request__||!o)return;let s=t(o.url);if(e.endTimestamp&&s){let m=i.__sentry_xhr_span_id__;if(!m)return;let h=r[m];h&&o.status_code!==void 0&&(pn.setHttpStatus(h,o.status_code),h.end(),delete r[m]);return}let a=pn.getCurrentScope(),c=pn.getIsolationScope(),l=$W(o.url),u=l?fn.parseUrl(l).host:void 0,d=s?pn.startInactiveSpan({name:`${o.method} ${o.url}`,onlyIfParent:!0,attributes:{type:"xhr","http.method":o.method,"http.url":l,url:o.url,"server.address":u,[pn.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.http.browser"},op:"http.client"}):void 0;d&&(i.__sentry_xhr_span_id__=d.spanContext().spanId,r[i.__sentry_xhr_span_id__]=d);let g=pn.getClient();if(i.setRequestHeader&&n(o.url)&&g){let{traceId:m,spanId:h,sampled:b,dsc:y}={...c.getPropagationContext(),...a.getPropagationContext()},v=d?pn.spanToTraceHeader(d):fn.generateSentryTraceHeader(m,h,b),H=fn.dynamicSamplingContextToSentryBaggageHeader(y||(d?pn.getDynamicSamplingContextFromSpan(d):pn.getDynamicSamplingContextFromClient(m,g,a)));f4(i,v,H)}return d}function f4(e,t,n){try{e.setRequestHeader("sentry-trace",t),n&&e.setRequestHeader(fn.BAGGAGE_HEADER_NAME,n)}catch{}}function $W(e){try{return new URL(e,d4.WINDOW.location.origin).href}catch{return}}Kr.DEFAULT_TRACE_PROPAGATION_TARGETS=bg;Kr.defaultRequestInstrumentationOptions=Th;Kr.extractNetworkProtocol=jW;Kr.instrumentOutgoingRequests=I4;Kr.shouldAttachHeaders=PW;Kr.xhrCallback=QW});var tR=I(kh=>{"use strict";Object.defineProperty(kh,"__esModule",{value:!0});var za=R(),eR=At(),Oa=Ft();function h4(e,t=!0,n=!0){if(!Oa.WINDOW||!Oa.WINDOW.location){eR.DEBUG_BUILD&&za.logger.warn("Could not initialize routing instrumentation due to invalid location");return}let r=Oa.WINDOW.location.href,i;t&&(i=e({name:Oa.WINDOW.location.pathname,startTimestamp:za.browserPerformanceTimeOrigin?za.browserPerformanceTimeOrigin/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),n&&za.addHistoryInstrumentationHandler(({to:o,from:s})=>{if(s===void 0&&r&&r.indexOf(o)!==-1){r=void 0;return}s!==o&&(r=void 0,i&&(eR.DEBUG_BUILD&&za.logger.log(`[Tracing] Finishing current transaction with op: ${i.op}`),i.end()),i=e({name:Oa.WINDOW.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))})}kh.instrumentRoutingWithDefaults=h4});var sR=I(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});var hn=j(),Ir=R(),Ur=At(),C4=ph(),nR=es(),Da=_h(),iR=yg(),b4=tR(),Fi=Ft(),oR="BrowserTracing",y4={...hn.TRACING_DEFAULTS,markBackgroundTransactions:!0,routingInstrumentation:b4.instrumentRoutingWithDefaults,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,enableInp:!1,interactionsSampleRate:1,_experiments:{},...iR.defaultRequestInstrumentationOptions},rR=10,Kh=class{constructor(t){this.name=oR,this._hasSetTracePropagationTargets=!1,hn.addTracingExtensions(),Ur.DEBUG_BUILD&&(this._hasSetTracePropagationTargets=!!(t&&(t.tracePropagationTargets||t.tracingOrigins))),this.options={...y4,...t},this.options._experiments.enableLongTask!==void 0&&(this.options.enableLongTask=this.options._experiments.enableLongTask),t&&!t.tracePropagationTargets&&t.tracingOrigins&&(this.options.tracePropagationTargets=t.tracingOrigins),this._collectWebVitals=Da.startTrackingWebVitals(),this._interactionIdToRouteNameMapping={},this.options.enableInp&&Da.startTrackingINP(this._interactionIdToRouteNameMapping,this.options.interactionsSampleRate),this.options.enableLongTask&&Da.startTrackingLongTasks(),this.options._experiments.enableInteractions&&Da.startTrackingInteractions(),this._latestRoute={name:void 0,context:void 0}}setupOnce(t,n){this._getCurrentHub=n;let i=n().getClient(),o=i&&i.getOptions(),{routingInstrumentation:s,startTransactionOnLocationChange:a,startTransactionOnPageLoad:c,markBackgroundTransactions:l,traceFetch:u,traceXHR:d,shouldCreateSpanForRequest:g,enableHTTPTimings:m,_experiments:h}=this.options,b=o&&o.tracePropagationTargets,y=b||this.options.tracePropagationTargets;Ur.DEBUG_BUILD&&this._hasSetTracePropagationTargets&&b&&Ir.logger.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),s(v=>{let H=this._createRouteTransaction(v);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(H,v,n),H},c,a),l&&C4.registerBackgroundTabDetection(),h.enableInteractions&&this._registerInteractionListener(),this.options.enableInp&&this._registerInpInteractionListener(),iR.instrumentOutgoingRequests({traceFetch:u,traceXHR:d,tracePropagationTargets:y,shouldCreateSpanForRequest:g,enableHTTPTimings:m})}_createRouteTransaction(t){if(!this._getCurrentHub){Ur.DEBUG_BUILD&&Ir.logger.warn(`[Tracing] Did not create ${t.op} transaction because _getCurrentHub is invalid.`);return}let n=this._getCurrentHub(),{beforeNavigate:r,idleTimeout:i,finalTimeout:o,heartbeatInterval:s}=this.options,a=t.op==="pageload",c;if(a){let m=a?Uh("sentry-trace"):"",h=a?Uh("baggage"):void 0,{traceId:b,dsc:y,parentSpanId:v,sampled:H}=Ir.propagationContextFromHeaders(m,h);c={traceId:b,parentSpanId:v,parentSampled:H,...t,metadata:{...t.metadata,dynamicSamplingContext:y},trimEnd:!0}}else c={trimEnd:!0,...t};let l=typeof r=="function"?r(c):c,u=l===void 0?{...c,sampled:!1}:l;u.metadata=u.name!==c.name?{...u.metadata,source:"custom"}:u.metadata,this._latestRoute.name=u.name,this._latestRoute.context=u,u.sampled===!1&&Ur.DEBUG_BUILD&&Ir.logger.log(`[Tracing] Will not send ${u.op} transaction because of beforeNavigate.`),Ur.DEBUG_BUILD&&Ir.logger.log(`[Tracing] Starting ${u.op} transaction on scope`);let{location:d}=Fi.WINDOW,g=hn.startIdleTransaction(n,u,i,o,!0,{location:d},s,a);return a&&Fi.WINDOW.document&&(Fi.WINDOW.document.addEventListener("readystatechange",()=>{["interactive","complete"].includes(Fi.WINDOW.document.readyState)&&g.sendAutoFinishSignal()}),["interactive","complete"].includes(Fi.WINDOW.document.readyState)&&g.sendAutoFinishSignal()),g.registerBeforeFinishCallback(m=>{this._collectWebVitals(),Da.addPerformanceEntries(m)}),g}_registerInteractionListener(){let t,n=()=>{let{idleTimeout:r,finalTimeout:i,heartbeatInterval:o}=this.options,s="ui.action.click",a=hn.getActiveTransaction();if(a&&a.op&&["navigation","pageload"].includes(a.op)){Ur.DEBUG_BUILD&&Ir.logger.warn(`[Tracing] Did not create ${s} transaction because a pageload or navigation transaction is in progress.`);return}if(t&&(t.setFinishReason("interactionInterrupted"),t.end(),t=void 0),!this._getCurrentHub){Ur.DEBUG_BUILD&&Ir.logger.warn(`[Tracing] Did not create ${s} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRoute.name){Ur.DEBUG_BUILD&&Ir.logger.warn(`[Tracing] Did not create ${s} transaction because _latestRouteName is missing.`);return}let c=this._getCurrentHub(),{location:l}=Fi.WINDOW,u={name:this._latestRoute.name,op:s,trimEnd:!0,data:{[hn.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:this._latestRoute.context?G4(this._latestRoute.context):"url"}};t=hn.startIdleTransaction(c,u,r,i,!0,{location:l},o)};["click"].forEach(r=>{Fi.WINDOW.document&&addEventListener(r,n,{once:!1,capture:!0})})}_registerInpInteractionListener(){let t=({entries:n})=>{let r=hn.getClient(),i=r!==void 0&&r.getIntegrationByName!==void 0?r.getIntegrationByName("Replay"):void 0,o=i!==void 0?i.getReplayId():void 0,s=hn.getActiveTransaction(),a=hn.getCurrentScope(),c=a!==void 0?a.getUser():void 0;n.forEach(l=>{if(B4(l)){let u=l.interactionId;if(u===void 0)return;let d=this._interactionIdToRouteNameMapping[u],g=l.duration,m=l.startTime,h=Object.keys(this._interactionIdToRouteNameMapping),b=h.length>0?h.reduce((y,v)=>this._interactionIdToRouteNameMapping[y].duration<this._interactionIdToRouteNameMapping[v].duration?y:v):void 0;if(l.entryType==="first-input"&&h.map(v=>this._interactionIdToRouteNameMapping[v]).some(v=>v.duration===g&&v.startTime===m)||!u)return;if(d)d.duration=Math.max(d.duration,g);else if(h.length<rR||b===void 0||g>this._interactionIdToRouteNameMapping[b].duration){let y=this._latestRoute.name,v=this._latestRoute.context;y&&v&&(b&&Object.keys(this._interactionIdToRouteNameMapping).length>=rR&&delete this._interactionIdToRouteNameMapping[b],this._interactionIdToRouteNameMapping[u]={routeName:y,duration:g,parentContext:v,user:c,activeTransaction:s,replayId:o,startTime:m})}}})};nR.addPerformanceInstrumentationHandler("event",t),nR.addPerformanceInstrumentationHandler("first-input",t)}};function Uh(e){let t=Ir.getDomElement(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}function G4(e){let t=e.attributes&&e.attributes[hn.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE],n=e.data&&e.data[hn.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE],r=e.metadata&&e.metadata.source;return t||n||r}function B4(e){return"duration"in e}qa.BROWSER_TRACING_INTEGRATION_ID=oR;qa.BrowserTracing=Kh;qa.getMetaContent=Uh});var IR=I(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});var Ve=j(),$t=R(),xr=At(),A4=ph(),aR=es(),Ma=_h(),uR=yg(),kt=Ft(),lR="BrowserTracing",Z4={...Ve.TRACING_DEFAULTS,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableInp:!1,interactionsSampleRate:1,_experiments:{},...uR.defaultRequestInstrumentationOptions},v4=(e={})=>{let t=xr.DEBUG_BUILD?!!(e.tracePropagationTargets||e.tracingOrigins):!1;Ve.addTracingExtensions(),!e.tracePropagationTargets&&e.tracingOrigins&&(e.tracePropagationTargets=e.tracingOrigins);let n={...Z4,...e},r=Ma.startTrackingWebVitals(),i={};n.enableInp&&Ma.startTrackingINP(i,n.interactionsSampleRate),n.enableLongTask&&Ma.startTrackingLongTasks(),n._experiments.enableInteractions&&Ma.startTrackingInteractions();let o={name:void 0,context:void 0};function s(a){let c=Ve.getCurrentHub(),{beforeStartSpan:l,idleTimeout:u,finalTimeout:d,heartbeatInterval:g}=n,m=a.op==="pageload",h;if(m){let H=m?xh("sentry-trace"):"",F=m?xh("baggage"):void 0,{traceId:Q,dsc:te,parentSpanId:V,sampled:x}=$t.propagationContextFromHeaders(H,F);h={traceId:Q,parentSpanId:V,parentSampled:x,...a,metadata:{...a.metadata,dynamicSamplingContext:te},trimEnd:!0}}else h={trimEnd:!0,...a};let b=l?l(h):h;b.metadata=b.name!==h.name?{...b.metadata,source:"custom"}:b.metadata,o.name=b.name,o.context=b,b.sampled===!1&&xr.DEBUG_BUILD&&$t.logger.log(`[Tracing] Will not send ${b.op} transaction because of beforeNavigate.`),xr.DEBUG_BUILD&&$t.logger.log(`[Tracing] Starting ${b.op} transaction on scope`);let{location:y}=kt.WINDOW,v=Ve.startIdleTransaction(c,b,u,d,!0,{location:y},g,m);return m&&kt.WINDOW.document&&(kt.WINDOW.document.addEventListener("readystatechange",()=>{["interactive","complete"].includes(kt.WINDOW.document.readyState)&&v.sendAutoFinishSignal()}),["interactive","complete"].includes(kt.WINDOW.document.readyState)&&v.sendAutoFinishSignal()),v.registerBeforeFinishCallback(H=>{r(),Ma.addPerformanceEntries(H)}),v}return{name:lR,setupOnce:()=>{},afterAllSetup(a){let c=a.getOptions(),{markBackgroundSpan:l,traceFetch:u,traceXHR:d,shouldCreateSpanForRequest:g,enableHTTPTimings:m,_experiments:h}=n,b=c&&c.tracePropagationTargets,y=b||n.tracePropagationTargets;xr.DEBUG_BUILD&&t&&b&&$t.logger.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used.");let v,H=kt.WINDOW.location&&kt.WINDOW.location.href;if(a.on&&(a.on("startNavigationSpan",F=>{v&&(xr.DEBUG_BUILD&&$t.logger.log(`[Tracing] Finishing current transaction with op: ${Ve.spanToJSON(v).op}`),v.end()),v=s({op:"navigation",...F})}),a.on("startPageLoadSpan",F=>{v&&(xr.DEBUG_BUILD&&$t.logger.log(`[Tracing] Finishing current transaction with op: ${Ve.spanToJSON(v).op}`),v.end()),v=s({op:"pageload",...F})})),n.instrumentPageLoad&&a.emit&&kt.WINDOW.location){let F={name:kt.WINDOW.location.pathname,startTimestamp:$t.browserPerformanceTimeOrigin?$t.browserPerformanceTimeOrigin/1e3:void 0,origin:"auto.pageload.browser",attributes:{[Ve.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"url"}};gR(a,F)}n.instrumentNavigation&&a.emit&&kt.WINDOW.location&&$t.addHistoryInstrumentationHandler(({to:F,from:Q})=>{if(Q===void 0&&H&&H.indexOf(F)!==-1){H=void 0;return}if(Q!==F){H=void 0;let te={name:kt.WINDOW.location.pathname,origin:"auto.navigation.browser",attributes:{[Ve.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"url"}};dR(a,te)}}),l&&A4.registerBackgroundTabDetection(),h.enableInteractions&&S4(n,o),n.enableInp&&R4(i,o),uR.instrumentOutgoingRequests({traceFetch:u,traceXHR:d,tracePropagationTargets:y,shouldCreateSpanForRequest:g,enableHTTPTimings:m})},options:n}};function gR(e,t){if(!e.emit)return;e.emit("startPageLoadSpan",t);let n=Ve.getActiveSpan();return(n&&Ve.spanToJSON(n).op)==="pageload"?n:void 0}function dR(e,t){if(!e.emit)return;e.emit("startNavigationSpan",t);let n=Ve.getActiveSpan();return(n&&Ve.spanToJSON(n).op)==="navigation"?n:void 0}function xh(e){let t=$t.getDomElement(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}function S4(e,t){let n,r=()=>{let{idleTimeout:i,finalTimeout:o,heartbeatInterval:s}=e,a="ui.action.click",c=Ve.getActiveTransaction();if(c&&c.op&&["navigation","pageload"].includes(c.op)){xr.DEBUG_BUILD&&$t.logger.warn(`[Tracing] Did not create ${a} transaction because a pageload or navigation transaction is in progress.`);return}if(n&&(n.setFinishReason("interactionInterrupted"),n.end(),n=void 0),!t.name){xr.DEBUG_BUILD&&$t.logger.warn(`[Tracing] Did not create ${a} transaction because _latestRouteName is missing.`);return}let{location:l}=kt.WINDOW,u={name:t.name,op:a,trimEnd:!0,data:{[Ve.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:t.context?V4(t.context):"url"}};n=Ve.startIdleTransaction(Ve.getCurrentHub(),u,i,o,!0,{location:l},s)};["click"].forEach(i=>{kt.WINDOW.document&&addEventListener(i,r,{once:!1,capture:!0})})}function W4(e){return"duration"in e}var cR=10;function R4(e,t){let n=({entries:r})=>{let i=Ve.getClient(),o=i!==void 0&&i.getIntegrationByName!==void 0?i.getIntegrationByName("Replay"):void 0,s=o!==void 0?o.getReplayId():void 0,a=Ve.getActiveTransaction(),c=Ve.getCurrentScope(),l=c!==void 0?c.getUser():void 0;r.forEach(u=>{if(W4(u)){let d=u.interactionId;if(d===void 0)return;let g=e[d],m=u.duration,h=u.startTime,b=Object.keys(e),y=b.length>0?b.reduce((v,H)=>e[v].duration<e[H].duration?v:H):void 0;if(u.entryType==="first-input"&&b.map(H=>e[H]).some(H=>H.duration===m&&H.startTime===h)||!d)return;if(g)g.duration=Math.max(g.duration,m);else if(b.length<cR||y===void 0||m>e[y].duration){let v=t.name,H=t.context;v&&H&&(y&&Object.keys(e).length>=cR&&delete e[y],e[d]={routeName:v,duration:m,parentContext:H,user:l,activeTransaction:a,replayId:s,startTime:h})}}})};aR.addPerformanceInstrumentationHandler("event",n),aR.addPerformanceInstrumentationHandler("first-input",n)}function V4(e){let t=e.attributes&&e.attributes[Ve.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE],n=e.data&&e.data[Ve.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE],r=e.metadata&&e.metadata.source;return t||n||r}Ti.BROWSER_TRACING_INTEGRATION_ID=lR;Ti.browserTracingIntegration=v4;Ti.getMetaContent=xh;Ti.startBrowserTracingNavigationSpan=dR;Ti.startBrowserTracingPageLoadSpan=gR});var pR=I((Lh,ja)=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});var mR=j(),ts=R();function N4(){let e=mR.getMainCarrier();if(!e.__SENTRY__)return;let t={mongodb(){let r=ts.dynamicRequire(ja,"./node/integrations/mongo");return new r.Mongo},mongoose(){let r=ts.dynamicRequire(ja,"./node/integrations/mongo");return new r.Mongo},mysql(){let r=ts.dynamicRequire(ja,"./node/integrations/mysql");return new r.Mysql},pg(){let r=ts.dynamicRequire(ja,"./node/integrations/postgres");return new r.Postgres}},n=Object.keys(t).filter(r=>!!ts.loadModule(r)).map(r=>{try{return t[r]()}catch{return}}).filter(r=>r);n.length>0&&(e.__SENTRY__.integrations=[...e.__SENTRY__.integrations||[],...n])}function w4(){mR.addTracingExtensions(),ts.isNodeEnv()&&N4()}Lh.addExtensionMethods=w4});var zh=I(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});var mr=j(),fR=R(),E4=oW(),H4=sW(),Y4=aW(),X4=uW(),_4=gW(),F4=IW(),T4=pW(),k4=fW(),hR=sR(),Jh=IR(),CR=yg(),Gg=es(),bR=Fh(),K4=pR();ne.IdleTransaction=mr.IdleTransaction;ne.Span=mr.Span;ne.SpanStatus=mr.SpanStatus;ne.Transaction=mr.Transaction;ne.extractTraceparentData=mr.extractTraceparentData;ne.getActiveTransaction=mr.getActiveTransaction;ne.hasTracingEnabled=mr.hasTracingEnabled;ne.spanStatusfromHttpCode=mr.spanStatusfromHttpCode;ne.startIdleTransaction=mr.startIdleTransaction;ne.TRACEPARENT_REGEXP=fR.TRACEPARENT_REGEXP;ne.stripUrlQueryAndFragment=fR.stripUrlQueryAndFragment;ne.Express=E4.Express;ne.Postgres=H4.Postgres;ne.Mysql=Y4.Mysql;ne.Mongo=X4.Mongo;ne.Prisma=_4.Prisma;ne.GraphQL=F4.GraphQL;ne.Apollo=T4.Apollo;ne.lazyLoadedNodePerformanceMonitoringIntegrations=k4.lazyLoadedNodePerformanceMonitoringIntegrations;ne.BROWSER_TRACING_INTEGRATION_ID=hR.BROWSER_TRACING_INTEGRATION_ID;ne.BrowserTracing=hR.BrowserTracing;ne.browserTracingIntegration=Jh.browserTracingIntegration;ne.startBrowserTracingNavigationSpan=Jh.startBrowserTracingNavigationSpan;ne.startBrowserTracingPageLoadSpan=Jh.startBrowserTracingPageLoadSpan;ne.defaultRequestInstrumentationOptions=CR.defaultRequestInstrumentationOptions;ne.instrumentOutgoingRequests=CR.instrumentOutgoingRequests;ne.addClsInstrumentationHandler=Gg.addClsInstrumentationHandler;ne.addFidInstrumentationHandler=Gg.addFidInstrumentationHandler;ne.addLcpInstrumentationHandler=Gg.addLcpInstrumentationHandler;ne.addPerformanceInstrumentationHandler=Gg.addPerformanceInstrumentationHandler;ne.addTracingHeadersToFetchRequest=bR.addTracingHeadersToFetchRequest;ne.instrumentFetchRequest=bR.instrumentFetchRequest;ne.addExtensionMethods=K4.addExtensionMethods});var yR=I(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});var U4=zh(),x4=R();function L4(){let e=U4.lazyLoadedNodePerformanceMonitoringIntegrations.map(t=>{try{return t()}catch{return}}).filter(t=>!!t);return e.length===0&&x4.logger.warn("Performance monitoring integrations could not be automatically loaded."),e.filter(t=>!!t.loadDependency())}Oh.autoDiscoverNodePerformanceMonitoringIntegrations=L4});var Mh=I(qh=>{"use strict";Object.defineProperty(qh,"__esModule",{value:!0});var J4=require("os"),z4=require("util"),GR=j(),Dh=class extends GR.ServerRuntimeClient{constructor(t){GR.applySdkMetadata(t,"node"),t.transportOptions={textEncoder:new z4.TextEncoder,...t.transportOptions};let n={...t,platform:"node",runtime:{name:"node",version:global.process.version},serverName:t.serverName||global.process.env.SENTRY_NAME||J4.hostname()};super(n)}};qh.NodeClient=Dh});var ZR=I(Ph=>{"use strict";var{_nullishCoalesce:BR}=R();Object.defineProperty(Ph,"__esModule",{value:!0});var AR=require("http");require("https");var Tn=Symbol("AgentBaseInternalState"),jh=class extends AR.Agent{constructor(t){super(t),this[Tn]={}}isSecureEndpoint(t){if(t){if(typeof t.secureEndpoint=="boolean")return t.secureEndpoint;if(typeof t.protocol=="string")return t.protocol==="https:"}let{stack:n}=new Error;return typeof n!="string"?!1:n.split(`
`).some(r=>r.indexOf("(https.js:")!==-1||r.indexOf("node:https:")!==-1)}createSocket(t,n,r){let i={...n,secureEndpoint:this.isSecureEndpoint(n)};Promise.resolve().then(()=>this.connect(t,i)).then(o=>{if(o instanceof AR.Agent)return o.addRequest(t,i);this[Tn].currentSocket=o,super.createSocket(t,n,r)},r)}createConnection(){let t=this[Tn].currentSocket;if(this[Tn].currentSocket=void 0,!t)throw new Error("No socket was returned in the `connect()` function");return t}get defaultPort(){return BR(this[Tn].defaultPort,()=>this.protocol==="https:"?443:80)}set defaultPort(t){this[Tn]&&(this[Tn].defaultPort=t)}get protocol(){return BR(this[Tn].protocol,()=>this.isSecureEndpoint()?"https:":"http:")}set protocol(t){this[Tn]&&(this[Tn].protocol=t)}};Ph.Agent=jh});var vR=I(Qh=>{"use strict";Object.defineProperty(Qh,"__esModule",{value:!0});var O4=R();function Bg(...e){O4.logger.log("[https-proxy-agent:parse-proxy-response]",...e)}function D4(e){return new Promise((t,n)=>{let r=0,i=[];function o(){let u=e.read();u?l(u):e.once("readable",o)}function s(){e.removeListener("end",a),e.removeListener("error",c),e.removeListener("readable",o)}function a(){s(),Bg("onend"),n(new Error("Proxy connection ended before receiving CONNECT response"))}function c(u){s(),Bg("onerror %o",u),n(u)}function l(u){i.push(u),r+=u.length;let d=Buffer.concat(i,r),g=d.indexOf(`\r
\r
`);if(g===-1){Bg("have not received end of HTTP headers yet..."),o();return}let m=d.slice(0,g).toString("ascii").split(`\r
`),h=m.shift();if(!h)return e.destroy(),n(new Error("No header received from proxy CONNECT response"));let b=h.split(" "),y=+b[1],v=b.slice(2).join(" "),H={};for(let F of m){if(!F)continue;let Q=F.indexOf(":");if(Q===-1)return e.destroy(),n(new Error(`Invalid header from proxy CONNECT response: "${F}"`));let te=F.slice(0,Q).toLowerCase(),V=F.slice(Q+1).trimStart(),x=H[te];typeof x=="string"?H[te]=[x,V]:Array.isArray(x)?x.push(V):H[te]=V}Bg("got proxy server response: %o %o",h,H),s(),t({connect:{statusCode:y,statusText:v,headers:H},buffered:d})}e.on("error",c),e.on("end",a),o()})}Qh.parseProxyResponse=D4});var RR=I($h=>{"use strict";var{_nullishCoalesce:q4,_optionalChain:M4}=R();Object.defineProperty($h,"__esModule",{value:!0});var Pa=require("net"),SR=require("tls"),j4=require("url"),P4=R(),Q4=ZR(),$4=vR();function Qa(...e){P4.logger.log("[https-proxy-agent]",...e)}var Ag=class extends Q4.Agent{static __initStatic(){this.protocols=["http","https"]}constructor(t,n){super(n),this.options={},this.proxy=typeof t=="string"?new j4.URL(t):t,this.proxyHeaders=q4(M4([n,"optionalAccess",o=>o.headers]),()=>({})),Qa("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),i=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...n?WR(n,"headers"):null,host:r,port:i}}async connect(t,n){let{proxy:r}=this;if(!n.host)throw new TypeError('No "host" provided');let i;if(r.protocol==="https:"){Qa("Creating `tls.Socket`: %o",this.connectOpts);let g=this.connectOpts.servername||this.connectOpts.host;i=SR.connect({...this.connectOpts,servername:g&&Pa.isIP(g)?void 0:g})}else Qa("Creating `net.Socket`: %o",this.connectOpts),i=Pa.connect(this.connectOpts);let o=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders},s=Pa.isIPv6(n.host)?`[${n.host}]`:n.host,a=`CONNECT ${s}:${n.port} HTTP/1.1\r
`;if(r.username||r.password){let g=`${decodeURIComponent(r.username)}:${decodeURIComponent(r.password)}`;o["Proxy-Authorization"]=`Basic ${Buffer.from(g).toString("base64")}`}o.Host=`${s}:${n.port}`,o["Proxy-Connection"]||(o["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let g of Object.keys(o))a+=`${g}: ${o[g]}\r
`;let c=$4.parseProxyResponse(i);i.write(`${a}\r
`);let{connect:l,buffered:u}=await c;if(t.emit("proxyConnect",l),this.emit("proxyConnect",l,t),l.statusCode===200){if(t.once("socket",e8),n.secureEndpoint){Qa("Upgrading socket connection to TLS");let g=n.servername||n.host;return SR.connect({...WR(n,"host","path","port"),socket:i,servername:Pa.isIP(g)?void 0:g})}return i}i.destroy();let d=new Pa.Socket({writable:!1});return d.readable=!0,t.once("socket",g=>{Qa("Replaying proxy buffer for failed request"),g.push(u),g.push(null)}),d}};Ag.__initStatic();function e8(e){e.resume()}function WR(e,...t){let n={},r;for(r in e)t.includes(r)||(n[r]=e[r]);return n}$h.HttpsProxyAgent=Ag});var nC=I(tC=>{"use strict";var{_nullishCoalesce:eC}=R();Object.defineProperty(tC,"__esModule",{value:!0});var t8=require("http"),n8=require("https"),r8=require("stream"),NR=require("url"),i8=require("zlib"),VR=j(),o8=R(),s8=RR(),a8=1024*32;function c8(e){return new r8.Readable({read(){this.push(e),this.push(null)}})}function u8(e){let t;try{t=new NR.URL(e.url)}catch{return o8.consoleSandbox(()=>{console.warn("[@sentry/node]: Invalid dsn or tunnel option, will not send any events. The tunnel option must be a full URL when used.")}),VR.createTransport(e,()=>Promise.resolve({}))}let n=t.protocol==="https:",r=l8(t,e.proxy||(n?process.env.https_proxy:void 0)||process.env.http_proxy),i=n?n8:t8,o=e.keepAlive===void 0?!1:e.keepAlive,s=r?new s8.HttpsProxyAgent(r):new i.Agent({keepAlive:o,maxSockets:30,timeout:2e3}),a=g8(e,eC(e.httpModule,()=>i),s);return VR.createTransport(e,a)}function l8(e,t){let{no_proxy:n}=process.env;if(!(n&&n.split(",").some(i=>e.host.endsWith(i)||e.hostname.endsWith(i))))return t}function g8(e,t,n){let{hostname:r,pathname:i,port:o,protocol:s,search:a}=new NR.URL(e.url);return function(l){return new Promise((u,d)=>{let g=c8(l.body),m={...e.headers};l.body.length>a8&&(m["content-encoding"]="gzip",g=g.pipe(i8.createGzip()));let h=t.request({method:"POST",agent:n,headers:m,hostname:r,path:`${i}${a}`,port:o,protocol:s,ca:e.caCerts},b=>{b.on("data",()=>{}),b.on("end",()=>{}),b.setEncoding("utf8");let y=eC(b.headers["retry-after"],()=>null),v=eC(b.headers["x-sentry-rate-limits"],()=>null);u({statusCode:b.statusCode,headers:{"retry-after":y,"x-sentry-rate-limits":Array.isArray(v)?v[0]:v}})});h.on("error",d),g.pipe(h)})}}tC.makeNodeTransport=u8});var ki=I(rC=>{"use strict";Object.defineProperty(rC,"__esModule",{value:!0});var d8=R(),I8=d8.parseSemver(process.versions.node);rC.NODE_VERSION=I8});var HR=I(iC=>{"use strict";var{_optionalChain:m8}=R();Object.defineProperty(iC,"__esModule",{value:!0});var wR=require("domain"),Ki=j();function ER(){return wR.active}function p8(){let e=ER();if(e)return Ki.ensureHubOnCarrier(e),Ki.getHubFromCarrier(e)}function f8(e){let t={};return Ki.ensureHubOnCarrier(t,e),Ki.getHubFromCarrier(t)}function h8(e,t){let n=ER();if(n&&m8([t,"optionalAccess",s=>s.reuseExisting]))return e();let r=wR.create(),i=n?Ki.getHubFromCarrier(n):void 0,o=f8(i);return Ki.setHubOnCarrier(r,o),r.bind(()=>e())()}function C8(){Ki.setAsyncContextStrategy({getCurrentHub:p8,runWithAsyncContext:h8})}iC.setDomainAsyncContextStrategy=C8});var YR=I(sC=>{"use strict";var{_optionalChain:b8}=R();Object.defineProperty(sC,"__esModule",{value:!0});var oC=j(),y8=require("async_hooks"),Zg;function G8(){Zg||(Zg=new y8.AsyncLocalStorage);function e(){return Zg.getStore()}function t(r){let i={};return oC.ensureHubOnCarrier(i,r),oC.getHubFromCarrier(i)}function n(r,i){let o=e();if(o&&b8([i,"optionalAccess",a=>a.reuseExisting]))return r();let s=t(o);return Zg.run(s,()=>r())}oC.setAsyncContextStrategy({getCurrentHub:e,runWithAsyncContext:n})}sC.setHooksAsyncContextStrategy=G8});var XR=I(aC=>{"use strict";Object.defineProperty(aC,"__esModule",{value:!0});var B8=ki(),A8=HR(),Z8=YR();function v8(){B8.NODE_VERSION.major>=14?Z8.setHooksAsyncContextStrategy():A8.setDomainAsyncContextStrategy()}aC.setNodeAsyncContextStrategy=v8});var Wg=I(Sg=>{"use strict";Object.defineProperty(Sg,"__esModule",{value:!0});var S8=require("util"),vg=j(),_R=R(),FR="Console",W8=()=>({name:FR,setupOnce(){},setup(e){_R.addConsoleInstrumentationHandler(({args:t,level:n})=>{vg.getClient()===e&&vg.addBreadcrumb({category:"console",level:_R.severityLevelFromString(n),message:S8.format.apply(void 0,t)},{input:[...t],level:n})})}}),TR=vg.defineIntegration(W8),R8=vg.convertIntegrationFnToClass(FR,TR);Sg.Console=R8;Sg.consoleIntegration=TR});var Rg=I(xi=>{"use strict";var{_optionalChain:Ui}=R();Object.defineProperty(xi,"__esModule",{value:!0});var V8=require("child_process"),KR=require("fs"),en=require("os"),N8=require("path"),UR=require("util"),xR=j(),LR=UR.promisify(KR.readFile),JR=UR.promisify(KR.readdir),zR="Context",w8=(e={})=>{let t,n={app:!0,os:!0,device:!0,culture:!0,cloudResource:!0,...e};async function r(o){t===void 0&&(t=i());let s=H8(await t);return o.contexts={...o.contexts,app:{...s.app,...Ui([o,"access",a=>a.contexts,"optionalAccess",a=>a.app])},os:{...s.os,...Ui([o,"access",a=>a.contexts,"optionalAccess",a=>a.os])},device:{...s.device,...Ui([o,"access",a=>a.contexts,"optionalAccess",a=>a.device])},culture:{...s.culture,...Ui([o,"access",a=>a.contexts,"optionalAccess",a=>a.culture])},cloud_resource:{...s.cloud_resource,...Ui([o,"access",a=>a.contexts,"optionalAccess",a=>a.cloud_resource])}},o}async function i(){let o={};if(n.os&&(o.os=await Y8()),n.app&&(o.app=_8()),n.device&&(o.device=DR(n.device)),n.culture){let s=X8();s&&(o.culture=s)}return n.cloudResource&&(o.cloud_resource=x8()),o}return{name:zR,setupOnce(){},processEvent(o){return r(o)}}},OR=xR.defineIntegration(w8),E8=xR.convertIntegrationFnToClass(zR,OR);function H8(e){return Ui([e,"optionalAccess",t=>t.app,"optionalAccess",t=>t.app_memory])&&(e.app.app_memory=process.memoryUsage().rss),Ui([e,"optionalAccess",t=>t.device,"optionalAccess",t=>t.free_memory])&&(e.device.free_memory=en.freemem()),e}async function Y8(){let e=en.platform();switch(e){case"darwin":return K8();case"linux":return U8();default:return{name:F8[e]||e,version:en.release()}}}function X8(){try{if(typeof process.versions.icu!="string")return;let e=new Date(9e8);if(new Intl.DateTimeFormat("es",{month:"long"}).format(e)==="enero"){let n=Intl.DateTimeFormat().resolvedOptions();return{locale:n.locale,timezone:n.timeZone}}}catch{}}function _8(){let e=process.memoryUsage().rss;return{app_start_time:new Date(Date.now()-process.uptime()*1e3).toISOString(),app_memory:e}}function DR(e){let t={},n;try{n=en.uptime&&en.uptime()}catch{}if(typeof n=="number"&&(t.boot_time=new Date(Date.now()-n*1e3).toISOString()),t.arch=en.arch(),(e===!0||e.memory)&&(t.memory_size=en.totalmem(),t.free_memory=en.freemem()),e===!0||e.cpu){let r=en.cpus();if(r&&r.length){let i=r[0];t.processor_count=r.length,t.cpu_description=i.model,t.processor_frequency=i.speed}}return t}var F8={aix:"IBM AIX",freebsd:"FreeBSD",openbsd:"OpenBSD",sunos:"SunOS",win32:"Windows"},T8=[{name:"fedora-release",distros:["Fedora"]},{name:"redhat-release",distros:["Red Hat Linux","Centos"]},{name:"redhat_version",distros:["Red Hat Linux"]},{name:"SuSE-release",distros:["SUSE Linux"]},{name:"lsb-release",distros:["Ubuntu Linux","Arch Linux"]},{name:"debian_version",distros:["Debian"]},{name:"debian_release",distros:["Debian"]},{name:"arch-release",distros:["Arch Linux"]},{name:"gentoo-release",distros:["Gentoo Linux"]},{name:"novell-release",distros:["SUSE Linux"]},{name:"alpine-release",distros:["Alpine Linux"]}],k8={alpine:e=>e,arch:e=>kn(/distrib_release=(.*)/,e),centos:e=>kn(/release ([^ ]+)/,e),debian:e=>e,fedora:e=>kn(/release (..)/,e),mint:e=>kn(/distrib_release=(.*)/,e),red:e=>kn(/release ([^ ]+)/,e),suse:e=>kn(/VERSION = (.*)\n/,e),ubuntu:e=>kn(/distrib_release=(.*)/,e)};function kn(e,t){let n=e.exec(t);return n?n[1]:void 0}async function K8(){let e={kernel_version:en.release(),name:"Mac OS X",version:`10.${Number(en.release().split(".")[0])-4}`};try{let t=await new Promise((n,r)=>{V8.execFile("/usr/bin/sw_vers",(i,o)=>{if(i){r(i);return}n(o)})});e.name=kn(/^ProductName:\s+(.*)$/m,t),e.version=kn(/^ProductVersion:\s+(.*)$/m,t),e.build=kn(/^BuildVersion:\s+(.*)$/m,t)}catch{}return e}function kR(e){return e.split(" ")[0].toLowerCase()}async function U8(){let e={kernel_version:en.release(),name:"Linux"};try{let t=await JR("/etc"),n=T8.find(a=>t.includes(a.name));if(!n)return e;let r=N8.join("/etc",n.name),i=(await LR(r,{encoding:"utf-8"})).toLowerCase(),{distros:o}=n;e.name=o.find(a=>i.indexOf(kR(a))>=0)||o[0];let s=kR(e.name);e.version=k8[s](i)}catch{}return e}function x8(){return process.env.VERCEL?{"cloud.provider":"vercel","cloud.region":process.env.VERCEL_REGION}:process.env.AWS_REGION?{"cloud.provider":"aws","cloud.region":process.env.AWS_REGION,"cloud.platform":process.env.AWS_EXECUTION_ENV}:process.env.GCP_PROJECT?{"cloud.provider":"gcp"}:process.env.ALIYUN_REGION_ID?{"cloud.provider":"alibaba_cloud","cloud.region":process.env.ALIYUN_REGION_ID}:process.env.WEBSITE_SITE_NAME&&process.env.REGION_NAME?{"cloud.provider":"azure","cloud.region":process.env.REGION_NAME}:process.env.IBM_CLOUD_REGION?{"cloud.provider":"ibm_cloud","cloud.region":process.env.IBM_CLOUD_REGION}:process.env.TENCENTCLOUD_REGION?{"cloud.provider":"tencent_cloud","cloud.region":process.env.TENCENTCLOUD_REGION,"cloud.account.id":process.env.TENCENTCLOUD_APPID,"cloud.availability_zone":process.env.TENCENTCLOUD_ZONE}:process.env.NETLIFY?{"cloud.provider":"netlify"}:process.env.FLY_REGION?{"cloud.provider":"fly.io","cloud.region":process.env.FLY_REGION}:process.env.DYNO?{"cloud.provider":"heroku"}:void 0}xi.Context=E8;xi.getDeviceContext=DR;xi.nodeContextIntegration=OR;xi.readDirAsync=JR;xi.readFileAsync=LR});var wg=I(Ng=>{"use strict";var{_optionalChain:cC}=R();Object.defineProperty(Ng,"__esModule",{value:!0});var L8=require("fs"),qR=j(),MR=R(),Vg=new MR.LRUMap(100),J8=7,jR="ContextLines";function z8(e){return new Promise((t,n)=>{L8.readFile(e,"utf8",(r,i)=>{r?n(r):t(i)})})}var O8=(e={})=>{let t=e.frameContextLines!==void 0?e.frameContextLines:J8;return{name:jR,setupOnce(){},processEvent(n){return q8(n,t)}}},PR=qR.defineIntegration(O8),D8=qR.convertIntegrationFnToClass(jR,PR);async function q8(e,t){let n={},r=[];if(t>0&&cC([e,"access",i=>i.exception,"optionalAccess",i=>i.values])){for(let i of e.exception.values)if(cC([i,"access",o=>o.stacktrace,"optionalAccess",o=>o.frames]))for(let o=i.stacktrace.frames.length-1;o>=0;o--){let s=i.stacktrace.frames[o];s.filename&&!n[s.filename]&&!Vg.get(s.filename)&&(r.push(j8(s.filename)),n[s.filename]=1)}}if(r.length>0&&await Promise.all(r),t>0&&cC([e,"access",i=>i.exception,"optionalAccess",i=>i.values]))for(let i of e.exception.values)i.stacktrace&&i.stacktrace.frames&&await M8(i.stacktrace.frames,t);return e}function M8(e,t){for(let n of e)if(n.filename&&n.context_line===void 0){let r=Vg.get(n.filename);if(r)try{MR.addContextToFrame(r,n,t)}catch{}}}async function j8(e){let t=Vg.get(e);if(t===null)return null;if(t!==void 0)return t;let n=null;try{n=(await z8(e)).split(`
`)}catch{}return Vg.set(e,n),n}Ng.ContextLines=D8;Ng.contextLinesIntegration=PR});var $a=I(uC=>{"use strict";Object.defineProperty(uC,"__esModule",{value:!0});var P8=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;uC.DEBUG_BUILD=P8});var eV=I(Li=>{"use strict";var{_optionalChain:Kn}=R();Object.defineProperty(Li,"__esModule",{value:!0});var lC=require("url"),Q8=ki();function $8(e){let{protocol:t,hostname:n,port:r}=$R(e),i=e.path?e.path:"/";return`${t}//${n}${r}${i}`}function QR(e){let{protocol:t,hostname:n,port:r}=$R(e),i=e.pathname||"/",o=e.auth?e$(e.auth):"";return`${t}//${o}${n}${r}${i}`}function e$(e){let[t,n]=e.split(":");return`${t?"[Filtered]":""}:${n?"[Filtered]":""}@`}function t$(e,t,n){if(!e)return e;let[r,i]=e.split(" ");return t.host&&!t.protocol&&(t.protocol=Kn([n,"optionalAccess",o=>o.agent,"optionalAccess",o=>o.protocol]),i=QR(t)),Kn([i,"optionalAccess",o=>o.startsWith,"call",o=>o("///")])&&(i=i.slice(2)),`${r} ${i}`}function gC(e){let t={protocol:e.protocol,hostname:typeof e.hostname=="string"&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return e.port!==""&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username}:${e.password}`),t}function n$(e,t){let n,r;if(typeof t[t.length-1]=="function"&&(n=t.pop()),typeof t[0]=="string")r=gC(new lC.URL(t[0]));else if(t[0]instanceof lC.URL)r=gC(t[0]);else{r=t[0];try{let i=new lC.URL(r.path||"",`${r.protocol||"http:"}//${r.hostname}`);r={pathname:i.pathname,search:i.search,hash:i.hash,...r}}catch{}}return t.length===2&&(r={...r,...t[1]}),r.protocol===void 0&&(Q8.NODE_VERSION.major>8?r.protocol=Kn([Kn([e,"optionalAccess",i=>i.globalAgent]),"optionalAccess",i=>i.protocol])||Kn([r.agent,"optionalAccess",i=>i.protocol])||Kn([r._defaultAgent,"optionalAccess",i=>i.protocol]):r.protocol=Kn([r.agent,"optionalAccess",i=>i.protocol])||Kn([r._defaultAgent,"optionalAccess",i=>i.protocol])||Kn([Kn([e,"optionalAccess",i=>i.globalAgent]),"optionalAccess",i=>i.protocol])),n?[r,n]:[r]}function $R(e){let t=e.protocol||"",n=e.hostname||e.host||"",r=!e.port||e.port===80||e.port===443||/^(.*):(\d+)$/.test(n)?"":`:${e.port}`;return{protocol:t,hostname:n,port:r}}Li.cleanSpanDescription=t$;Li.extractRawUrl=$8;Li.extractUrl=QR;Li.normalizeRequestArgs=n$;Li.urlToOptions=gC});var Eg=I(is=>{"use strict";var{_optionalChain:ns}=R();Object.defineProperty(is,"__esModule",{value:!0});var tt=j(),Kt=R(),dC=$a(),r$=ki(),ec=eV(),i$=(e={})=>{let{breadcrumbs:t,tracing:n,shouldCreateSpanForRequest:r}=e,i={breadcrumbs:t,tracing:n===!1?!1:Kt.dropUndefinedKeys({enableIfHasTracingEnabled:n===!0?void 0:!0,shouldCreateSpanForRequest:r})};return new rs(i)},o$=tt.defineIntegration(i$),rs=class e{static __initStatic(){this.id="Http"}__init(){this.name=e.id}constructor(t={}){e.prototype.__init.call(this),this._breadcrumbs=typeof t.breadcrumbs>"u"?!0:t.breadcrumbs,this._tracing=t.tracing?t.tracing===!0?{}:t.tracing:void 0}setupOnce(t,n){let r=ns([n,"call",l=>l(),"access",l=>l.getClient,"call",l=>l(),"optionalAccess",l=>l.getOptions,"call",l=>l()]),i=nV(this._tracing,r);if(!this._breadcrumbs&&!i)return;if(r&&r.instrumenter!=="sentry"){dC.DEBUG_BUILD&&Kt.logger.log("HTTP Integration is skipped because of instrumenter configuration.");return}let o=rV(i,this._tracing,r),s=ns([r,"optionalAccess",l=>l.tracePropagationTargets])||ns([this,"access",l=>l._tracing,"optionalAccess",l=>l.tracePropagationTargets]),a=require("http"),c=tV(a,this._breadcrumbs,o,s);if(Kt.fill(a,"get",c),Kt.fill(a,"request",c),r$.NODE_VERSION.major>8){let l=require("https"),u=tV(l,this._breadcrumbs,o,s);Kt.fill(l,"get",u),Kt.fill(l,"request",u)}}};rs.__initStatic();function tV(e,t,n,r){let i=new Kt.LRUMap(100),o=new Kt.LRUMap(100),s=l=>{if(n===void 0)return!0;let u=i.get(l);if(u!==void 0)return u;let d=n(l);return i.set(l,d),d},a=l=>{if(r===void 0)return!0;let u=o.get(l);if(u!==void 0)return u;let d=Kt.stringMatchesSomePattern(l,r);return o.set(l,d),d};function c(l,u,d,g){tt.getCurrentHub().getIntegration(rs)&&tt.addBreadcrumb({category:"http",data:{status_code:g&&g.statusCode,...u},type:"http"},{event:l,request:d,response:g})}return function(u){return function(...g){let m=ec.normalizeRequestArgs(e,g),h=m[0],b=ec.extractRawUrl(h),y=ec.extractUrl(h),v=tt.getClient();if(tt.isSentryRequestUrl(y,v))return u.apply(e,m);let H=tt.getCurrentScope(),F=tt.getIsolationScope(),Q=tt.getActiveSpan(),te=a$(y,h),V=s(b)?ns([Q,"optionalAccess",x=>x.startChild,"call",x=>x({op:"http.client",origin:"auto.http.node.http",description:`${te["http.method"]} ${te.url}`,data:te})]):void 0;if(v&&a(b)){let{traceId:x,spanId:O,sampled:k,dsc:D}={...F.getPropagationContext(),...H.getPropagationContext()},M=V?tt.spanToTraceHeader(V):Kt.generateSentryTraceHeader(x,O,k),re=Kt.dynamicSamplingContextToSentryBaggageHeader(D||(V?tt.getDynamicSamplingContextFromSpan(V):tt.getDynamicSamplingContextFromClient(x,v,H)));s$(h,y,M,re)}else dC.DEBUG_BUILD&&Kt.logger.log(`[Tracing] Not adding sentry-trace header to outgoing request (${y}) due to mismatching tracePropagationTargets option.`);return u.apply(e,m).once("response",function(x){let O=this;t&&c("response",te,O,x),V&&(x.statusCode&&tt.setHttpStatus(V,x.statusCode),V.updateName(ec.cleanSpanDescription(tt.spanToJSON(V).description||"",h,O)||""),V.end())}).once("error",function(){let x=this;t&&c("error",te,x),V&&(tt.setHttpStatus(V,500),V.updateName(ec.cleanSpanDescription(tt.spanToJSON(V).description||"",h,x)||""),V.end())})}}}function s$(e,t,n,r){(e.headers||{})["sentry-trace"]||(dC.DEBUG_BUILD&&Kt.logger.log(`[Tracing] Adding sentry-trace header ${n} to outgoing request to "${t}": `),e.headers={...e.headers,"sentry-trace":n,...r&&r.length>0&&{baggage:c$(e,r)}})}function a$(e,t){let n=t.method||"GET",r={url:e,"http.method":n};return t.hash&&(r["http.fragment"]=t.hash.substring(1)),t.search&&(r["http.query"]=t.search.substring(1)),r}function c$(e,t){if(!e.headers||!e.headers.baggage)return t;if(t){if(Array.isArray(e.headers.baggage))return[...e.headers.baggage,t]}else return e.headers.baggage;return[e.headers.baggage,t]}function nV(e,t){return e===void 0?!1:e.enableIfHasTracingEnabled?tt.hasTracingEnabled(t):!0}function rV(e,t,n){return e?ns([t,"optionalAccess",i=>i.shouldCreateSpanForRequest])||ns([n,"optionalAccess",i=>i.shouldCreateSpanForRequest]):()=>!1}is.Http=rs;is._getShouldCreateSpanForRequest=rV;is._shouldCreateSpans=nV;is.httpIntegration=o$});var oV=I(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});function u$(e,t,n){let r=0,i=5,o=0;return setInterval(()=>{o===0?r>e&&(i*=2,n(i),i>86400&&(i=86400),o=i):(o-=1,o===0&&t()),r=0},1e3).unref(),()=>{r+=1}}function IC(e){return e!==void 0&&(e.length===0||e==="?"||e==="<anonymous>")}function l$(e,t){return e===t||IC(e)&&IC(t)}function iV(e){if(e!==void 0)return e.slice(-10).reduce((t,n)=>`${t},${n.function},${n.lineno},${n.colno}`,"")}function g$(e,t){if(t!==void 0)return iV(e(t,1))}Ji.createRateLimiter=u$;Ji.functionNamesMatch=l$;Ji.hashFrames=iV;Ji.hashFromStack=g$;Ji.isAnonymous=IC});var cV=I(tc=>{"use strict";var{_optionalChain:Be}=R();Object.defineProperty(tc,"__esModule",{value:!0});var pC=j(),Hg=R(),d$=ki(),Yg=oV();function fC(e){let t=[],n=!1;function r(s){t=[],!n&&(n=!0,e(s))}t.push(r);function i(s){t.push(s)}function o(s){let a=t.pop()||r;try{a(s)}catch{r(s)}}return{add:i,next:o}}var mC=class{constructor(){let{Session:t}=require("inspector");this._session=new t}configureAndConnect(t,n){this._session.connect(),this._session.on("Debugger.paused",r=>{t(r,()=>{this._session.post("Debugger.resume")})}),this._session.post("Debugger.enable"),this._session.post("Debugger.setPauseOnExceptions",{state:n?"all":"uncaught"})}setPauseOnExceptions(t){this._session.post("Debugger.setPauseOnExceptions",{state:t?"all":"uncaught"})}getLocalVariables(t,n){this._getProperties(t,r=>{let{add:i,next:o}=fC(n);for(let s of r)if(Be([s,"optionalAccess",a=>a.value,"optionalAccess",a=>a.objectId])&&Be([s,"optionalAccess",a=>a.value,"access",a=>a.className])==="Array"){let a=s.value.objectId;i(c=>this._unrollArray(a,s.name,c,o))}else if(Be([s,"optionalAccess",a=>a.value,"optionalAccess",a=>a.objectId])&&Be([s,"optionalAccess",a=>a.value,"optionalAccess",a=>a.className])==="Object"){let a=s.value.objectId;i(c=>this._unrollObject(a,s.name,c,o))}else(Be([s,"optionalAccess",a=>a.value,"optionalAccess",a=>a.value])!=null||Be([s,"optionalAccess",a=>a.value,"optionalAccess",a=>a.description])!=null)&&i(a=>this._unrollOther(s,a,o));o({})})}_getProperties(t,n){this._session.post("Runtime.getProperties",{objectId:t,ownProperties:!0},(r,i)=>{n(r?[]:i.result)})}_unrollArray(t,n,r,i){this._getProperties(t,o=>{r[n]=o.filter(s=>s.name!=="length"&&!isNaN(parseInt(s.name,10))).sort((s,a)=>parseInt(s.name,10)-parseInt(a.name,10)).map(s=>Be([s,"optionalAccess",a=>a.value,"optionalAccess",a=>a.value])),i(r)})}_unrollObject(t,n,r,i){this._getProperties(t,o=>{r[n]=o.map(s=>[s.name,Be([s,"optionalAccess",a=>a.value,"optionalAccess",a=>a.value])]).reduce((s,[a,c])=>(s[a]=c,s),{}),i(r)})}_unrollOther(t,n,r){Be([t,"optionalAccess",i=>i.value,"optionalAccess",i=>i.value])!=null?n[t.name]=t.value.value:Be([t,"optionalAccess",i=>i.value,"optionalAccess",i=>i.description])!=null&&Be([t,"optionalAccess",i=>i.value,"optionalAccess",i=>i.type])!=="function"&&(n[t.name]=`<${t.value.description}>`),r(n)}};function I$(){try{return new mC}catch{return}}var sV="LocalVariables",m$=(e={},t=I$())=>{let n=new Hg.LRUMap(20),r,i=!1;function o(c,{params:{reason:l,data:u,callFrames:d}},g){if(l!=="exception"&&l!=="promiseRejection"){g();return}Be([r,"optionalCall",y=>y()]);let m=Yg.hashFromStack(c,Be([u,"optionalAccess",y=>y.description]));if(m==null){g();return}let{add:h,next:b}=fC(y=>{n.set(m,y),g()});for(let y=0;y<Math.min(d.length,5);y++){let{scopeChain:v,functionName:H,this:F}=d[y],Q=v.find(V=>V.type==="local"),te=F.className==="global"||!F.className?H:`${F.className}.${H}`;if(Be([Q,"optionalAccess",V=>V.object,"access",V=>V.objectId])===void 0)h(V=>{V[y]={function:te},b(V)});else{let V=Q.object.objectId;h(x=>Be([t,"optionalAccess",O=>O.getLocalVariables,"call",O=>O(V,k=>{x[y]={function:te,vars:k},b(x)})]))}}b([])}function s(c){let l=Yg.hashFrames(Be([c,"optionalAccess",g=>g.stacktrace,"optionalAccess",g=>g.frames]));if(l===void 0)return;let u=n.remove(l);if(u===void 0)return;let d=(Be([c,"access",g=>g.stacktrace,"optionalAccess",g=>g.frames])||[]).filter(g=>g.function!=="new Promise");for(let g=0;g<d.length;g++){let m=d.length-g-1;if(!d[m]||!u[g])break;u[g].vars===void 0||d[m].in_app===!1||!Yg.functionNamesMatch(d[m].function,u[g].function)||(d[m].vars=u[g].vars)}}function a(c){for(let l of Be([c,"optionalAccess",u=>u.exception,"optionalAccess",u=>u.values])||[])s(l);return c}return{name:sV,setupOnce(){let c=pC.getClient(),l=Be([c,"optionalAccess",u=>u.getOptions,"call",u=>u()]);if(t&&Be([l,"optionalAccess",u=>u.includeLocalVariables])){if(d$.NODE_VERSION.major<18){Hg.logger.log("The `LocalVariables` integration is only supported on Node >= v18.");return}let d=e.captureAllExceptions!==!1;if(t.configureAndConnect((g,m)=>o(l.stackParser,g,m),d),d){let g=e.maxExceptionsPerSecond||50;r=Yg.createRateLimiter(g,()=>{Hg.logger.log("Local variables rate-limit lifted."),Be([t,"optionalAccess",m=>m.setPauseOnExceptions,"call",m=>m(!0)])},m=>{Hg.logger.log(`Local variables rate-limit exceeded. Disabling capturing of caught exceptions for ${m} seconds.`),Be([t,"optionalAccess",h=>h.setPauseOnExceptions,"call",h=>h(!1)])})}i=!0}},processEvent(c){return i?a(c):c},_getCachedFramesCount(){return n.size},_getFirstCachedFrame(){return n.values()[0]}}},aV=pC.defineIntegration(m$),p$=pC.convertIntegrationFnToClass(sV,aV);tc.LocalVariablesSync=p$;tc.createCallbackList=fC;tc.localVariablesSyncIntegration=aV});var _g=I(Xg=>{"use strict";Object.defineProperty(Xg,"__esModule",{value:!0});var uV=cV(),f$=uV.LocalVariablesSync,h$=uV.localVariablesSyncIntegration;Xg.LocalVariables=f$;Xg.localVariablesIntegration=h$});var Tg=I(Fg=>{"use strict";Object.defineProperty(Fg,"__esModule",{value:!0});var lV=require("fs"),gV=require("path"),dV=j(),hC,IV="Modules";function C$(){try{return require.cache?Object.keys(require.cache):[]}catch{return[]}}function b$(){let e=require.main&&require.main.paths||[],t=C$(),n={},r={};return t.forEach(i=>{let o=i,s=()=>{let a=o;if(o=gV.dirname(a),!o||a===o||r[a])return;if(e.indexOf(o)<0)return s();let c=gV.join(a,"package.json");if(r[a]=!0,!lV.existsSync(c))return s();try{let l=JSON.parse(lV.readFileSync(c,"utf8"));n[l.name]=l.version}catch{}};s()}),n}function y$(){return hC||(hC=b$()),hC}var G$=()=>({name:IV,setupOnce(){},processEvent(e){return e.modules={...e.modules,...y$()},e}}),mV=dV.defineIntegration(G$),B$=dV.convertIntegrationFnToClass(IV,mV);Fg.Modules=B$;Fg.modulesIntegration=mV});var yC=I(bC=>{"use strict";Object.defineProperty(bC,"__esModule",{value:!0});var A$=j(),kg=R(),CC=$a(),Z$=2e3;function v$(e){kg.consoleSandbox(()=>{console.error(e)});let t=A$.getClient();t===void 0&&(CC.DEBUG_BUILD&&kg.logger.warn("No NodeClient was defined, we are exiting the process now."),global.process.exit(1));let n=t.getOptions(),r=n&&n.shutdownTimeout&&n.shutdownTimeout>0&&n.shutdownTimeout||Z$;t.close(r).then(i=>{i||CC.DEBUG_BUILD&&kg.logger.warn("We reached the timeout for emptying the request buffer, still exiting now!"),global.process.exit(1)},i=>{CC.DEBUG_BUILD&&kg.logger.error(i)})}bC.logAndExitProcess=v$});var Ug=I(nc=>{"use strict";Object.defineProperty(nc,"__esModule",{value:!0});var Kg=j(),S$=R(),W$=$a(),pV=yC(),fV="OnUncaughtException",R$=(e={})=>{let t={exitEvenIfOtherHandlersAreRegistered:!0,...e};return{name:fV,setupOnce(){},setup(n){global.process.on("uncaughtException",CV(n,t))}}},hV=Kg.defineIntegration(R$),V$=Kg.convertIntegrationFnToClass(fV,hV);function CV(e,t){let r=!1,i=!1,o=!1,s,a=e.getOptions();return Object.assign(c=>{let l=pV.logAndExitProcess;t.onFatalError?l=t.onFatalError:a.onFatalError&&(l=a.onFatalError);let d=global.process.listeners("uncaughtException").reduce((m,h)=>h.name==="domainUncaughtExceptionClear"||h.tag&&h.tag==="sentry_tracingErrorCallback"||h._errorHandler?m:m+1,0)===0,g=t.exitEvenIfOtherHandlersAreRegistered||d;r?g&&(o?(W$.DEBUG_BUILD&&S$.logger.warn("uncaught exception after calling fatal error shutdown callback - this is bad! forcing shutdown"),pV.logAndExitProcess(c)):i||(i=!0,setTimeout(()=>{o||(o=!0,l(s,c))},2e3))):(s=c,r=!0,Kg.getClient()===e&&Kg.captureException(c,{originalException:c,captureContext:{level:"fatal"},mechanism:{handled:!1,type:"onuncaughtexception"}}),!o&&g&&(o=!0,l(c)))},{_errorHandler:!0})}nc.OnUncaughtException=V$;nc.makeErrorHandler=CV;nc.onUncaughtExceptionIntegration=hV});var Lg=I(rc=>{"use strict";Object.defineProperty(rc,"__esModule",{value:!0});var xg=j(),bV=R(),N$=yC(),yV="OnUnhandledRejection",w$=(e={})=>{let t=e.mode||"warn";return{name:yV,setupOnce(){},setup(n){global.process.on("unhandledRejection",BV(n,{mode:t}))}}},GV=xg.defineIntegration(w$),E$=xg.convertIntegrationFnToClass(yV,GV);function BV(e,t){return function(r,i){xg.getClient()===e&&(xg.captureException(r,{originalException:i,captureContext:{extra:{unhandledPromiseRejection:!0}},mechanism:{handled:!1,type:"onunhandledrejection"}}),H$(r,t))}}function H$(e,t){let n="This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). The promise rejected with the reason:";t.mode==="warn"?bV.consoleSandbox(()=>{console.warn(n),console.error(e&&e.stack?e.stack:e)}):t.mode==="strict"&&(bV.consoleSandbox(()=>{console.warn(n)}),N$.logAndExitProcess(e))}rc.OnUnhandledRejection=E$;rc.makeUnhandledPromiseHandler=BV;rc.onUnhandledRejectionIntegration=GV});var Jg=I(ic=>{"use strict";Object.defineProperty(ic,"__esModule",{value:!0});var Y$=require("http"),X$=require("url"),AV=j(),os=R(),ZV="Spotlight",_$=(e={})=>{let t={sidecarUrl:e.sidecarUrl||"http://localhost:8969/stream"};return{name:ZV,setupOnce(){},setup(n){typeof process=="object"&&process.env&&process.env.NODE_ENV!=="development"&&os.logger.warn("[Spotlight] It seems you're not in dev mode. Do you really want to have Spotlight enabled?"),T$(n,t)}}},vV=AV.defineIntegration(_$),F$=AV.convertIntegrationFnToClass(ZV,vV);function T$(e,t){let n=k$(t.sidecarUrl);if(!n)return;let r=0;if(typeof e.on!="function"){os.logger.warn("[Spotlight] Cannot connect to spotlight due to missing method on SDK client (`client.on`)");return}e.on("beforeEnvelope",i=>{if(r>3){os.logger.warn("[Spotlight] Disabled Sentry -> Spotlight integration due to too many failed requests");return}let o=os.serializeEnvelope(i),a=SV()({method:"POST",path:n.pathname,hostname:n.hostname,port:n.port,headers:{"Content-Type":"application/x-sentry-envelope"}},c=>{c.on("data",()=>{}),c.on("end",()=>{}),c.setEncoding("utf8")});a.on("error",()=>{r++,os.logger.warn("[Spotlight] Failed to send envelope to Spotlight Sidecar")}),a.write(o),a.end()})}function k$(e){try{return new X$.URL(`${e}`)}catch{os.logger.warn(`[Spotlight] Invalid sidecar URL: ${e}`);return}}function SV(){let{request:e}=Y$;return K$(e)?e.__sentry_original__:e}function K$(e){return"__sentry_original__"in e}ic.Spotlight=F$;ic.getNativeHttpRequest=SV;ic.spotlightIntegration=vV});var Og=I(Un=>{"use strict";var{_optionalChain:zg}=R();Object.defineProperty(Un,"__esModule",{value:!0});var Ee=j(),zi=R(),U$=ki();Un.ChannelName=void 0;(function(e){let t="undici:request:create";e.RequestCreate=t;let n="undici:request:headers";e.RequestEnd=n;let r="undici:request:error";e.RequestError=r})(Un.ChannelName||(Un.ChannelName={}));var x$=e=>new oc(e),L$=Ee.defineIntegration(x$),oc=class e{static __initStatic(){this.id="Undici"}__init(){this.name=e.id}__init2(){this._createSpanUrlMap=new zi.LRUMap(100)}__init3(){this._headersUrlMap=new zi.LRUMap(100)}constructor(t={}){e.prototype.__init.call(this),e.prototype.__init2.call(this),e.prototype.__init3.call(this),e.prototype.__init4.call(this),e.prototype.__init5.call(this),e.prototype.__init6.call(this),this._options={breadcrumbs:t.breadcrumbs===void 0?!0:t.breadcrumbs,tracing:t.tracing,shouldCreateSpanForRequest:t.shouldCreateSpanForRequest}}setupOnce(t){if(U$.NODE_VERSION.major<16)return;let n;try{n=require("diagnostics_channel")}catch{}!n||!n.subscribe||(n.subscribe(Un.ChannelName.RequestCreate,this._onRequestCreate),n.subscribe(Un.ChannelName.RequestEnd,this._onRequestEnd),n.subscribe(Un.ChannelName.RequestError,this._onRequestError))}_shouldCreateSpan(t){if(this._options.tracing===!1||this._options.tracing===void 0&&!Ee.hasTracingEnabled())return!1;if(this._options.shouldCreateSpanForRequest===void 0)return!0;let n=this._createSpanUrlMap.get(t);if(n!==void 0)return n;let r=this._options.shouldCreateSpanForRequest(t);return this._createSpanUrlMap.set(t,r),r}__init4(){this._onRequestCreate=t=>{if(!zg([Ee.getClient,"call",d=>d(),"optionalAccess",d=>d.getIntegration,"call",d=>d(e)]))return;let{request:n}=t,r=n.origin?n.origin.toString()+n.path:n.path,i=Ee.getClient();if(!i||Ee.isSentryRequestUrl(r,i)||n.__sentry_span__!==void 0)return;let o=i.getOptions(),s=Ee.getCurrentScope(),a=Ee.getIsolationScope(),c=Ee.getActiveSpan(),l=this._shouldCreateSpan(r)?z$(c,n,r):void 0;if(l&&(n.__sentry_span__=l),(d=>{if(o.tracePropagationTargets===void 0)return!0;let g=this._headersUrlMap.get(d);if(g!==void 0)return g;let m=zi.stringMatchesSomePattern(d,o.tracePropagationTargets);return this._headersUrlMap.set(d,m),m})(r)){let{traceId:d,spanId:g,sampled:m,dsc:h}={...a.getPropagationContext(),...s.getPropagationContext()},b=l?Ee.spanToTraceHeader(l):zi.generateSentryTraceHeader(d,g,m),y=zi.dynamicSamplingContextToSentryBaggageHeader(h||(l?Ee.getDynamicSamplingContextFromSpan(l):Ee.getDynamicSamplingContextFromClient(d,i,s)));J$(n,b,y)}}}__init5(){this._onRequestEnd=t=>{if(!zg([Ee.getClient,"call",s=>s(),"optionalAccess",s=>s.getIntegration,"call",s=>s(e)]))return;let{request:n,response:r}=t,i=n.origin?n.origin.toString()+n.path:n.path;if(Ee.isSentryRequestUrl(i,Ee.getClient()))return;let o=n.__sentry_span__;o&&(Ee.setHttpStatus(o,r.statusCode),o.end()),this._options.breadcrumbs&&Ee.addBreadcrumb({category:"http",data:{method:n.method,status_code:r.statusCode,url:i},type:"http"},{event:"response",request:n,response:r})}}__init6(){this._onRequestError=t=>{if(!zg([Ee.getClient,"call",o=>o(),"optionalAccess",o=>o.getIntegration,"call",o=>o(e)]))return;let{request:n}=t,r=n.origin?n.origin.toString()+n.path:n.path;if(Ee.isSentryRequestUrl(r,Ee.getClient()))return;let i=n.__sentry_span__;i&&(i.setStatus("internal_error"),i.end()),this._options.breadcrumbs&&Ee.addBreadcrumb({category:"http",data:{method:n.method,url:r},level:"error",type:"http"},{event:"error",request:n})}}};oc.__initStatic();function J$(e,t,n){let r;Array.isArray(e.headers)?r=e.headers.some(i=>i==="sentry-trace"):r=e.headers.split(`\r
`).some(o=>o.startsWith("sentry-trace:")),!r&&(e.addHeader("sentry-trace",t),n&&e.addHeader("baggage",n))}function z$(e,t,n){let r=zi.parseUrl(n),i=t.method||"GET",o={"http.method":i};return r.search&&(o["http.query"]=r.search),r.hash&&(o["http.fragment"]=r.hash),zg([e,"optionalAccess",s=>s.startChild,"call",s=>s({op:"http.client",origin:"auto.http.node.undici",description:`${i} ${zi.getSanitizedUrlString(r)}`,data:o})])}Un.Undici=oc;Un.nativeNodeFetchintegration=L$});var BC=I(GC=>{"use strict";Object.defineProperty(GC,"__esModule",{value:!0});var WV=require("path"),O$=R();function RV(e){return e.replace(/^[A-Z]:/,"").replace(/\\/g,"/")}function D$(e=process.argv[1]?O$.dirname(process.argv[1]):process.cwd(),t=WV.sep==="\\"){let n=t?RV(e):e;return r=>{if(!r)return;let i=t?RV(r):r,{dir:o,base:s,ext:a}=WV.posix.parse(i);(a===".js"||a===".mjs"||a===".cjs")&&(s=s.slice(0,a.length*-1)),o||(o=".");let c=o.lastIndexOf("/node_modules");if(c>-1)return`${o.slice(c+14).replace(/\//g,".")}:${s}`;if(o.startsWith(n)){let l=o.slice(n.length+1).replace(/\//g,".");return l&&(l+=":"),l+=s,l}return s}}GC.createGetModuleFromFilename=D$});var AC=I(Lr=>{"use strict";var{_optionalChain:q$}=R();Object.defineProperty(Lr,"__esModule",{value:!0});var tn=j(),Oi=R(),M$=XR(),j$=Mh(),P$=Wg(),Q$=Rg(),$$=wg(),e7=Eg(),t7=_g(),n7=Tg(),r7=Ug(),i7=Lg(),o7=Jg(),s7=Og(),a7=BC(),c7=nC(),VV=[tn.inboundFiltersIntegration(),tn.functionToStringIntegration(),tn.linkedErrorsIntegration(),tn.requestDataIntegration(),P$.consoleIntegration(),e7.httpIntegration(),s7.nativeNodeFetchintegration(),r7.onUncaughtExceptionIntegration(),i7.onUnhandledRejectionIntegration(),$$.contextLinesIntegration(),t7.localVariablesIntegration(),Q$.nodeContextIntegration(),n7.modulesIntegration()];function NV(e){let t=tn.getMainCarrier(),n=q$([t,"access",r=>r.__SENTRY__,"optionalAccess",r=>r.integrations])||[];return[...VV,...n]}function u7(e={}){M$.setNodeAsyncContextStrategy(),e.defaultIntegrations===void 0&&(e.defaultIntegrations=NV()),e.dsn===void 0&&(e.dsn="https://cbe9c82c26b9431a9d05cf0a97984f0d@o10801.ingest.sentry.io/6418580");let t=process.env.SENTRY_TRACES_SAMPLE_RATE;if(e.tracesSampleRate===void 0&&t){let r=parseFloat(t);isFinite(r)&&(e.tracesSampleRate=r)}if(e.release===void 0){let r=wV();r!==void 0?e.release=r:e.autoSessionTracking=!1}e.environment===void 0&&process.env.SENTRY_ENVIRONMENT&&(e.environment=process.env.SENTRY_ENVIRONMENT),e.autoSessionTracking===void 0&&e.dsn!==void 0&&(e.autoSessionTracking=!0),e.instrumenter===void 0&&(e.instrumenter="sentry");let n={...e,stackParser:Oi.stackParserFromStackParserOptions(e.stackParser||EV),integrations:tn.getIntegrationsToSetup(e),transport:e.transport||c7.makeNodeTransport};if(tn.initAndBind(e.clientClass||j$.NodeClient,n),e.autoSessionTracking&&g7(),d7(),e.spotlight){let r=tn.getClient();if(r&&r.addIntegration){let i=r.getOptions().integrations;for(let o of i)r.addIntegration(o);r.addIntegration(o7.spotlightIntegration({sidecarUrl:typeof e.spotlight=="string"?e.spotlight:void 0}))}}}function l7(e){if(e===void 0)return!1;let t=e&&e.getOptions();return t&&t.autoSessionTracking!==void 0?t.autoSessionTracking:!1}function wV(e){return process.env.SENTRY_RELEASE?process.env.SENTRY_RELEASE:Oi.GLOBAL_OBJ.SENTRY_RELEASE&&Oi.GLOBAL_OBJ.SENTRY_RELEASE.id?Oi.GLOBAL_OBJ.SENTRY_RELEASE.id:process.env.GITHUB_SHA||process.env.COMMIT_REF||process.env.VERCEL_GIT_COMMIT_SHA||process.env.VERCEL_GITHUB_COMMIT_SHA||process.env.VERCEL_GITLAB_COMMIT_SHA||process.env.VERCEL_BITBUCKET_COMMIT_SHA||process.env.ZEIT_GITHUB_COMMIT_SHA||process.env.ZEIT_GITLAB_COMMIT_SHA||process.env.ZEIT_BITBUCKET_COMMIT_SHA||process.env.CF_PAGES_COMMIT_SHA||e}var EV=Oi.createStackParser(Oi.nodeStackLineParser(a7.createGetModuleFromFilename()));function g7(){tn.startSession(),process.on("beforeExit",()=>{let e=tn.getIsolationScope().getSession();e&&!["exited","crashed"].includes(e.status)&&tn.endSession()})}function d7(){let e=(process.env.SENTRY_USE_ENVIRONMENT||"").toLowerCase();if(!["false","n","no","off","0"].includes(e)){let t=process.env.SENTRY_TRACE,n=process.env.SENTRY_BAGGAGE,r=Oi.propagationContextFromHeaders(t,n);tn.getCurrentScope().setPropagationContext(r)}}Lr.defaultIntegrations=VV;Lr.defaultStackParser=EV;Lr.getDefaultIntegrations=NV;Lr.getSentryRelease=wV;Lr.init=u7;Lr.isAutoSessionTrackingEnabled=l7});var HV=I(vC=>{"use strict";Object.defineProperty(vC,"__esModule",{value:!0});var Dg=require("fs"),ZC=require("path");function I7(e){let t=ZC.resolve(e);if(!Dg.existsSync(t))throw new Error(`Cannot read contents of ${t}. Directory does not exist.`);if(!Dg.statSync(t).isDirectory())throw new Error(`Cannot read contents of ${t}, because it is not a directory.`);let n=r=>Dg.readdirSync(r).reduce((i,o)=>{let s=ZC.join(r,o);return Dg.statSync(s).isDirectory()?i.concat(n(s)):(i.push(s),i)},[]);return n(t).map(r=>ZC.relative(t,r))}vC.deepReadDirSync=I7});var XV=I(YV=>{"use strict";YV.base64WorkerScript="aW1wb3J0IHsgU2Vzc2lvbiB9IGZyb20gJ2luc3BlY3Rvcic7CmltcG9ydCB7IHdvcmtlckRhdGEsIHBhcmVudFBvcnQgfSBmcm9tICd3b3JrZXJfdGhyZWFkcyc7CmltcG9ydCB7IHBvc2l4LCBzZXAgfSBmcm9tICdwYXRoJzsKaW1wb3J0ICogYXMgaHR0cCBmcm9tICdodHRwJzsKaW1wb3J0ICogYXMgaHR0cHMgZnJvbSAnaHR0cHMnOwppbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7CmltcG9ydCB7IFVSTCB9IGZyb20gJ3VybCc7CmltcG9ydCB7IGNyZWF0ZUd6aXAgfSBmcm9tICd6bGliJzsKaW1wb3J0ICogYXMgbmV0IGZyb20gJ25ldCc7CmltcG9ydCAqIGFzIHRscyBmcm9tICd0bHMnOwoKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC91bmJvdW5kLW1ldGhvZApjb25zdCBvYmplY3RUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIG9uZSBvZiBhIGZldyBFcnJvciBvciBFcnJvci1saWtlCiAqIHtAbGluayBpc0Vycm9yfS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzRXJyb3Iod2F0KSB7CiAgc3dpdGNoIChvYmplY3RUb1N0cmluZy5jYWxsKHdhdCkpIHsKICAgIGNhc2UgJ1tvYmplY3QgRXJyb3JdJzoKICAgIGNhc2UgJ1tvYmplY3QgRXhjZXB0aW9uXSc6CiAgICBjYXNlICdbb2JqZWN0IERPTUV4Y2VwdGlvbl0nOgogICAgICByZXR1cm4gdHJ1ZTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBpc0luc3RhbmNlT2Yod2F0LCBFcnJvcik7CiAgfQp9Ci8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSBpcyBhbiBpbnN0YW5jZSBvZiB0aGUgZ2l2ZW4gYnVpbHQtaW4gY2xhc3MuCiAqCiAqIEBwYXJhbSB3YXQgVGhlIHZhbHVlIHRvIGJlIGNoZWNrZWQKICogQHBhcmFtIGNsYXNzTmFtZQogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc0J1aWx0aW4od2F0LCBjbGFzc05hbWUpIHsKICByZXR1cm4gb2JqZWN0VG9TdHJpbmcuY2FsbCh3YXQpID09PSBgW29iamVjdCAke2NsYXNzTmFtZX1dYDsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhIHN0cmluZwogKiB7QGxpbmsgaXNTdHJpbmd9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNTdHJpbmcod2F0KSB7CiAgcmV0dXJuIGlzQnVpbHRpbih3YXQsICdTdHJpbmcnKTsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhbiBvYmplY3QgbGl0ZXJhbCwgb3IgYSBjbGFzcyBpbnN0YW5jZS4KICoge0BsaW5rIGlzUGxhaW5PYmplY3R9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh3YXQpIHsKICByZXR1cm4gaXNCdWlsdGluKHdhdCwgJ09iamVjdCcpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIEV2ZW50IGluc3RhbmNlCiAqIHtAbGluayBpc0V2ZW50fS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzRXZlbnQod2F0KSB7CiAgcmV0dXJuIHR5cGVvZiBFdmVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgaXNJbnN0YW5jZU9mKHdhdCwgRXZlbnQpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIEVsZW1lbnQgaW5zdGFuY2UKICoge0BsaW5rIGlzRWxlbWVudH0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc0VsZW1lbnQod2F0KSB7CiAgcmV0dXJuIHR5cGVvZiBFbGVtZW50ICE9PSAndW5kZWZpbmVkJyAmJiBpc0luc3RhbmNlT2Yod2F0LCBFbGVtZW50KTsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlIGhhcyBhIHRoZW4gZnVuY3Rpb24uCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKi8KZnVuY3Rpb24gaXNUaGVuYWJsZSh3YXQpIHsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzCiAgcmV0dXJuIEJvb2xlYW4od2F0ICYmIHdhdC50aGVuICYmIHR5cGVvZiB3YXQudGhlbiA9PT0gJ2Z1bmN0aW9uJyk7Cn0KCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSdzIHR5cGUgaXMgYSBTeW50aGV0aWNFdmVudAogKiB7QGxpbmsgaXNTeW50aGV0aWNFdmVudH0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1N5bnRoZXRpY0V2ZW50KHdhdCkgewogIHJldHVybiBpc1BsYWluT2JqZWN0KHdhdCkgJiYgJ25hdGl2ZUV2ZW50JyBpbiB3YXQgJiYgJ3ByZXZlbnREZWZhdWx0JyBpbiB3YXQgJiYgJ3N0b3BQcm9wYWdhdGlvbicgaW4gd2F0Owp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUgaXMgTmFOCiAqIHtAbGluayBpc05hTn0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc05hTiQxKHdhdCkgewogIHJldHVybiB0eXBlb2Ygd2F0ID09PSAnbnVtYmVyJyAmJiB3YXQgIT09IHdhdDsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhbiBpbnN0YW5jZSBvZiBwcm92aWRlZCBjb25zdHJ1Y3Rvci4KICoge0BsaW5rIGlzSW5zdGFuY2VPZn0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcGFyYW0gYmFzZSBBIGNvbnN0cnVjdG9yIHRvIGJlIHVzZWQgaW4gYSBjaGVjay4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNJbnN0YW5jZU9mKHdhdCwgYmFzZSkgewogIHRyeSB7CiAgICByZXR1cm4gd2F0IGluc3RhbmNlb2YgYmFzZTsKICB9IGNhdGNoIChfZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhIFZ1ZSBWaWV3TW9kZWwuCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1Z1ZVZpZXdNb2RlbCh3YXQpIHsKICAvLyBOb3QgdXNpbmcgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyBiZWNhdXNlIGluIFZ1ZSAzIGl0IHdvdWxkIHJlYWQgdGhlIGluc3RhbmNlJ3MgU3ltYm9sKFN5bWJvbC50b1N0cmluZ1RhZykgcHJvcGVydHkuCiAgcmV0dXJuICEhKHR5cGVvZiB3YXQgPT09ICdvYmplY3QnICYmIHdhdCAhPT0gbnVsbCAmJiAoKHdhdCApLl9faXNWdWUgfHwgKHdhdCApLl9pc1Z1ZSkpOwp9CgovKiogSW50ZXJuYWwgZ2xvYmFsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIFNlbnRyeSBleHRlbnNpb25zICAqLwoKLy8gVGhlIGNvZGUgYmVsb3cgZm9yICdpc0dsb2JhbE9iaicgYW5kICdHTE9CQUxfT0JKJyB3YXMgY29waWVkIGZyb20gY29yZS1qcyBiZWZvcmUgbW9kaWZpY2F0aW9uCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2Jsb2IvMWI5NDRkZjU1MjgyY2RjOTljOTBkYjVmNDllYjBiNmVkYTJjYzBhMy9wYWNrYWdlcy9jb3JlLWpzL2ludGVybmFscy9nbG9iYWwuanMKLy8gY29yZS1qcyBoYXMgdGhlIGZvbGxvd2luZyBsaWNlbmNlOgovLwovLyBDb3B5cmlnaHQgKGMpIDIwMTQtMjAyMiBEZW5pcyBQdXNoa2FyZXYKLy8KLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weQovLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAovLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzCi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwKLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6Ci8vCi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgovLwovLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgovLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTgovLyBUSEUgU09GVFdBUkUuCgovKiogUmV0dXJucyAnb2JqJyBpZiBpdCdzIHRoZSBnbG9iYWwgb2JqZWN0LCBvdGhlcndpc2UgcmV0dXJucyB1bmRlZmluZWQgKi8KZnVuY3Rpb24gaXNHbG9iYWxPYmoob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouTWF0aCA9PSBNYXRoID8gb2JqIDogdW5kZWZpbmVkOwp9CgovKiogR2V0J3MgdGhlIGdsb2JhbCBvYmplY3QgZm9yIHRoZSBjdXJyZW50IEphdmFTY3JpcHQgcnVudGltZSAqLwpjb25zdCBHTE9CQUxfT0JKID0KICAodHlwZW9mIGdsb2JhbFRoaXMgPT0gJ29iamVjdCcgJiYgaXNHbG9iYWxPYmooZ2xvYmFsVGhpcykpIHx8CiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscwogICh0eXBlb2Ygd2luZG93ID09ICdvYmplY3QnICYmIGlzR2xvYmFsT2JqKHdpbmRvdykpIHx8CiAgKHR5cGVvZiBzZWxmID09ICdvYmplY3QnICYmIGlzR2xvYmFsT2JqKHNlbGYpKSB8fAogICh0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGlzR2xvYmFsT2JqKGdsb2JhbCkpIHx8CiAgKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzOwogIH0pKCkgfHwKICB7fTsKCi8qKgogKiBAZGVwcmVjYXRlZCBVc2UgR0xPQkFMX09CSiBpbnN0ZWFkIG9yIFdJTkRPVyBmcm9tIEBzZW50cnkvYnJvd3Nlci4gVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gdjgKICovCmZ1bmN0aW9uIGdldEdsb2JhbE9iamVjdCgpIHsKICByZXR1cm4gR0xPQkFMX09CSiA7Cn0KCi8qKgogKiBSZXR1cm5zIGEgZ2xvYmFsIHNpbmdsZXRvbiBjb250YWluZWQgaW4gdGhlIGdsb2JhbCBgX19TRU5UUllfX2Agb2JqZWN0LgogKgogKiBJZiB0aGUgc2luZ2xldG9uIGRvZXNuJ3QgYWxyZWFkeSBleGlzdCBpbiBgX19TRU5UUllfX2AsIGl0IHdpbGwgYmUgY3JlYXRlZCB1c2luZyB0aGUgZ2l2ZW4gZmFjdG9yeQogKiBmdW5jdGlvbiBhbmQgYWRkZWQgdG8gdGhlIGBfX1NFTlRSWV9fYCBvYmplY3QuCiAqCiAqIEBwYXJhbSBuYW1lIG5hbWUgb2YgdGhlIGdsb2JhbCBzaW5nbGV0b24gb24gX19TRU5UUllfXwogKiBAcGFyYW0gY3JlYXRvciBjcmVhdG9yIEZhY3RvcnkgZnVuY3Rpb24gdG8gY3JlYXRlIHRoZSBzaW5nbGV0b24gaWYgaXQgZG9lc24ndCBhbHJlYWR5IGV4aXN0IG9uIGBfX1NFTlRSWV9fYAogKiBAcGFyYW0gb2JqIChPcHRpb25hbCkgVGhlIGdsb2JhbCBvYmplY3Qgb24gd2hpY2ggdG8gbG9vayBmb3IgYF9fU0VOVFJZX19gLCBpZiBub3QgYEdMT0JBTF9PQkpgJ3MgcmV0dXJuIHZhbHVlCiAqIEByZXR1cm5zIHRoZSBzaW5nbGV0b24KICovCmZ1bmN0aW9uIGdldEdsb2JhbFNpbmdsZXRvbihuYW1lLCBjcmVhdG9yLCBvYmopIHsKICBjb25zdCBnYmwgPSAob2JqIHx8IEdMT0JBTF9PQkopIDsKICBjb25zdCBfX1NFTlRSWV9fID0gKGdibC5fX1NFTlRSWV9fID0gZ2JsLl9fU0VOVFJZX18gfHwge30pOwogIGNvbnN0IHNpbmdsZXRvbiA9IF9fU0VOVFJZX19bbmFtZV0gfHwgKF9fU0VOVFJZX19bbmFtZV0gPSBjcmVhdG9yKCkpOwogIHJldHVybiBzaW5nbGV0b247Cn0KCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpjb25zdCBXSU5ET1cgPSBnZXRHbG9iYWxPYmplY3QoKTsKCmNvbnN0IERFRkFVTFRfTUFYX1NUUklOR19MRU5HVEggPSA4MDsKCi8qKgogKiBHaXZlbiBhIGNoaWxkIERPTSBlbGVtZW50LCByZXR1cm5zIGEgcXVlcnktc2VsZWN0b3Igc3RhdGVtZW50IGRlc2NyaWJpbmcgdGhhdAogKiBhbmQgaXRzIGFuY2VzdG9ycwogKiBlLmcuIFtIVE1MRWxlbWVudF0gPT4gYm9keSA+IGRpdiA+IGlucHV0I2Zvby5idG5bbmFtZT1iYXpdCiAqIEByZXR1cm5zIGdlbmVyYXRlZCBET00gcGF0aAogKi8KZnVuY3Rpb24gaHRtbFRyZWVBc1N0cmluZygKICBlbGVtLAogIG9wdGlvbnMgPSB7fSwKKSB7CiAgaWYgKCFlbGVtKSB7CiAgICByZXR1cm4gJzx1bmtub3duPic7CiAgfQoKICAvLyB0cnkvY2F0Y2ggYm90aDoKICAvLyAtIGFjY2Vzc2luZyBldmVudC50YXJnZXQgKHNlZSBnZXRzZW50cnkvcmF2ZW4tanMjODM4LCAjNzY4KQogIC8vIC0gYGh0bWxUcmVlQXNTdHJpbmdgIGJlY2F1c2UgaXQncyBjb21wbGV4LCBhbmQganVzdCBhY2Nlc3NpbmcgdGhlIERPTSBpbmNvcnJlY3RseQogIC8vIC0gY2FuIHRocm93IGFuIGV4Y2VwdGlvbiBpbiBzb21lIGNpcmN1bXN0YW5jZXMuCiAgdHJ5IHsKICAgIGxldCBjdXJyZW50RWxlbSA9IGVsZW0gOwogICAgY29uc3QgTUFYX1RSQVZFUlNFX0hFSUdIVCA9IDU7CiAgICBjb25zdCBvdXQgPSBbXTsKICAgIGxldCBoZWlnaHQgPSAwOwogICAgbGV0IGxlbiA9IDA7CiAgICBjb25zdCBzZXBhcmF0b3IgPSAnID4gJzsKICAgIGNvbnN0IHNlcExlbmd0aCA9IHNlcGFyYXRvci5sZW5ndGg7CiAgICBsZXQgbmV4dFN0cjsKICAgIGNvbnN0IGtleUF0dHJzID0gQXJyYXkuaXNBcnJheShvcHRpb25zKSA/IG9wdGlvbnMgOiBvcHRpb25zLmtleUF0dHJzOwogICAgY29uc3QgbWF4U3RyaW5nTGVuZ3RoID0gKCFBcnJheS5pc0FycmF5KG9wdGlvbnMpICYmIG9wdGlvbnMubWF4U3RyaW5nTGVuZ3RoKSB8fCBERUZBVUxUX01BWF9TVFJJTkdfTEVOR1RIOwoKICAgIHdoaWxlIChjdXJyZW50RWxlbSAmJiBoZWlnaHQrKyA8IE1BWF9UUkFWRVJTRV9IRUlHSFQpIHsKICAgICAgbmV4dFN0ciA9IF9odG1sRWxlbWVudEFzU3RyaW5nKGN1cnJlbnRFbGVtLCBrZXlBdHRycyk7CiAgICAgIC8vIGJhaWwgb3V0IGlmCiAgICAgIC8vIC0gbmV4dFN0ciBpcyB0aGUgJ2h0bWwnIGVsZW1lbnQKICAgICAgLy8gLSB0aGUgbGVuZ3RoIG9mIHRoZSBzdHJpbmcgdGhhdCB3b3VsZCBiZSBjcmVhdGVkIGV4Y2VlZHMgbWF4U3RyaW5nTGVuZ3RoCiAgICAgIC8vICAgKGlnbm9yZSB0aGlzIGxpbWl0IGlmIHdlIGFyZSBvbiB0aGUgZmlyc3QgaXRlcmF0aW9uKQogICAgICBpZiAobmV4dFN0ciA9PT0gJ2h0bWwnIHx8IChoZWlnaHQgPiAxICYmIGxlbiArIG91dC5sZW5ndGggKiBzZXBMZW5ndGggKyBuZXh0U3RyLmxlbmd0aCA+PSBtYXhTdHJpbmdMZW5ndGgpKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIG91dC5wdXNoKG5leHRTdHIpOwoKICAgICAgbGVuICs9IG5leHRTdHIubGVuZ3RoOwogICAgICBjdXJyZW50RWxlbSA9IGN1cnJlbnRFbGVtLnBhcmVudE5vZGU7CiAgICB9CgogICAgcmV0dXJuIG91dC5yZXZlcnNlKCkuam9pbihzZXBhcmF0b3IpOwogIH0gY2F0Y2ggKF9vTykgewogICAgcmV0dXJuICc8dW5rbm93bj4nOwogIH0KfQoKLyoqCiAqIFJldHVybnMgYSBzaW1wbGUsIHF1ZXJ5LXNlbGVjdG9yIHJlcHJlc2VudGF0aW9uIG9mIGEgRE9NIGVsZW1lbnQKICogZS5nLiBbSFRNTEVsZW1lbnRdID0+IGlucHV0I2Zvby5idG5bbmFtZT1iYXpdCiAqIEByZXR1cm5zIGdlbmVyYXRlZCBET00gcGF0aAogKi8KZnVuY3Rpb24gX2h0bWxFbGVtZW50QXNTdHJpbmcoZWwsIGtleUF0dHJzKSB7CiAgY29uc3QgZWxlbSA9IGVsCgo7CgogIGNvbnN0IG91dCA9IFtdOwogIGxldCBjbGFzc05hbWU7CiAgbGV0IGNsYXNzZXM7CiAgbGV0IGtleTsKICBsZXQgYXR0cjsKICBsZXQgaTsKCiAgaWYgKCFlbGVtIHx8ICFlbGVtLnRhZ05hbWUpIHsKICAgIHJldHVybiAnJzsKICB9CgogIC8vIEB0cy1leHBlY3QtZXJyb3IgV0lORE9XIGhhcyBIVE1MRWxlbWVudAogIGlmIChXSU5ET1cuSFRNTEVsZW1lbnQpIHsKICAgIC8vIElmIHVzaW5nIHRoZSBjb21wb25lbnQgbmFtZSBhbm5vdGF0aW9uIHBsdWdpbiwgdGhpcyB2YWx1ZSBtYXkgYmUgYXZhaWxhYmxlIG9uIHRoZSBET00gbm9kZQogICAgaWYgKGVsZW0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiBlbGVtLmRhdGFzZXQgJiYgZWxlbS5kYXRhc2V0WydzZW50cnlDb21wb25lbnQnXSkgewogICAgICByZXR1cm4gZWxlbS5kYXRhc2V0WydzZW50cnlDb21wb25lbnQnXTsKICAgIH0KICB9CgogIG91dC5wdXNoKGVsZW0udGFnTmFtZS50b0xvd2VyQ2FzZSgpKTsKCiAgLy8gUGFpcnMgb2YgYXR0cmlidXRlIGtleXMgZGVmaW5lZCBpbiBgc2VyaWFsaXplQXR0cmlidXRlYCBhbmQgdGhlaXIgdmFsdWVzIG9uIGVsZW1lbnQuCiAgY29uc3Qga2V5QXR0clBhaXJzID0KICAgIGtleUF0dHJzICYmIGtleUF0dHJzLmxlbmd0aAogICAgICA/IGtleUF0dHJzLmZpbHRlcihrZXlBdHRyID0+IGVsZW0uZ2V0QXR0cmlidXRlKGtleUF0dHIpKS5tYXAoa2V5QXR0ciA9PiBba2V5QXR0ciwgZWxlbS5nZXRBdHRyaWJ1dGUoa2V5QXR0cildKQogICAgICA6IG51bGw7CgogIGlmIChrZXlBdHRyUGFpcnMgJiYga2V5QXR0clBhaXJzLmxlbmd0aCkgewogICAga2V5QXR0clBhaXJzLmZvckVhY2goa2V5QXR0clBhaXIgPT4gewogICAgICBvdXQucHVzaChgWyR7a2V5QXR0clBhaXJbMF19PSIke2tleUF0dHJQYWlyWzFdfSJdYCk7CiAgICB9KTsKICB9IGVsc2UgewogICAgaWYgKGVsZW0uaWQpIHsKICAgICAgb3V0LnB1c2goYCMke2VsZW0uaWR9YCk7CiAgICB9CgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdAogICAgY2xhc3NOYW1lID0gZWxlbS5jbGFzc05hbWU7CiAgICBpZiAoY2xhc3NOYW1lICYmIGlzU3RyaW5nKGNsYXNzTmFtZSkpIHsKICAgICAgY2xhc3NlcyA9IGNsYXNzTmFtZS5zcGxpdCgvXHMrLyk7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBjbGFzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgb3V0LnB1c2goYC4ke2NsYXNzZXNbaV19YCk7CiAgICAgIH0KICAgIH0KICB9CiAgY29uc3QgYWxsb3dlZEF0dHJzID0gWydhcmlhLWxhYmVsJywgJ3R5cGUnLCAnbmFtZScsICd0aXRsZScsICdhbHQnXTsKICBmb3IgKGkgPSAwOyBpIDwgYWxsb3dlZEF0dHJzLmxlbmd0aDsgaSsrKSB7CiAgICBrZXkgPSBhbGxvd2VkQXR0cnNbaV07CiAgICBhdHRyID0gZWxlbS5nZXRBdHRyaWJ1dGUoa2V5KTsKICAgIGlmIChhdHRyKSB7CiAgICAgIG91dC5wdXNoKGBbJHtrZXl9PSIke2F0dHJ9Il1gKTsKICAgIH0KICB9CiAgcmV0dXJuIG91dC5qb2luKCcnKTsKfQoKLyoqCiAqIFRoaXMgc2VydmVzIGFzIGEgYnVpbGQgdGltZSBmbGFnIHRoYXQgd2lsbCBiZSB0cnVlIGJ5IGRlZmF1bHQsIGJ1dCBmYWxzZSBpbiBub24tZGVidWcgYnVpbGRzIG9yIGlmIHVzZXJzIHJlcGxhY2UgYF9fU0VOVFJZX0RFQlVHX19gIGluIHRoZWlyIGdlbmVyYXRlZCBjb2RlLgogKgogKiBBVFRFTlRJT046IFRoaXMgY29uc3RhbnQgbXVzdCBuZXZlciBjcm9zcyBwYWNrYWdlIGJvdW5kYXJpZXMgKGkuZS4gYmUgZXhwb3J0ZWQpIHRvIGd1YXJhbnRlZSB0aGF0IGl0IGNhbiBiZSB1c2VkIGZvciB0cmVlIHNoYWtpbmcuCiAqLwpjb25zdCBERUJVR19CVUlMRCQxID0gKHR5cGVvZiBfX1NFTlRSWV9ERUJVR19fID09PSAndW5kZWZpbmVkJyB8fCBfX1NFTlRSWV9ERUJVR19fKTsKCi8qKiBQcmVmaXggZm9yIGxvZ2dpbmcgc3RyaW5ncyAqLwpjb25zdCBQUkVGSVggPSAnU2VudHJ5IExvZ2dlciAnOwoKY29uc3QgQ09OU09MRV9MRVZFTFMgPSBbCiAgJ2RlYnVnJywKICAnaW5mbycsCiAgJ3dhcm4nLAogICdlcnJvcicsCiAgJ2xvZycsCiAgJ2Fzc2VydCcsCiAgJ3RyYWNlJywKXSA7CgovKiogVGhpcyBtYXkgYmUgbXV0YXRlZCBieSB0aGUgY29uc29sZSBpbnN0cnVtZW50YXRpb24uICovCmNvbnN0IG9yaWdpbmFsQ29uc29sZU1ldGhvZHMKCiA9IHt9OwoKLyoqIEpTRG9jICovCgovKioKICogVGVtcG9yYXJpbHkgZGlzYWJsZSBzZW50cnkgY29uc29sZSBpbnN0cnVtZW50YXRpb25zLgogKgogKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIHJ1biBhZ2FpbnN0IHRoZSBvcmlnaW5hbCBgY29uc29sZWAgbWVzc2FnZXMKICogQHJldHVybnMgVGhlIHJlc3VsdHMgb2YgdGhlIGNhbGxiYWNrCiAqLwpmdW5jdGlvbiBjb25zb2xlU2FuZGJveChjYWxsYmFjaykgewogIGlmICghKCdjb25zb2xlJyBpbiBHTE9CQUxfT0JKKSkgewogICAgcmV0dXJuIGNhbGxiYWNrKCk7CiAgfQoKICBjb25zdCBjb25zb2xlID0gR0xPQkFMX09CSi5jb25zb2xlIDsKICBjb25zdCB3cmFwcGVkRnVuY3MgPSB7fTsKCiAgY29uc3Qgd3JhcHBlZExldmVscyA9IE9iamVjdC5rZXlzKG9yaWdpbmFsQ29uc29sZU1ldGhvZHMpIDsKCiAgLy8gUmVzdG9yZSBhbGwgd3JhcHBlZCBjb25zb2xlIG1ldGhvZHMKICB3cmFwcGVkTGV2ZWxzLmZvckVhY2gobGV2ZWwgPT4gewogICAgY29uc3Qgb3JpZ2luYWxDb25zb2xlTWV0aG9kID0gb3JpZ2luYWxDb25zb2xlTWV0aG9kc1tsZXZlbF0gOwogICAgd3JhcHBlZEZ1bmNzW2xldmVsXSA9IGNvbnNvbGVbbGV2ZWxdIDsKICAgIGNvbnNvbGVbbGV2ZWxdID0gb3JpZ2luYWxDb25zb2xlTWV0aG9kOwogIH0pOwoKICB0cnkgewogICAgcmV0dXJuIGNhbGxiYWNrKCk7CiAgfSBmaW5hbGx5IHsKICAgIC8vIFJldmVydCByZXN0b3JhdGlvbiB0byB3cmFwcGVkIHN0YXRlCiAgICB3cmFwcGVkTGV2ZWxzLmZvckVhY2gobGV2ZWwgPT4gewogICAgICBjb25zb2xlW2xldmVsXSA9IHdyYXBwZWRGdW5jc1tsZXZlbF0gOwogICAgfSk7CiAgfQp9CgpmdW5jdGlvbiBtYWtlTG9nZ2VyKCkgewogIGxldCBlbmFibGVkID0gZmFsc2U7CiAgY29uc3QgbG9nZ2VyID0gewogICAgZW5hYmxlOiAoKSA9PiB7CiAgICAgIGVuYWJsZWQgPSB0cnVlOwogICAgfSwKICAgIGRpc2FibGU6ICgpID0+IHsKICAgICAgZW5hYmxlZCA9IGZhbHNlOwogICAgfSwKICAgIGlzRW5hYmxlZDogKCkgPT4gZW5hYmxlZCwKICB9OwoKICBpZiAoREVCVUdfQlVJTEQkMSkgewogICAgQ09OU09MRV9MRVZFTFMuZm9yRWFjaChuYW1lID0+IHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkKICAgICAgbG9nZ2VyW25hbWVdID0gKC4uLmFyZ3MpID0+IHsKICAgICAgICBpZiAoZW5hYmxlZCkgewogICAgICAgICAgY29uc29sZVNhbmRib3goKCkgPT4gewogICAgICAgICAgICBHTE9CQUxfT0JKLmNvbnNvbGVbbmFtZV0oYCR7UFJFRklYfVske25hbWV9XTpgLCAuLi5hcmdzKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICBDT05TT0xFX0xFVkVMUy5mb3JFYWNoKG5hbWUgPT4gewogICAgICBsb2dnZXJbbmFtZV0gPSAoKSA9PiB1bmRlZmluZWQ7CiAgICB9KTsKICB9CgogIHJldHVybiBsb2dnZXIgOwp9Cgpjb25zdCBsb2dnZXIgPSBtYWtlTG9nZ2VyKCk7CgovKioKICogUmVuZGVycyB0aGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgRHNuLgogKgogKiBCeSBkZWZhdWx0LCB0aGlzIHdpbGwgcmVuZGVyIHRoZSBwdWJsaWMgcmVwcmVzZW50YXRpb24gd2l0aG91dCB0aGUgcGFzc3dvcmQKICogY29tcG9uZW50LiBUbyBnZXQgdGhlIGRlcHJlY2F0ZWQgcHJpdmF0ZSByZXByZXNlbnRhdGlvbiwgc2V0IGB3aXRoUGFzc3dvcmRgCiAqIHRvIHRydWUuCiAqCiAqIEBwYXJhbSB3aXRoUGFzc3dvcmQgV2hlbiBzZXQgdG8gdHJ1ZSwgdGhlIHBhc3N3b3JkIHdpbGwgYmUgaW5jbHVkZWQuCiAqLwpmdW5jdGlvbiBkc25Ub1N0cmluZyhkc24sIHdpdGhQYXNzd29yZCA9IGZhbHNlKSB7CiAgY29uc3QgeyBob3N0LCBwYXRoLCBwYXNzLCBwb3J0LCBwcm9qZWN0SWQsIHByb3RvY29sLCBwdWJsaWNLZXkgfSA9IGRzbjsKICByZXR1cm4gKAogICAgYCR7cHJvdG9jb2x9Oi8vJHtwdWJsaWNLZXl9JHt3aXRoUGFzc3dvcmQgJiYgcGFzcyA/IGA6JHtwYXNzfWAgOiAnJ31gICsKICAgIGBAJHtob3N0fSR7cG9ydCA/IGA6JHtwb3J0fWAgOiAnJ30vJHtwYXRoID8gYCR7cGF0aH0vYCA6IHBhdGh9JHtwcm9qZWN0SWR9YAogICk7Cn0KCi8qKiBBbiBlcnJvciBlbWl0dGVkIGJ5IFNlbnRyeSBTREtzIGFuZCByZWxhdGVkIHV0aWxpdGllcy4gKi8KY2xhc3MgU2VudHJ5RXJyb3IgZXh0ZW5kcyBFcnJvciB7CiAgLyoqIERpc3BsYXkgbmFtZSBvZiB0aGlzIGVycm9yIGluc3RhbmNlLiAqLwoKICAgY29uc3RydWN0b3IoIG1lc3NhZ2UsIGxvZ0xldmVsID0gJ3dhcm4nKSB7CiAgICBzdXBlcihtZXNzYWdlKTt0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOwogICAgdGhpcy5uYW1lID0gbmV3LnRhcmdldC5wcm90b3R5cGUuY29uc3RydWN0b3IubmFtZTsKICAgIC8vIFRoaXMgc2V0cyB0aGUgcHJvdG90eXBlIHRvIGJlIGBFcnJvcmAsIG5vdCBgU2VudHJ5RXJyb3JgLiBJdCdzIHVuY2xlYXIgd2h5IHdlIGRvIHRoaXMsIGJ1dCBjb21tZW50aW5nIHRoaXMgbGluZQogICAgLy8gb3V0IGNhdXNlcyB2YXJpb3VzIChzZWVtaW5nbHkgdG90YWxseSB1bnJlbGF0ZWQpIHBsYXl3cmlnaHQgdGVzdHMgY29uc2lzdGVudGx5IHRpbWUgb3V0LiBGWUksIHRoaXMgbWFrZXMKICAgIC8vIGluc3RhbmNlcyBvZiBgU2VudHJ5RXJyb3JgIGZhaWwgYG9iaiBpbnN0YW5jZW9mIFNlbnRyeUVycm9yYCBjaGVja3MuCiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgbmV3LnRhcmdldC5wcm90b3R5cGUpOwogICAgdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsOwogIH0KfQoKLyoqCiAqIEVuY29kZXMgZ2l2ZW4gb2JqZWN0IGludG8gdXJsLWZyaWVuZGx5IGZvcm1hdAogKgogKiBAcGFyYW0gb2JqZWN0IEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHNlcmlhbGl6YWJsZSB2YWx1ZXMKICogQHJldHVybnMgc3RyaW5nIEVuY29kZWQKICovCmZ1bmN0aW9uIHVybEVuY29kZShvYmplY3QpIHsKICByZXR1cm4gT2JqZWN0LmtleXMob2JqZWN0KQogICAgLm1hcChrZXkgPT4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KG9iamVjdFtrZXldKX1gKQogICAgLmpvaW4oJyYnKTsKfQoKLyoqCiAqIFRyYW5zZm9ybXMgYW55IGBFcnJvcmAgb3IgYEV2ZW50YCBpbnRvIGEgcGxhaW4gb2JqZWN0IHdpdGggYWxsIG9mIHRoZWlyIGVudW1lcmFibGUgcHJvcGVydGllcywgYW5kIHNvbWUgb2YgdGhlaXIKICogbm9uLWVudW1lcmFibGUgcHJvcGVydGllcyBhdHRhY2hlZC4KICoKICogQHBhcmFtIHZhbHVlIEluaXRpYWwgc291cmNlIHRoYXQgd2UgaGF2ZSB0byB0cmFuc2Zvcm0gaW4gb3JkZXIgZm9yIGl0IHRvIGJlIHVzYWJsZSBieSB0aGUgc2VyaWFsaXplcgogKiBAcmV0dXJucyBBbiBFdmVudCBvciBFcnJvciB0dXJuZWQgaW50byBhbiBvYmplY3QgLSBvciB0aGUgdmFsdWUgYXJndXJtZW50IGl0c2VsZiwgd2hlbiB2YWx1ZSBpcyBuZWl0aGVyIGFuIEV2ZW50IG5vcgogKiAgYW4gRXJyb3IuCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9QbGFpbk9iamVjdCgKICB2YWx1ZSwKKQoKIHsKICBpZiAoaXNFcnJvcih2YWx1ZSkpIHsKICAgIHJldHVybiB7CiAgICAgIG1lc3NhZ2U6IHZhbHVlLm1lc3NhZ2UsCiAgICAgIG5hbWU6IHZhbHVlLm5hbWUsCiAgICAgIHN0YWNrOiB2YWx1ZS5zdGFjaywKICAgICAgLi4uZ2V0T3duUHJvcGVydGllcyh2YWx1ZSksCiAgICB9OwogIH0gZWxzZSBpZiAoaXNFdmVudCh2YWx1ZSkpIHsKICAgIGNvbnN0IG5ld09iagoKID0gewogICAgICB0eXBlOiB2YWx1ZS50eXBlLAogICAgICB0YXJnZXQ6IHNlcmlhbGl6ZUV2ZW50VGFyZ2V0KHZhbHVlLnRhcmdldCksCiAgICAgIGN1cnJlbnRUYXJnZXQ6IHNlcmlhbGl6ZUV2ZW50VGFyZ2V0KHZhbHVlLmN1cnJlbnRUYXJnZXQpLAogICAgICAuLi5nZXRPd25Qcm9wZXJ0aWVzKHZhbHVlKSwKICAgIH07CgogICAgaWYgKHR5cGVvZiBDdXN0b21FdmVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgaXNJbnN0YW5jZU9mKHZhbHVlLCBDdXN0b21FdmVudCkpIHsKICAgICAgbmV3T2JqLmRldGFpbCA9IHZhbHVlLmRldGFpbDsKICAgIH0KCiAgICByZXR1cm4gbmV3T2JqOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdmFsdWU7CiAgfQp9CgovKiogQ3JlYXRlcyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgdGFyZ2V0IG9mIGFuIGBFdmVudGAgb2JqZWN0ICovCmZ1bmN0aW9uIHNlcmlhbGl6ZUV2ZW50VGFyZ2V0KHRhcmdldCkgewogIHRyeSB7CiAgICByZXR1cm4gaXNFbGVtZW50KHRhcmdldCkgPyBodG1sVHJlZUFzU3RyaW5nKHRhcmdldCkgOiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGFyZ2V0KTsKICB9IGNhdGNoIChfb08pIHsKICAgIHJldHVybiAnPHVua25vd24+JzsKICB9Cn0KCi8qKiBGaWx0ZXJzIG91dCBhbGwgYnV0IGFuIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzICovCmZ1bmN0aW9uIGdldE93blByb3BlcnRpZXMob2JqKSB7CiAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIG9iaiAhPT0gbnVsbCkgewogICAgY29uc3QgZXh0cmFjdGVkUHJvcHMgPSB7fTsKICAgIGZvciAoY29uc3QgcHJvcGVydHkgaW4gb2JqKSB7CiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wZXJ0eSkpIHsKICAgICAgICBleHRyYWN0ZWRQcm9wc1twcm9wZXJ0eV0gPSAob2JqIClbcHJvcGVydHldOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gZXh0cmFjdGVkUHJvcHM7CiAgfSBlbHNlIHsKICAgIHJldHVybiB7fTsKICB9Cn0KCi8qKgogKiBHaXZlbiBhbnkgb2JqZWN0LCByZXR1cm4gYSBuZXcgb2JqZWN0IGhhdmluZyByZW1vdmVkIGFsbCBmaWVsZHMgd2hvc2UgdmFsdWUgd2FzIGB1bmRlZmluZWRgLgogKiBXb3JrcyByZWN1cnNpdmVseSBvbiBvYmplY3RzIGFuZCBhcnJheXMuCiAqCiAqIEF0dGVudGlvbjogVGhpcyBmdW5jdGlvbiBrZWVwcyBjaXJjdWxhciByZWZlcmVuY2VzIGluIHRoZSByZXR1cm5lZCBvYmplY3QuCiAqLwpmdW5jdGlvbiBkcm9wVW5kZWZpbmVkS2V5cyhpbnB1dFZhbHVlKSB7CiAgLy8gVGhpcyBtYXAga2VlcHMgdHJhY2sgb2Ygd2hhdCBhbHJlYWR5IHZpc2l0ZWQgbm9kZXMgbWFwIHRvLgogIC8vIE91ciBTZXQgLSBiYXNlZCBtZW1vQnVpbGRlciBkb2Vzbid0IHdvcmsgaGVyZSBiZWNhdXNlIHdlIHdhbnQgdG8gdGhlIG91dHB1dCBvYmplY3QgdG8gaGF2ZSB0aGUgc2FtZSBjaXJjdWxhcgogIC8vIHJlZmVyZW5jZXMgYXMgdGhlIGlucHV0IG9iamVjdC4KICBjb25zdCBtZW1vaXphdGlvbk1hcCA9IG5ldyBNYXAoKTsKCiAgLy8gVGhpcyBmdW5jdGlvbiBqdXN0IHByb3hpZXMgYF9kcm9wVW5kZWZpbmVkS2V5c2AgdG8ga2VlcCB0aGUgYG1lbW9CdWlsZGVyYCBvdXQgb2YgdGhpcyBmdW5jdGlvbidzIEFQSQogIHJldHVybiBfZHJvcFVuZGVmaW5lZEtleXMoaW5wdXRWYWx1ZSwgbWVtb2l6YXRpb25NYXApOwp9CgpmdW5jdGlvbiBfZHJvcFVuZGVmaW5lZEtleXMoaW5wdXRWYWx1ZSwgbWVtb2l6YXRpb25NYXApIHsKICBpZiAoaXNQb2pvKGlucHV0VmFsdWUpKSB7CiAgICAvLyBJZiB0aGlzIG5vZGUgaGFzIGFscmVhZHkgYmVlbiB2aXNpdGVkIGR1ZSB0byBhIGNpcmN1bGFyIHJlZmVyZW5jZSwgcmV0dXJuIHRoZSBvYmplY3QgaXQgd2FzIG1hcHBlZCB0byBpbiB0aGUgbmV3IG9iamVjdAogICAgY29uc3QgbWVtb1ZhbCA9IG1lbW9pemF0aW9uTWFwLmdldChpbnB1dFZhbHVlKTsKICAgIGlmIChtZW1vVmFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIG1lbW9WYWwgOwogICAgfQoKICAgIGNvbnN0IHJldHVyblZhbHVlID0ge307CiAgICAvLyBTdG9yZSB0aGUgbWFwcGluZyBvZiB0aGlzIHZhbHVlIGluIGNhc2Ugd2UgdmlzaXQgaXQgYWdhaW4sIGluIGNhc2Ugb2YgY2lyY3VsYXIgZGF0YQogICAgbWVtb2l6YXRpb25NYXAuc2V0KGlucHV0VmFsdWUsIHJldHVyblZhbHVlKTsKCiAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhpbnB1dFZhbHVlKSkgewogICAgICBpZiAodHlwZW9mIGlucHV0VmFsdWVba2V5XSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICByZXR1cm5WYWx1ZVtrZXldID0gX2Ryb3BVbmRlZmluZWRLZXlzKGlucHV0VmFsdWVba2V5XSwgbWVtb2l6YXRpb25NYXApOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJldHVyblZhbHVlIDsKICB9CgogIGlmIChBcnJheS5pc0FycmF5KGlucHV0VmFsdWUpKSB7CiAgICAvLyBJZiB0aGlzIG5vZGUgaGFzIGFscmVhZHkgYmVlbiB2aXNpdGVkIGR1ZSB0byBhIGNpcmN1bGFyIHJlZmVyZW5jZSwgcmV0dXJuIHRoZSBhcnJheSBpdCB3YXMgbWFwcGVkIHRvIGluIHRoZSBuZXcgb2JqZWN0CiAgICBjb25zdCBtZW1vVmFsID0gbWVtb2l6YXRpb25NYXAuZ2V0KGlucHV0VmFsdWUpOwogICAgaWYgKG1lbW9WYWwgIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gbWVtb1ZhbCA7CiAgICB9CgogICAgY29uc3QgcmV0dXJuVmFsdWUgPSBbXTsKICAgIC8vIFN0b3JlIHRoZSBtYXBwaW5nIG9mIHRoaXMgdmFsdWUgaW4gY2FzZSB3ZSB2aXNpdCBpdCBhZ2FpbiwgaW4gY2FzZSBvZiBjaXJjdWxhciBkYXRhCiAgICBtZW1vaXphdGlvbk1hcC5zZXQoaW5wdXRWYWx1ZSwgcmV0dXJuVmFsdWUpOwoKICAgIGlucHV0VmFsdWUuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgICByZXR1cm5WYWx1ZS5wdXNoKF9kcm9wVW5kZWZpbmVkS2V5cyhpdGVtLCBtZW1vaXphdGlvbk1hcCkpOwogICAgfSk7CgogICAgcmV0dXJuIHJldHVyblZhbHVlIDsKICB9CgogIHJldHVybiBpbnB1dFZhbHVlOwp9CgpmdW5jdGlvbiBpc1Bvam8oaW5wdXQpIHsKICBpZiAoIWlzUGxhaW5PYmplY3QoaW5wdXQpKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICB0cnkgewogICAgY29uc3QgbmFtZSA9IChPYmplY3QuZ2V0UHJvdG90eXBlT2YoaW5wdXQpICkuY29uc3RydWN0b3IubmFtZTsKICAgIHJldHVybiAhbmFtZSB8fCBuYW1lID09PSAnT2JqZWN0JzsKICB9IGNhdGNoIChlKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKgogKiBEb2VzIHRoaXMgZmlsZW5hbWUgbG9vayBsaWtlIGl0J3MgcGFydCBvZiB0aGUgYXBwIGNvZGU/CiAqLwpmdW5jdGlvbiBmaWxlbmFtZUlzSW5BcHAoZmlsZW5hbWUsIGlzTmF0aXZlID0gZmFsc2UpIHsKICBjb25zdCBpc0ludGVybmFsID0KICAgIGlzTmF0aXZlIHx8CiAgICAoZmlsZW5hbWUgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgaXQncyBhbiBhYnNvbHV0ZSBsaW51eCBwYXRoCiAgICAgICFmaWxlbmFtZS5zdGFydHNXaXRoKCcvJykgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgaXQncyBhbiBhYnNvbHV0ZSB3aW5kb3dzIHBhdGgKICAgICAgIWZpbGVuYW1lLm1hdGNoKC9eW0EtWl06LykgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgdGhlIHBhdGggaXMgc3RhcnRpbmcgd2l0aCBhIGRvdAogICAgICAhZmlsZW5hbWUuc3RhcnRzV2l0aCgnLicpICYmCiAgICAgIC8vIEl0J3Mgbm90IGludGVybmFsIGlmIHRoZSBmcmFtZSBoYXMgYSBwcm90b2NvbC4gSW4gbm9kZSwgdGhpcyBpcyB1c3VhbGx5IHRoZSBjYXNlIGlmIHRoZSBmaWxlIGdvdCBwcmUtcHJvY2Vzc2VkIHdpdGggYSBidW5kbGVyIGxpa2Ugd2VicGFjawogICAgICAhZmlsZW5hbWUubWF0Y2goL15bYS16QS1aXShbYS16QS1aMC05LlwtK10pKjpcL1wvLykpOyAvLyBTY2hlbWEgZnJvbTogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM2NDE3ODIKCiAgLy8gaW5fYXBwIGlzIGFsbCB0aGF0J3Mgbm90IGFuIGludGVybmFsIE5vZGUgZnVuY3Rpb24gb3IgYSBtb2R1bGUgd2l0aGluIG5vZGVfbW9kdWxlcwogIC8vIG5vdGUgdGhhdCBpc05hdGl2ZSBhcHBlYXJzIHRvIHJldHVybiB0cnVlIGV2ZW4gZm9yIG5vZGUgY29yZSBsaWJyYXJpZXMKICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2dldHNlbnRyeS9yYXZlbi1ub2RlL2lzc3Vlcy8xNzYKCiAgcmV0dXJuICFpc0ludGVybmFsICYmIGZpbGVuYW1lICE9PSB1bmRlZmluZWQgJiYgIWZpbGVuYW1lLmluY2x1ZGVzKCdub2RlX21vZHVsZXMvJyk7Cn0KCmNvbnN0IFNUQUNLVFJBQ0VfRlJBTUVfTElNSVQgPSA1MDsKY29uc3QgU1RSSVBfRlJBTUVfUkVHRVhQID0gL2NhcHR1cmVNZXNzYWdlfGNhcHR1cmVFeGNlcHRpb24vOwoKLyoqCiAqIFJlbW92ZXMgU2VudHJ5IGZyYW1lcyBmcm9tIHRoZSB0b3AgYW5kIGJvdHRvbSBvZiB0aGUgc3RhY2sgaWYgcHJlc2VudCBhbmQgZW5mb3JjZXMgYSBsaW1pdCBvZiBtYXggbnVtYmVyIG9mIGZyYW1lcy4KICogQXNzdW1lcyBzdGFjayBpbnB1dCBpcyBvcmRlcmVkIGZyb20gdG9wIHRvIGJvdHRvbSBhbmQgcmV0dXJucyB0aGUgcmV2ZXJzZSByZXByZXNlbnRhdGlvbiBzbyBjYWxsIHNpdGUgb2YgdGhlCiAqIGZ1bmN0aW9uIHRoYXQgY2F1c2VkIHRoZSBjcmFzaCBpcyB0aGUgbGFzdCBmcmFtZSBpbiB0aGUgYXJyYXkuCiAqIEBoaWRkZW4KICovCmZ1bmN0aW9uIHN0cmlwU2VudHJ5RnJhbWVzQW5kUmV2ZXJzZShzdGFjaykgewogIGlmICghc3RhY2subGVuZ3RoKSB7CiAgICByZXR1cm4gW107CiAgfQoKICBjb25zdCBsb2NhbFN0YWNrID0gQXJyYXkuZnJvbShzdGFjayk7CgogIC8vIElmIHN0YWNrIHN0YXJ0cyB3aXRoIG9uZSBvZiBvdXIgQVBJIGNhbGxzLCByZW1vdmUgaXQgKHN0YXJ0cywgbWVhbmluZyBpdCdzIHRoZSB0b3Agb2YgdGhlIHN0YWNrIC0gYWthIGxhc3QgY2FsbCkKICBpZiAoL3NlbnRyeVdyYXBwZWQvLnRlc3QobG9jYWxTdGFja1tsb2NhbFN0YWNrLmxlbmd0aCAtIDFdLmZ1bmN0aW9uIHx8ICcnKSkgewogICAgbG9jYWxTdGFjay5wb3AoKTsKICB9CgogIC8vIFJldmVyc2luZyBpbiB0aGUgbWlkZGxlIG9mIHRoZSBwcm9jZWR1cmUgYWxsb3dzIHVzIHRvIGp1c3QgcG9wIHRoZSB2YWx1ZXMgb2ZmIHRoZSBzdGFjawogIGxvY2FsU3RhY2sucmV2ZXJzZSgpOwoKICAvLyBJZiBzdGFjayBlbmRzIHdpdGggb25lIG9mIG91ciBpbnRlcm5hbCBBUEkgY2FsbHMsIHJlbW92ZSBpdCAoZW5kcywgbWVhbmluZyBpdCdzIHRoZSBib3R0b20gb2YgdGhlIHN0YWNrIC0gYWthIHRvcC1tb3N0IGNhbGwpCiAgaWYgKFNUUklQX0ZSQU1FX1JFR0VYUC50ZXN0KGxvY2FsU3RhY2tbbG9jYWxTdGFjay5sZW5ndGggLSAxXS5mdW5jdGlvbiB8fCAnJykpIHsKICAgIGxvY2FsU3RhY2sucG9wKCk7CgogICAgLy8gV2hlbiB1c2luZyBzeW50aGV0aWMgZXZlbnRzLCB3ZSB3aWxsIGhhdmUgYSAyIGxldmVscyBkZWVwIHN0YWNrLCBhcyBgbmV3IEVycm9yKCdTZW50cnkgc3ludGhldGljRXhjZXB0aW9uJylgCiAgICAvLyBpcyBwcm9kdWNlZCB3aXRoaW4gdGhlIGh1YiBpdHNlbGYsIG1ha2luZyBpdDoKICAgIC8vCiAgICAvLyAgIFNlbnRyeS5jYXB0dXJlRXhjZXB0aW9uKCkKICAgIC8vICAgZ2V0Q3VycmVudEh1YigpLmNhcHR1cmVFeGNlcHRpb24oKQogICAgLy8KICAgIC8vIGluc3RlYWQgb2YganVzdCB0aGUgdG9wIGBTZW50cnlgIGNhbGwgaXRzZWxmLgogICAgLy8gVGhpcyBmb3JjZXMgdXMgdG8gcG9zc2libHkgc3RyaXAgYW4gYWRkaXRpb25hbCBmcmFtZSBpbiB0aGUgZXhhY3Qgc2FtZSB3YXMgYXMgYWJvdmUuCiAgICBpZiAoU1RSSVBfRlJBTUVfUkVHRVhQLnRlc3QobG9jYWxTdGFja1tsb2NhbFN0YWNrLmxlbmd0aCAtIDFdLmZ1bmN0aW9uIHx8ICcnKSkgewogICAgICBsb2NhbFN0YWNrLnBvcCgpOwogICAgfQogIH0KCiAgcmV0dXJuIGxvY2FsU3RhY2suc2xpY2UoMCwgU1RBQ0tUUkFDRV9GUkFNRV9MSU1JVCkubWFwKGZyYW1lID0+ICh7CiAgICAuLi5mcmFtZSwKICAgIGZpbGVuYW1lOiBmcmFtZS5maWxlbmFtZSB8fCBsb2NhbFN0YWNrW2xvY2FsU3RhY2subGVuZ3RoIC0gMV0uZmlsZW5hbWUsCiAgICBmdW5jdGlvbjogZnJhbWUuZnVuY3Rpb24gfHwgJz8nLAogIH0pKTsKfQoKY29uc3QgZGVmYXVsdEZ1bmN0aW9uTmFtZSA9ICc8YW5vbnltb3VzPic7CgovKioKICogU2FmZWx5IGV4dHJhY3QgZnVuY3Rpb24gbmFtZSBmcm9tIGl0c2VsZgogKi8KZnVuY3Rpb24gZ2V0RnVuY3Rpb25OYW1lKGZuKSB7CiAgdHJ5IHsKICAgIGlmICghZm4gfHwgdHlwZW9mIGZuICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBkZWZhdWx0RnVuY3Rpb25OYW1lOwogICAgfQogICAgcmV0dXJuIGZuLm5hbWUgfHwgZGVmYXVsdEZ1bmN0aW9uTmFtZTsKICB9IGNhdGNoIChlKSB7CiAgICAvLyBKdXN0IGFjY2Vzc2luZyBjdXN0b20gcHJvcHMgaW4gc29tZSBTZWxlbml1bSBlbnZpcm9ubWVudHMKICAgIC8vIGNhbiBjYXVzZSBhICJQZXJtaXNzaW9uIGRlbmllZCIgZXhjZXB0aW9uIChzZWUgcmF2ZW4tanMjNDk1KS4KICAgIHJldHVybiBkZWZhdWx0RnVuY3Rpb25OYW1lOwogIH0KfQoKLyoqCiAqIFVVSUQ0IGdlbmVyYXRvcgogKgogKiBAcmV0dXJucyBzdHJpbmcgR2VuZXJhdGVkIFVVSUQ0LgogKi8KZnVuY3Rpb24gdXVpZDQoKSB7CiAgY29uc3QgZ2JsID0gR0xPQkFMX09CSiA7CiAgY29uc3QgY3J5cHRvID0gZ2JsLmNyeXB0byB8fCBnYmwubXNDcnlwdG87CgogIGxldCBnZXRSYW5kb21CeXRlID0gKCkgPT4gTWF0aC5yYW5kb20oKSAqIDE2OwogIHRyeSB7CiAgICBpZiAoY3J5cHRvICYmIGNyeXB0by5yYW5kb21VVUlEKSB7CiAgICAgIHJldHVybiBjcnlwdG8ucmFuZG9tVVVJRCgpLnJlcGxhY2UoLy0vZywgJycpOwogICAgfQogICAgaWYgKGNyeXB0byAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKSB7CiAgICAgIGdldFJhbmRvbUJ5dGUgPSAoKSA9PiB7CiAgICAgICAgLy8gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyBtaWdodCByZXR1cm4gdW5kZWZpbmVkIGluc3RlYWQgb2YgdGhlIHR5cGVkIGFycmF5CiAgICAgICAgLy8gaW4gb2xkIENocm9taXVtIHZlcnNpb25zIChlLmcuIDIzLjAuMTIzNS4wICgxNTE0MjIpKQogICAgICAgIC8vIEhvd2V2ZXIsIGB0eXBlZEFycmF5YCBpcyBzdGlsbCBmaWxsZWQgaW4tcGxhY2UuCiAgICAgICAgLy8gQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ3J5cHRvL2dldFJhbmRvbVZhbHVlcyN0eXBlZGFycmF5CiAgICAgICAgY29uc3QgdHlwZWRBcnJheSA9IG5ldyBVaW50OEFycmF5KDEpOwogICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXModHlwZWRBcnJheSk7CiAgICAgICAgcmV0dXJuIHR5cGVkQXJyYXlbMF07CiAgICAgIH07CiAgICB9CiAgfSBjYXRjaCAoXykgewogICAgLy8gc29tZSBydW50aW1lcyBjYW4gY3Jhc2ggaW52b2tpbmcgY3J5cHRvCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L2lzc3Vlcy84OTM1CiAgfQoKICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwNTAzNC9ob3ctdG8tY3JlYXRlLWEtZ3VpZC11dWlkLWluLWphdmFzY3JpcHQvMjExNzUyMyMyMTE3NTIzCiAgLy8gQ29uY2F0ZW5hdGluZyB0aGUgZm9sbG93aW5nIG51bWJlcnMgYXMgc3RyaW5ncyByZXN1bHRzIGluICcxMDAwMDAwMDEwMDA0MDAwODAwMDEwMDAwMDAwMDAwMCcKICByZXR1cm4gKChbMWU3XSApICsgMWUzICsgNGUzICsgOGUzICsgMWUxMSkucmVwbGFjZSgvWzAxOF0vZywgYyA9PgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWJpdHdpc2UKICAgICgoYyApIF4gKChnZXRSYW5kb21CeXRlKCkgJiAxNSkgPj4gKChjICkgLyA0KSkpLnRvU3RyaW5nKDE2KSwKICApOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgdGhlIGdpdmVuIGlucHV0IGlzIGFscmVhZHkgYW4gYXJyYXksIGFuZCBpZiBpdCBpc24ndCwgd3JhcHMgaXQgaW4gb25lLgogKgogKiBAcGFyYW0gbWF5YmVBcnJheSBJbnB1dCB0byB0dXJuIGludG8gYW4gYXJyYXksIGlmIG5lY2Vzc2FyeQogKiBAcmV0dXJucyBUaGUgaW5wdXQsIGlmIGFscmVhZHkgYW4gYXJyYXksIG9yIGFuIGFycmF5IHdpdGggdGhlIGlucHV0IGFzIHRoZSBvbmx5IGVsZW1lbnQsIGlmIG5vdAogKi8KZnVuY3Rpb24gYXJyYXlpZnkobWF5YmVBcnJheSkgewogIHJldHVybiBBcnJheS5pc0FycmF5KG1heWJlQXJyYXkpID8gbWF5YmVBcnJheSA6IFttYXliZUFycmF5XTsKfQoKLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzICovCi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi8KCi8qKgogKiBIZWxwZXIgdG8gZGVjeWNsZSBqc29uIG9iamVjdHMKICovCmZ1bmN0aW9uIG1lbW9CdWlsZGVyKCkgewogIGNvbnN0IGhhc1dlYWtTZXQgPSB0eXBlb2YgV2Vha1NldCA9PT0gJ2Z1bmN0aW9uJzsKICBjb25zdCBpbm5lciA9IGhhc1dlYWtTZXQgPyBuZXcgV2Vha1NldCgpIDogW107CiAgZnVuY3Rpb24gbWVtb2l6ZShvYmopIHsKICAgIGlmIChoYXNXZWFrU2V0KSB7CiAgICAgIGlmIChpbm5lci5oYXMob2JqKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIGlubmVyLmFkZChvYmopOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3ByZWZlci1mb3Itb2YKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5uZXIubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgdmFsdWUgPSBpbm5lcltpXTsKICAgICAgaWYgKHZhbHVlID09PSBvYmopIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogICAgaW5uZXIucHVzaChvYmopOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gdW5tZW1vaXplKG9iaikgewogICAgaWYgKGhhc1dlYWtTZXQpIHsKICAgICAgaW5uZXIuZGVsZXRlKG9iaik7CiAgICB9IGVsc2UgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlubmVyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGlubmVyW2ldID09PSBvYmopIHsKICAgICAgICAgIGlubmVyLnNwbGljZShpLCAxKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICByZXR1cm4gW21lbW9pemUsIHVubWVtb2l6ZV07Cn0KCi8qKgogKiBSZWN1cnNpdmVseSBub3JtYWxpemVzIHRoZSBnaXZlbiBvYmplY3QuCiAqCiAqIC0gQ3JlYXRlcyBhIGNvcHkgdG8gcHJldmVudCBvcmlnaW5hbCBpbnB1dCBtdXRhdGlvbgogKiAtIFNraXBzIG5vbi1lbnVtZXJhYmxlIHByb3BlcnRpZXMKICogLSBXaGVuIHN0cmluZ2lmeWluZywgY2FsbHMgYHRvSlNPTmAgaWYgaW1wbGVtZW50ZWQKICogLSBSZW1vdmVzIGNpcmN1bGFyIHJlZmVyZW5jZXMKICogLSBUcmFuc2xhdGVzIG5vbi1zZXJpYWxpemFibGUgdmFsdWVzIChgdW5kZWZpbmVkYC9gTmFOYC9mdW5jdGlvbnMpIHRvIHNlcmlhbGl6YWJsZSBmb3JtYXQKICogLSBUcmFuc2xhdGVzIGtub3duIGdsb2JhbCBvYmplY3RzL2NsYXNzZXMgdG8gYSBzdHJpbmcgcmVwcmVzZW50YXRpb25zCiAqIC0gVGFrZXMgY2FyZSBvZiBgRXJyb3JgIG9iamVjdCBzZXJpYWxpemF0aW9uCiAqIC0gT3B0aW9uYWxseSBsaW1pdHMgZGVwdGggb2YgZmluYWwgb3V0cHV0CiAqIC0gT3B0aW9uYWxseSBsaW1pdHMgbnVtYmVyIG9mIHByb3BlcnRpZXMvZWxlbWVudHMgaW5jbHVkZWQgaW4gYW55IHNpbmdsZSBvYmplY3QvYXJyYXkKICoKICogQHBhcmFtIGlucHV0IFRoZSBvYmplY3QgdG8gYmUgbm9ybWFsaXplZC4KICogQHBhcmFtIGRlcHRoIFRoZSBtYXggZGVwdGggdG8gd2hpY2ggdG8gbm9ybWFsaXplIHRoZSBvYmplY3QuIChBbnl0aGluZyBkZWVwZXIgc3RyaW5naWZpZWQgd2hvbGUuKQogKiBAcGFyYW0gbWF4UHJvcGVydGllcyBUaGUgbWF4IG51bWJlciBvZiBlbGVtZW50cyBvciBwcm9wZXJ0aWVzIHRvIGJlIGluY2x1ZGVkIGluIGFueSBzaW5nbGUgYXJyYXkgb3IKICogb2JqZWN0IGluIHRoZSBub3JtYWxsaXplZCBvdXRwdXQuCiAqIEByZXR1cm5zIEEgbm9ybWFsaXplZCB2ZXJzaW9uIG9mIHRoZSBvYmplY3QsIG9yIGAiKipub24tc2VyaWFsaXphYmxlKioiYCBpZiBhbnkgZXJyb3JzIGFyZSB0aHJvd24gZHVyaW5nIG5vcm1hbGl6YXRpb24uCiAqLwovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQpmdW5jdGlvbiBub3JtYWxpemUoaW5wdXQsIGRlcHRoID0gMTAwLCBtYXhQcm9wZXJ0aWVzID0gK0luZmluaXR5KSB7CiAgdHJ5IHsKICAgIC8vIHNpbmNlIHdlJ3JlIGF0IHRoZSBvdXRlcm1vc3QgbGV2ZWwsIHdlIGRvbid0IHByb3ZpZGUgYSBrZXkKICAgIHJldHVybiB2aXNpdCgnJywgaW5wdXQsIGRlcHRoLCBtYXhQcm9wZXJ0aWVzKTsKICB9IGNhdGNoIChlcnIpIHsKICAgIHJldHVybiB7IEVSUk9SOiBgKipub24tc2VyaWFsaXphYmxlKiogKCR7ZXJyfSlgIH07CiAgfQp9CgovKioKICogVmlzaXRzIGEgbm9kZSB0byBwZXJmb3JtIG5vcm1hbGl6YXRpb24gb24gaXQKICoKICogQHBhcmFtIGtleSBUaGUga2V5IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIG5vZGUKICogQHBhcmFtIHZhbHVlIFRoZSBub2RlIHRvIGJlIHZpc2l0ZWQKICogQHBhcmFtIGRlcHRoIE9wdGlvbmFsIG51bWJlciBpbmRpY2F0aW5nIHRoZSBtYXhpbXVtIHJlY3Vyc2lvbiBkZXB0aAogKiBAcGFyYW0gbWF4UHJvcGVydGllcyBPcHRpb25hbCBtYXhpbXVtIG51bWJlciBvZiBwcm9wZXJ0aWVzL2VsZW1lbnRzIGluY2x1ZGVkIGluIGFueSBzaW5nbGUgb2JqZWN0L2FycmF5CiAqIEBwYXJhbSBtZW1vIE9wdGlvbmFsIE1lbW8gY2xhc3MgaGFuZGxpbmcgZGVjeWNsaW5nCiAqLwpmdW5jdGlvbiB2aXNpdCgKICBrZXksCiAgdmFsdWUsCiAgZGVwdGggPSArSW5maW5pdHksCiAgbWF4UHJvcGVydGllcyA9ICtJbmZpbml0eSwKICBtZW1vID0gbWVtb0J1aWxkZXIoKSwKKSB7CiAgY29uc3QgW21lbW9pemUsIHVubWVtb2l6ZV0gPSBtZW1vOwoKICAvLyBHZXQgdGhlIHNpbXBsZSBjYXNlcyBvdXQgb2YgdGhlIHdheSBmaXJzdAogIGlmICgKICAgIHZhbHVlID09IG51bGwgfHwgLy8gdGhpcyBtYXRjaGVzIG51bGwgYW5kIHVuZGVmaW5lZCAtPiBlcWVxIG5vdCBlcWVxZXEKICAgIChbJ251bWJlcicsICdib29sZWFuJywgJ3N0cmluZyddLmluY2x1ZGVzKHR5cGVvZiB2YWx1ZSkgJiYgIWlzTmFOJDEodmFsdWUpKQogICkgewogICAgcmV0dXJuIHZhbHVlIDsKICB9CgogIGNvbnN0IHN0cmluZ2lmaWVkID0gc3RyaW5naWZ5VmFsdWUoa2V5LCB2YWx1ZSk7CgogIC8vIEFueXRoaW5nIHdlIGNvdWxkIHBvdGVudGlhbGx5IGRpZyBpbnRvIG1vcmUgKG9iamVjdHMgb3IgYXJyYXlzKSB3aWxsIGhhdmUgY29tZSBiYWNrIGFzIGAiW29iamVjdCBYWFhYXSJgLgogIC8vIEV2ZXJ5dGhpbmcgZWxzZSB3aWxsIGhhdmUgYWxyZWFkeSBiZWVuIHNlcmlhbGl6ZWQsIHNvIGlmIHdlIGRvbid0IHNlZSB0aGF0IHBhdHRlcm4sIHdlJ3JlIGRvbmUuCiAgaWYgKCFzdHJpbmdpZmllZC5zdGFydHNXaXRoKCdbb2JqZWN0ICcpKSB7CiAgICByZXR1cm4gc3RyaW5naWZpZWQ7CiAgfQoKICAvLyBGcm9tIGhlcmUgb24sIHdlIGNhbiBhc3NlcnQgdGhhdCBgdmFsdWVgIGlzIGVpdGhlciBhbiBvYmplY3Qgb3IgYW4gYXJyYXkuCgogIC8vIERvIG5vdCBub3JtYWxpemUgb2JqZWN0cyB0aGF0IHdlIGtub3cgaGF2ZSBhbHJlYWR5IGJlZW4gbm9ybWFsaXplZC4gQXMgYSBnZW5lcmFsIHJ1bGUsIHRoZQogIC8vICJfX3NlbnRyeV9za2lwX25vcm1hbGl6YXRpb25fXyIgcHJvcGVydHkgc2hvdWxkIG9ubHkgYmUgdXNlZCBzcGFyaW5nbHkgYW5kIG9ubHkgc2hvdWxkIG9ubHkgYmUgc2V0IG9uIG9iamVjdHMgdGhhdAogIC8vIGhhdmUgYWxyZWFkeSBiZWVuIG5vcm1hbGl6ZWQuCiAgaWYgKCh2YWx1ZSApWydfX3NlbnRyeV9za2lwX25vcm1hbGl6YXRpb25fXyddKSB7CiAgICByZXR1cm4gdmFsdWUgOwogIH0KCiAgLy8gV2UgY2FuIHNldCBgX19zZW50cnlfb3ZlcnJpZGVfbm9ybWFsaXphdGlvbl9kZXB0aF9fYCBvbiBhbiBvYmplY3QgdG8gZW5zdXJlIHRoYXQgZnJvbSB0aGVyZQogIC8vIFdlIGtlZXAgYSBjZXJ0YWluIGFtb3VudCBvZiBkZXB0aC4KICAvLyBUaGlzIHNob3VsZCBiZSB1c2VkIHNwYXJpbmdseSwgZS5nLiB3ZSB1c2UgaXQgZm9yIHRoZSByZWR1eCBpbnRlZ3JhdGlvbiB0byBlbnN1cmUgd2UgZ2V0IGEgY2VydGFpbiBhbW91bnQgb2Ygc3RhdGUuCiAgY29uc3QgcmVtYWluaW5nRGVwdGggPQogICAgdHlwZW9mICh2YWx1ZSApWydfX3NlbnRyeV9vdmVycmlkZV9ub3JtYWxpemF0aW9uX2RlcHRoX18nXSA9PT0gJ251bWJlcicKICAgICAgPyAoKHZhbHVlIClbJ19fc2VudHJ5X292ZXJyaWRlX25vcm1hbGl6YXRpb25fZGVwdGhfXyddICkKICAgICAgOiBkZXB0aDsKCiAgLy8gV2UncmUgYWxzbyBkb25lIGlmIHdlJ3ZlIHJlYWNoZWQgdGhlIG1heCBkZXB0aAogIGlmIChyZW1haW5pbmdEZXB0aCA9PT0gMCkgewogICAgLy8gQXQgdGhpcyBwb2ludCB3ZSBrbm93IGBzZXJpYWxpemVkYCBpcyBhIHN0cmluZyBvZiB0aGUgZm9ybSBgIltvYmplY3QgWFhYWF0iYC4gQ2xlYW4gaXQgdXAgc28gaXQncyBqdXN0IGAiW1hYWFhdImAuCiAgICByZXR1cm4gc3RyaW5naWZpZWQucmVwbGFjZSgnb2JqZWN0ICcsICcnKTsKICB9CgogIC8vIElmIHdlJ3ZlIGFscmVhZHkgdmlzaXRlZCB0aGlzIGJyYW5jaCwgYmFpbCBvdXQsIGFzIGl0J3MgY2lyY3VsYXIgcmVmZXJlbmNlLiBJZiBub3QsIG5vdGUgdGhhdCB3ZSdyZSBzZWVpbmcgaXQgbm93LgogIGlmIChtZW1vaXplKHZhbHVlKSkgewogICAgcmV0dXJuICdbQ2lyY3VsYXIgfl0nOwogIH0KCiAgLy8gSWYgdGhlIHZhbHVlIGhhcyBhIGB0b0pTT05gIG1ldGhvZCwgd2UgY2FsbCBpdCB0byBleHRyYWN0IG1vcmUgaW5mb3JtYXRpb24KICBjb25zdCB2YWx1ZVdpdGhUb0pTT04gPSB2YWx1ZSA7CiAgaWYgKHZhbHVlV2l0aFRvSlNPTiAmJiB0eXBlb2YgdmFsdWVXaXRoVG9KU09OLnRvSlNPTiA9PT0gJ2Z1bmN0aW9uJykgewogICAgdHJ5IHsKICAgICAgY29uc3QganNvblZhbHVlID0gdmFsdWVXaXRoVG9KU09OLnRvSlNPTigpOwogICAgICAvLyBXZSBuZWVkIHRvIG5vcm1hbGl6ZSB0aGUgcmV0dXJuIHZhbHVlIG9mIGAudG9KU09OKClgIGluIGNhc2UgaXQgaGFzIGNpcmN1bGFyIHJlZmVyZW5jZXMKICAgICAgcmV0dXJuIHZpc2l0KCcnLCBqc29uVmFsdWUsIHJlbWFpbmluZ0RlcHRoIC0gMSwgbWF4UHJvcGVydGllcywgbWVtbyk7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgLy8gcGFzcyAoVGhlIGJ1aWx0LWluIGB0b0pTT05gIGZhaWxlZCwgYnV0IHdlIGNhbiBzdGlsbCB0cnkgdG8gZG8gaXQgb3Vyc2VsdmVzKQogICAgfQogIH0KCiAgLy8gQXQgdGhpcyBwb2ludCB3ZSBrbm93IHdlIGVpdGhlciBoYXZlIGFuIG9iamVjdCBvciBhbiBhcnJheSwgd2UgaGF2ZW4ndCBzZWVuIGl0IGJlZm9yZSwgYW5kIHdlJ3JlIGdvaW5nIHRvIHJlY3Vyc2UKICAvLyBiZWNhdXNlIHdlIGhhdmVuJ3QgeWV0IHJlYWNoZWQgdGhlIG1heCBkZXB0aC4gQ3JlYXRlIGFuIGFjY3VtdWxhdG9yIHRvIGhvbGQgdGhlIHJlc3VsdHMgb2YgdmlzaXRpbmcgZWFjaAogIC8vIHByb3BlcnR5L2VudHJ5LCBhbmQga2VlcCB0cmFjayBvZiB0aGUgbnVtYmVyIG9mIGl0ZW1zIHdlIGFkZCB0byBpdC4KICBjb25zdCBub3JtYWxpemVkID0gKEFycmF5LmlzQXJyYXkodmFsdWUpID8gW10gOiB7fSkgOwogIGxldCBudW1BZGRlZCA9IDA7CgogIC8vIEJlZm9yZSB3ZSBiZWdpbiwgY29udmVydGBFcnJvcmAgYW5kYEV2ZW50YCBpbnN0YW5jZXMgaW50byBwbGFpbiBvYmplY3RzLCBzaW5jZSBzb21lIG9mIGVhY2ggb2YgdGhlaXIgcmVsZXZhbnQKICAvLyBwcm9wZXJ0aWVzIGFyZSBub24tZW51bWVyYWJsZSBhbmQgb3RoZXJ3aXNlIHdvdWxkIGdldCBtaXNzZWQuCiAgY29uc3QgdmlzaXRhYmxlID0gY29udmVydFRvUGxhaW5PYmplY3QodmFsdWUgKTsKCiAgZm9yIChjb25zdCB2aXNpdEtleSBpbiB2aXNpdGFibGUpIHsKICAgIC8vIEF2b2lkIGl0ZXJhdGluZyBvdmVyIGZpZWxkcyBpbiB0aGUgcHJvdG90eXBlIGlmIHRoZXkndmUgc29tZWhvdyBiZWVuIGV4cG9zZWQgdG8gZW51bWVyYXRpb24uCiAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh2aXNpdGFibGUsIHZpc2l0S2V5KSkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBpZiAobnVtQWRkZWQgPj0gbWF4UHJvcGVydGllcykgewogICAgICBub3JtYWxpemVkW3Zpc2l0S2V5XSA9ICdbTWF4UHJvcGVydGllcyB+XSc7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIC8vIFJlY3Vyc2l2ZWx5IHZpc2l0IGFsbCB0aGUgY2hpbGQgbm9kZXMKICAgIGNvbnN0IHZpc2l0VmFsdWUgPSB2aXNpdGFibGVbdmlzaXRLZXldOwogICAgbm9ybWFsaXplZFt2aXNpdEtleV0gPSB2aXNpdCh2aXNpdEtleSwgdmlzaXRWYWx1ZSwgcmVtYWluaW5nRGVwdGggLSAxLCBtYXhQcm9wZXJ0aWVzLCBtZW1vKTsKCiAgICBudW1BZGRlZCsrOwogIH0KCiAgLy8gT25jZSB3ZSd2ZSB2aXNpdGVkIGFsbCB0aGUgYnJhbmNoZXMsIHJlbW92ZSB0aGUgcGFyZW50IGZyb20gbWVtbyBzdG9yYWdlCiAgdW5tZW1vaXplKHZhbHVlKTsKCiAgLy8gUmV0dXJuIGFjY3VtdWxhdGVkIHZhbHVlcwogIHJldHVybiBub3JtYWxpemVkOwp9CgovKiBlc2xpbnQtZGlzYWJsZSBjb21wbGV4aXR5ICovCi8qKgogKiBTdHJpbmdpZnkgdGhlIGdpdmVuIHZhbHVlLiBIYW5kbGVzIHZhcmlvdXMga25vd24gc3BlY2lhbCB2YWx1ZXMgYW5kIHR5cGVzLgogKgogKiBOb3QgbWVhbnQgdG8gYmUgdXNlZCBvbiBzaW1wbGUgcHJpbWl0aXZlcyB3aGljaCBhbHJlYWR5IGhhdmUgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24sIGFzIGl0IHdpbGwsIGZvciBleGFtcGxlLCB0dXJuCiAqIHRoZSBudW1iZXIgMTIzMSBpbnRvICJbT2JqZWN0IE51bWJlcl0iLCBub3Igb24gYG51bGxgLCBhcyBpdCB3aWxsIHRocm93LgogKgogKiBAcGFyYW0gdmFsdWUgVGhlIHZhbHVlIHRvIHN0cmluZ2lmeQogKiBAcmV0dXJucyBBIHN0cmluZ2lmaWVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiB2YWx1ZQogKi8KZnVuY3Rpb24gc3RyaW5naWZ5VmFsdWUoCiAga2V5LAogIC8vIHRoaXMgdHlwZSBpcyBhIHRpbnkgYml0IG9mIGEgY2hlYXQsIHNpbmNlIHRoaXMgZnVuY3Rpb24gZG9lcyBoYW5kbGUgTmFOICh3aGljaCBpcyB0ZWNobmljYWxseSBhIG51bWJlciksIGJ1dCBmb3IKICAvLyBvdXIgaW50ZXJuYWwgdXNlLCBpdCdsbCBkbwogIHZhbHVlLAopIHsKICB0cnkgewogICAgaWYgKGtleSA9PT0gJ2RvbWFpbicgJiYgdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiAodmFsdWUgKS5fZXZlbnRzKSB7CiAgICAgIHJldHVybiAnW0RvbWFpbl0nOwogICAgfQoKICAgIGlmIChrZXkgPT09ICdkb21haW5FbWl0dGVyJykgewogICAgICByZXR1cm4gJ1tEb21haW5FbWl0dGVyXSc7CiAgICB9CgogICAgLy8gSXQncyBzYWZlIHRvIHVzZSBgZ2xvYmFsYCwgYHdpbmRvd2AsIGFuZCBgZG9jdW1lbnRgIGhlcmUgaW4gdGhpcyBtYW5uZXIsIGFzIHdlIGFyZSBhc3NlcnRpbmcgdXNpbmcgYHR5cGVvZmAgZmlyc3QKICAgIC8vIHdoaWNoIHdvbid0IHRocm93IGlmIHRoZXkgYXJlIG5vdCBwcmVzZW50LgoKICAgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSA9PT0gZ2xvYmFsKSB7CiAgICAgIHJldHVybiAnW0dsb2JhbF0nOwogICAgfQoKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLWdsb2JhbHMKICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSA9PT0gd2luZG93KSB7CiAgICAgIHJldHVybiAnW1dpbmRvd10nOwogICAgfQoKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLWdsb2JhbHMKICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlID09PSBkb2N1bWVudCkgewogICAgICByZXR1cm4gJ1tEb2N1bWVudF0nOwogICAgfQoKICAgIGlmIChpc1Z1ZVZpZXdNb2RlbCh2YWx1ZSkpIHsKICAgICAgcmV0dXJuICdbVnVlVmlld01vZGVsXSc7CiAgICB9CgogICAgLy8gUmVhY3QncyBTeW50aGV0aWNFdmVudCB0aGluZ3kKICAgIGlmIChpc1N5bnRoZXRpY0V2ZW50KHZhbHVlKSkgewogICAgICByZXR1cm4gJ1tTeW50aGV0aWNFdmVudF0nOwogICAgfQoKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIHZhbHVlICE9PSB2YWx1ZSkgewogICAgICByZXR1cm4gJ1tOYU5dJzsKICAgIH0KCiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBgW0Z1bmN0aW9uOiAke2dldEZ1bmN0aW9uTmFtZSh2YWx1ZSl9XWA7CiAgICB9CgogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N5bWJvbCcpIHsKICAgICAgcmV0dXJuIGBbJHtTdHJpbmcodmFsdWUpfV1gOwogICAgfQoKICAgIC8vIHN0cmluZ2lmaWVkIEJpZ0ludHMgYXJlIGluZGlzdGluZ3Vpc2hhYmxlIGZyb20gcmVndWxhciBudW1iZXJzLCBzbyB3ZSBuZWVkIHRvIGxhYmVsIHRoZW0gdG8gYXZvaWQgY29uZnVzaW9uCiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnYmlnaW50JykgewogICAgICByZXR1cm4gYFtCaWdJbnQ6ICR7U3RyaW5nKHZhbHVlKX1dYDsKICAgIH0KCiAgICAvLyBOb3cgdGhhdCB3ZSd2ZSBrbm9ja2VkIG91dCBhbGwgdGhlIHNwZWNpYWwgY2FzZXMgYW5kIHRoZSBwcmltaXRpdmVzLCBhbGwgd2UgaGF2ZSBsZWZ0IGFyZSBvYmplY3RzLiBTaW1wbHkgY2FzdGluZwogICAgLy8gdGhlbSB0byBzdHJpbmdzIG1lYW5zIHRoYXQgaW5zdGFuY2VzIG9mIGNsYXNzZXMgd2hpY2ggaGF2ZW4ndCBkZWZpbmVkIHRoZWlyIGB0b1N0cmluZ1RhZ2Agd2lsbCBqdXN0IGNvbWUgb3V0IGFzCiAgICAvLyBgIltvYmplY3QgT2JqZWN0XSJgLiBJZiB3ZSBpbnN0ZWFkIGxvb2sgYXQgdGhlIGNvbnN0cnVjdG9yJ3MgbmFtZSAod2hpY2ggaXMgdGhlIHNhbWUgYXMgdGhlIG5hbWUgb2YgdGhlIGNsYXNzKSwKICAgIC8vIHdlIGNhbiBtYWtlIHN1cmUgdGhhdCBvbmx5IHBsYWluIG9iamVjdHMgY29tZSBvdXQgdGhhdCB3YXkuCiAgICBjb25zdCBvYmpOYW1lID0gZ2V0Q29uc3RydWN0b3JOYW1lKHZhbHVlKTsKCiAgICAvLyBIYW5kbGUgSFRNTCBFbGVtZW50cwogICAgaWYgKC9eSFRNTChcdyopRWxlbWVudCQvLnRlc3Qob2JqTmFtZSkpIHsKICAgICAgcmV0dXJuIGBbSFRNTEVsZW1lbnQ6ICR7b2JqTmFtZX1dYDsKICAgIH0KCiAgICByZXR1cm4gYFtvYmplY3QgJHtvYmpOYW1lfV1gOwogIH0gY2F0Y2ggKGVycikgewogICAgcmV0dXJuIGAqKm5vbi1zZXJpYWxpemFibGUqKiAoJHtlcnJ9KWA7CiAgfQp9Ci8qIGVzbGludC1lbmFibGUgY29tcGxleGl0eSAqLwoKZnVuY3Rpb24gZ2V0Q29uc3RydWN0b3JOYW1lKHZhbHVlKSB7CiAgY29uc3QgcHJvdG90eXBlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHZhbHVlKTsKCiAgcmV0dXJuIHByb3RvdHlwZSA/IHByb3RvdHlwZS5jb25zdHJ1Y3Rvci5uYW1lIDogJ251bGwgcHJvdG90eXBlJzsKfQoKLyoqCiAqIE5vcm1hbGl6ZXMgVVJMcyBpbiBleGNlcHRpb25zIGFuZCBzdGFja3RyYWNlcyB0byBhIGJhc2UgcGF0aCBzbyBTZW50cnkgY2FuIGZpbmdlcnByaW50CiAqIGFjcm9zcyBwbGF0Zm9ybXMgYW5kIHdvcmtpbmcgZGlyZWN0b3J5LgogKgogKiBAcGFyYW0gdXJsIFRoZSBVUkwgdG8gYmUgbm9ybWFsaXplZC4KICogQHBhcmFtIGJhc2VQYXRoIFRoZSBhcHBsaWNhdGlvbiBiYXNlIHBhdGguCiAqIEByZXR1cm5zIFRoZSBub3JtYWxpemVkIFVSTC4KICovCmZ1bmN0aW9uIG5vcm1hbGl6ZVVybFRvQmFzZSh1cmwsIGJhc2VQYXRoKSB7CiAgY29uc3QgZXNjYXBlZEJhc2UgPSBiYXNlUGF0aAogICAgLy8gQmFja3NsYXNoIHRvIGZvcndhcmQKICAgIC5yZXBsYWNlKC9cXC9nLCAnLycpCiAgICAvLyBFc2NhcGUgUmVnRXhwIHNwZWNpYWwgY2hhcmFjdGVycwogICAgLnJlcGxhY2UoL1t8XFx7fSgpW1xdXiQrKj8uXS9nLCAnXFwkJicpOwoKICBsZXQgbmV3VXJsID0gdXJsOwogIHRyeSB7CiAgICBuZXdVcmwgPSBkZWNvZGVVUkkodXJsKTsKICB9IGNhdGNoIChfT28pIHsKICAgIC8vIFNvbWV0aW1lIHRoaXMgYnJlYWtzCiAgfQogIHJldHVybiAoCiAgICBuZXdVcmwKICAgICAgLnJlcGxhY2UoL1xcL2csICcvJykKICAgICAgLnJlcGxhY2UoL3dlYnBhY2s6XC8/L2csICcnKSAvLyBSZW1vdmUgaW50ZXJtZWRpYXRlIGJhc2UgcGF0aAogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHNlbnRyeS1pbnRlcm5hbC9zZGsvbm8tcmVnZXhwLWNvbnN0cnVjdG9yCiAgICAgIC5yZXBsYWNlKG5ldyBSZWdFeHAoYChmaWxlOi8vKT8vKiR7ZXNjYXBlZEJhc2V9LypgLCAnaWcnKSwgJ2FwcDovLy8nKQogICk7Cn0KCi8vIFNsaWdodGx5IG1vZGlmaWVkIChubyBJRTggc3VwcG9ydCwgRVM2KSBhbmQgdHJhbnNjcmliZWQgdG8gVHlwZVNjcmlwdAoKLy8gU3BsaXQgYSBmaWxlbmFtZSBpbnRvIFtyb290LCBkaXIsIGJhc2VuYW1lLCBleHRdLCB1bml4IHZlcnNpb24KLy8gJ3Jvb3QnIGlzIGp1c3QgYSBzbGFzaCwgb3Igbm90aGluZy4KY29uc3Qgc3BsaXRQYXRoUmUgPSAvXihcUys6XFx8XC8/KShbXHNcU10qPykoKD86XC57MSwyfXxbXi9cXF0rP3wpKFwuW14uL1xcXSp8KSkoPzpbL1xcXSopJC87Ci8qKiBKU0RvYyAqLwpmdW5jdGlvbiBzcGxpdFBhdGgoZmlsZW5hbWUpIHsKICAvLyBUcnVuY2F0ZSBmaWxlcyBuYW1lcyBncmVhdGVyIHRoYW4gMTAyNCBjaGFyYWN0ZXJzIHRvIGF2b2lkIHJlZ2V4IGRvcwogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvcHVsbC84NzM3I2Rpc2N1c3Npb25fcjEyODU3MTkxNzIKICBjb25zdCB0cnVuY2F0ZWQgPSBmaWxlbmFtZS5sZW5ndGggPiAxMDI0ID8gYDx0cnVuY2F0ZWQ+JHtmaWxlbmFtZS5zbGljZSgtMTAyNCl9YCA6IGZpbGVuYW1lOwogIGNvbnN0IHBhcnRzID0gc3BsaXRQYXRoUmUuZXhlYyh0cnVuY2F0ZWQpOwogIHJldHVybiBwYXJ0cyA/IHBhcnRzLnNsaWNlKDEpIDogW107Cn0KCi8qKiBKU0RvYyAqLwpmdW5jdGlvbiBkaXJuYW1lKHBhdGgpIHsKICBjb25zdCByZXN1bHQgPSBzcGxpdFBhdGgocGF0aCk7CiAgY29uc3Qgcm9vdCA9IHJlc3VsdFswXTsKICBsZXQgZGlyID0gcmVzdWx0WzFdOwoKICBpZiAoIXJvb3QgJiYgIWRpcikgewogICAgLy8gTm8gZGlybmFtZSB3aGF0c29ldmVyCiAgICByZXR1cm4gJy4nOwogIH0KCiAgaWYgKGRpcikgewogICAgLy8gSXQgaGFzIGEgZGlybmFtZSwgc3RyaXAgdHJhaWxpbmcgc2xhc2gKICAgIGRpciA9IGRpci5zbGljZSgwLCBkaXIubGVuZ3RoIC0gMSk7CiAgfQoKICByZXR1cm4gcm9vdCArIGRpcjsKfQoKLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LWZ1bmN0aW9uLXJldHVybi10eXBlICovCgovKiogU3luY1Byb21pc2UgaW50ZXJuYWwgc3RhdGVzICovCnZhciBTdGF0ZXM7IChmdW5jdGlvbiAoU3RhdGVzKSB7CiAgLyoqIFBlbmRpbmcgKi8KICBjb25zdCBQRU5ESU5HID0gMDsgU3RhdGVzW1N0YXRlc1siUEVORElORyJdID0gUEVORElOR10gPSAiUEVORElORyI7CiAgLyoqIFJlc29sdmVkIC8gT0sgKi8KICBjb25zdCBSRVNPTFZFRCA9IDE7IFN0YXRlc1tTdGF0ZXNbIlJFU09MVkVEIl0gPSBSRVNPTFZFRF0gPSAiUkVTT0xWRUQiOwogIC8qKiBSZWplY3RlZCAvIEVycm9yICovCiAgY29uc3QgUkVKRUNURUQgPSAyOyBTdGF0ZXNbU3RhdGVzWyJSRUpFQ1RFRCJdID0gUkVKRUNURURdID0gIlJFSkVDVEVEIjsKfSkoU3RhdGVzIHx8IChTdGF0ZXMgPSB7fSkpOwoKLy8gT3ZlcmxvYWRzIHNvIHdlIGNhbiBjYWxsIHJlc29sdmVkU3luY1Byb21pc2Ugd2l0aG91dCBhcmd1bWVudHMgYW5kIGdlbmVyaWMgYXJndW1lbnQKCi8qKgogKiBDcmVhdGVzIGEgcmVzb2x2ZWQgc3luYyBwcm9taXNlLgogKgogKiBAcGFyYW0gdmFsdWUgdGhlIHZhbHVlIHRvIHJlc29sdmUgdGhlIHByb21pc2Ugd2l0aAogKiBAcmV0dXJucyB0aGUgcmVzb2x2ZWQgc3luYyBwcm9taXNlCiAqLwpmdW5jdGlvbiByZXNvbHZlZFN5bmNQcm9taXNlKHZhbHVlKSB7CiAgcmV0dXJuIG5ldyBTeW5jUHJvbWlzZShyZXNvbHZlID0+IHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0pOwp9CgovKioKICogQ3JlYXRlcyBhIHJlamVjdGVkIHN5bmMgcHJvbWlzZS4KICoKICogQHBhcmFtIHZhbHVlIHRoZSB2YWx1ZSB0byByZWplY3QgdGhlIHByb21pc2Ugd2l0aAogKiBAcmV0dXJucyB0aGUgcmVqZWN0ZWQgc3luYyBwcm9taXNlCiAqLwpmdW5jdGlvbiByZWplY3RlZFN5bmNQcm9taXNlKHJlYXNvbikgewogIHJldHVybiBuZXcgU3luY1Byb21pc2UoKF8sIHJlamVjdCkgPT4gewogICAgcmVqZWN0KHJlYXNvbik7CiAgfSk7Cn0KCi8qKgogKiBUaGVuYWJsZSBjbGFzcyB0aGF0IGJlaGF2ZXMgbGlrZSBhIFByb21pc2UgYW5kIGZvbGxvd3MgaXQncyBpbnRlcmZhY2UKICogYnV0IGlzIG5vdCBhc3luYyBpbnRlcm5hbGx5CiAqLwpjbGFzcyBTeW5jUHJvbWlzZSB7CgogICBjb25zdHJ1Y3RvcigKICAgIGV4ZWN1dG9yLAogICkge1N5bmNQcm9taXNlLnByb3RvdHlwZS5fX2luaXQuY2FsbCh0aGlzKTtTeW5jUHJvbWlzZS5wcm90b3R5cGUuX19pbml0Mi5jYWxsKHRoaXMpO1N5bmNQcm9taXNlLnByb3RvdHlwZS5fX2luaXQzLmNhbGwodGhpcyk7U3luY1Byb21pc2UucHJvdG90eXBlLl9faW5pdDQuY2FsbCh0aGlzKTsKICAgIHRoaXMuX3N0YXRlID0gU3RhdGVzLlBFTkRJTkc7CiAgICB0aGlzLl9oYW5kbGVycyA9IFtdOwoKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKHRoaXMuX3Jlc29sdmUsIHRoaXMuX3JlamVjdCk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHRoaXMuX3JlamVjdChlKTsKICAgIH0KICB9CgogIC8qKiBKU0RvYyAqLwogICB0aGVuKAogICAgb25mdWxmaWxsZWQsCiAgICBvbnJlamVjdGVkLAogICkgewogICAgcmV0dXJuIG5ldyBTeW5jUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIHRoaXMuX2hhbmRsZXJzLnB1c2goWwogICAgICAgIGZhbHNlLAogICAgICAgIHJlc3VsdCA9PiB7CiAgICAgICAgICBpZiAoIW9uZnVsZmlsbGVkKSB7CiAgICAgICAgICAgIC8vIFRPRE86IMKvXF8o44OEKV8vwq8KICAgICAgICAgICAgLy8gVE9ETzogRklYTUUKICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQgKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgcmVzb2x2ZShvbmZ1bGZpbGxlZChyZXN1bHQpKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcmVhc29uID0+IHsKICAgICAgICAgIGlmICghb25yZWplY3RlZCkgewogICAgICAgICAgICByZWplY3QocmVhc29uKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgcmVzb2x2ZShvbnJlamVjdGVkKHJlYXNvbikpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgXSk7CiAgICAgIHRoaXMuX2V4ZWN1dGVIYW5kbGVycygpOwogICAgfSk7CiAgfQoKICAvKiogSlNEb2MgKi8KICAgY2F0Y2goCiAgICBvbnJlamVjdGVkLAogICkgewogICAgcmV0dXJuIHRoaXMudGhlbih2YWwgPT4gdmFsLCBvbnJlamVjdGVkKTsKICB9CgogIC8qKiBKU0RvYyAqLwogICBmaW5hbGx5KG9uZmluYWxseSkgewogICAgcmV0dXJuIG5ldyBTeW5jUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGxldCB2YWw7CiAgICAgIGxldCBpc1JlamVjdGVkOwoKICAgICAgcmV0dXJuIHRoaXMudGhlbigKICAgICAgICB2YWx1ZSA9PiB7CiAgICAgICAgICBpc1JlamVjdGVkID0gZmFsc2U7CiAgICAgICAgICB2YWwgPSB2YWx1ZTsKICAgICAgICAgIGlmIChvbmZpbmFsbHkpIHsKICAgICAgICAgICAgb25maW5hbGx5KCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByZWFzb24gPT4gewogICAgICAgICAgaXNSZWplY3RlZCA9IHRydWU7CiAgICAgICAgICB2YWwgPSByZWFzb247CiAgICAgICAgICBpZiAob25maW5hbGx5KSB7CiAgICAgICAgICAgIG9uZmluYWxseSgpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICkudGhlbigoKSA9PiB7CiAgICAgICAgaWYgKGlzUmVqZWN0ZWQpIHsKICAgICAgICAgIHJlamVjdCh2YWwpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcmVzb2x2ZSh2YWwgKTsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIC8qKiBKU0RvYyAqLwogICAgX19pbml0KCkge3RoaXMuX3Jlc29sdmUgPSAodmFsdWUpID0+IHsKICAgIHRoaXMuX3NldFJlc3VsdChTdGF0ZXMuUkVTT0xWRUQsIHZhbHVlKTsKICB9O30KCiAgLyoqIEpTRG9jICovCiAgICBfX2luaXQyKCkge3RoaXMuX3JlamVjdCA9IChyZWFzb24pID0+IHsKICAgIHRoaXMuX3NldFJlc3VsdChTdGF0ZXMuUkVKRUNURUQsIHJlYXNvbik7CiAgfTt9CgogIC8qKiBKU0RvYyAqLwogICAgX19pbml0MygpIHt0aGlzLl9zZXRSZXN1bHQgPSAoc3RhdGUsIHZhbHVlKSA9PiB7CiAgICBpZiAodGhpcy5fc3RhdGUgIT09IFN0YXRlcy5QRU5ESU5HKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoaXNUaGVuYWJsZSh2YWx1ZSkpIHsKICAgICAgdm9pZCAodmFsdWUgKS50aGVuKHRoaXMuX3Jlc29sdmUsIHRoaXMuX3JlamVjdCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlOwogICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTsKCiAgICB0aGlzLl9leGVjdXRlSGFuZGxlcnMoKTsKICB9O30KCiAgLyoqIEpTRG9jICovCiAgICBfX2luaXQ0KCkge3RoaXMuX2V4ZWN1dGVIYW5kbGVycyA9ICgpID0+IHsKICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gU3RhdGVzLlBFTkRJTkcpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGNhY2hlZEhhbmRsZXJzID0gdGhpcy5faGFuZGxlcnMuc2xpY2UoKTsKICAgIHRoaXMuX2hhbmRsZXJzID0gW107CgogICAgY2FjaGVkSGFuZGxlcnMuZm9yRWFjaChoYW5kbGVyID0+IHsKICAgICAgaWYgKGhhbmRsZXJbMF0pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gU3RhdGVzLlJFU09MVkVEKSB7CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlcwogICAgICAgIGhhbmRsZXJbMV0odGhpcy5fdmFsdWUgKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBTdGF0ZXMuUkVKRUNURUQpIHsKICAgICAgICBoYW5kbGVyWzJdKHRoaXMuX3ZhbHVlKTsKICAgICAgfQoKICAgICAgaGFuZGxlclswXSA9IHRydWU7CiAgICB9KTsKICB9O30KfQoKLyoqCiAqIENyZWF0ZXMgYW4gbmV3IFByb21pc2VCdWZmZXIgb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBsaW1pdAogKiBAcGFyYW0gbGltaXQgbWF4IG51bWJlciBvZiBwcm9taXNlcyB0aGF0IGNhbiBiZSBzdG9yZWQgaW4gdGhlIGJ1ZmZlcgogKi8KZnVuY3Rpb24gbWFrZVByb21pc2VCdWZmZXIobGltaXQpIHsKICBjb25zdCBidWZmZXIgPSBbXTsKCiAgZnVuY3Rpb24gaXNSZWFkeSgpIHsKICAgIHJldHVybiBsaW1pdCA9PT0gdW5kZWZpbmVkIHx8IGJ1ZmZlci5sZW5ndGggPCBsaW1pdDsKICB9CgogIC8qKgogICAqIFJlbW92ZSBhIHByb21pc2UgZnJvbSB0aGUgcXVldWUuCiAgICoKICAgKiBAcGFyYW0gdGFzayBDYW4gYmUgYW55IFByb21pc2VMaWtlPFQ+CiAgICogQHJldHVybnMgUmVtb3ZlZCBwcm9taXNlLgogICAqLwogIGZ1bmN0aW9uIHJlbW92ZSh0YXNrKSB7CiAgICByZXR1cm4gYnVmZmVyLnNwbGljZShidWZmZXIuaW5kZXhPZih0YXNrKSwgMSlbMF07CiAgfQoKICAvKioKICAgKiBBZGQgYSBwcm9taXNlIChyZXByZXNlbnRpbmcgYW4gaW4tZmxpZ2h0IGFjdGlvbikgdG8gdGhlIHF1ZXVlLCBhbmQgc2V0IGl0IHRvIHJlbW92ZSBpdHNlbGYgb24gZnVsZmlsbG1lbnQuCiAgICoKICAgKiBAcGFyYW0gdGFza1Byb2R1Y2VyIEEgZnVuY3Rpb24gcHJvZHVjaW5nIGFueSBQcm9taXNlTGlrZTxUPjsgSW4gcHJldmlvdXMgdmVyc2lvbnMgdGhpcyB1c2VkIHRvIGJlIGB0YXNrOgogICAqICAgICAgICBQcm9taXNlTGlrZTxUPmAsIGJ1dCB1bmRlciB0aGF0IG1vZGVsLCBQcm9taXNlcyB3ZXJlIGluc3RhbnRseSBjcmVhdGVkIG9uIHRoZSBjYWxsLXNpdGUgYW5kIHRoZWlyIGV4ZWN1dG9yCiAgICogICAgICAgIGZ1bmN0aW9ucyB0aGVyZWZvcmUgcmFuIGltbWVkaWF0ZWx5LiBUaHVzLCBldmVuIGlmIHRoZSBidWZmZXIgd2FzIGZ1bGwsIHRoZSBhY3Rpb24gc3RpbGwgaGFwcGVuZWQuIEJ5CiAgICogICAgICAgIHJlcXVpcmluZyB0aGUgcHJvbWlzZSB0byBiZSB3cmFwcGVkIGluIGEgZnVuY3Rpb24sIHdlIGNhbiBkZWZlciBwcm9taXNlIGNyZWF0aW9uIHVudGlsIGFmdGVyIHRoZSBidWZmZXIKICAgKiAgICAgICAgbGltaXQgY2hlY2suCiAgICogQHJldHVybnMgVGhlIG9yaWdpbmFsIHByb21pc2UuCiAgICovCiAgZnVuY3Rpb24gYWRkKHRhc2tQcm9kdWNlcikgewogICAgaWYgKCFpc1JlYWR5KCkpIHsKICAgICAgcmV0dXJuIHJlamVjdGVkU3luY1Byb21pc2UobmV3IFNlbnRyeUVycm9yKCdOb3QgYWRkaW5nIFByb21pc2UgYmVjYXVzZSBidWZmZXIgbGltaXQgd2FzIHJlYWNoZWQuJykpOwogICAgfQoKICAgIC8vIHN0YXJ0IHRoZSB0YXNrIGFuZCBhZGQgaXRzIHByb21pc2UgdG8gdGhlIHF1ZXVlCiAgICBjb25zdCB0YXNrID0gdGFza1Byb2R1Y2VyKCk7CiAgICBpZiAoYnVmZmVyLmluZGV4T2YodGFzaykgPT09IC0xKSB7CiAgICAgIGJ1ZmZlci5wdXNoKHRhc2spOwogICAgfQogICAgdm9pZCB0YXNrCiAgICAgIC50aGVuKCgpID0+IHJlbW92ZSh0YXNrKSkKICAgICAgLy8gVXNlIGB0aGVuKG51bGwsIHJlamVjdGlvbkhhbmRsZXIpYCByYXRoZXIgdGhhbiBgY2F0Y2gocmVqZWN0aW9uSGFuZGxlcilgIHNvIHRoYXQgd2UgY2FuIHVzZSBgUHJvbWlzZUxpa2VgCiAgICAgIC8vIHJhdGhlciB0aGFuIGBQcm9taXNlYC4gYFByb21pc2VMaWtlYCBkb2Vzbid0IGhhdmUgYSBgLmNhdGNoYCBtZXRob2QsIG1ha2luZyBpdHMgcG9seWZpbGwgc21hbGxlci4gKEVTNSBkaWRuJ3QKICAgICAgLy8gaGF2ZSBwcm9taXNlcywgc28gVFMgaGFzIHRvIHBvbHlmaWxsIHdoZW4gZG93bi1jb21waWxpbmcuKQogICAgICAudGhlbihudWxsLCAoKSA9PgogICAgICAgIHJlbW92ZSh0YXNrKS50aGVuKG51bGwsICgpID0+IHsKICAgICAgICAgIC8vIFdlIGhhdmUgdG8gYWRkIGFub3RoZXIgY2F0Y2ggaGVyZSBiZWNhdXNlIGByZW1vdmUoKWAgc3RhcnRzIGEgbmV3IHByb21pc2UgY2hhaW4uCiAgICAgICAgfSksCiAgICAgICk7CiAgICByZXR1cm4gdGFzazsKICB9CgogIC8qKgogICAqIFdhaXQgZm9yIGFsbCBwcm9taXNlcyBpbiB0aGUgcXVldWUgdG8gcmVzb2x2ZSBvciBmb3IgdGltZW91dCB0byBleHBpcmUsIHdoaWNoZXZlciBjb21lcyBmaXJzdC4KICAgKgogICAqIEBwYXJhbSB0aW1lb3V0IFRoZSB0aW1lLCBpbiBtcywgYWZ0ZXIgd2hpY2ggdG8gcmVzb2x2ZSB0byBgZmFsc2VgIGlmIHRoZSBxdWV1ZSBpcyBzdGlsbCBub24tZW1wdHkuIFBhc3NpbmcgYDBgIChvcgogICAqIG5vdCBwYXNzaW5nIGFueXRoaW5nKSB3aWxsIG1ha2UgdGhlIHByb21pc2Ugd2FpdCBhcyBsb25nIGFzIGl0IHRha2VzIGZvciB0aGUgcXVldWUgdG8gZHJhaW4gYmVmb3JlIHJlc29sdmluZyB0bwogICAqIGB0cnVlYC4KICAgKiBAcmV0dXJucyBBIHByb21pc2Ugd2hpY2ggd2lsbCByZXNvbHZlIHRvIGB0cnVlYCBpZiB0aGUgcXVldWUgaXMgYWxyZWFkeSBlbXB0eSBvciBkcmFpbnMgYmVmb3JlIHRoZSB0aW1lb3V0LCBhbmQKICAgKiBgZmFsc2VgIG90aGVyd2lzZQogICAqLwogIGZ1bmN0aW9uIGRyYWluKHRpbWVvdXQpIHsKICAgIHJldHVybiBuZXcgU3luY1Byb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBsZXQgY291bnRlciA9IGJ1ZmZlci5sZW5ndGg7CgogICAgICBpZiAoIWNvdW50ZXIpIHsKICAgICAgICByZXR1cm4gcmVzb2x2ZSh0cnVlKTsKICAgICAgfQoKICAgICAgLy8gd2FpdCBmb3IgYHRpbWVvdXRgIG1zIGFuZCB0aGVuIHJlc29sdmUgdG8gYGZhbHNlYCAoaWYgbm90IGNhbmNlbGxlZCBmaXJzdCkKICAgICAgY29uc3QgY2FwdHVyZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgaWYgKHRpbWVvdXQgJiYgdGltZW91dCA+IDApIHsKICAgICAgICAgIHJlc29sdmUoZmFsc2UpOwogICAgICAgIH0KICAgICAgfSwgdGltZW91dCk7CgogICAgICAvLyBpZiBhbGwgcHJvbWlzZXMgcmVzb2x2ZSBpbiB0aW1lLCBjYW5jZWwgdGhlIHRpbWVyIGFuZCByZXNvbHZlIHRvIGB0cnVlYAogICAgICBidWZmZXIuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICB2b2lkIHJlc29sdmVkU3luY1Byb21pc2UoaXRlbSkudGhlbigoKSA9PiB7CiAgICAgICAgICBpZiAoIS0tY291bnRlcikgewogICAgICAgICAgICBjbGVhclRpbWVvdXQoY2FwdHVyZWRTZXRUaW1lb3V0KTsKICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9LCByZWplY3QpOwogICAgICB9KTsKICAgIH0pOwogIH0KCiAgcmV0dXJuIHsKICAgICQ6IGJ1ZmZlciwKICAgIGFkZCwKICAgIGRyYWluLAogIH07Cn0KCmNvbnN0IE9ORV9TRUNPTkRfSU5fTVMgPSAxMDAwOwoKLyoqCiAqIEEgcGFydGlhbCBkZWZpbml0aW9uIG9mIHRoZSBbUGVyZm9ybWFuY2UgV2ViIEFQSV17QGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1BlcmZvcm1hbmNlfQogKiBmb3IgYWNjZXNzaW5nIGEgaGlnaC1yZXNvbHV0aW9uIG1vbm90b25pYyBjbG9jay4KICovCgovKioKICogUmV0dXJucyBhIHRpbWVzdGFtcCBpbiBzZWNvbmRzIHNpbmNlIHRoZSBVTklYIGVwb2NoIHVzaW5nIHRoZSBEYXRlIEFQSS4KICoKICogVE9ETyh2OCk6IFJldHVybiB0eXBlIHNob3VsZCBiZSByb3VuZGVkLgogKi8KZnVuY3Rpb24gZGF0ZVRpbWVzdGFtcEluU2Vjb25kcygpIHsKICByZXR1cm4gRGF0ZS5ub3coKSAvIE9ORV9TRUNPTkRfSU5fTVM7Cn0KCi8qKgogKiBSZXR1cm5zIGEgd3JhcHBlciBhcm91bmQgdGhlIG5hdGl2ZSBQZXJmb3JtYW5jZSBBUEkgYnJvd3NlciBpbXBsZW1lbnRhdGlvbiwgb3IgdW5kZWZpbmVkIGZvciBicm93c2VycyB0aGF0IGRvIG5vdAogKiBzdXBwb3J0IHRoZSBBUEkuCiAqCiAqIFdyYXBwaW5nIHRoZSBuYXRpdmUgQVBJIHdvcmtzIGFyb3VuZCBkaWZmZXJlbmNlcyBpbiBiZWhhdmlvciBmcm9tIGRpZmZlcmVudCBicm93c2Vycy4KICovCmZ1bmN0aW9uIGNyZWF0ZVVuaXhUaW1lc3RhbXBJblNlY29uZHNGdW5jKCkgewogIGNvbnN0IHsgcGVyZm9ybWFuY2UgfSA9IEdMT0JBTF9PQkogOwogIGlmICghcGVyZm9ybWFuY2UgfHwgIXBlcmZvcm1hbmNlLm5vdykgewogICAgcmV0dXJuIGRhdGVUaW1lc3RhbXBJblNlY29uZHM7CiAgfQoKICAvLyBTb21lIGJyb3dzZXIgYW5kIGVudmlyb25tZW50cyBkb24ndCBoYXZlIGEgdGltZU9yaWdpbiwgc28gd2UgZmFsbGJhY2sgdG8KICAvLyB1c2luZyBEYXRlLm5vdygpIHRvIGNvbXB1dGUgdGhlIHN0YXJ0aW5nIHRpbWUuCiAgY29uc3QgYXBwcm94U3RhcnRpbmdUaW1lT3JpZ2luID0gRGF0ZS5ub3coKSAtIHBlcmZvcm1hbmNlLm5vdygpOwogIGNvbnN0IHRpbWVPcmlnaW4gPSBwZXJmb3JtYW5jZS50aW1lT3JpZ2luID09IHVuZGVmaW5lZCA/IGFwcHJveFN0YXJ0aW5nVGltZU9yaWdpbiA6IHBlcmZvcm1hbmNlLnRpbWVPcmlnaW47CgogIC8vIHBlcmZvcm1hbmNlLm5vdygpIGlzIGEgbW9ub3RvbmljIGNsb2NrLCB3aGljaCBtZWFucyBpdCBzdGFydHMgYXQgMCB3aGVuIHRoZSBwcm9jZXNzIGJlZ2lucy4gVG8gZ2V0IHRoZSBjdXJyZW50CiAgLy8gd2FsbCBjbG9jayB0aW1lIChhY3R1YWwgVU5JWCB0aW1lc3RhbXApLCB3ZSBuZWVkIHRvIGFkZCB0aGUgc3RhcnRpbmcgdGltZSBvcmlnaW4gYW5kIHRoZSBjdXJyZW50IHRpbWUgZWxhcHNlZC4KICAvLwogIC8vIFRPRE86IFRoaXMgZG9lcyBub3QgYWNjb3VudCBmb3IgdGhlIGNhc2Ugd2hlcmUgdGhlIG1vbm90b25pYyBjbG9jayB0aGF0IHBvd2VycyBwZXJmb3JtYW5jZS5ub3coKSBkcmlmdHMgZnJvbSB0aGUKICAvLyB3YWxsIGNsb2NrIHRpbWUsIHdoaWNoIGNhdXNlcyB0aGUgcmV0dXJuZWQgdGltZXN0YW1wIHRvIGJlIGluYWNjdXJhdGUuIFdlIHNob3VsZCBpbnZlc3RpZ2F0ZSBob3cgdG8gZGV0ZWN0IGFuZAogIC8vIGNvcnJlY3QgZm9yIHRoaXMuCiAgLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L2lzc3Vlcy8yNTkwCiAgLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vbWRuL2NvbnRlbnQvaXNzdWVzLzQ3MTMKICAvLyBTZWU6IGh0dHBzOi8vZGV2LnRvL25vYW1yL3doZW4tYS1taWxsaXNlY29uZC1pcy1ub3QtYS1taWxsaXNlY29uZC0zaDYKICByZXR1cm4gKCkgPT4gewogICAgcmV0dXJuICh0aW1lT3JpZ2luICsgcGVyZm9ybWFuY2Uubm93KCkpIC8gT05FX1NFQ09ORF9JTl9NUzsKICB9Owp9CgovKioKICogUmV0dXJucyBhIHRpbWVzdGFtcCBpbiBzZWNvbmRzIHNpbmNlIHRoZSBVTklYIGVwb2NoIHVzaW5nIGVpdGhlciB0aGUgUGVyZm9ybWFuY2Ugb3IgRGF0ZSBBUElzLCBkZXBlbmRpbmcgb24gdGhlCiAqIGF2YWlsYWJpbGl0eSBvZiB0aGUgUGVyZm9ybWFuY2UgQVBJLgogKgogKiBCVUc6IE5vdGUgdGhhdCBiZWNhdXNlIG9mIGhvdyBicm93c2VycyBpbXBsZW1lbnQgdGhlIFBlcmZvcm1hbmNlIEFQSSwgdGhlIGNsb2NrIG1pZ2h0IHN0b3Agd2hlbiB0aGUgY29tcHV0ZXIgaXMKICogYXNsZWVwLiBUaGlzIGNyZWF0ZXMgYSBza2V3IGJldHdlZW4gYGRhdGVUaW1lc3RhbXBJblNlY29uZHNgIGFuZCBgdGltZXN0YW1wSW5TZWNvbmRzYC4gVGhlCiAqIHNrZXcgY2FuIGdyb3cgdG8gYXJiaXRyYXJ5IGFtb3VudHMgbGlrZSBkYXlzLCB3ZWVrcyBvciBtb250aHMuCiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L2lzc3Vlcy8yNTkwLgogKi8KY29uc3QgdGltZXN0YW1wSW5TZWNvbmRzID0gY3JlYXRlVW5peFRpbWVzdGFtcEluU2Vjb25kc0Z1bmMoKTsKCi8qKgogKiBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBzaW5jZSB0aGUgVU5JWCBlcG9jaC4gVGhpcyB2YWx1ZSBpcyBvbmx5IHVzYWJsZSBpbiBhIGJyb3dzZXIsIGFuZCBvbmx5IHdoZW4gdGhlCiAqIHBlcmZvcm1hbmNlIEFQSSBpcyBhdmFpbGFibGUuCiAqLwooKCkgPT4gewogIC8vIFVuZm9ydHVuYXRlbHkgYnJvd3NlcnMgbWF5IHJlcG9ydCBhbiBpbmFjY3VyYXRlIHRpbWUgb3JpZ2luIGRhdGEsIHRocm91Z2ggZWl0aGVyIHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4gb3IKICAvLyBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0LCB3aGljaCByZXN1bHRzIGluIHBvb3IgcmVzdWx0cyBpbiBwZXJmb3JtYW5jZSBkYXRhLiBXZSBvbmx5IHRyZWF0IHRpbWUgb3JpZ2luCiAgLy8gZGF0YSBhcyByZWxpYWJsZSBpZiB0aGV5IGFyZSB3aXRoaW4gYSByZWFzb25hYmxlIHRocmVzaG9sZCBvZiB0aGUgY3VycmVudCB0aW1lLgoKICBjb25zdCB7IHBlcmZvcm1hbmNlIH0gPSBHTE9CQUxfT0JKIDsKICBpZiAoIXBlcmZvcm1hbmNlIHx8ICFwZXJmb3JtYW5jZS5ub3cpIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBjb25zdCB0aHJlc2hvbGQgPSAzNjAwICogMTAwMDsKICBjb25zdCBwZXJmb3JtYW5jZU5vdyA9IHBlcmZvcm1hbmNlLm5vdygpOwogIGNvbnN0IGRhdGVOb3cgPSBEYXRlLm5vdygpOwoKICAvLyBpZiB0aW1lT3JpZ2luIGlzbid0IGF2YWlsYWJsZSBzZXQgZGVsdGEgdG8gdGhyZXNob2xkIHNvIGl0IGlzbid0IHVzZWQKICBjb25zdCB0aW1lT3JpZ2luRGVsdGEgPSBwZXJmb3JtYW5jZS50aW1lT3JpZ2luCiAgICA/IE1hdGguYWJzKHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4gKyBwZXJmb3JtYW5jZU5vdyAtIGRhdGVOb3cpCiAgICA6IHRocmVzaG9sZDsKICBjb25zdCB0aW1lT3JpZ2luSXNSZWxpYWJsZSA9IHRpbWVPcmlnaW5EZWx0YSA8IHRocmVzaG9sZDsKCiAgLy8gV2hpbGUgcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydCBpcyBkZXByZWNhdGVkIGluIGZhdm9yIG9mIHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4sIHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4KICAvLyBpcyBub3QgYXMgd2lkZWx5IHN1cHBvcnRlZC4gTmFtZWx5LCBwZXJmb3JtYW5jZS50aW1lT3JpZ2luIGlzIHVuZGVmaW5lZCBpbiBTYWZhcmkgYXMgb2Ygd3JpdGluZy4KICAvLyBBbHNvIGFzIG9mIHdyaXRpbmcsIHBlcmZvcm1hbmNlLnRpbWluZyBpcyBub3QgYXZhaWxhYmxlIGluIFdlYiBXb3JrZXJzIGluIG1haW5zdHJlYW0gYnJvd3NlcnMsIHNvIGl0IGlzIG5vdCBhbHdheXMKICAvLyBhIHZhbGlkIGZhbGxiYWNrLiBJbiB0aGUgYWJzZW5jZSBvZiBhbiBpbml0aWFsIHRpbWUgcHJvdmlkZWQgYnkgdGhlIGJyb3dzZXIsIGZhbGxiYWNrIHRvIHRoZSBjdXJyZW50IHRpbWUgZnJvbSB0aGUKICAvLyBEYXRlIEFQSS4KICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICBjb25zdCBuYXZpZ2F0aW9uU3RhcnQgPSBwZXJmb3JtYW5jZS50aW1pbmcgJiYgcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydDsKICBjb25zdCBoYXNOYXZpZ2F0aW9uU3RhcnQgPSB0eXBlb2YgbmF2aWdhdGlvblN0YXJ0ID09PSAnbnVtYmVyJzsKICAvLyBpZiBuYXZpZ2F0aW9uU3RhcnQgaXNuJ3QgYXZhaWxhYmxlIHNldCBkZWx0YSB0byB0aHJlc2hvbGQgc28gaXQgaXNuJ3QgdXNlZAogIGNvbnN0IG5hdmlnYXRpb25TdGFydERlbHRhID0gaGFzTmF2aWdhdGlvblN0YXJ0ID8gTWF0aC5hYnMobmF2aWdhdGlvblN0YXJ0ICsgcGVyZm9ybWFuY2VOb3cgLSBkYXRlTm93KSA6IHRocmVzaG9sZDsKICBjb25zdCBuYXZpZ2F0aW9uU3RhcnRJc1JlbGlhYmxlID0gbmF2aWdhdGlvblN0YXJ0RGVsdGEgPCB0aHJlc2hvbGQ7CgogIGlmICh0aW1lT3JpZ2luSXNSZWxpYWJsZSB8fCBuYXZpZ2F0aW9uU3RhcnRJc1JlbGlhYmxlKSB7CiAgICAvLyBVc2UgdGhlIG1vcmUgcmVsaWFibGUgdGltZSBvcmlnaW4KICAgIGlmICh0aW1lT3JpZ2luRGVsdGEgPD0gbmF2aWdhdGlvblN0YXJ0RGVsdGEpIHsKICAgICAgcmV0dXJuIHBlcmZvcm1hbmNlLnRpbWVPcmlnaW47CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gbmF2aWdhdGlvblN0YXJ0OwogICAgfQogIH0KICByZXR1cm4gZGF0ZU5vdzsKfSkoKTsKCi8qKgogKiBDcmVhdGVzIGFuIGVudmVsb3BlLgogKiBNYWtlIHN1cmUgdG8gYWx3YXlzIGV4cGxpY2l0bHkgcHJvdmlkZSB0aGUgZ2VuZXJpYyB0byB0aGlzIGZ1bmN0aW9uCiAqIHNvIHRoYXQgdGhlIGVudmVsb3BlIHR5cGVzIHJlc29sdmUgY29ycmVjdGx5LgogKi8KZnVuY3Rpb24gY3JlYXRlRW52ZWxvcGUoaGVhZGVycywgaXRlbXMgPSBbXSkgewogIHJldHVybiBbaGVhZGVycywgaXRlbXNdIDsKfQoKLyoqCiAqIENvbnZlbmllbmNlIGZ1bmN0aW9uIHRvIGxvb3AgdGhyb3VnaCB0aGUgaXRlbXMgYW5kIGl0ZW0gdHlwZXMgb2YgYW4gZW52ZWxvcGUuCiAqIChUaGlzIGZ1bmN0aW9uIHdhcyBtb3N0bHkgY3JlYXRlZCBiZWNhdXNlIHdvcmtpbmcgd2l0aCBlbnZlbG9wZSB0eXBlcyBpcyBwYWluZnVsIGF0IHRoZSBtb21lbnQpCiAqCiAqIElmIHRoZSBjYWxsYmFjayByZXR1cm5zIHRydWUsIHRoZSByZXN0IG9mIHRoZSBpdGVtcyB3aWxsIGJlIHNraXBwZWQuCiAqLwpmdW5jdGlvbiBmb3JFYWNoRW52ZWxvcGVJdGVtKAogIGVudmVsb3BlLAogIGNhbGxiYWNrLAopIHsKICBjb25zdCBlbnZlbG9wZUl0ZW1zID0gZW52ZWxvcGVbMV07CgogIGZvciAoY29uc3QgZW52ZWxvcGVJdGVtIG9mIGVudmVsb3BlSXRlbXMpIHsKICAgIGNvbnN0IGVudmVsb3BlSXRlbVR5cGUgPSBlbnZlbG9wZUl0ZW1bMF0udHlwZTsKICAgIGNvbnN0IHJlc3VsdCA9IGNhbGxiYWNrKGVudmVsb3BlSXRlbSwgZW52ZWxvcGVJdGVtVHlwZSk7CgogICAgaWYgKHJlc3VsdCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9CgogIHJldHVybiBmYWxzZTsKfQoKLyoqCiAqIEVuY29kZSBhIHN0cmluZyB0byBVVEY4LgogKi8KZnVuY3Rpb24gZW5jb2RlVVRGOChpbnB1dCwgdGV4dEVuY29kZXIpIHsKICBjb25zdCB1dGY4ID0gdGV4dEVuY29kZXIgfHwgbmV3IFRleHRFbmNvZGVyKCk7CiAgcmV0dXJuIHV0ZjguZW5jb2RlKGlucHV0KTsKfQoKLyoqCiAqIFNlcmlhbGl6ZXMgYW4gZW52ZWxvcGUuCiAqLwpmdW5jdGlvbiBzZXJpYWxpemVFbnZlbG9wZShlbnZlbG9wZSwgdGV4dEVuY29kZXIpIHsKICBjb25zdCBbZW52SGVhZGVycywgaXRlbXNdID0gZW52ZWxvcGU7CgogIC8vIEluaXRpYWxseSB3ZSBjb25zdHJ1Y3Qgb3VyIGVudmVsb3BlIGFzIGEgc3RyaW5nIGFuZCBvbmx5IGNvbnZlcnQgdG8gYmluYXJ5IGNodW5rcyBpZiB3ZSBlbmNvdW50ZXIgYmluYXJ5IGRhdGEKICBsZXQgcGFydHMgPSBKU09OLnN0cmluZ2lmeShlbnZIZWFkZXJzKTsKCiAgZnVuY3Rpb24gYXBwZW5kKG5leHQpIHsKICAgIGlmICh0eXBlb2YgcGFydHMgPT09ICdzdHJpbmcnKSB7CiAgICAgIHBhcnRzID0gdHlwZW9mIG5leHQgPT09ICdzdHJpbmcnID8gcGFydHMgKyBuZXh0IDogW2VuY29kZVVURjgocGFydHMsIHRleHRFbmNvZGVyKSwgbmV4dF07CiAgICB9IGVsc2UgewogICAgICBwYXJ0cy5wdXNoKHR5cGVvZiBuZXh0ID09PSAnc3RyaW5nJyA/IGVuY29kZVVURjgobmV4dCwgdGV4dEVuY29kZXIpIDogbmV4dCk7CiAgICB9CiAgfQoKICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHsKICAgIGNvbnN0IFtpdGVtSGVhZGVycywgcGF5bG9hZF0gPSBpdGVtOwoKICAgIGFwcGVuZChgXG4ke0pTT04uc3RyaW5naWZ5KGl0ZW1IZWFkZXJzKX1cbmApOwoKICAgIGlmICh0eXBlb2YgcGF5bG9hZCA9PT0gJ3N0cmluZycgfHwgcGF5bG9hZCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKICAgICAgYXBwZW5kKHBheWxvYWQpOwogICAgfSBlbHNlIHsKICAgICAgbGV0IHN0cmluZ2lmaWVkUGF5bG9hZDsKICAgICAgdHJ5IHsKICAgICAgICBzdHJpbmdpZmllZFBheWxvYWQgPSBKU09OLnN0cmluZ2lmeShwYXlsb2FkKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIC8vIEluIGNhc2UsIGRlc3BpdGUgYWxsIG91ciBlZmZvcnRzIHRvIGtlZXAgYHBheWxvYWRgIGNpcmN1bGFyLWRlcGVuZGVuY3ktZnJlZSwgYEpTT04uc3RyaW5pZnkoKWAgc3RpbGwKICAgICAgICAvLyBmYWlscywgd2UgdHJ5IGFnYWluIGFmdGVyIG5vcm1hbGl6aW5nIGl0IGFnYWluIHdpdGggaW5maW5pdGUgbm9ybWFsaXphdGlvbiBkZXB0aC4gVGhpcyBvZiBjb3Vyc2UgaGFzIGEKICAgICAgICAvLyBwZXJmb3JtYW5jZSBpbXBhY3QgYnV0IGluIHRoaXMgY2FzZSBhIHBlcmZvcm1hbmNlIGhpdCBpcyBiZXR0ZXIgdGhhbiB0aHJvd2luZy4KICAgICAgICBzdHJpbmdpZmllZFBheWxvYWQgPSBKU09OLnN0cmluZ2lmeShub3JtYWxpemUocGF5bG9hZCkpOwogICAgICB9CiAgICAgIGFwcGVuZChzdHJpbmdpZmllZFBheWxvYWQpOwogICAgfQogIH0KCiAgcmV0dXJuIHR5cGVvZiBwYXJ0cyA9PT0gJ3N0cmluZycgPyBwYXJ0cyA6IGNvbmNhdEJ1ZmZlcnMocGFydHMpOwp9CgpmdW5jdGlvbiBjb25jYXRCdWZmZXJzKGJ1ZmZlcnMpIHsKICBjb25zdCB0b3RhbExlbmd0aCA9IGJ1ZmZlcnMucmVkdWNlKChhY2MsIGJ1ZikgPT4gYWNjICsgYnVmLmxlbmd0aCwgMCk7CgogIGNvbnN0IG1lcmdlZCA9IG5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTsKICBsZXQgb2Zmc2V0ID0gMDsKICBmb3IgKGNvbnN0IGJ1ZmZlciBvZiBidWZmZXJzKSB7CiAgICBtZXJnZWQuc2V0KGJ1ZmZlciwgb2Zmc2V0KTsKICAgIG9mZnNldCArPSBidWZmZXIubGVuZ3RoOwogIH0KCiAgcmV0dXJuIG1lcmdlZDsKfQoKY29uc3QgSVRFTV9UWVBFX1RPX0RBVEFfQ0FURUdPUllfTUFQID0gewogIHNlc3Npb246ICdzZXNzaW9uJywKICBzZXNzaW9uczogJ3Nlc3Npb24nLAogIGF0dGFjaG1lbnQ6ICdhdHRhY2htZW50JywKICB0cmFuc2FjdGlvbjogJ3RyYW5zYWN0aW9uJywKICBldmVudDogJ2Vycm9yJywKICBjbGllbnRfcmVwb3J0OiAnaW50ZXJuYWwnLAogIHVzZXJfcmVwb3J0OiAnZGVmYXVsdCcsCiAgcHJvZmlsZTogJ3Byb2ZpbGUnLAogIHJlcGxheV9ldmVudDogJ3JlcGxheScsCiAgcmVwbGF5X3JlY29yZGluZzogJ3JlcGxheScsCiAgY2hlY2tfaW46ICdtb25pdG9yJywKICBmZWVkYmFjazogJ2ZlZWRiYWNrJywKICBzcGFuOiAnc3BhbicsCiAgc3RhdHNkOiAnbWV0cmljX2J1Y2tldCcsCn07CgovKioKICogTWFwcyB0aGUgdHlwZSBvZiBhbiBlbnZlbG9wZSBpdGVtIHRvIGEgZGF0YSBjYXRlZ29yeS4KICovCmZ1bmN0aW9uIGVudmVsb3BlSXRlbVR5cGVUb0RhdGFDYXRlZ29yeSh0eXBlKSB7CiAgcmV0dXJuIElURU1fVFlQRV9UT19EQVRBX0NBVEVHT1JZX01BUFt0eXBlXTsKfQoKLyoqIEV4dHJhY3RzIHRoZSBtaW5pbWFsIFNESyBpbmZvIGZyb20gdGhlIG1ldGFkYXRhIG9yIGFuIGV2ZW50cyAqLwpmdW5jdGlvbiBnZXRTZGtNZXRhZGF0YUZvckVudmVsb3BlSGVhZGVyKG1ldGFkYXRhT3JFdmVudCkgewogIGlmICghbWV0YWRhdGFPckV2ZW50IHx8ICFtZXRhZGF0YU9yRXZlbnQuc2RrKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IHsgbmFtZSwgdmVyc2lvbiB9ID0gbWV0YWRhdGFPckV2ZW50LnNkazsKICByZXR1cm4geyBuYW1lLCB2ZXJzaW9uIH07Cn0KCi8qKgogKiBDcmVhdGVzIGV2ZW50IGVudmVsb3BlIGhlYWRlcnMsIGJhc2VkIG9uIGV2ZW50LCBzZGsgaW5mbyBhbmQgdHVubmVsCiAqIE5vdGU6IFRoaXMgZnVuY3Rpb24gd2FzIGV4dHJhY3RlZCBmcm9tIHRoZSBjb3JlIHBhY2thZ2UgdG8gbWFrZSBpdCBhdmFpbGFibGUgaW4gUmVwbGF5CiAqLwpmdW5jdGlvbiBjcmVhdGVFdmVudEVudmVsb3BlSGVhZGVycygKICBldmVudCwKICBzZGtJbmZvLAogIHR1bm5lbCwKICBkc24sCikgewogIGNvbnN0IGR5bmFtaWNTYW1wbGluZ0NvbnRleHQgPSBldmVudC5zZGtQcm9jZXNzaW5nTWV0YWRhdGEgJiYgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhLmR5bmFtaWNTYW1wbGluZ0NvbnRleHQ7CiAgcmV0dXJuIHsKICAgIGV2ZW50X2lkOiBldmVudC5ldmVudF9pZCAsCiAgICBzZW50X2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksCiAgICAuLi4oc2RrSW5mbyAmJiB7IHNkazogc2RrSW5mbyB9KSwKICAgIC4uLighIXR1bm5lbCAmJiBkc24gJiYgeyBkc246IGRzblRvU3RyaW5nKGRzbikgfSksCiAgICAuLi4oZHluYW1pY1NhbXBsaW5nQ29udGV4dCAmJiB7CiAgICAgIHRyYWNlOiBkcm9wVW5kZWZpbmVkS2V5cyh7IC4uLmR5bmFtaWNTYW1wbGluZ0NvbnRleHQgfSksCiAgICB9KSwKICB9Owp9CgovLyBJbnRlbnRpb25hbGx5IGtlZXBpbmcgdGhlIGtleSBicm9hZCwgYXMgd2UgZG9uJ3Qga25vdyBmb3Igc3VyZSB3aGF0IHJhdGUgbGltaXQgaGVhZGVycyBnZXQgcmV0dXJuZWQgZnJvbSBiYWNrZW5kCgpjb25zdCBERUZBVUxUX1JFVFJZX0FGVEVSID0gNjAgKiAxMDAwOyAvLyA2MCBzZWNvbmRzCgovKioKICogRXh0cmFjdHMgUmV0cnktQWZ0ZXIgdmFsdWUgZnJvbSB0aGUgcmVxdWVzdCBoZWFkZXIgb3IgcmV0dXJucyBkZWZhdWx0IHZhbHVlCiAqIEBwYXJhbSBoZWFkZXIgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mICdSZXRyeS1BZnRlcicgaGVhZGVyCiAqIEBwYXJhbSBub3cgY3VycmVudCB1bml4IHRpbWVzdGFtcAogKgogKi8KZnVuY3Rpb24gcGFyc2VSZXRyeUFmdGVySGVhZGVyKGhlYWRlciwgbm93ID0gRGF0ZS5ub3coKSkgewogIGNvbnN0IGhlYWRlckRlbGF5ID0gcGFyc2VJbnQoYCR7aGVhZGVyfWAsIDEwKTsKICBpZiAoIWlzTmFOKGhlYWRlckRlbGF5KSkgewogICAgcmV0dXJuIGhlYWRlckRlbGF5ICogMTAwMDsKICB9CgogIGNvbnN0IGhlYWRlckRhdGUgPSBEYXRlLnBhcnNlKGAke2hlYWRlcn1gKTsKICBpZiAoIWlzTmFOKGhlYWRlckRhdGUpKSB7CiAgICByZXR1cm4gaGVhZGVyRGF0ZSAtIG5vdzsKICB9CgogIHJldHVybiBERUZBVUxUX1JFVFJZX0FGVEVSOwp9CgovKioKICogR2V0cyB0aGUgdGltZSB0aGF0IHRoZSBnaXZlbiBjYXRlZ29yeSBpcyBkaXNhYmxlZCB1bnRpbCBmb3IgcmF0ZSBsaW1pdGluZy4KICogSW4gY2FzZSBubyBjYXRlZ29yeS1zcGVjaWZpYyBsaW1pdCBpcyBzZXQgYnV0IGEgZ2VuZXJhbCByYXRlIGxpbWl0IGFjcm9zcyBhbGwgY2F0ZWdvcmllcyBpcyBhY3RpdmUsCiAqIHRoYXQgdGltZSBpcyByZXR1cm5lZC4KICoKICogQHJldHVybiB0aGUgdGltZSBpbiBtcyB0aGF0IHRoZSBjYXRlZ29yeSBpcyBkaXNhYmxlZCB1bnRpbCBvciAwIGlmIHRoZXJlJ3Mgbm8gYWN0aXZlIHJhdGUgbGltaXQuCiAqLwpmdW5jdGlvbiBkaXNhYmxlZFVudGlsKGxpbWl0cywgZGF0YUNhdGVnb3J5KSB7CiAgcmV0dXJuIGxpbWl0c1tkYXRhQ2F0ZWdvcnldIHx8IGxpbWl0cy5hbGwgfHwgMDsKfQoKLyoqCiAqIENoZWNrcyBpZiBhIGNhdGVnb3J5IGlzIHJhdGUgbGltaXRlZAogKi8KZnVuY3Rpb24gaXNSYXRlTGltaXRlZChsaW1pdHMsIGRhdGFDYXRlZ29yeSwgbm93ID0gRGF0ZS5ub3coKSkgewogIHJldHVybiBkaXNhYmxlZFVudGlsKGxpbWl0cywgZGF0YUNhdGVnb3J5KSA+IG5vdzsKfQoKLyoqCiAqIFVwZGF0ZSByYXRlbGltaXRzIGZyb20gaW5jb21pbmcgaGVhZGVycy4KICoKICogQHJldHVybiB0aGUgdXBkYXRlZCBSYXRlTGltaXRzIG9iamVjdC4KICovCmZ1bmN0aW9uIHVwZGF0ZVJhdGVMaW1pdHMoCiAgbGltaXRzLAogIHsgc3RhdHVzQ29kZSwgaGVhZGVycyB9LAogIG5vdyA9IERhdGUubm93KCksCikgewogIGNvbnN0IHVwZGF0ZWRSYXRlTGltaXRzID0gewogICAgLi4ubGltaXRzLAogIH07CgogIC8vICJUaGUgbmFtZSBpcyBjYXNlLWluc2Vuc2l0aXZlLiIKICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSGVhZGVycy9nZXQKICBjb25zdCByYXRlTGltaXRIZWFkZXIgPSBoZWFkZXJzICYmIGhlYWRlcnNbJ3gtc2VudHJ5LXJhdGUtbGltaXRzJ107CiAgY29uc3QgcmV0cnlBZnRlckhlYWRlciA9IGhlYWRlcnMgJiYgaGVhZGVyc1sncmV0cnktYWZ0ZXInXTsKCiAgaWYgKHJhdGVMaW1pdEhlYWRlcikgewogICAgLyoqCiAgICAgKiByYXRlIGxpbWl0IGhlYWRlcnMgYXJlIG9mIHRoZSBmb3JtCiAgICAgKiAgICAgPGhlYWRlcj4sPGhlYWRlcj4sLi4KICAgICAqIHdoZXJlIGVhY2ggPGhlYWRlcj4gaXMgb2YgdGhlIGZvcm0KICAgICAqICAgICA8cmV0cnlfYWZ0ZXI+OiA8Y2F0ZWdvcmllcz46IDxzY29wZT46IDxyZWFzb25fY29kZT46IDxuYW1lc3BhY2VzPgogICAgICogd2hlcmUKICAgICAqICAgICA8cmV0cnlfYWZ0ZXI+IGlzIGEgZGVsYXkgaW4gc2Vjb25kcwogICAgICogICAgIDxjYXRlZ29yaWVzPiBpcyB0aGUgZXZlbnQgdHlwZShzKSAoZXJyb3IsIHRyYW5zYWN0aW9uLCBldGMpIGJlaW5nIHJhdGUgbGltaXRlZCBhbmQgaXMgb2YgdGhlIGZvcm0KICAgICAqICAgICAgICAgPGNhdGVnb3J5Pjs8Y2F0ZWdvcnk+Oy4uLgogICAgICogICAgIDxzY29wZT4gaXMgd2hhdCdzIGJlaW5nIGxpbWl0ZWQgKG9yZywgcHJvamVjdCwgb3Iga2V5KSAtIGlnbm9yZWQgYnkgU0RLCiAgICAgKiAgICAgPHJlYXNvbl9jb2RlPiBpcyBhbiBhcmJpdHJhcnkgc3RyaW5nIGxpa2UgIm9yZ19xdW90YSIgLSBpZ25vcmVkIGJ5IFNESwogICAgICogICAgIDxuYW1lc3BhY2VzPiBTZW1pY29sb24tc2VwYXJhdGVkIGxpc3Qgb2YgbWV0cmljIG5hbWVzcGFjZSBpZGVudGlmaWVycy4gRGVmaW5lcyB3aGljaCBuYW1lc3BhY2Uocykgd2lsbCBiZSBhZmZlY3RlZC4KICAgICAqICAgICAgICAgT25seSBwcmVzZW50IGlmIHJhdGUgbGltaXQgYXBwbGllcyB0byB0aGUgbWV0cmljX2J1Y2tldCBkYXRhIGNhdGVnb3J5LgogICAgICovCiAgICBmb3IgKGNvbnN0IGxpbWl0IG9mIHJhdGVMaW1pdEhlYWRlci50cmltKCkuc3BsaXQoJywnKSkgewogICAgICBjb25zdCBbcmV0cnlBZnRlciwgY2F0ZWdvcmllcywgLCAsIG5hbWVzcGFjZXNdID0gbGltaXQuc3BsaXQoJzonLCA1KTsKICAgICAgY29uc3QgaGVhZGVyRGVsYXkgPSBwYXJzZUludChyZXRyeUFmdGVyLCAxMCk7CiAgICAgIGNvbnN0IGRlbGF5ID0gKCFpc05hTihoZWFkZXJEZWxheSkgPyBoZWFkZXJEZWxheSA6IDYwKSAqIDEwMDA7IC8vIDYwc2VjIGRlZmF1bHQKICAgICAgaWYgKCFjYXRlZ29yaWVzKSB7CiAgICAgICAgdXBkYXRlZFJhdGVMaW1pdHMuYWxsID0gbm93ICsgZGVsYXk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChjb25zdCBjYXRlZ29yeSBvZiBjYXRlZ29yaWVzLnNwbGl0KCc7JykpIHsKICAgICAgICAgIGlmIChjYXRlZ29yeSA9PT0gJ21ldHJpY19idWNrZXQnKSB7CiAgICAgICAgICAgIC8vIG5hbWVzcGFjZXMgd2lsbCBiZSBwcmVzZW50IHdoZW4gY2F0ZWdvcnkgPT09ICdtZXRyaWNfYnVja2V0JwogICAgICAgICAgICBpZiAoIW5hbWVzcGFjZXMgfHwgbmFtZXNwYWNlcy5zcGxpdCgnOycpLmluY2x1ZGVzKCdjdXN0b20nKSkgewogICAgICAgICAgICAgIHVwZGF0ZWRSYXRlTGltaXRzW2NhdGVnb3J5XSA9IG5vdyArIGRlbGF5OwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1cGRhdGVkUmF0ZUxpbWl0c1tjYXRlZ29yeV0gPSBub3cgKyBkZWxheTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9IGVsc2UgaWYgKHJldHJ5QWZ0ZXJIZWFkZXIpIHsKICAgIHVwZGF0ZWRSYXRlTGltaXRzLmFsbCA9IG5vdyArIHBhcnNlUmV0cnlBZnRlckhlYWRlcihyZXRyeUFmdGVySGVhZGVyLCBub3cpOwogIH0gZWxzZSBpZiAoc3RhdHVzQ29kZSA9PT0gNDI5KSB7CiAgICB1cGRhdGVkUmF0ZUxpbWl0cy5hbGwgPSBub3cgKyA2MCAqIDEwMDA7CiAgfQoKICByZXR1cm4gdXBkYXRlZFJhdGVMaW1pdHM7Cn0KCi8qKgogKiBBIG5vZGUuanMgd2F0Y2hkb2cgdGltZXIKICogQHBhcmFtIHBvbGxJbnRlcnZhbCBUaGUgaW50ZXJ2YWwgdGhhdCB3ZSBleHBlY3QgdG8gZ2V0IHBvbGxlZCBhdAogKiBAcGFyYW0gYW5yVGhyZXNob2xkIFRoZSB0aHJlc2hvbGQgZm9yIHdoZW4gd2UgY29uc2lkZXIgQU5SCiAqIEBwYXJhbSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gY2FsbCBmb3IgQU5SCiAqIEByZXR1cm5zIEFuIG9iamVjdCB3aXRoIGBwb2xsYCBhbmQgYGVuYWJsZWRgIGZ1bmN0aW9ucyB7QGxpbmsgV2F0Y2hkb2dSZXR1cm59CiAqLwpmdW5jdGlvbiB3YXRjaGRvZ1RpbWVyKAogIGNyZWF0ZVRpbWVyLAogIHBvbGxJbnRlcnZhbCwKICBhbnJUaHJlc2hvbGQsCiAgY2FsbGJhY2ssCikgewogIGNvbnN0IHRpbWVyID0gY3JlYXRlVGltZXIoKTsKICBsZXQgdHJpZ2dlcmVkID0gZmFsc2U7CiAgbGV0IGVuYWJsZWQgPSB0cnVlOwoKICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICBjb25zdCBkaWZmTXMgPSB0aW1lci5nZXRUaW1lTXMoKTsKCiAgICBpZiAodHJpZ2dlcmVkID09PSBmYWxzZSAmJiBkaWZmTXMgPiBwb2xsSW50ZXJ2YWwgKyBhbnJUaHJlc2hvbGQpIHsKICAgICAgdHJpZ2dlcmVkID0gdHJ1ZTsKICAgICAgaWYgKGVuYWJsZWQpIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CiAgICB9CgogICAgaWYgKGRpZmZNcyA8IHBvbGxJbnRlcnZhbCArIGFuclRocmVzaG9sZCkgewogICAgICB0cmlnZ2VyZWQgPSBmYWxzZTsKICAgIH0KICB9LCAyMCk7CgogIHJldHVybiB7CiAgICBwb2xsOiAoKSA9PiB7CiAgICAgIHRpbWVyLnJlc2V0KCk7CiAgICB9LAogICAgZW5hYmxlZDogKHN0YXRlKSA9PiB7CiAgICAgIGVuYWJsZWQgPSBzdGF0ZTsKICAgIH0sCiAgfTsKfQoKLy8gdHlwZXMgY29waWVkIGZyb20gaW5zcGVjdG9yLmQudHMKCi8qKgogKiBDb252ZXJ0cyBEZWJ1Z2dlci5DYWxsRnJhbWUgdG8gU2VudHJ5IFN0YWNrRnJhbWUKICovCmZ1bmN0aW9uIGNhbGxGcmFtZVRvU3RhY2tGcmFtZSgKICBmcmFtZSwKICB1cmwsCiAgZ2V0TW9kdWxlRnJvbUZpbGVuYW1lLAopIHsKICBjb25zdCBmaWxlbmFtZSA9IHVybCA/IHVybC5yZXBsYWNlKC9eZmlsZTpcL1wvLywgJycpIDogdW5kZWZpbmVkOwoKICAvLyBDYWxsRnJhbWUgcm93L2NvbCBhcmUgMCBiYXNlZCwgd2hlcmVhcyBTdGFja0ZyYW1lIGFyZSAxIGJhc2VkCiAgY29uc3QgY29sbm8gPSBmcmFtZS5sb2NhdGlvbi5jb2x1bW5OdW1iZXIgPyBmcmFtZS5sb2NhdGlvbi5jb2x1bW5OdW1iZXIgKyAxIDogdW5kZWZpbmVkOwogIGNvbnN0IGxpbmVubyA9IGZyYW1lLmxvY2F0aW9uLmxpbmVOdW1iZXIgPyBmcmFtZS5sb2NhdGlvbi5saW5lTnVtYmVyICsgMSA6IHVuZGVmaW5lZDsKCiAgcmV0dXJuIGRyb3BVbmRlZmluZWRLZXlzKHsKICAgIGZpbGVuYW1lLAogICAgbW9kdWxlOiBnZXRNb2R1bGVGcm9tRmlsZW5hbWUoZmlsZW5hbWUpLAogICAgZnVuY3Rpb246IGZyYW1lLmZ1bmN0aW9uTmFtZSB8fCAnPycsCiAgICBjb2xubywKICAgIGxpbmVubywKICAgIGluX2FwcDogZmlsZW5hbWUgPyBmaWxlbmFtZUlzSW5BcHAoZmlsZW5hbWUpIDogdW5kZWZpbmVkLAogIH0pOwp9CgovKioKICogVGhpcyBzZXJ2ZXMgYXMgYSBidWlsZCB0aW1lIGZsYWcgdGhhdCB3aWxsIGJlIHRydWUgYnkgZGVmYXVsdCwgYnV0IGZhbHNlIGluIG5vbi1kZWJ1ZyBidWlsZHMgb3IgaWYgdXNlcnMgcmVwbGFjZSBgX19TRU5UUllfREVCVUdfX2AgaW4gdGhlaXIgZ2VuZXJhdGVkIGNvZGUuCiAqCiAqIEFUVEVOVElPTjogVGhpcyBjb25zdGFudCBtdXN0IG5ldmVyIGNyb3NzIHBhY2thZ2UgYm91bmRhcmllcyAoaS5lLiBiZSBleHBvcnRlZCkgdG8gZ3VhcmFudGVlIHRoYXQgaXQgY2FuIGJlIHVzZWQgZm9yIHRyZWUgc2hha2luZy4KICovCmNvbnN0IERFQlVHX0JVSUxEID0gKHR5cGVvZiBfX1NFTlRSWV9ERUJVR19fID09PSAndW5kZWZpbmVkJyB8fCBfX1NFTlRSWV9ERUJVR19fKTsKCmNvbnN0IERFRkFVTFRfRU5WSVJPTk1FTlQgPSAncHJvZHVjdGlvbic7CgovKioKICogUmV0dXJucyB0aGUgZ2xvYmFsIGV2ZW50IHByb2Nlc3NvcnMuCiAqIEBkZXByZWNhdGVkIEdsb2JhbCBldmVudCBwcm9jZXNzb3JzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4KICovCmZ1bmN0aW9uIGdldEdsb2JhbEV2ZW50UHJvY2Vzc29ycygpIHsKICByZXR1cm4gZ2V0R2xvYmFsU2luZ2xldG9uKCdnbG9iYWxFdmVudFByb2Nlc3NvcnMnLCAoKSA9PiBbXSk7Cn0KCi8qKgogKiBQcm9jZXNzIGFuIGFycmF5IG9mIGV2ZW50IHByb2Nlc3NvcnMsIHJldHVybmluZyB0aGUgcHJvY2Vzc2VkIGV2ZW50IChvciBgbnVsbGAgaWYgdGhlIGV2ZW50IHdhcyBkcm9wcGVkKS4KICovCmZ1bmN0aW9uIG5vdGlmeUV2ZW50UHJvY2Vzc29ycygKICBwcm9jZXNzb3JzLAogIGV2ZW50LAogIGhpbnQsCiAgaW5kZXggPSAwLAopIHsKICByZXR1cm4gbmV3IFN5bmNQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIGNvbnN0IHByb2Nlc3NvciA9IHByb2Nlc3NvcnNbaW5kZXhdOwogICAgaWYgKGV2ZW50ID09PSBudWxsIHx8IHR5cGVvZiBwcm9jZXNzb3IgIT09ICdmdW5jdGlvbicpIHsKICAgICAgcmVzb2x2ZShldmVudCk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCByZXN1bHQgPSBwcm9jZXNzb3IoeyAuLi5ldmVudCB9LCBoaW50KSA7CgogICAgICBERUJVR19CVUlMRCAmJiBwcm9jZXNzb3IuaWQgJiYgcmVzdWx0ID09PSBudWxsICYmIGxvZ2dlci5sb2coYEV2ZW50IHByb2Nlc3NvciAiJHtwcm9jZXNzb3IuaWR9IiBkcm9wcGVkIGV2ZW50YCk7CgogICAgICBpZiAoaXNUaGVuYWJsZShyZXN1bHQpKSB7CiAgICAgICAgdm9pZCByZXN1bHQKICAgICAgICAgIC50aGVuKGZpbmFsID0+IG5vdGlmeUV2ZW50UHJvY2Vzc29ycyhwcm9jZXNzb3JzLCBmaW5hbCwgaGludCwgaW5kZXggKyAxKS50aGVuKHJlc29sdmUpKQogICAgICAgICAgLnRoZW4obnVsbCwgcmVqZWN0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2b2lkIG5vdGlmeUV2ZW50UHJvY2Vzc29ycyhwcm9jZXNzb3JzLCByZXN1bHQsIGhpbnQsIGluZGV4ICsgMSkKICAgICAgICAgIC50aGVuKHJlc29sdmUpCiAgICAgICAgICAudGhlbihudWxsLCByZWplY3QpOwogICAgICB9CiAgICB9CiAgfSk7Cn0KCi8qKgogKiBDcmVhdGVzIGEgbmV3IGBTZXNzaW9uYCBvYmplY3QgYnkgc2V0dGluZyBjZXJ0YWluIGRlZmF1bHQgcGFyYW1ldGVycy4gSWYgb3B0aW9uYWwgQHBhcmFtIGNvbnRleHQKICogaXMgcGFzc2VkLCB0aGUgcGFzc2VkIHByb3BlcnRpZXMgYXJlIGFwcGxpZWQgdG8gdGhlIHNlc3Npb24gb2JqZWN0LgogKgogKiBAcGFyYW0gY29udGV4dCAob3B0aW9uYWwpIGFkZGl0aW9uYWwgcHJvcGVydGllcyB0byBiZSBhcHBsaWVkIHRvIHRoZSByZXR1cm5lZCBzZXNzaW9uIG9iamVjdAogKgogKiBAcmV0dXJucyBhIG5ldyBgU2Vzc2lvbmAgb2JqZWN0CiAqLwpmdW5jdGlvbiBtYWtlU2Vzc2lvbihjb250ZXh0KSB7CiAgLy8gQm90aCB0aW1lc3RhbXAgYW5kIHN0YXJ0ZWQgYXJlIGluIHNlY29uZHMgc2luY2UgdGhlIFVOSVggZXBvY2guCiAgY29uc3Qgc3RhcnRpbmdUaW1lID0gdGltZXN0YW1wSW5TZWNvbmRzKCk7CgogIGNvbnN0IHNlc3Npb24gPSB7CiAgICBzaWQ6IHV1aWQ0KCksCiAgICBpbml0OiB0cnVlLAogICAgdGltZXN0YW1wOiBzdGFydGluZ1RpbWUsCiAgICBzdGFydGVkOiBzdGFydGluZ1RpbWUsCiAgICBkdXJhdGlvbjogMCwKICAgIHN0YXR1czogJ29rJywKICAgIGVycm9yczogMCwKICAgIGlnbm9yZUR1cmF0aW9uOiBmYWxzZSwKICAgIHRvSlNPTjogKCkgPT4gc2Vzc2lvblRvSlNPTihzZXNzaW9uKSwKICB9OwoKICBpZiAoY29udGV4dCkgewogICAgdXBkYXRlU2Vzc2lvbihzZXNzaW9uLCBjb250ZXh0KTsKICB9CgogIHJldHVybiBzZXNzaW9uOwp9CgovKioKICogVXBkYXRlcyBhIHNlc3Npb24gb2JqZWN0IHdpdGggdGhlIHByb3BlcnRpZXMgcGFzc2VkIGluIHRoZSBjb250ZXh0LgogKgogKiBOb3RlIHRoYXQgdGhpcyBmdW5jdGlvbiBtdXRhdGVzIHRoZSBwYXNzZWQgb2JqZWN0IGFuZCByZXR1cm5zIHZvaWQuCiAqIChIYWQgdG8gZG8gdGhpcyBpbnN0ZWFkIG9mIHJldHVybmluZyBhIG5ldyBhbmQgdXBkYXRlZCBzZXNzaW9uIGJlY2F1c2UgY2xvc2luZyBhbmQgc2VuZGluZyBhIHNlc3Npb24KICogbWFrZXMgYW4gdXBkYXRlIHRvIHRoZSBzZXNzaW9uIGFmdGVyIGl0IHdhcyBwYXNzZWQgdG8gdGhlIHNlbmRpbmcgbG9naWMuCiAqIEBzZWUgQmFzZUNsaWVudC5jYXB0dXJlU2Vzc2lvbiApCiAqCiAqIEBwYXJhbSBzZXNzaW9uIHRoZSBgU2Vzc2lvbmAgdG8gdXBkYXRlCiAqIEBwYXJhbSBjb250ZXh0IHRoZSBgU2Vzc2lvbkNvbnRleHRgIGhvbGRpbmcgdGhlIHByb3BlcnRpZXMgdGhhdCBzaG91bGQgYmUgdXBkYXRlZCBpbiBAcGFyYW0gc2Vzc2lvbgogKi8KLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHkKZnVuY3Rpb24gdXBkYXRlU2Vzc2lvbihzZXNzaW9uLCBjb250ZXh0ID0ge30pIHsKICBpZiAoY29udGV4dC51c2VyKSB7CiAgICBpZiAoIXNlc3Npb24uaXBBZGRyZXNzICYmIGNvbnRleHQudXNlci5pcF9hZGRyZXNzKSB7CiAgICAgIHNlc3Npb24uaXBBZGRyZXNzID0gY29udGV4dC51c2VyLmlwX2FkZHJlc3M7CiAgICB9CgogICAgaWYgKCFzZXNzaW9uLmRpZCAmJiAhY29udGV4dC5kaWQpIHsKICAgICAgc2Vzc2lvbi5kaWQgPSBjb250ZXh0LnVzZXIuaWQgfHwgY29udGV4dC51c2VyLmVtYWlsIHx8IGNvbnRleHQudXNlci51c2VybmFtZTsKICAgIH0KICB9CgogIHNlc3Npb24udGltZXN0YW1wID0gY29udGV4dC50aW1lc3RhbXAgfHwgdGltZXN0YW1wSW5TZWNvbmRzKCk7CgogIGlmIChjb250ZXh0LmFibm9ybWFsX21lY2hhbmlzbSkgewogICAgc2Vzc2lvbi5hYm5vcm1hbF9tZWNoYW5pc20gPSBjb250ZXh0LmFibm9ybWFsX21lY2hhbmlzbTsKICB9CgogIGlmIChjb250ZXh0Lmlnbm9yZUR1cmF0aW9uKSB7CiAgICBzZXNzaW9uLmlnbm9yZUR1cmF0aW9uID0gY29udGV4dC5pZ25vcmVEdXJhdGlvbjsKICB9CiAgaWYgKGNvbnRleHQuc2lkKSB7CiAgICAvLyBHb29kIGVub3VnaCB1dWlkIHZhbGlkYXRpb24uIOKAlCBLYW1pbAogICAgc2Vzc2lvbi5zaWQgPSBjb250ZXh0LnNpZC5sZW5ndGggPT09IDMyID8gY29udGV4dC5zaWQgOiB1dWlkNCgpOwogIH0KICBpZiAoY29udGV4dC5pbml0ICE9PSB1bmRlZmluZWQpIHsKICAgIHNlc3Npb24uaW5pdCA9IGNvbnRleHQuaW5pdDsKICB9CiAgaWYgKCFzZXNzaW9uLmRpZCAmJiBjb250ZXh0LmRpZCkgewogICAgc2Vzc2lvbi5kaWQgPSBgJHtjb250ZXh0LmRpZH1gOwogIH0KICBpZiAodHlwZW9mIGNvbnRleHQuc3RhcnRlZCA9PT0gJ251bWJlcicpIHsKICAgIHNlc3Npb24uc3RhcnRlZCA9IGNvbnRleHQuc3RhcnRlZDsKICB9CiAgaWYgKHNlc3Npb24uaWdub3JlRHVyYXRpb24pIHsKICAgIHNlc3Npb24uZHVyYXRpb24gPSB1bmRlZmluZWQ7CiAgfSBlbHNlIGlmICh0eXBlb2YgY29udGV4dC5kdXJhdGlvbiA9PT0gJ251bWJlcicpIHsKICAgIHNlc3Npb24uZHVyYXRpb24gPSBjb250ZXh0LmR1cmF0aW9uOwogIH0gZWxzZSB7CiAgICBjb25zdCBkdXJhdGlvbiA9IHNlc3Npb24udGltZXN0YW1wIC0gc2Vzc2lvbi5zdGFydGVkOwogICAgc2Vzc2lvbi5kdXJhdGlvbiA9IGR1cmF0aW9uID49IDAgPyBkdXJhdGlvbiA6IDA7CiAgfQogIGlmIChjb250ZXh0LnJlbGVhc2UpIHsKICAgIHNlc3Npb24ucmVsZWFzZSA9IGNvbnRleHQucmVsZWFzZTsKICB9CiAgaWYgKGNvbnRleHQuZW52aXJvbm1lbnQpIHsKICAgIHNlc3Npb24uZW52aXJvbm1lbnQgPSBjb250ZXh0LmVudmlyb25tZW50OwogIH0KICBpZiAoIXNlc3Npb24uaXBBZGRyZXNzICYmIGNvbnRleHQuaXBBZGRyZXNzKSB7CiAgICBzZXNzaW9uLmlwQWRkcmVzcyA9IGNvbnRleHQuaXBBZGRyZXNzOwogIH0KICBpZiAoIXNlc3Npb24udXNlckFnZW50ICYmIGNvbnRleHQudXNlckFnZW50KSB7CiAgICBzZXNzaW9uLnVzZXJBZ2VudCA9IGNvbnRleHQudXNlckFnZW50OwogIH0KICBpZiAodHlwZW9mIGNvbnRleHQuZXJyb3JzID09PSAnbnVtYmVyJykgewogICAgc2Vzc2lvbi5lcnJvcnMgPSBjb250ZXh0LmVycm9yczsKICB9CiAgaWYgKGNvbnRleHQuc3RhdHVzKSB7CiAgICBzZXNzaW9uLnN0YXR1cyA9IGNvbnRleHQuc3RhdHVzOwogIH0KfQoKLyoqCiAqIENsb3NlcyBhIHNlc3Npb24gYnkgc2V0dGluZyBpdHMgc3RhdHVzIGFuZCB1cGRhdGluZyB0aGUgc2Vzc2lvbiBvYmplY3Qgd2l0aCBpdC4KICogSW50ZXJuYWxseSBjYWxscyBgdXBkYXRlU2Vzc2lvbmAgdG8gdXBkYXRlIHRoZSBwYXNzZWQgc2Vzc2lvbiBvYmplY3QuCiAqCiAqIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIG11dGF0ZXMgdGhlIHBhc3NlZCBzZXNzaW9uIChAc2VlIHVwZGF0ZVNlc3Npb24gZm9yIGV4cGxhbmF0aW9uKS4KICoKICogQHBhcmFtIHNlc3Npb24gdGhlIGBTZXNzaW9uYCBvYmplY3QgdG8gYmUgY2xvc2VkCiAqIEBwYXJhbSBzdGF0dXMgdGhlIGBTZXNzaW9uU3RhdHVzYCB3aXRoIHdoaWNoIHRoZSBzZXNzaW9uIHdhcyBjbG9zZWQuIElmIHlvdSBkb24ndCBwYXNzIGEgc3RhdHVzLAogKiAgICAgICAgICAgICAgIHRoaXMgZnVuY3Rpb24gd2lsbCBrZWVwIHRoZSBwcmV2aW91c2x5IHNldCBzdGF0dXMsIHVubGVzcyBpdCB3YXMgYCdvaydgIGluIHdoaWNoIGNhc2UKICogICAgICAgICAgICAgICBpdCBpcyBjaGFuZ2VkIHRvIGAnZXhpdGVkJ2AuCiAqLwpmdW5jdGlvbiBjbG9zZVNlc3Npb24oc2Vzc2lvbiwgc3RhdHVzKSB7CiAgbGV0IGNvbnRleHQgPSB7fTsKICBpZiAoc3RhdHVzKSB7CiAgICBjb250ZXh0ID0geyBzdGF0dXMgfTsKICB9IGVsc2UgaWYgKHNlc3Npb24uc3RhdHVzID09PSAnb2snKSB7CiAgICBjb250ZXh0ID0geyBzdGF0dXM6ICdleGl0ZWQnIH07CiAgfQoKICB1cGRhdGVTZXNzaW9uKHNlc3Npb24sIGNvbnRleHQpOwp9CgovKioKICogU2VyaWFsaXplcyBhIHBhc3NlZCBzZXNzaW9uIG9iamVjdCB0byBhIEpTT04gb2JqZWN0IHdpdGggYSBzbGlnaHRseSBkaWZmZXJlbnQgc3RydWN0dXJlLgogKiBUaGlzIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHRoZSBTZW50cnkgYmFja2VuZCByZXF1aXJlcyBhIHNsaWdodGx5IGRpZmZlcmVudCBzY2hlbWEgb2YgYSBzZXNzaW9uCiAqIHRoYW4gdGhlIG9uZSB0aGUgSlMgU0RLcyB1c2UgaW50ZXJuYWxseS4KICoKICogQHBhcmFtIHNlc3Npb24gdGhlIHNlc3Npb24gdG8gYmUgY29udmVydGVkCiAqCiAqIEByZXR1cm5zIGEgSlNPTiBvYmplY3Qgb2YgdGhlIHBhc3NlZCBzZXNzaW9uCiAqLwpmdW5jdGlvbiBzZXNzaW9uVG9KU09OKHNlc3Npb24pIHsKICByZXR1cm4gZHJvcFVuZGVmaW5lZEtleXMoewogICAgc2lkOiBgJHtzZXNzaW9uLnNpZH1gLAogICAgaW5pdDogc2Vzc2lvbi5pbml0LAogICAgLy8gTWFrZSBzdXJlIHRoYXQgc2VjIGlzIGNvbnZlcnRlZCB0byBtcyBmb3IgZGF0ZSBjb25zdHJ1Y3RvcgogICAgc3RhcnRlZDogbmV3IERhdGUoc2Vzc2lvbi5zdGFydGVkICogMTAwMCkudG9JU09TdHJpbmcoKSwKICAgIHRpbWVzdGFtcDogbmV3IERhdGUoc2Vzc2lvbi50aW1lc3RhbXAgKiAxMDAwKS50b0lTT1N0cmluZygpLAogICAgc3RhdHVzOiBzZXNzaW9uLnN0YXR1cywKICAgIGVycm9yczogc2Vzc2lvbi5lcnJvcnMsCiAgICBkaWQ6IHR5cGVvZiBzZXNzaW9uLmRpZCA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHNlc3Npb24uZGlkID09PSAnc3RyaW5nJyA/IGAke3Nlc3Npb24uZGlkfWAgOiB1bmRlZmluZWQsCiAgICBkdXJhdGlvbjogc2Vzc2lvbi5kdXJhdGlvbiwKICAgIGFibm9ybWFsX21lY2hhbmlzbTogc2Vzc2lvbi5hYm5vcm1hbF9tZWNoYW5pc20sCiAgICBhdHRyczogewogICAgICByZWxlYXNlOiBzZXNzaW9uLnJlbGVhc2UsCiAgICAgIGVudmlyb25tZW50OiBzZXNzaW9uLmVudmlyb25tZW50LAogICAgICBpcF9hZGRyZXNzOiBzZXNzaW9uLmlwQWRkcmVzcywKICAgICAgdXNlcl9hZ2VudDogc2Vzc2lvbi51c2VyQWdlbnQsCiAgICB9LAogIH0pOwp9Cgpjb25zdCBUUkFDRV9GTEFHX1NBTVBMRUQgPSAweDE7CgovKioKICogQ29udmVydCBhIHNwYW4gdG8gYSB0cmFjZSBjb250ZXh0LCB3aGljaCBjYW4gYmUgc2VudCBhcyB0aGUgYHRyYWNlYCBjb250ZXh0IGluIGFuIGV2ZW50LgogKi8KZnVuY3Rpb24gc3BhblRvVHJhY2VDb250ZXh0KHNwYW4pIHsKICBjb25zdCB7IHNwYW5JZDogc3Bhbl9pZCwgdHJhY2VJZDogdHJhY2VfaWQgfSA9IHNwYW4uc3BhbkNvbnRleHQoKTsKICBjb25zdCB7IGRhdGEsIG9wLCBwYXJlbnRfc3Bhbl9pZCwgc3RhdHVzLCB0YWdzLCBvcmlnaW4gfSA9IHNwYW5Ub0pTT04oc3Bhbik7CgogIHJldHVybiBkcm9wVW5kZWZpbmVkS2V5cyh7CiAgICBkYXRhLAogICAgb3AsCiAgICBwYXJlbnRfc3Bhbl9pZCwKICAgIHNwYW5faWQsCiAgICBzdGF0dXMsCiAgICB0YWdzLAogICAgdHJhY2VfaWQsCiAgICBvcmlnaW4sCiAgfSk7Cn0KCi8qKgogKiBDb252ZXJ0IGEgc3BhbiB0byBhIEpTT04gcmVwcmVzZW50YXRpb24uCiAqIE5vdGUgdGhhdCBhbGwgZmllbGRzIHJldHVybmVkIGhlcmUgYXJlIG9wdGlvbmFsIGFuZCBuZWVkIHRvIGJlIGd1YXJkZWQgYWdhaW5zdC4KICoKICogTm90ZTogQmVjYXVzZSBvZiB0aGlzLCB3ZSBjdXJyZW50bHkgaGF2ZSBhIGNpcmN1bGFyIHR5cGUgZGVwZW5kZW5jeSAod2hpY2ggd2Ugb3B0ZWQgb3V0IG9mIGluIHBhY2thZ2UuanNvbikuCiAqIFRoaXMgaXMgbm90IGF2b2lkYWJsZSBhcyB3ZSBuZWVkIGBzcGFuVG9KU09OYCBpbiBgc3BhblV0aWxzLnRzYCwgd2hpY2ggaW4gdHVybiBpcyBuZWVkZWQgYnkgYHNwYW4udHNgIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS4KICogQW5kIGBzcGFuVG9KU09OYCBuZWVkcyB0aGUgU3BhbiBjbGFzcyBmcm9tIGBzcGFuLnRzYCB0byBjaGVjayBoZXJlLgogKiBUT0RPIHY4OiBXaGVuIHdlIHJlbW92ZSB0aGUgZGVwcmVjYXRlZCBzdHVmZiBmcm9tIGBzcGFuLnRzYCwgd2UgY2FuIHJlbW92ZSB0aGUgY2lyY3VsYXIgZGVwZW5kZW5jeSBhZ2Fpbi4KICovCmZ1bmN0aW9uIHNwYW5Ub0pTT04oc3BhbikgewogIGlmIChzcGFuSXNTcGFuQ2xhc3Moc3BhbikpIHsKICAgIHJldHVybiBzcGFuLmdldFNwYW5KU09OKCk7CiAgfQoKICAvLyBGYWxsYmFjazogV2UgYWxzbyBjaGVjayBmb3IgYC50b0pTT04oKWAgaGVyZS4uLgogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogIGlmICh0eXBlb2Ygc3Bhbi50b0pTT04gPT09ICdmdW5jdGlvbicpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgcmV0dXJuIHNwYW4udG9KU09OKCk7CiAgfQoKICByZXR1cm4ge307Cn0KCi8qKgogKiBTYWRseSwgZHVlIHRvIGNpcmN1bGFyIGRlcGVuZGVuY3kgY2hlY2tzIHdlIGNhbm5vdCBhY3R1YWxseSBpbXBvcnQgdGhlIFNwYW4gY2xhc3MgaGVyZSBhbmQgY2hlY2sgZm9yIGluc3RhbmNlb2YuCiAqIDooIFNvIGluc3RlYWQgd2UgYXBwcm94aW1hdGUgdGhpcyBieSBjaGVja2luZyBpZiBpdCBoYXMgdGhlIGBnZXRTcGFuSlNPTmAgbWV0aG9kLgogKi8KZnVuY3Rpb24gc3BhbklzU3BhbkNsYXNzKHNwYW4pIHsKICByZXR1cm4gdHlwZW9mIChzcGFuICkuZ2V0U3BhbkpTT04gPT09ICdmdW5jdGlvbic7Cn0KCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgYSBzcGFuIGlzIHNhbXBsZWQuCiAqIEluIG1vc3QgY2FzZXMsIHlvdSBzaG91bGQganVzdCB1c2UgYHNwYW4uaXNSZWNvcmRpbmcoKWAgaW5zdGVhZC4KICogSG93ZXZlciwgdGhpcyBoYXMgYSBzbGlnaHRseSBkaWZmZXJlbnQgc2VtYW50aWMsIGFzIGl0IGFsc28gcmV0dXJucyBmYWxzZSBpZiB0aGUgc3BhbiBpcyBmaW5pc2hlZC4KICogU28gaW4gdGhlIGNhc2Ugd2hlcmUgdGhpcyBkaXN0aW5jdGlvbiBpcyBpbXBvcnRhbnQsIHVzZSB0aGlzIG1ldGhvZC4KICovCmZ1bmN0aW9uIHNwYW5Jc1NhbXBsZWQoc3BhbikgewogIC8vIFdlIGFsaWduIG91ciB0cmFjZSBmbGFncyB3aXRoIHRoZSBvbmVzIE9wZW5UZWxlbWV0cnkgdXNlCiAgLy8gU28gd2UgYWxzbyBjaGVjayBmb3Igc2FtcGxlZCB0aGUgc2FtZSB3YXkgdGhleSBkby4KICBjb25zdCB7IHRyYWNlRmxhZ3MgfSA9IHNwYW4uc3BhbkNvbnRleHQoKTsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYml0d2lzZQogIHJldHVybiBCb29sZWFuKHRyYWNlRmxhZ3MgJiBUUkFDRV9GTEFHX1NBTVBMRUQpOwp9CgovKioKICogR2V0IHRoZSBjdXJyZW50bHkgYWN0aXZlIGNsaWVudC4KICovCmZ1bmN0aW9uIGdldENsaWVudCgpIHsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICByZXR1cm4gZ2V0Q3VycmVudEh1YigpLmdldENsaWVudCgpOwp9CgovKioKICogR2V0IHRoZSBjdXJyZW50bHkgYWN0aXZlIHNjb3BlLgogKi8KZnVuY3Rpb24gZ2V0Q3VycmVudFNjb3BlKCkgewogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogIHJldHVybiBnZXRDdXJyZW50SHViKCkuZ2V0U2NvcGUoKTsKfQoKLyoqCiAqIFJldHVybnMgdGhlIHJvb3Qgc3BhbiBvZiBhIGdpdmVuIHNwYW4uCiAqCiAqIEFzIGxvbmcgYXMgd2UgdXNlIGBUcmFuc2FjdGlvbmBzIGludGVybmFsbHksIHRoZSByZXR1cm5lZCByb290IHNwYW4KICogd2lsbCBiZSBhIGBUcmFuc2FjdGlvbmAgYnV0IGJlIGF3YXJlIHRoYXQgdGhpcyBtaWdodCBjaGFuZ2UgaW4gdGhlIGZ1dHVyZS4KICoKICogSWYgdGhlIGdpdmVuIHNwYW4gaGFzIG5vIHJvb3Qgc3BhbiBvciB0cmFuc2FjdGlvbiwgYHVuZGVmaW5lZGAgaXMgcmV0dXJuZWQuCiAqLwpmdW5jdGlvbiBnZXRSb290U3BhbihzcGFuKSB7CiAgLy8gVE9ETyAodjgpOiBSZW1vdmUgdGhpcyBjaGVjayBhbmQganVzdCByZXR1cm4gc3BhbgogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogIHJldHVybiBzcGFuLnRyYW5zYWN0aW9uOwp9CgovKioKICogQ3JlYXRlcyBhIGR5bmFtaWMgc2FtcGxpbmcgY29udGV4dCBmcm9tIGEgY2xpZW50LgogKgogKiBEaXNwYXRjaGVzIHRoZSBgY3JlYXRlRHNjYCBsaWZlY3ljbGUgaG9vayBhcyBhIHNpZGUgZWZmZWN0LgogKi8KZnVuY3Rpb24gZ2V0RHluYW1pY1NhbXBsaW5nQ29udGV4dEZyb21DbGllbnQoCiAgdHJhY2VfaWQsCiAgY2xpZW50LAogIHNjb3BlLAopIHsKICBjb25zdCBvcHRpb25zID0gY2xpZW50LmdldE9wdGlvbnMoKTsKCiAgY29uc3QgeyBwdWJsaWNLZXk6IHB1YmxpY19rZXkgfSA9IGNsaWVudC5nZXREc24oKSB8fCB7fTsKICAvLyBUT0RPKHY4KTogUmVtb3ZlIHNlZ21lbnQgZnJvbSBVc2VyCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgY29uc3QgeyBzZWdtZW50OiB1c2VyX3NlZ21lbnQgfSA9IChzY29wZSAmJiBzY29wZS5nZXRVc2VyKCkpIHx8IHt9OwoKICBjb25zdCBkc2MgPSBkcm9wVW5kZWZpbmVkS2V5cyh7CiAgICBlbnZpcm9ubWVudDogb3B0aW9ucy5lbnZpcm9ubWVudCB8fCBERUZBVUxUX0VOVklST05NRU5ULAogICAgcmVsZWFzZTogb3B0aW9ucy5yZWxlYXNlLAogICAgdXNlcl9zZWdtZW50LAogICAgcHVibGljX2tleSwKICAgIHRyYWNlX2lkLAogIH0pIDsKCiAgY2xpZW50LmVtaXQgJiYgY2xpZW50LmVtaXQoJ2NyZWF0ZURzYycsIGRzYyk7CgogIHJldHVybiBkc2M7Cn0KCi8qKgogKiBBIFNwYW4gd2l0aCBhIGZyb3plbiBkeW5hbWljIHNhbXBsaW5nIGNvbnRleHQuCiAqLwoKLyoqCiAqIENyZWF0ZXMgYSBkeW5hbWljIHNhbXBsaW5nIGNvbnRleHQgZnJvbSBhIHNwYW4gKGFuZCBjbGllbnQgYW5kIHNjb3BlKQogKgogKiBAcGFyYW0gc3BhbiB0aGUgc3BhbiBmcm9tIHdoaWNoIGEgZmV3IHZhbHVlcyBsaWtlIHRoZSByb290IHNwYW4gbmFtZSBhbmQgc2FtcGxlIHJhdGUgYXJlIGV4dHJhY3RlZC4KICoKICogQHJldHVybnMgYSBkeW5hbWljIHNhbXBsaW5nIGNvbnRleHQKICovCmZ1bmN0aW9uIGdldER5bmFtaWNTYW1wbGluZ0NvbnRleHRGcm9tU3BhbihzcGFuKSB7CiAgY29uc3QgY2xpZW50ID0gZ2V0Q2xpZW50KCk7CiAgaWYgKCFjbGllbnQpIHsKICAgIHJldHVybiB7fTsKICB9CgogIC8vIHBhc3NpbmcgZW1pdD1mYWxzZSBoZXJlIHRvIG9ubHkgZW1pdCBsYXRlciBvbmNlIHRoZSBEU0MgaXMgYWN0dWFsbHkgcG9wdWxhdGVkCiAgY29uc3QgZHNjID0gZ2V0RHluYW1pY1NhbXBsaW5nQ29udGV4dEZyb21DbGllbnQoc3BhblRvSlNPTihzcGFuKS50cmFjZV9pZCB8fCAnJywgY2xpZW50LCBnZXRDdXJyZW50U2NvcGUoKSk7CgogIC8vIFRPRE8gKHY4KTogUmVtb3ZlIHY3RnJvemVuRHNjIGFzIGEgVHJhbnNhY3Rpb24gd2lsbCBubyBsb25nZXIgaGF2ZSBfZnJvemVuRHluYW1pY1NhbXBsaW5nQ29udGV4dAogIGNvbnN0IHR4biA9IGdldFJvb3RTcGFuKHNwYW4pIDsKICBpZiAoIXR4bikgewogICAgcmV0dXJuIGRzYzsKICB9CgogIC8vIFRPRE8gKHY4KTogUmVtb3ZlIHY3RnJvemVuRHNjIGFzIGEgVHJhbnNhY3Rpb24gd2lsbCBubyBsb25nZXIgaGF2ZSBfZnJvemVuRHluYW1pY1NhbXBsaW5nQ29udGV4dAogIC8vIEZvciBub3cgd2UgbmVlZCB0byBhdm9pZCBicmVha2luZyB1c2VycyB3aG8gZGlyZWN0bHkgY3JlYXRlZCBhIHR4biB3aXRoIGEgRFNDLCB3aGVyZSB0aGlzIGZpZWxkIGlzIHN0aWxsIHNldC4KICAvLyBAc2VlIFRyYW5zYWN0aW9uIGNsYXNzIGNvbnN0cnVjdG9yCiAgY29uc3QgdjdGcm96ZW5Ec2MgPSB0eG4gJiYgdHhuLl9mcm96ZW5EeW5hbWljU2FtcGxpbmdDb250ZXh0OwogIGlmICh2N0Zyb3plbkRzYykgewogICAgcmV0dXJuIHY3RnJvemVuRHNjOwogIH0KCiAgLy8gVE9ETyAodjgpOiBSZXBsYWNlIHR4bi5tZXRhZGF0YSB3aXRoIHR4bi5hdHRyaWJ1dGVzW10KICAvLyBXZSBjYW4ndCBkbyB0aGlzIHlldCBiZWNhdXNlIGF0dHJpYnV0ZXMgYXJlbid0IGFsd2F5cyBzZXQgeWV0LgogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogIGNvbnN0IHsgc2FtcGxlUmF0ZTogbWF5YmVTYW1wbGVSYXRlLCBzb3VyY2UgfSA9IHR4bi5tZXRhZGF0YTsKICBpZiAobWF5YmVTYW1wbGVSYXRlICE9IG51bGwpIHsKICAgIGRzYy5zYW1wbGVfcmF0ZSA9IGAke21heWJlU2FtcGxlUmF0ZX1gOwogIH0KCiAgLy8gV2UgZG9uJ3Qgd2FudCB0byBoYXZlIGEgdHJhbnNhY3Rpb24gbmFtZSBpbiB0aGUgRFNDIGlmIHRoZSBzb3VyY2UgaXMgInVybCIgYmVjYXVzZSBVUkxzIG1pZ2h0IGNvbnRhaW4gUElJCiAgY29uc3QganNvblNwYW4gPSBzcGFuVG9KU09OKHR4bik7CgogIC8vIGFmdGVyIEpTT04gY29udmVyc2lvbiwgdHhuLm5hbWUgYmVjb21lcyBqc29uU3Bhbi5kZXNjcmlwdGlvbgogIGlmIChzb3VyY2UgJiYgc291cmNlICE9PSAndXJsJykgewogICAgZHNjLnRyYW5zYWN0aW9uID0ganNvblNwYW4uZGVzY3JpcHRpb247CiAgfQoKICBkc2Muc2FtcGxlZCA9IFN0cmluZyhzcGFuSXNTYW1wbGVkKHR4bikpOwoKICBjbGllbnQuZW1pdCAmJiBjbGllbnQuZW1pdCgnY3JlYXRlRHNjJywgZHNjKTsKCiAgcmV0dXJuIGRzYzsKfQoKLyoqCiAqIEFwcGxpZXMgZGF0YSBmcm9tIHRoZSBzY29wZSB0byB0aGUgZXZlbnQgYW5kIHJ1bnMgYWxsIGV2ZW50IHByb2Nlc3NvcnMgb24gaXQuCiAqLwpmdW5jdGlvbiBhcHBseVNjb3BlRGF0YVRvRXZlbnQoZXZlbnQsIGRhdGEpIHsKICBjb25zdCB7IGZpbmdlcnByaW50LCBzcGFuLCBicmVhZGNydW1icywgc2RrUHJvY2Vzc2luZ01ldGFkYXRhIH0gPSBkYXRhOwoKICAvLyBBcHBseSBnZW5lcmFsIGRhdGEKICBhcHBseURhdGFUb0V2ZW50KGV2ZW50LCBkYXRhKTsKCiAgLy8gV2Ugd2FudCB0byBzZXQgdGhlIHRyYWNlIGNvbnRleHQgZm9yIG5vcm1hbCBldmVudHMgb25seSBpZiB0aGVyZSBpc24ndCBhbHJlYWR5CiAgLy8gYSB0cmFjZSBjb250ZXh0IG9uIHRoZSBldmVudC4gVGhlcmUgaXMgYSBwcm9kdWN0IGZlYXR1cmUgaW4gcGxhY2Ugd2hlcmUgd2UgbGluawogIC8vIGVycm9ycyB3aXRoIHRyYW5zYWN0aW9uIGFuZCBpdCByZWxpZXMgb24gdGhhdC4KICBpZiAoc3BhbikgewogICAgYXBwbHlTcGFuVG9FdmVudChldmVudCwgc3Bhbik7CiAgfQoKICBhcHBseUZpbmdlcnByaW50VG9FdmVudChldmVudCwgZmluZ2VycHJpbnQpOwogIGFwcGx5QnJlYWRjcnVtYnNUb0V2ZW50KGV2ZW50LCBicmVhZGNydW1icyk7CiAgYXBwbHlTZGtNZXRhZGF0YVRvRXZlbnQoZXZlbnQsIHNka1Byb2Nlc3NpbmdNZXRhZGF0YSk7Cn0KCmZ1bmN0aW9uIGFwcGx5RGF0YVRvRXZlbnQoZXZlbnQsIGRhdGEpIHsKICBjb25zdCB7CiAgICBleHRyYSwKICAgIHRhZ3MsCiAgICB1c2VyLAogICAgY29udGV4dHMsCiAgICBsZXZlbCwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdHJhbnNhY3Rpb25OYW1lLAogIH0gPSBkYXRhOwoKICBjb25zdCBjbGVhbmVkRXh0cmEgPSBkcm9wVW5kZWZpbmVkS2V5cyhleHRyYSk7CiAgaWYgKGNsZWFuZWRFeHRyYSAmJiBPYmplY3Qua2V5cyhjbGVhbmVkRXh0cmEpLmxlbmd0aCkgewogICAgZXZlbnQuZXh0cmEgPSB7IC4uLmNsZWFuZWRFeHRyYSwgLi4uZXZlbnQuZXh0cmEgfTsKICB9CgogIGNvbnN0IGNsZWFuZWRUYWdzID0gZHJvcFVuZGVmaW5lZEtleXModGFncyk7CiAgaWYgKGNsZWFuZWRUYWdzICYmIE9iamVjdC5rZXlzKGNsZWFuZWRUYWdzKS5sZW5ndGgpIHsKICAgIGV2ZW50LnRhZ3MgPSB7IC4uLmNsZWFuZWRUYWdzLCAuLi5ldmVudC50YWdzIH07CiAgfQoKICBjb25zdCBjbGVhbmVkVXNlciA9IGRyb3BVbmRlZmluZWRLZXlzKHVzZXIpOwogIGlmIChjbGVhbmVkVXNlciAmJiBPYmplY3Qua2V5cyhjbGVhbmVkVXNlcikubGVuZ3RoKSB7CiAgICBldmVudC51c2VyID0geyAuLi5jbGVhbmVkVXNlciwgLi4uZXZlbnQudXNlciB9OwogIH0KCiAgY29uc3QgY2xlYW5lZENvbnRleHRzID0gZHJvcFVuZGVmaW5lZEtleXMoY29udGV4dHMpOwogIGlmIChjbGVhbmVkQ29udGV4dHMgJiYgT2JqZWN0LmtleXMoY2xlYW5lZENvbnRleHRzKS5sZW5ndGgpIHsKICAgIGV2ZW50LmNvbnRleHRzID0geyAuLi5jbGVhbmVkQ29udGV4dHMsIC4uLmV2ZW50LmNvbnRleHRzIH07CiAgfQoKICBpZiAobGV2ZWwpIHsKICAgIGV2ZW50LmxldmVsID0gbGV2ZWw7CiAgfQoKICBpZiAodHJhbnNhY3Rpb25OYW1lKSB7CiAgICBldmVudC50cmFuc2FjdGlvbiA9IHRyYW5zYWN0aW9uTmFtZTsKICB9Cn0KCmZ1bmN0aW9uIGFwcGx5QnJlYWRjcnVtYnNUb0V2ZW50KGV2ZW50LCBicmVhZGNydW1icykgewogIGNvbnN0IG1lcmdlZEJyZWFkY3J1bWJzID0gWy4uLihldmVudC5icmVhZGNydW1icyB8fCBbXSksIC4uLmJyZWFkY3J1bWJzXTsKICBldmVudC5icmVhZGNydW1icyA9IG1lcmdlZEJyZWFkY3J1bWJzLmxlbmd0aCA/IG1lcmdlZEJyZWFkY3J1bWJzIDogdW5kZWZpbmVkOwp9CgpmdW5jdGlvbiBhcHBseVNka01ldGFkYXRhVG9FdmVudChldmVudCwgc2RrUHJvY2Vzc2luZ01ldGFkYXRhKSB7CiAgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhID0gewogICAgLi4uZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhLAogICAgLi4uc2RrUHJvY2Vzc2luZ01ldGFkYXRhLAogIH07Cn0KCmZ1bmN0aW9uIGFwcGx5U3BhblRvRXZlbnQoZXZlbnQsIHNwYW4pIHsKICBldmVudC5jb250ZXh0cyA9IHsgdHJhY2U6IHNwYW5Ub1RyYWNlQ29udGV4dChzcGFuKSwgLi4uZXZlbnQuY29udGV4dHMgfTsKICBjb25zdCByb290U3BhbiA9IGdldFJvb3RTcGFuKHNwYW4pOwogIGlmIChyb290U3BhbikgewogICAgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhID0gewogICAgICBkeW5hbWljU2FtcGxpbmdDb250ZXh0OiBnZXREeW5hbWljU2FtcGxpbmdDb250ZXh0RnJvbVNwYW4oc3BhbiksCiAgICAgIC4uLmV2ZW50LnNka1Byb2Nlc3NpbmdNZXRhZGF0YSwKICAgIH07CiAgICBjb25zdCB0cmFuc2FjdGlvbk5hbWUgPSBzcGFuVG9KU09OKHJvb3RTcGFuKS5kZXNjcmlwdGlvbjsKICAgIGlmICh0cmFuc2FjdGlvbk5hbWUpIHsKICAgICAgZXZlbnQudGFncyA9IHsgdHJhbnNhY3Rpb246IHRyYW5zYWN0aW9uTmFtZSwgLi4uZXZlbnQudGFncyB9OwogICAgfQogIH0KfQoKLyoqCiAqIEFwcGxpZXMgZmluZ2VycHJpbnQgZnJvbSB0aGUgc2NvcGUgdG8gdGhlIGV2ZW50IGlmIHRoZXJlJ3Mgb25lLAogKiB1c2VzIG1lc3NhZ2UgaWYgdGhlcmUncyBvbmUgaW5zdGVhZCBvciBnZXQgcmlkIG9mIGVtcHR5IGZpbmdlcnByaW50CiAqLwpmdW5jdGlvbiBhcHBseUZpbmdlcnByaW50VG9FdmVudChldmVudCwgZmluZ2VycHJpbnQpIHsKICAvLyBNYWtlIHN1cmUgaXQncyBhbiBhcnJheSBmaXJzdCBhbmQgd2UgYWN0dWFsbHkgaGF2ZSBzb21ldGhpbmcgaW4gcGxhY2UKICBldmVudC5maW5nZXJwcmludCA9IGV2ZW50LmZpbmdlcnByaW50ID8gYXJyYXlpZnkoZXZlbnQuZmluZ2VycHJpbnQpIDogW107CgogIC8vIElmIHdlIGhhdmUgc29tZXRoaW5nIG9uIHRoZSBzY29wZSwgdGhlbiBtZXJnZSBpdCB3aXRoIGV2ZW50CiAgaWYgKGZpbmdlcnByaW50KSB7CiAgICBldmVudC5maW5nZXJwcmludCA9IGV2ZW50LmZpbmdlcnByaW50LmNvbmNhdChmaW5nZXJwcmludCk7CiAgfQoKICAvLyBJZiB3ZSBoYXZlIG5vIGRhdGEgYXQgYWxsLCByZW1vdmUgZW1wdHkgYXJyYXkgZGVmYXVsdAogIGlmIChldmVudC5maW5nZXJwcmludCAmJiAhZXZlbnQuZmluZ2VycHJpbnQubGVuZ3RoKSB7CiAgICBkZWxldGUgZXZlbnQuZmluZ2VycHJpbnQ7CiAgfQp9CgovKioKICogRGVmYXVsdCB2YWx1ZSBmb3IgbWF4aW11bSBudW1iZXIgb2YgYnJlYWRjcnVtYnMgYWRkZWQgdG8gYW4gZXZlbnQuCiAqLwpjb25zdCBERUZBVUxUX01BWF9CUkVBRENSVU1CUyA9IDEwMDsKCi8qKgogKiBIb2xkcyBhZGRpdGlvbmFsIGV2ZW50IGluZm9ybWF0aW9uLiB7QGxpbmsgU2NvcGUuYXBwbHlUb0V2ZW50fSB3aWxsIGJlCiAqIGNhbGxlZCBieSB0aGUgY2xpZW50IGJlZm9yZSBhbiBldmVudCB3aWxsIGJlIHNlbnQuCiAqLwpjbGFzcyBTY29wZSAgewogIC8qKiBGbGFnIGlmIG5vdGlmeWluZyBpcyBoYXBwZW5pbmcuICovCgogIC8qKiBDYWxsYmFjayBmb3IgY2xpZW50IHRvIHJlY2VpdmUgc2NvcGUgY2hhbmdlcy4gKi8KCiAgLyoqIENhbGxiYWNrIGxpc3QgdGhhdCB3aWxsIGJlIGNhbGxlZCBhZnRlciB7QGxpbmsgYXBwbHlUb0V2ZW50fS4gKi8KCiAgLyoqIEFycmF5IG9mIGJyZWFkY3J1bWJzLiAqLwoKICAvKiogVXNlciAqLwoKICAvKiogVGFncyAqLwoKICAvKiogRXh0cmEgKi8KCiAgLyoqIENvbnRleHRzICovCgogIC8qKiBBdHRhY2htZW50cyAqLwoKICAvKiogUHJvcGFnYXRpb24gQ29udGV4dCBmb3IgZGlzdHJpYnV0ZWQgdHJhY2luZyAqLwoKICAvKioKICAgKiBBIHBsYWNlIHRvIHN0YXNoIGRhdGEgd2hpY2ggaXMgbmVlZGVkIGF0IHNvbWUgcG9pbnQgaW4gdGhlIFNESydzIGV2ZW50IHByb2Nlc3NpbmcgcGlwZWxpbmUgYnV0IHdoaWNoIHNob3VsZG4ndCBnZXQKICAgKiBzZW50IHRvIFNlbnRyeQogICAqLwoKICAvKiogRmluZ2VycHJpbnQgKi8KCiAgLyoqIFNldmVyaXR5ICovCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCgogIC8qKgogICAqIFRyYW5zYWN0aW9uIE5hbWUKICAgKi8KCiAgLyoqIFNwYW4gKi8KCiAgLyoqIFNlc3Npb24gKi8KCiAgLyoqIFJlcXVlc3QgTW9kZSBTZXNzaW9uIFN0YXR1cyAqLwoKICAvKiogVGhlIGNsaWVudCBvbiB0aGlzIHNjb3BlICovCgogIC8vIE5PVEU6IEFueSBmaWVsZCB3aGljaCBnZXRzIGFkZGVkIGhlcmUgc2hvdWxkIGdldCBhZGRlZCBub3Qgb25seSB0byB0aGUgY29uc3RydWN0b3IgYnV0IGFsc28gdG8gdGhlIGBjbG9uZWAgbWV0aG9kLgoKICAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLl9ub3RpZnlpbmdMaXN0ZW5lcnMgPSBmYWxzZTsKICAgIHRoaXMuX3Njb3BlTGlzdGVuZXJzID0gW107CiAgICB0aGlzLl9ldmVudFByb2Nlc3NvcnMgPSBbXTsKICAgIHRoaXMuX2JyZWFkY3J1bWJzID0gW107CiAgICB0aGlzLl9hdHRhY2htZW50cyA9IFtdOwogICAgdGhpcy5fdXNlciA9IHt9OwogICAgdGhpcy5fdGFncyA9IHt9OwogICAgdGhpcy5fZXh0cmEgPSB7fTsKICAgIHRoaXMuX2NvbnRleHRzID0ge307CiAgICB0aGlzLl9zZGtQcm9jZXNzaW5nTWV0YWRhdGEgPSB7fTsKICAgIHRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dCA9IGdlbmVyYXRlUHJvcGFnYXRpb25Db250ZXh0KCk7CiAgfQoKICAvKioKICAgKiBJbmhlcml0IHZhbHVlcyBmcm9tIHRoZSBwYXJlbnQgc2NvcGUuCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBzY29wZS5jbG9uZSgpYCBhbmQgYG5ldyBTY29wZSgpYCBpbnN0ZWFkLgogICAqLwogICBzdGF0aWMgY2xvbmUoc2NvcGUpIHsKICAgIHJldHVybiBzY29wZSA/IHNjb3BlLmNsb25lKCkgOiBuZXcgU2NvcGUoKTsKICB9CgogIC8qKgogICAqIENsb25lIHRoaXMgc2NvcGUgaW5zdGFuY2UuCiAgICovCiAgIGNsb25lKCkgewogICAgY29uc3QgbmV3U2NvcGUgPSBuZXcgU2NvcGUoKTsKICAgIG5ld1Njb3BlLl9icmVhZGNydW1icyA9IFsuLi50aGlzLl9icmVhZGNydW1ic107CiAgICBuZXdTY29wZS5fdGFncyA9IHsgLi4udGhpcy5fdGFncyB9OwogICAgbmV3U2NvcGUuX2V4dHJhID0geyAuLi50aGlzLl9leHRyYSB9OwogICAgbmV3U2NvcGUuX2NvbnRleHRzID0geyAuLi50aGlzLl9jb250ZXh0cyB9OwogICAgbmV3U2NvcGUuX3VzZXIgPSB0aGlzLl91c2VyOwogICAgbmV3U2NvcGUuX2xldmVsID0gdGhpcy5fbGV2ZWw7CiAgICBuZXdTY29wZS5fc3BhbiA9IHRoaXMuX3NwYW47CiAgICBuZXdTY29wZS5fc2Vzc2lvbiA9IHRoaXMuX3Nlc3Npb247CiAgICBuZXdTY29wZS5fdHJhbnNhY3Rpb25OYW1lID0gdGhpcy5fdHJhbnNhY3Rpb25OYW1lOwogICAgbmV3U2NvcGUuX2ZpbmdlcnByaW50ID0gdGhpcy5fZmluZ2VycHJpbnQ7CiAgICBuZXdTY29wZS5fZXZlbnRQcm9jZXNzb3JzID0gWy4uLnRoaXMuX2V2ZW50UHJvY2Vzc29yc107CiAgICBuZXdTY29wZS5fcmVxdWVzdFNlc3Npb24gPSB0aGlzLl9yZXF1ZXN0U2Vzc2lvbjsKICAgIG5ld1Njb3BlLl9hdHRhY2htZW50cyA9IFsuLi50aGlzLl9hdHRhY2htZW50c107CiAgICBuZXdTY29wZS5fc2RrUHJvY2Vzc2luZ01ldGFkYXRhID0geyAuLi50aGlzLl9zZGtQcm9jZXNzaW5nTWV0YWRhdGEgfTsKICAgIG5ld1Njb3BlLl9wcm9wYWdhdGlvbkNvbnRleHQgPSB7IC4uLnRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dCB9OwogICAgbmV3U2NvcGUuX2NsaWVudCA9IHRoaXMuX2NsaWVudDsKCiAgICByZXR1cm4gbmV3U2NvcGU7CiAgfQoKICAvKiogVXBkYXRlIHRoZSBjbGllbnQgb24gdGhlIHNjb3BlLiAqLwogICBzZXRDbGllbnQoY2xpZW50KSB7CiAgICB0aGlzLl9jbGllbnQgPSBjbGllbnQ7CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGNsaWVudCBhc3NpZ25lZCB0byB0aGlzIHNjb3BlLgogICAqCiAgICogSXQgaXMgZ2VuZXJhbGx5IHJlY29tbWVuZGVkIHRvIHVzZSB0aGUgZ2xvYmFsIGZ1bmN0aW9uIGBTZW50cnkuZ2V0Q2xpZW50KClgIGluc3RlYWQsIHVubGVzcyB5b3Uga25vdyB3aGF0IHlvdSBhcmUgZG9pbmcuCiAgICovCiAgIGdldENsaWVudCgpIHsKICAgIHJldHVybiB0aGlzLl9jbGllbnQ7CiAgfQoKICAvKioKICAgKiBBZGQgaW50ZXJuYWwgb24gY2hhbmdlIGxpc3RlbmVyLiBVc2VkIGZvciBzdWIgU0RLcyB0aGF0IG5lZWQgdG8gc3RvcmUgdGhlIHNjb3BlLgogICAqIEBoaWRkZW4KICAgKi8KICAgYWRkU2NvcGVMaXN0ZW5lcihjYWxsYmFjaykgewogICAgdGhpcy5fc2NvcGVMaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBhZGRFdmVudFByb2Nlc3NvcihjYWxsYmFjaykgewogICAgdGhpcy5fZXZlbnRQcm9jZXNzb3JzLnB1c2goY2FsbGJhY2spOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRVc2VyKHVzZXIpIHsKICAgIC8vIElmIG51bGwgaXMgcGFzc2VkIHdlIHdhbnQgdG8gdW5zZXQgZXZlcnl0aGluZywgYnV0IHN0aWxsIGRlZmluZSBrZXlzLAogICAgLy8gc28gdGhhdCBsYXRlciBkb3duIGluIHRoZSBwaXBlbGluZSBhbnkgZXhpc3RpbmcgdmFsdWVzIGFyZSBjbGVhcmVkLgogICAgdGhpcy5fdXNlciA9IHVzZXIgfHwgewogICAgICBlbWFpbDogdW5kZWZpbmVkLAogICAgICBpZDogdW5kZWZpbmVkLAogICAgICBpcF9hZGRyZXNzOiB1bmRlZmluZWQsCiAgICAgIHNlZ21lbnQ6IHVuZGVmaW5lZCwKICAgICAgdXNlcm5hbWU6IHVuZGVmaW5lZCwKICAgIH07CgogICAgaWYgKHRoaXMuX3Nlc3Npb24pIHsKICAgICAgdXBkYXRlU2Vzc2lvbih0aGlzLl9zZXNzaW9uLCB7IHVzZXIgfSk7CiAgICB9CgogICAgdGhpcy5fbm90aWZ5U2NvcGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0VXNlcigpIHsKICAgIHJldHVybiB0aGlzLl91c2VyOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0UmVxdWVzdFNlc3Npb24oKSB7CiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdFNlc3Npb247CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRSZXF1ZXN0U2Vzc2lvbihyZXF1ZXN0U2Vzc2lvbikgewogICAgdGhpcy5fcmVxdWVzdFNlc3Npb24gPSByZXF1ZXN0U2Vzc2lvbjsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgc2V0VGFncyh0YWdzKSB7CiAgICB0aGlzLl90YWdzID0gewogICAgICAuLi50aGlzLl90YWdzLAogICAgICAuLi50YWdzLAogICAgfTsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIHNldFRhZyhrZXksIHZhbHVlKSB7CiAgICB0aGlzLl90YWdzID0geyAuLi50aGlzLl90YWdzLCBba2V5XTogdmFsdWUgfTsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIHNldEV4dHJhcyhleHRyYXMpIHsKICAgIHRoaXMuX2V4dHJhID0gewogICAgICAuLi50aGlzLl9leHRyYSwKICAgICAgLi4uZXh0cmFzLAogICAgfTsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIHNldEV4dHJhKGtleSwgZXh0cmEpIHsKICAgIHRoaXMuX2V4dHJhID0geyAuLi50aGlzLl9leHRyYSwgW2tleV06IGV4dHJhIH07CiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRGaW5nZXJwcmludChmaW5nZXJwcmludCkgewogICAgdGhpcy5fZmluZ2VycHJpbnQgPSBmaW5nZXJwcmludDsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIHNldExldmVsKAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBsZXZlbCwKICApIHsKICAgIHRoaXMuX2xldmVsID0gbGV2ZWw7CiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBTZXRzIHRoZSB0cmFuc2FjdGlvbiBuYW1lIG9uIHRoZSBzY29wZSBmb3IgZnV0dXJlIGV2ZW50cy4KICAgKi8KICAgc2V0VHJhbnNhY3Rpb25OYW1lKG5hbWUpIHsKICAgIHRoaXMuX3RyYW5zYWN0aW9uTmFtZSA9IG5hbWU7CiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRDb250ZXh0KGtleSwgY29udGV4dCkgewogICAgaWYgKGNvbnRleHQgPT09IG51bGwpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1keW5hbWljLWRlbGV0ZQogICAgICBkZWxldGUgdGhpcy5fY29udGV4dHNba2V5XTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuX2NvbnRleHRzW2tleV0gPSBjb250ZXh0OwogICAgfQoKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIFNldHMgdGhlIFNwYW4gb24gdGhlIHNjb3BlLgogICAqIEBwYXJhbSBzcGFuIFNwYW4KICAgKiBAZGVwcmVjYXRlZCBJbnN0ZWFkIG9mIHNldHRpbmcgYSBzcGFuIG9uIGEgc2NvcGUsIHVzZSBgc3RhcnRTcGFuKClgL2BzdGFydFNwYW5NYW51YWwoKWAgaW5zdGVhZC4KICAgKi8KICAgc2V0U3BhbihzcGFuKSB7CiAgICB0aGlzLl9zcGFuID0gc3BhbjsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIFJldHVybnMgdGhlIGBTcGFuYCBpZiB0aGVyZSBpcyBvbmUuCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBnZXRBY3RpdmVTcGFuKClgIGluc3RlYWQuCiAgICovCiAgIGdldFNwYW4oKSB7CiAgICByZXR1cm4gdGhpcy5fc3BhbjsKICB9CgogIC8qKgogICAqIFJldHVybnMgdGhlIGBUcmFuc2FjdGlvbmAgYXR0YWNoZWQgdG8gdGhlIHNjb3BlIChpZiB0aGVyZSBpcyBvbmUpLgogICAqIEBkZXByZWNhdGVkIFlvdSBzaG91bGQgbm90IHJlbHkgb24gdGhlIHRyYW5zYWN0aW9uLCBidXQganVzdCB1c2UgYHN0YXJ0U3BhbigpYCBBUElzIGluc3RlYWQuCiAgICovCiAgIGdldFRyYW5zYWN0aW9uKCkgewogICAgLy8gT2Z0ZW4sIHRoaXMgc3BhbiAoaWYgaXQgZXhpc3RzIGF0IGFsbCkgd2lsbCBiZSBhIHRyYW5zYWN0aW9uLCBidXQgaXQncyBub3QgZ3VhcmFudGVlZCB0byBiZS4gUmVnYXJkbGVzcywgaXQgd2lsbAogICAgLy8gaGF2ZSBhIHBvaW50ZXIgdG8gdGhlIGN1cnJlbnRseS1hY3RpdmUgdHJhbnNhY3Rpb24uCiAgICBjb25zdCBzcGFuID0gdGhpcy5fc3BhbjsKICAgIC8vIENhbm5vdCByZXBsYWNlIHdpdGggZ2V0Um9vdFNwYW4gYmVjYXVzZSBnZXRSb290U3BhbiByZXR1cm5zIGEgc3Bhbiwgbm90IGEgdHJhbnNhY3Rpb24KICAgIC8vIEFsc28sIHRoaXMgbWV0aG9kIHdpbGwgYmUgcmVtb3ZlZCBhbnl3YXkuCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHJldHVybiBzcGFuICYmIHNwYW4udHJhbnNhY3Rpb247CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRTZXNzaW9uKHNlc3Npb24pIHsKICAgIGlmICghc2Vzc2lvbikgewogICAgICBkZWxldGUgdGhpcy5fc2Vzc2lvbjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuX3Nlc3Npb24gPSBzZXNzaW9uOwogICAgfQogICAgdGhpcy5fbm90aWZ5U2NvcGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0U2Vzc2lvbigpIHsKICAgIHJldHVybiB0aGlzLl9zZXNzaW9uOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgdXBkYXRlKGNhcHR1cmVDb250ZXh0KSB7CiAgICBpZiAoIWNhcHR1cmVDb250ZXh0KSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGNvbnN0IHNjb3BlVG9NZXJnZSA9IHR5cGVvZiBjYXB0dXJlQ29udGV4dCA9PT0gJ2Z1bmN0aW9uJyA/IGNhcHR1cmVDb250ZXh0KHRoaXMpIDogY2FwdHVyZUNvbnRleHQ7CgogICAgaWYgKHNjb3BlVG9NZXJnZSBpbnN0YW5jZW9mIFNjb3BlKSB7CiAgICAgIGNvbnN0IHNjb3BlRGF0YSA9IHNjb3BlVG9NZXJnZS5nZXRTY29wZURhdGEoKTsKCiAgICAgIHRoaXMuX3RhZ3MgPSB7IC4uLnRoaXMuX3RhZ3MsIC4uLnNjb3BlRGF0YS50YWdzIH07CiAgICAgIHRoaXMuX2V4dHJhID0geyAuLi50aGlzLl9leHRyYSwgLi4uc2NvcGVEYXRhLmV4dHJhIH07CiAgICAgIHRoaXMuX2NvbnRleHRzID0geyAuLi50aGlzLl9jb250ZXh0cywgLi4uc2NvcGVEYXRhLmNvbnRleHRzIH07CiAgICAgIGlmIChzY29wZURhdGEudXNlciAmJiBPYmplY3Qua2V5cyhzY29wZURhdGEudXNlcikubGVuZ3RoKSB7CiAgICAgICAgdGhpcy5fdXNlciA9IHNjb3BlRGF0YS51c2VyOwogICAgICB9CiAgICAgIGlmIChzY29wZURhdGEubGV2ZWwpIHsKICAgICAgICB0aGlzLl9sZXZlbCA9IHNjb3BlRGF0YS5sZXZlbDsKICAgICAgfQogICAgICBpZiAoc2NvcGVEYXRhLmZpbmdlcnByaW50Lmxlbmd0aCkgewogICAgICAgIHRoaXMuX2ZpbmdlcnByaW50ID0gc2NvcGVEYXRhLmZpbmdlcnByaW50OwogICAgICB9CiAgICAgIGlmIChzY29wZVRvTWVyZ2UuZ2V0UmVxdWVzdFNlc3Npb24oKSkgewogICAgICAgIHRoaXMuX3JlcXVlc3RTZXNzaW9uID0gc2NvcGVUb01lcmdlLmdldFJlcXVlc3RTZXNzaW9uKCk7CiAgICAgIH0KICAgICAgaWYgKHNjb3BlRGF0YS5wcm9wYWdhdGlvbkNvbnRleHQpIHsKICAgICAgICB0aGlzLl9wcm9wYWdhdGlvbkNvbnRleHQgPSBzY29wZURhdGEucHJvcGFnYXRpb25Db250ZXh0OwogICAgICB9CiAgICB9IGVsc2UgaWYgKGlzUGxhaW5PYmplY3Qoc2NvcGVUb01lcmdlKSkgewogICAgICBjb25zdCBzY29wZUNvbnRleHQgPSBjYXB0dXJlQ29udGV4dCA7CiAgICAgIHRoaXMuX3RhZ3MgPSB7IC4uLnRoaXMuX3RhZ3MsIC4uLnNjb3BlQ29udGV4dC50YWdzIH07CiAgICAgIHRoaXMuX2V4dHJhID0geyAuLi50aGlzLl9leHRyYSwgLi4uc2NvcGVDb250ZXh0LmV4dHJhIH07CiAgICAgIHRoaXMuX2NvbnRleHRzID0geyAuLi50aGlzLl9jb250ZXh0cywgLi4uc2NvcGVDb250ZXh0LmNvbnRleHRzIH07CiAgICAgIGlmIChzY29wZUNvbnRleHQudXNlcikgewogICAgICAgIHRoaXMuX3VzZXIgPSBzY29wZUNvbnRleHQudXNlcjsKICAgICAgfQogICAgICBpZiAoc2NvcGVDb250ZXh0LmxldmVsKSB7CiAgICAgICAgdGhpcy5fbGV2ZWwgPSBzY29wZUNvbnRleHQubGV2ZWw7CiAgICAgIH0KICAgICAgaWYgKHNjb3BlQ29udGV4dC5maW5nZXJwcmludCkgewogICAgICAgIHRoaXMuX2ZpbmdlcnByaW50ID0gc2NvcGVDb250ZXh0LmZpbmdlcnByaW50OwogICAgICB9CiAgICAgIGlmIChzY29wZUNvbnRleHQucmVxdWVzdFNlc3Npb24pIHsKICAgICAgICB0aGlzLl9yZXF1ZXN0U2Vzc2lvbiA9IHNjb3BlQ29udGV4dC5yZXF1ZXN0U2Vzc2lvbjsKICAgICAgfQogICAgICBpZiAoc2NvcGVDb250ZXh0LnByb3BhZ2F0aW9uQ29udGV4dCkgewogICAgICAgIHRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dCA9IHNjb3BlQ29udGV4dC5wcm9wYWdhdGlvbkNvbnRleHQ7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIGNsZWFyKCkgewogICAgdGhpcy5fYnJlYWRjcnVtYnMgPSBbXTsKICAgIHRoaXMuX3RhZ3MgPSB7fTsKICAgIHRoaXMuX2V4dHJhID0ge307CiAgICB0aGlzLl91c2VyID0ge307CiAgICB0aGlzLl9jb250ZXh0cyA9IHt9OwogICAgdGhpcy5fbGV2ZWwgPSB1bmRlZmluZWQ7CiAgICB0aGlzLl90cmFuc2FjdGlvbk5hbWUgPSB1bmRlZmluZWQ7CiAgICB0aGlzLl9maW5nZXJwcmludCA9IHVuZGVmaW5lZDsKICAgIHRoaXMuX3JlcXVlc3RTZXNzaW9uID0gdW5kZWZpbmVkOwogICAgdGhpcy5fc3BhbiA9IHVuZGVmaW5lZDsKICAgIHRoaXMuX3Nlc3Npb24gPSB1bmRlZmluZWQ7CiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwogICAgdGhpcy5fYXR0YWNobWVudHMgPSBbXTsKICAgIHRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dCA9IGdlbmVyYXRlUHJvcGFnYXRpb25Db250ZXh0KCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIGFkZEJyZWFkY3J1bWIoYnJlYWRjcnVtYiwgbWF4QnJlYWRjcnVtYnMpIHsKICAgIGNvbnN0IG1heENydW1icyA9IHR5cGVvZiBtYXhCcmVhZGNydW1icyA9PT0gJ251bWJlcicgPyBtYXhCcmVhZGNydW1icyA6IERFRkFVTFRfTUFYX0JSRUFEQ1JVTUJTOwoKICAgIC8vIE5vIGRhdGEgaGFzIGJlZW4gY2hhbmdlZCwgc28gZG9uJ3Qgbm90aWZ5IHNjb3BlIGxpc3RlbmVycwogICAgaWYgKG1heENydW1icyA8PSAwKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGNvbnN0IG1lcmdlZEJyZWFkY3J1bWIgPSB7CiAgICAgIHRpbWVzdGFtcDogZGF0ZVRpbWVzdGFtcEluU2Vjb25kcygpLAogICAgICAuLi5icmVhZGNydW1iLAogICAgfTsKCiAgICBjb25zdCBicmVhZGNydW1icyA9IHRoaXMuX2JyZWFkY3J1bWJzOwogICAgYnJlYWRjcnVtYnMucHVzaChtZXJnZWRCcmVhZGNydW1iKTsKICAgIHRoaXMuX2JyZWFkY3J1bWJzID0gYnJlYWRjcnVtYnMubGVuZ3RoID4gbWF4Q3J1bWJzID8gYnJlYWRjcnVtYnMuc2xpY2UoLW1heENydW1icykgOiBicmVhZGNydW1iczsKCiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwoKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0TGFzdEJyZWFkY3J1bWIoKSB7CiAgICByZXR1cm4gdGhpcy5fYnJlYWRjcnVtYnNbdGhpcy5fYnJlYWRjcnVtYnMubGVuZ3RoIC0gMV07CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBjbGVhckJyZWFkY3J1bWJzKCkgewogICAgdGhpcy5fYnJlYWRjcnVtYnMgPSBbXTsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIGFkZEF0dGFjaG1lbnQoYXR0YWNobWVudCkgewogICAgdGhpcy5fYXR0YWNobWVudHMucHVzaChhdHRhY2htZW50KTsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKiBAZGVwcmVjYXRlZCBVc2UgYGdldFNjb3BlRGF0YSgpYCBpbnN0ZWFkLgogICAqLwogICBnZXRBdHRhY2htZW50cygpIHsKICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldFNjb3BlRGF0YSgpOwoKICAgIHJldHVybiBkYXRhLmF0dGFjaG1lbnRzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgY2xlYXJBdHRhY2htZW50cygpIHsKICAgIHRoaXMuX2F0dGFjaG1lbnRzID0gW107CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKiBAaW5oZXJpdERvYyAqLwogICBnZXRTY29wZURhdGEoKSB7CiAgICBjb25zdCB7CiAgICAgIF9icmVhZGNydW1icywKICAgICAgX2F0dGFjaG1lbnRzLAogICAgICBfY29udGV4dHMsCiAgICAgIF90YWdzLAogICAgICBfZXh0cmEsCiAgICAgIF91c2VyLAogICAgICBfbGV2ZWwsCiAgICAgIF9maW5nZXJwcmludCwKICAgICAgX2V2ZW50UHJvY2Vzc29ycywKICAgICAgX3Byb3BhZ2F0aW9uQ29udGV4dCwKICAgICAgX3Nka1Byb2Nlc3NpbmdNZXRhZGF0YSwKICAgICAgX3RyYW5zYWN0aW9uTmFtZSwKICAgICAgX3NwYW4sCiAgICB9ID0gdGhpczsKCiAgICByZXR1cm4gewogICAgICBicmVhZGNydW1iczogX2JyZWFkY3J1bWJzLAogICAgICBhdHRhY2htZW50czogX2F0dGFjaG1lbnRzLAogICAgICBjb250ZXh0czogX2NvbnRleHRzLAogICAgICB0YWdzOiBfdGFncywKICAgICAgZXh0cmE6IF9leHRyYSwKICAgICAgdXNlcjogX3VzZXIsCiAgICAgIGxldmVsOiBfbGV2ZWwsCiAgICAgIGZpbmdlcnByaW50OiBfZmluZ2VycHJpbnQgfHwgW10sCiAgICAgIGV2ZW50UHJvY2Vzc29yczogX2V2ZW50UHJvY2Vzc29ycywKICAgICAgcHJvcGFnYXRpb25Db250ZXh0OiBfcHJvcGFnYXRpb25Db250ZXh0LAogICAgICBzZGtQcm9jZXNzaW5nTWV0YWRhdGE6IF9zZGtQcm9jZXNzaW5nTWV0YWRhdGEsCiAgICAgIHRyYW5zYWN0aW9uTmFtZTogX3RyYW5zYWN0aW9uTmFtZSwKICAgICAgc3BhbjogX3NwYW4sCiAgICB9OwogIH0KCiAgLyoqCiAgICogQXBwbGllcyBkYXRhIGZyb20gdGhlIHNjb3BlIHRvIHRoZSBldmVudCBhbmQgcnVucyBhbGwgZXZlbnQgcHJvY2Vzc29ycyBvbiBpdC4KICAgKgogICAqIEBwYXJhbSBldmVudCBFdmVudAogICAqIEBwYXJhbSBoaW50IE9iamVjdCBjb250YWluaW5nIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG9yaWdpbmFsIGV4Y2VwdGlvbiwgZm9yIHVzZSBieSB0aGUgZXZlbnQgcHJvY2Vzc29ycy4KICAgKiBAaGlkZGVuCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBhcHBseVNjb3BlRGF0YVRvRXZlbnQoKWAgZGlyZWN0bHkKICAgKi8KICAgYXBwbHlUb0V2ZW50KAogICAgZXZlbnQsCiAgICBoaW50ID0ge30sCiAgICBhZGRpdGlvbmFsRXZlbnRQcm9jZXNzb3JzID0gW10sCiAgKSB7CiAgICBhcHBseVNjb3BlRGF0YVRvRXZlbnQoZXZlbnQsIHRoaXMuZ2V0U2NvcGVEYXRhKCkpOwoKICAgIC8vIFRPRE8gKHY4KTogVXBkYXRlIHRoaXMgb3JkZXIgdG8gYmU6IEdsb2JhbCA+IENsaWVudCA+IFNjb3BlCiAgICBjb25zdCBldmVudFByb2Nlc3NvcnMgPSBbCiAgICAgIC4uLmFkZGl0aW9uYWxFdmVudFByb2Nlc3NvcnMsCiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgICAuLi5nZXRHbG9iYWxFdmVudFByb2Nlc3NvcnMoKSwKICAgICAgLi4udGhpcy5fZXZlbnRQcm9jZXNzb3JzLAogICAgXTsKCiAgICByZXR1cm4gbm90aWZ5RXZlbnRQcm9jZXNzb3JzKGV2ZW50UHJvY2Vzc29ycywgZXZlbnQsIGhpbnQpOwogIH0KCiAgLyoqCiAgICogQWRkIGRhdGEgd2hpY2ggd2lsbCBiZSBhY2Nlc3NpYmxlIGR1cmluZyBldmVudCBwcm9jZXNzaW5nIGJ1dCB3b24ndCBnZXQgc2VudCB0byBTZW50cnkKICAgKi8KICAgc2V0U0RLUHJvY2Vzc2luZ01ldGFkYXRhKG5ld0RhdGEpIHsKICAgIHRoaXMuX3Nka1Byb2Nlc3NpbmdNZXRhZGF0YSA9IHsgLi4udGhpcy5fc2RrUHJvY2Vzc2luZ01ldGFkYXRhLCAuLi5uZXdEYXRhIH07CgogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRQcm9wYWdhdGlvbkNvbnRleHQoY29udGV4dCkgewogICAgdGhpcy5fcHJvcGFnYXRpb25Db250ZXh0ID0gY29udGV4dDsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0UHJvcGFnYXRpb25Db250ZXh0KCkgewogICAgcmV0dXJuIHRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dDsKICB9CgogIC8qKgogICAqIENhcHR1cmUgYW4gZXhjZXB0aW9uIGZvciB0aGlzIHNjb3BlLgogICAqCiAgICogQHBhcmFtIGV4Y2VwdGlvbiBUaGUgZXhjZXB0aW9uIHRvIGNhcHR1cmUuCiAgICogQHBhcmFtIGhpbnQgT3B0aW5hbCBhZGRpdGlvbmFsIGRhdGEgdG8gYXR0YWNoIHRvIHRoZSBTZW50cnkgZXZlbnQuCiAgICogQHJldHVybnMgdGhlIGlkIG9mIHRoZSBjYXB0dXJlZCBTZW50cnkgZXZlbnQuCiAgICovCiAgIGNhcHR1cmVFeGNlcHRpb24oZXhjZXB0aW9uLCBoaW50KSB7CiAgICBjb25zdCBldmVudElkID0gaGludCAmJiBoaW50LmV2ZW50X2lkID8gaGludC5ldmVudF9pZCA6IHV1aWQ0KCk7CgogICAgaWYgKCF0aGlzLl9jbGllbnQpIHsKICAgICAgbG9nZ2VyLndhcm4oJ05vIGNsaWVudCBjb25maWd1cmVkIG9uIHNjb3BlIC0gd2lsbCBub3QgY2FwdHVyZSBleGNlcHRpb24hJyk7CiAgICAgIHJldHVybiBldmVudElkOwogICAgfQoKICAgIGNvbnN0IHN5bnRoZXRpY0V4Y2VwdGlvbiA9IG5ldyBFcnJvcignU2VudHJ5IHN5bnRoZXRpY0V4Y2VwdGlvbicpOwoKICAgIHRoaXMuX2NsaWVudC5jYXB0dXJlRXhjZXB0aW9uKAogICAgICBleGNlcHRpb24sCiAgICAgIHsKICAgICAgICBvcmlnaW5hbEV4Y2VwdGlvbjogZXhjZXB0aW9uLAogICAgICAgIHN5bnRoZXRpY0V4Y2VwdGlvbiwKICAgICAgICAuLi5oaW50LAogICAgICAgIGV2ZW50X2lkOiBldmVudElkLAogICAgICB9LAogICAgICB0aGlzLAogICAgKTsKCiAgICByZXR1cm4gZXZlbnRJZDsKICB9CgogIC8qKgogICAqIENhcHR1cmUgYSBtZXNzYWdlIGZvciB0aGlzIHNjb3BlLgogICAqCiAgICogQHBhcmFtIG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdG8gY2FwdHVyZS4KICAgKiBAcGFyYW0gbGV2ZWwgQW4gb3B0aW9uYWwgc2V2ZXJpdHkgbGV2ZWwgdG8gcmVwb3J0IHRoZSBtZXNzYWdlIHdpdGguCiAgICogQHBhcmFtIGhpbnQgT3B0aW9uYWwgYWRkaXRpb25hbCBkYXRhIHRvIGF0dGFjaCB0byB0aGUgU2VudHJ5IGV2ZW50LgogICAqIEByZXR1cm5zIHRoZSBpZCBvZiB0aGUgY2FwdHVyZWQgbWVzc2FnZS4KICAgKi8KICAgY2FwdHVyZU1lc3NhZ2UobWVzc2FnZSwgbGV2ZWwsIGhpbnQpIHsKICAgIGNvbnN0IGV2ZW50SWQgPSBoaW50ICYmIGhpbnQuZXZlbnRfaWQgPyBoaW50LmV2ZW50X2lkIDogdXVpZDQoKTsKCiAgICBpZiAoIXRoaXMuX2NsaWVudCkgewogICAgICBsb2dnZXIud2FybignTm8gY2xpZW50IGNvbmZpZ3VyZWQgb24gc2NvcGUgLSB3aWxsIG5vdCBjYXB0dXJlIG1lc3NhZ2UhJyk7CiAgICAgIHJldHVybiBldmVudElkOwogICAgfQoKICAgIGNvbnN0IHN5bnRoZXRpY0V4Y2VwdGlvbiA9IG5ldyBFcnJvcihtZXNzYWdlKTsKCiAgICB0aGlzLl9jbGllbnQuY2FwdHVyZU1lc3NhZ2UoCiAgICAgIG1lc3NhZ2UsCiAgICAgIGxldmVsLAogICAgICB7CiAgICAgICAgb3JpZ2luYWxFeGNlcHRpb246IG1lc3NhZ2UsCiAgICAgICAgc3ludGhldGljRXhjZXB0aW9uLAogICAgICAgIC4uLmhpbnQsCiAgICAgICAgZXZlbnRfaWQ6IGV2ZW50SWQsCiAgICAgIH0sCiAgICAgIHRoaXMsCiAgICApOwoKICAgIHJldHVybiBldmVudElkOwogIH0KCiAgLyoqCiAgICogQ2FwdHVyZXMgYSBtYW51YWxseSBjcmVhdGVkIGV2ZW50IGZvciB0aGlzIHNjb3BlIGFuZCBzZW5kcyBpdCB0byBTZW50cnkuCiAgICoKICAgKiBAcGFyYW0gZXhjZXB0aW9uIFRoZSBldmVudCB0byBjYXB0dXJlLgogICAqIEBwYXJhbSBoaW50IE9wdGlvbmFsIGFkZGl0aW9uYWwgZGF0YSB0byBhdHRhY2ggdG8gdGhlIFNlbnRyeSBldmVudC4KICAgKiBAcmV0dXJucyB0aGUgaWQgb2YgdGhlIGNhcHR1cmVkIGV2ZW50LgogICAqLwogICBjYXB0dXJlRXZlbnQoZXZlbnQsIGhpbnQpIHsKICAgIGNvbnN0IGV2ZW50SWQgPSBoaW50ICYmIGhpbnQuZXZlbnRfaWQgPyBoaW50LmV2ZW50X2lkIDogdXVpZDQoKTsKCiAgICBpZiAoIXRoaXMuX2NsaWVudCkgewogICAgICBsb2dnZXIud2FybignTm8gY2xpZW50IGNvbmZpZ3VyZWQgb24gc2NvcGUgLSB3aWxsIG5vdCBjYXB0dXJlIGV2ZW50IScpOwogICAgICByZXR1cm4gZXZlbnRJZDsKICAgIH0KCiAgICB0aGlzLl9jbGllbnQuY2FwdHVyZUV2ZW50KGV2ZW50LCB7IC4uLmhpbnQsIGV2ZW50X2lkOiBldmVudElkIH0sIHRoaXMpOwoKICAgIHJldHVybiBldmVudElkOwogIH0KCiAgLyoqCiAgICogVGhpcyB3aWxsIGJlIGNhbGxlZCBvbiBldmVyeSBzZXQgY2FsbC4KICAgKi8KICAgX25vdGlmeVNjb3BlTGlzdGVuZXJzKCkgewogICAgLy8gV2UgbmVlZCB0aGlzIGNoZWNrIGZvciB0aGlzLl9ub3RpZnlpbmdMaXN0ZW5lcnMgdG8gYmUgYWJsZSB0byB3b3JrIG9uIHNjb3BlIGR1cmluZyB1cGRhdGVzCiAgICAvLyBJZiB0aGlzIGNoZWNrIGlzIG5vdCBoZXJlIHdlJ2xsIHByb2R1Y2UgZW5kbGVzcyByZWN1cnNpb24gd2hlbiBzb21ldGhpbmcgaXMgZG9uZSB3aXRoIHRoZSBzY29wZQogICAgLy8gZHVyaW5nIHRoZSBjYWxsYmFjay4KICAgIGlmICghdGhpcy5fbm90aWZ5aW5nTGlzdGVuZXJzKSB7CiAgICAgIHRoaXMuX25vdGlmeWluZ0xpc3RlbmVycyA9IHRydWU7CiAgICAgIHRoaXMuX3Njb3BlTGlzdGVuZXJzLmZvckVhY2goY2FsbGJhY2sgPT4gewogICAgICAgIGNhbGxiYWNrKHRoaXMpOwogICAgICB9KTsKICAgICAgdGhpcy5fbm90aWZ5aW5nTGlzdGVuZXJzID0gZmFsc2U7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBnZW5lcmF0ZVByb3BhZ2F0aW9uQ29udGV4dCgpIHsKICByZXR1cm4gewogICAgdHJhY2VJZDogdXVpZDQoKSwKICAgIHNwYW5JZDogdXVpZDQoKS5zdWJzdHJpbmcoMTYpLAogIH07Cn0KCmNvbnN0IFNES19WRVJTSU9OID0gJzcuMTE5LjInOwoKLyoqCiAqIEFQSSBjb21wYXRpYmlsaXR5IHZlcnNpb24gb2YgdGhpcyBodWIuCiAqCiAqIFdBUk5JTkc6IFRoaXMgbnVtYmVyIHNob3VsZCBvbmx5IGJlIGluY3JlYXNlZCB3aGVuIHRoZSBnbG9iYWwgaW50ZXJmYWNlCiAqIGNoYW5nZXMgYW5kIG5ldyBtZXRob2RzIGFyZSBpbnRyb2R1Y2VkLgogKgogKiBAaGlkZGVuCiAqLwpjb25zdCBBUElfVkVSU0lPTiA9IHBhcnNlRmxvYXQoU0RLX1ZFUlNJT04pOwoKLyoqCiAqIERlZmF1bHQgbWF4aW11bSBudW1iZXIgb2YgYnJlYWRjcnVtYnMgYWRkZWQgdG8gYW4gZXZlbnQuIENhbiBiZSBvdmVyd3JpdHRlbgogKiB3aXRoIHtAbGluayBPcHRpb25zLm1heEJyZWFkY3J1bWJzfS4KICovCmNvbnN0IERFRkFVTFRfQlJFQURDUlVNQlMgPSAxMDA7CgovKioKICogQGRlcHJlY2F0ZWQgVGhlIGBIdWJgIGNsYXNzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2ZXJzaW9uIDggb2YgdGhlIFNESyBpbiBmYXZvdXIgb2YgYFNjb3BlYCBhbmQgYENsaWVudGAgb2JqZWN0cy4KICoKICogSWYgeW91IHByZXZpb3VzbHkgdXNlZCB0aGUgYEh1YmAgY2xhc3MgZGlyZWN0bHksIHJlcGxhY2UgaXQgd2l0aCBgU2NvcGVgIGFuZCBgQ2xpZW50YCBvYmplY3RzLiBNb3JlIGluZm9ybWF0aW9uOgogKiAtIFtNdWx0aXBsZSBTZW50cnkgSW5zdGFuY2VzXShodHRwczovL2RvY3Muc2VudHJ5LmlvL3BsYXRmb3Jtcy9qYXZhc2NyaXB0L2Jlc3QtcHJhY3RpY2VzL211bHRpcGxlLXNlbnRyeS1pbnN0YW5jZXMvKQogKiAtIFtCcm93c2VyIEV4dGVuc2lvbnNdKGh0dHBzOi8vZG9jcy5zZW50cnkuaW8vcGxhdGZvcm1zL2phdmFzY3JpcHQvYmVzdC1wcmFjdGljZXMvYnJvd3Nlci1leHRlbnNpb25zLykKICoKICogU29tZSBvZiBvdXIgQVBJcyBhcmUgdHlwZWQgd2l0aCB0aGUgSHViIGNsYXNzIGluc3RlYWQgb2YgdGhlIGludGVyZmFjZSAoZS5nLiBgZ2V0Q3VycmVudEh1YmApLiBNb3N0IG9mIHRoZW0gYXJlIGRlcHJlY2F0ZWQKICogdGhlbXNlbHZlcyBhbmQgd2lsbCBhbHNvIGJlIHJlbW92ZWQgaW4gdmVyc2lvbiA4LiBNb3JlIGluZm9ybWF0aW9uOgogKiAtIFtNaWdyYXRpb24gR3VpZGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvYmxvYi9kZXZlbG9wL01JR1JBVElPTi5tZCNkZXByZWNhdGUtaHViKQogKi8KLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCmNsYXNzIEh1YiAgewogIC8qKiBJcyBhIHtAbGluayBMYXllcn1bXSBjb250YWluaW5nIHRoZSBjbGllbnQgYW5kIHNjb3BlICovCgogIC8qKiBDb250YWlucyB0aGUgbGFzdCBldmVudCBpZCBvZiBhIGNhcHR1cmVkIGV2ZW50LiAgKi8KCiAgLyoqCiAgICogQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgaHViLCB3aWxsIHB1c2ggb25lIHtAbGluayBMYXllcn0gaW50byB0aGUKICAgKiBpbnRlcm5hbCBzdGFjayBvbiBjcmVhdGlvbi4KICAgKgogICAqIEBwYXJhbSBjbGllbnQgYm91bmQgdG8gdGhlIGh1Yi4KICAgKiBAcGFyYW0gc2NvcGUgYm91bmQgdG8gdGhlIGh1Yi4KICAgKiBAcGFyYW0gdmVyc2lvbiBudW1iZXIsIGhpZ2hlciBudW1iZXIgbWVhbnMgaGlnaGVyIHByaW9yaXR5LgogICAqCiAgICogQGRlcHJlY2F0ZWQgSW5zdGFudGlhdGlvbiBvZiBIdWIgb2JqZWN0cyBpcyBkZXByZWNhdGVkIGFuZCB0aGUgY29uc3RydWN0b3Igd2lsbCBiZSByZW1vdmVkIGluIHZlcnNpb24gOCBvZiB0aGUgU0RLLgogICAqCiAgICogSWYgeW91IGFyZSBjdXJyZW50bHkgdXNpbmcgdGhlIEh1YiBmb3IgbXVsdGktY2xpZW50IHVzZSBsaWtlIHNvOgogICAqCiAgICogYGBgCiAgICogLy8gT0xECiAgICogY29uc3QgaHViID0gbmV3IEh1YigpOwogICAqIGh1Yi5iaW5kQ2xpZW50KGNsaWVudCk7CiAgICogbWFrZU1haW4oaHViKQogICAqIGBgYAogICAqCiAgICogaW5zdGVhZCBpbml0aWFsaXplIHRoZSBjbGllbnQgYXMgZm9sbG93czoKICAgKgogICAqIGBgYAogICAqIC8vIE5FVwogICAqIFNlbnRyeS53aXRoSXNvbGF0aW9uU2NvcGUoKCkgPT4gewogICAqICAgIFNlbnRyeS5zZXRDdXJyZW50Q2xpZW50KGNsaWVudCk7CiAgICogICAgY2xpZW50LmluaXQoKTsKICAgKiB9KTsKICAgKiBgYGAKICAgKgogICAqIElmIHlvdSBhcmUgdXNpbmcgdGhlIEh1YiB0byBjYXB0dXJlIGV2ZW50cyBsaWtlIHNvOgogICAqCiAgICogYGBgCiAgICogLy8gT0xECiAgICogY29uc3QgY2xpZW50ID0gbmV3IENsaWVudCgpOwogICAqIGNvbnN0IGh1YiA9IG5ldyBIdWIoY2xpZW50KTsKICAgKiBodWIuY2FwdHVyZUV4Y2VwdGlvbigpCiAgICogYGBgCiAgICoKICAgKiBpbnN0ZWFkIGNhcHR1cmUgaXNvbGF0ZWQgZXZlbnRzIGFzIGZvbGxvd3M6CiAgICoKICAgKiBgYGAKICAgKiAvLyBORVcKICAgKiBjb25zdCBjbGllbnQgPSBuZXcgQ2xpZW50KCk7CiAgICogY29uc3Qgc2NvcGUgPSBuZXcgU2NvcGUoKTsKICAgKiBzY29wZS5zZXRDbGllbnQoY2xpZW50KTsKICAgKiBzY29wZS5jYXB0dXJlRXhjZXB0aW9uKCk7CiAgICogYGBgCiAgICovCiAgIGNvbnN0cnVjdG9yKAogICAgY2xpZW50LAogICAgc2NvcGUsCiAgICBpc29sYXRpb25TY29wZSwKICAgICAgX3ZlcnNpb24gPSBBUElfVkVSU0lPTiwKICApIHt0aGlzLl92ZXJzaW9uID0gX3ZlcnNpb247CiAgICBsZXQgYXNzaWduZWRTY29wZTsKICAgIGlmICghc2NvcGUpIHsKICAgICAgYXNzaWduZWRTY29wZSA9IG5ldyBTY29wZSgpOwogICAgICBhc3NpZ25lZFNjb3BlLnNldENsaWVudChjbGllbnQpOwogICAgfSBlbHNlIHsKICAgICAgYXNzaWduZWRTY29wZSA9IHNjb3BlOwogICAgfQoKICAgIGxldCBhc3NpZ25lZElzb2xhdGlvblNjb3BlOwogICAgaWYgKCFpc29sYXRpb25TY29wZSkgewogICAgICBhc3NpZ25lZElzb2xhdGlvblNjb3BlID0gbmV3IFNjb3BlKCk7CiAgICAgIGFzc2lnbmVkSXNvbGF0aW9uU2NvcGUuc2V0Q2xpZW50KGNsaWVudCk7CiAgICB9IGVsc2UgewogICAgICBhc3NpZ25lZElzb2xhdGlvblNjb3BlID0gaXNvbGF0aW9uU2NvcGU7CiAgICB9CgogICAgdGhpcy5fc3RhY2sgPSBbeyBzY29wZTogYXNzaWduZWRTY29wZSB9XTsKCiAgICBpZiAoY2xpZW50KSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgICB0aGlzLmJpbmRDbGllbnQoY2xpZW50KTsKICAgIH0KCiAgICB0aGlzLl9pc29sYXRpb25TY29wZSA9IGFzc2lnbmVkSXNvbGF0aW9uU2NvcGU7CiAgfQoKICAvKioKICAgKiBDaGVja3MgaWYgdGhpcyBodWIncyB2ZXJzaW9uIGlzIG9sZGVyIHRoYW4gdGhlIGdpdmVuIHZlcnNpb24uCiAgICoKICAgKiBAcGFyYW0gdmVyc2lvbiBBIHZlcnNpb24gbnVtYmVyIHRvIGNvbXBhcmUgdG8uCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBnaXZlbiB2ZXJzaW9uIGlzIG5ld2VyOyBvdGhlcndpc2UgZmFsc2UuCiAgICoKICAgKiBAZGVwcmVjYXRlZCBUaGlzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4KICAgKi8KICAgaXNPbGRlclRoYW4odmVyc2lvbikgewogICAgcmV0dXJuIHRoaXMuX3ZlcnNpb24gPCB2ZXJzaW9uOwogIH0KCiAgLyoqCiAgICogVGhpcyBiaW5kcyB0aGUgZ2l2ZW4gY2xpZW50IHRvIHRoZSBjdXJyZW50IHNjb3BlLgogICAqIEBwYXJhbSBjbGllbnQgQW4gU0RLIGNsaWVudCAoY2xpZW50KSBpbnN0YW5jZS4KICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgaW5pdEFuZEJpbmQoKWAgZGlyZWN0bHksIG9yIGBzZXRDdXJyZW50Q2xpZW50KClgIGFuZC9vciBgY2xpZW50LmluaXQoKWAgaW5zdGVhZC4KICAgKi8KICAgYmluZENsaWVudChjbGllbnQpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgY29uc3QgdG9wID0gdGhpcy5nZXRTdGFja1RvcCgpOwogICAgdG9wLmNsaWVudCA9IGNsaWVudDsKICAgIHRvcC5zY29wZS5zZXRDbGllbnQoY2xpZW50KTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgaWYgKGNsaWVudCAmJiBjbGllbnQuc2V0dXBJbnRlZ3JhdGlvbnMpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICAgIGNsaWVudC5zZXR1cEludGVncmF0aW9ucygpOwogICAgfQogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgd2l0aFNjb3BlYCBpbnN0ZWFkLgogICAqLwogICBwdXNoU2NvcGUoKSB7CiAgICAvLyBXZSB3YW50IHRvIGNsb25lIHRoZSBjb250ZW50IG9mIHByZXYgc2NvcGUKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgY29uc3Qgc2NvcGUgPSB0aGlzLmdldFNjb3BlKCkuY2xvbmUoKTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRTdGFjaygpLnB1c2goewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgICAgY2xpZW50OiB0aGlzLmdldENsaWVudCgpLAogICAgICBzY29wZSwKICAgIH0pOwogICAgcmV0dXJuIHNjb3BlOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgd2l0aFNjb3BlYCBpbnN0ZWFkLgogICAqLwogICBwb3BTY29wZSgpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgaWYgKHRoaXMuZ2V0U3RhY2soKS5sZW5ndGggPD0gMSkgcmV0dXJuIGZhbHNlOwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICByZXR1cm4gISF0aGlzLmdldFN0YWNrKCkucG9wKCk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBTZW50cnkud2l0aFNjb3BlKClgIGluc3RlYWQuCiAgICovCiAgIHdpdGhTY29wZShjYWxsYmFjaykgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBjb25zdCBzY29wZSA9IHRoaXMucHVzaFNjb3BlKCk7CgogICAgbGV0IG1heWJlUHJvbWlzZVJlc3VsdDsKICAgIHRyeSB7CiAgICAgIG1heWJlUHJvbWlzZVJlc3VsdCA9IGNhbGxiYWNrKHNjb3BlKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICAgIHRoaXMucG9wU2NvcGUoKTsKICAgICAgdGhyb3cgZTsKICAgIH0KCiAgICBpZiAoaXNUaGVuYWJsZShtYXliZVByb21pc2VSZXN1bHQpKSB7CiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLSBpc1RoZW5hYmxlIHJldHVybnMgdGhlIHdyb25nIHR5cGUKICAgICAgcmV0dXJuIG1heWJlUHJvbWlzZVJlc3VsdC50aGVuKAogICAgICAgIHJlcyA9PiB7CiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgICAgICAgIHRoaXMucG9wU2NvcGUoKTsKICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfSwKICAgICAgICBlID0+IHsKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgICAgICAgdGhpcy5wb3BTY29wZSgpOwogICAgICAgICAgdGhyb3cgZTsKICAgICAgICB9LAogICAgICApOwogICAgfQoKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5wb3BTY29wZSgpOwogICAgcmV0dXJuIG1heWJlUHJvbWlzZVJlc3VsdDsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICoKICAgKiBAZGVwcmVjYXRlZCBVc2UgYFNlbnRyeS5nZXRDbGllbnQoKWAgaW5zdGVhZC4KICAgKi8KICAgZ2V0Q2xpZW50KCkgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICByZXR1cm4gdGhpcy5nZXRTdGFja1RvcCgpLmNsaWVudCA7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBzY29wZSBvZiB0aGUgdG9wIHN0YWNrLgogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBTZW50cnkuZ2V0Q3VycmVudFNjb3BlKClgIGluc3RlYWQuCiAgICovCiAgIGdldFNjb3BlKCkgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICByZXR1cm4gdGhpcy5nZXRTdGFja1RvcCgpLnNjb3BlOwogIH0KCiAgLyoqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBTZW50cnkuZ2V0SXNvbGF0aW9uU2NvcGUoKWAgaW5zdGVhZC4KICAgKi8KICAgZ2V0SXNvbGF0aW9uU2NvcGUoKSB7CiAgICByZXR1cm4gdGhpcy5faXNvbGF0aW9uU2NvcGU7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBzY29wZSBzdGFjayBmb3IgZG9tYWlucyBvciB0aGUgcHJvY2Vzcy4KICAgKiBAZGVwcmVjYXRlZCBUaGlzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4KICAgKi8KICAgZ2V0U3RhY2soKSB7CiAgICByZXR1cm4gdGhpcy5fc3RhY2s7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSB0b3Btb3N0IHNjb3BlIGxheWVyIGluIHRoZSBvcmRlciBkb21haW4gPiBsb2NhbCA+IHByb2Nlc3MuCiAgICogQGRlcHJlY2F0ZWQgVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gdjguCiAgICovCiAgIGdldFN0YWNrVG9wKCkgewogICAgcmV0dXJuIHRoaXMuX3N0YWNrW3RoaXMuX3N0YWNrLmxlbmd0aCAtIDFdOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LmNhcHR1cmVFeGNlcHRpb24oKWAgaW5zdGVhZC4KICAgKi8KICAgY2FwdHVyZUV4Y2VwdGlvbihleGNlcHRpb24sIGhpbnQpIHsKICAgIGNvbnN0IGV2ZW50SWQgPSAodGhpcy5fbGFzdEV2ZW50SWQgPSBoaW50ICYmIGhpbnQuZXZlbnRfaWQgPyBoaW50LmV2ZW50X2lkIDogdXVpZDQoKSk7CiAgICBjb25zdCBzeW50aGV0aWNFeGNlcHRpb24gPSBuZXcgRXJyb3IoJ1NlbnRyeSBzeW50aGV0aWNFeGNlcHRpb24nKTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRTY29wZSgpLmNhcHR1cmVFeGNlcHRpb24oZXhjZXB0aW9uLCB7CiAgICAgIG9yaWdpbmFsRXhjZXB0aW9uOiBleGNlcHRpb24sCiAgICAgIHN5bnRoZXRpY0V4Y2VwdGlvbiwKICAgICAgLi4uaGludCwKICAgICAgZXZlbnRfaWQ6IGV2ZW50SWQsCiAgICB9KTsKCiAgICByZXR1cm4gZXZlbnRJZDsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICoKICAgKiBAZGVwcmVjYXRlZCBVc2UgIGBTZW50cnkuY2FwdHVyZU1lc3NhZ2UoKWAgaW5zdGVhZC4KICAgKi8KICAgY2FwdHVyZU1lc3NhZ2UoCiAgICBtZXNzYWdlLAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBsZXZlbCwKICAgIGhpbnQsCiAgKSB7CiAgICBjb25zdCBldmVudElkID0gKHRoaXMuX2xhc3RFdmVudElkID0gaGludCAmJiBoaW50LmV2ZW50X2lkID8gaGludC5ldmVudF9pZCA6IHV1aWQ0KCkpOwogICAgY29uc3Qgc3ludGhldGljRXhjZXB0aW9uID0gbmV3IEVycm9yKG1lc3NhZ2UpOwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldFNjb3BlKCkuY2FwdHVyZU1lc3NhZ2UobWVzc2FnZSwgbGV2ZWwsIHsKICAgICAgb3JpZ2luYWxFeGNlcHRpb246IG1lc3NhZ2UsCiAgICAgIHN5bnRoZXRpY0V4Y2VwdGlvbiwKICAgICAgLi4uaGludCwKICAgICAgZXZlbnRfaWQ6IGV2ZW50SWQsCiAgICB9KTsKCiAgICByZXR1cm4gZXZlbnRJZDsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICoKICAgKiBAZGVwcmVjYXRlZCBVc2UgYFNlbnRyeS5jYXB0dXJlRXZlbnQoKWAgaW5zdGVhZC4KICAgKi8KICAgY2FwdHVyZUV2ZW50KGV2ZW50LCBoaW50KSB7CiAgICBjb25zdCBldmVudElkID0gaGludCAmJiBoaW50LmV2ZW50X2lkID8gaGludC5ldmVudF9pZCA6IHV1aWQ0KCk7CiAgICBpZiAoIWV2ZW50LnR5cGUpIHsKICAgICAgdGhpcy5fbGFzdEV2ZW50SWQgPSBldmVudElkOwogICAgfQogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldFNjb3BlKCkuY2FwdHVyZUV2ZW50KGV2ZW50LCB7IC4uLmhpbnQsIGV2ZW50X2lkOiBldmVudElkIH0pOwogICAgcmV0dXJuIGV2ZW50SWQ7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqCiAgICogQGRlcHJlY2F0ZWQgVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gdjguCiAgICovCiAgIGxhc3RFdmVudElkKCkgewogICAgcmV0dXJuIHRoaXMuX2xhc3RFdmVudElkOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LmFkZEJyZWFkY3J1bWIoKWAgaW5zdGVhZC4KICAgKi8KICAgYWRkQnJlYWRjcnVtYihicmVhZGNydW1iLCBoaW50KSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIGNvbnN0IHsgc2NvcGUsIGNsaWVudCB9ID0gdGhpcy5nZXRTdGFja1RvcCgpOwoKICAgIGlmICghY2xpZW50KSByZXR1cm47CgogICAgY29uc3QgeyBiZWZvcmVCcmVhZGNydW1iID0gbnVsbCwgbWF4QnJlYWRjcnVtYnMgPSBERUZBVUxUX0JSRUFEQ1JVTUJTIH0gPQogICAgICAoY2xpZW50LmdldE9wdGlvbnMgJiYgY2xpZW50LmdldE9wdGlvbnMoKSkgfHwge307CgogICAgaWYgKG1heEJyZWFkY3J1bWJzIDw9IDApIHJldHVybjsKCiAgICBjb25zdCB0aW1lc3RhbXAgPSBkYXRlVGltZXN0YW1wSW5TZWNvbmRzKCk7CiAgICBjb25zdCBtZXJnZWRCcmVhZGNydW1iID0geyB0aW1lc3RhbXAsIC4uLmJyZWFkY3J1bWIgfTsKICAgIGNvbnN0IGZpbmFsQnJlYWRjcnVtYiA9IGJlZm9yZUJyZWFkY3J1bWIKICAgICAgPyAoY29uc29sZVNhbmRib3goKCkgPT4gYmVmb3JlQnJlYWRjcnVtYihtZXJnZWRCcmVhZGNydW1iLCBoaW50KSkgKQogICAgICA6IG1lcmdlZEJyZWFkY3J1bWI7CgogICAgaWYgKGZpbmFsQnJlYWRjcnVtYiA9PT0gbnVsbCkgcmV0dXJuOwoKICAgIGlmIChjbGllbnQuZW1pdCkgewogICAgICBjbGllbnQuZW1pdCgnYmVmb3JlQWRkQnJlYWRjcnVtYicsIGZpbmFsQnJlYWRjcnVtYiwgaGludCk7CiAgICB9CgogICAgLy8gVE9ETyh2OCk6IEkga25vdyB0aGlzIGNvbW1lbnQgZG9lc24ndCBtYWtlIG11Y2ggc2Vuc2UgYmVjYXVzZSB0aGUgaHViIHdpbGwgYmUgZGVwcmVjYXRlZCBidXQgSSBzdGlsbCB3YW50ZWQgdG8KICAgIC8vIHdyaXRlIGl0IGRvd24uIEluIHRoZW9yeSwgd2Ugd291bGQgaGF2ZSB0byBhZGQgdGhlIGJyZWFkY3J1bWJzIHRvIHRoZSBpc29sYXRpb24gc2NvcGUgaGVyZSwgaG93ZXZlciwgdGhhdCB3b3VsZAogICAgLy8gZHVwbGljYXRlIGFsbCBvZiB0aGUgYnJlYWRjcnVtYnMuIFRoZXJlIHdhcyB0aGUgcG9zc2liaWxpdHkgb2YgYWRkaW5nIGJyZWFkY3J1bWJzIHRvIGJvdGgsIHRoZSBpc29sYXRpb24gc2NvcGUKICAgIC8vIGFuZCB0aGUgbm9ybWFsIHNjb3BlLCBhbmQgZGVkdXBsaWNhdGluZyBpdCBkb3duIHRoZSBsaW5lIGluIHRoZSBldmVudCBwcm9jZXNzaW5nIHBpcGVsaW5lLiBIb3dldmVyLCB0aGF0IHdvdWxkCiAgICAvLyBoYXZlIGJlZW4gdmVyeSBmcmFnaWxlLCBiZWNhdXNlIHRoZSBicmVhZGNydW1iIG9iamVjdHMgd291bGQgaGF2ZSBuZWVkZWQgdG8ga2VlcCB0aGVpciBpZGVudGl0eSBhbGwgdGhyb3VnaG91dAogICAgLy8gdGhlIGV2ZW50IHByb2Nlc3NpbmcgcGlwZWxpbmUuCiAgICAvLyBJbiB0aGUgbmV3IGltcGxlbWVudGF0aW9uLCB0aGUgdG9wIGxldmVsIGBTZW50cnkuYWRkQnJlYWRjcnVtYigpYCBzaG91bGQgT05MWSB3cml0ZSB0byB0aGUgaXNvbGF0aW9uIHNjb3BlLgoKICAgIHNjb3BlLmFkZEJyZWFkY3J1bWIoZmluYWxCcmVhZGNydW1iLCBtYXhCcmVhZGNydW1icyk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LnNldFVzZXIoKWAgaW5zdGVhZC4KICAgKi8KICAgc2V0VXNlcih1c2VyKSB7CiAgICAvLyBUT0RPKHY4KTogVGhlIHRvcCBsZXZlbCBgU2VudHJ5LnNldFVzZXIoKWAgZnVuY3Rpb24gc2hvdWxkIHdyaXRlIE9OTFkgdG8gdGhlIGlzb2xhdGlvbiBzY29wZS4KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRTY29wZSgpLnNldFVzZXIodXNlcik7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0SXNvbGF0aW9uU2NvcGUoKS5zZXRVc2VyKHVzZXIpOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKiBAZGVwcmVjYXRlZCBVc2UgYFNlbnRyeS5zZXRUYWdzKClgIGluc3RlYWQuCiAgICovCiAgIHNldFRhZ3ModGFncykgewogICAgLy8gVE9ETyh2OCk6IFRoZSB0b3AgbGV2ZWwgYFNlbnRyeS5zZXRUYWdzKClgIGZ1bmN0aW9uIHNob3VsZCB3cml0ZSBPTkxZIHRvIHRoZSBpc29sYXRpb24gc2NvcGUuCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0U2NvcGUoKS5zZXRUYWdzKHRhZ3MpOwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldElzb2xhdGlvblNjb3BlKCkuc2V0VGFncyh0YWdzKTsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBTZW50cnkuc2V0RXh0cmFzKClgIGluc3RlYWQuCiAgICovCiAgIHNldEV4dHJhcyhleHRyYXMpIHsKICAgIC8vIFRPRE8odjgpOiBUaGUgdG9wIGxldmVsIGBTZW50cnkuc2V0RXh0cmFzKClgIGZ1bmN0aW9uIHNob3VsZCB3cml0ZSBPTkxZIHRvIHRoZSBpc29sYXRpb24gc2NvcGUuCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0U2NvcGUoKS5zZXRFeHRyYXMoZXh0cmFzKTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRJc29sYXRpb25TY29wZSgpLnNldEV4dHJhcyhleHRyYXMpOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKiBAZGVwcmVjYXRlZCBVc2UgYFNlbnRyeS5zZXRUYWcoKWAgaW5zdGVhZC4KICAgKi8KICAgc2V0VGFnKGtleSwgdmFsdWUpIHsKICAgIC8vIFRPRE8odjgpOiBUaGUgdG9wIGxldmVsIGBTZW50cnkuc2V0VGFnKClgIGZ1bmN0aW9uIHNob3VsZCB3cml0ZSBPTkxZIHRvIHRoZSBpc29sYXRpb24gc2NvcGUuCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0U2NvcGUoKS5zZXRUYWcoa2V5LCB2YWx1ZSk7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0SXNvbGF0aW9uU2NvcGUoKS5zZXRUYWcoa2V5LCB2YWx1ZSk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LnNldEV4dHJhKClgIGluc3RlYWQuCiAgICovCiAgIHNldEV4dHJhKGtleSwgZXh0cmEpIHsKICAgIC8vIFRPRE8odjgpOiBUaGUgdG9wIGxldmVsIGBTZW50cnkuc2V0RXh0cmEoKWAgZnVuY3Rpb24gc2hvdWxkIHdyaXRlIE9OTFkgdG8gdGhlIGlzb2xhdGlvbiBzY29wZS4KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRTY29wZSgpLnNldEV4dHJhKGtleSwgZXh0cmEpOwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldElzb2xhdGlvblNjb3BlKCkuc2V0RXh0cmEoa2V5LCBleHRyYSk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LnNldENvbnRleHQoKWAgaW5zdGVhZC4KICAgKi8KICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQogICBzZXRDb250ZXh0KG5hbWUsIGNvbnRleHQpIHsKICAgIC8vIFRPRE8odjgpOiBUaGUgdG9wIGxldmVsIGBTZW50cnkuc2V0Q29udGV4dCgpYCBmdW5jdGlvbiBzaG91bGQgd3JpdGUgT05MWSB0byB0aGUgaXNvbGF0aW9uIHNjb3BlLgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldFNjb3BlKCkuc2V0Q29udGV4dChuYW1lLCBjb250ZXh0KTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRJc29sYXRpb25TY29wZSgpLnNldENvbnRleHQobmFtZSwgY29udGV4dCk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBnZXRTY29wZSgpYCBkaXJlY3RseS4KICAgKi8KICAgY29uZmlndXJlU2NvcGUoY2FsbGJhY2spIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgY29uc3QgeyBzY29wZSwgY2xpZW50IH0gPSB0aGlzLmdldFN0YWNrVG9wKCk7CiAgICBpZiAoY2xpZW50KSB7CiAgICAgIGNhbGxiYWNrKHNjb3BlKTsKICAgIH0KICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgIHJ1bihjYWxsYmFjaykgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBjb25zdCBvbGRIdWIgPSBtYWtlTWFpbih0aGlzKTsKICAgIHRyeSB7CiAgICAgIGNhbGxiYWNrKHRoaXMpOwogICAgfSBmaW5hbGx5IHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICAgIG1ha2VNYWluKG9sZEh1Yik7CiAgICB9CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LmdldENsaWVudCgpLmdldEludGVncmF0aW9uQnlOYW1lKClgIGluc3RlYWQuCiAgICovCiAgIGdldEludGVncmF0aW9uKGludGVncmF0aW9uKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIGNvbnN0IGNsaWVudCA9IHRoaXMuZ2V0Q2xpZW50KCk7CiAgICBpZiAoIWNsaWVudCkgcmV0dXJuIG51bGw7CiAgICB0cnkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgICAgcmV0dXJuIGNsaWVudC5nZXRJbnRlZ3JhdGlvbihpbnRlZ3JhdGlvbik7CiAgICB9IGNhdGNoIChfb08pIHsKICAgICAgREVCVUdfQlVJTEQgJiYgbG9nZ2VyLndhcm4oYENhbm5vdCByZXRyaWV2ZSBpbnRlZ3JhdGlvbiAke2ludGVncmF0aW9uLmlkfSBmcm9tIHRoZSBjdXJyZW50IEh1YmApOwogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9CgogIC8qKgogICAqIFN0YXJ0cyBhIG5ldyBgVHJhbnNhY3Rpb25gIGFuZCByZXR1cm5zIGl0LiBUaGlzIGlzIHRoZSBlbnRyeSBwb2ludCB0byBtYW51YWwgdHJhY2luZyBpbnN0cnVtZW50YXRpb24uCiAgICoKICAgKiBBIHRyZWUgc3RydWN0dXJlIGNhbiBiZSBidWlsdCBieSBhZGRpbmcgY2hpbGQgc3BhbnMgdG8gdGhlIHRyYW5zYWN0aW9uLCBhbmQgY2hpbGQgc3BhbnMgdG8gb3RoZXIgc3BhbnMuIFRvIHN0YXJ0IGEKICAgKiBuZXcgY2hpbGQgc3BhbiB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uIG9yIGFueSBzcGFuLCBjYWxsIHRoZSByZXNwZWN0aXZlIGAuc3RhcnRDaGlsZCgpYCBtZXRob2QuCiAgICoKICAgKiBFdmVyeSBjaGlsZCBzcGFuIG11c3QgYmUgZmluaXNoZWQgYmVmb3JlIHRoZSB0cmFuc2FjdGlvbiBpcyBmaW5pc2hlZCwgb3RoZXJ3aXNlIHRoZSB1bmZpbmlzaGVkIHNwYW5zIGFyZSBkaXNjYXJkZWQuCiAgICoKICAgKiBUaGUgdHJhbnNhY3Rpb24gbXVzdCBiZSBmaW5pc2hlZCB3aXRoIGEgY2FsbCB0byBpdHMgYC5lbmQoKWAgbWV0aG9kLCBhdCB3aGljaCBwb2ludCB0aGUgdHJhbnNhY3Rpb24gd2l0aCBhbGwgaXRzCiAgICogZmluaXNoZWQgY2hpbGQgc3BhbnMgd2lsbCBiZSBzZW50IHRvIFNlbnRyeS4KICAgKgogICAqIEBwYXJhbSBjb250ZXh0IFByb3BlcnRpZXMgb2YgdGhlIG5ldyBgVHJhbnNhY3Rpb25gLgogICAqIEBwYXJhbSBjdXN0b21TYW1wbGluZ0NvbnRleHQgSW5mb3JtYXRpb24gZ2l2ZW4gdG8gdGhlIHRyYW5zYWN0aW9uIHNhbXBsaW5nIGZ1bmN0aW9uIChhbG9uZyB3aXRoIGNvbnRleHQtZGVwZW5kZW50CiAgICogZGVmYXVsdCB2YWx1ZXMpLiBTZWUge0BsaW5rIE9wdGlvbnMudHJhY2VzU2FtcGxlcn0uCiAgICoKICAgKiBAcmV0dXJucyBUaGUgdHJhbnNhY3Rpb24gd2hpY2ggd2FzIGp1c3Qgc3RhcnRlZAogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBzdGFydFNwYW4oKWAsIGBzdGFydFNwYW5NYW51YWwoKWAgb3IgYHN0YXJ0SW5hY3RpdmVTcGFuKClgIGluc3RlYWQuCiAgICovCiAgIHN0YXJ0VHJhbnNhY3Rpb24oY29udGV4dCwgY3VzdG9tU2FtcGxpbmdDb250ZXh0KSB7CiAgICBjb25zdCByZXN1bHQgPSB0aGlzLl9jYWxsRXh0ZW5zaW9uTWV0aG9kKCdzdGFydFRyYW5zYWN0aW9uJywgY29udGV4dCwgY3VzdG9tU2FtcGxpbmdDb250ZXh0KTsKCiAgICBpZiAoREVCVUdfQlVJTEQgJiYgIXJlc3VsdCkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgICAgY29uc3QgY2xpZW50ID0gdGhpcy5nZXRDbGllbnQoKTsKICAgICAgaWYgKCFjbGllbnQpIHsKICAgICAgICBsb2dnZXIud2FybigKICAgICAgICAgICJUcmFjaW5nIGV4dGVuc2lvbiAnc3RhcnRUcmFuc2FjdGlvbicgaXMgbWlzc2luZy4gWW91IHNob3VsZCAnaW5pdCcgdGhlIFNESyBiZWZvcmUgY2FsbGluZyAnc3RhcnRUcmFuc2FjdGlvbiciLAogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbG9nZ2VyLndhcm4oYFRyYWNpbmcgZXh0ZW5zaW9uICdzdGFydFRyYW5zYWN0aW9uJyBoYXMgbm90IGJlZW4gYWRkZWQuIENhbGwgJ2FkZFRyYWNpbmdFeHRlbnNpb25zJyBiZWZvcmUgY2FsbGluZyAnaW5pdCc6ClNlbnRyeS5hZGRUcmFjaW5nRXh0ZW5zaW9ucygpOwpTZW50cnkuaW5pdCh7Li4ufSk7CmApOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBzcGFuVG9UcmFjZUhlYWRlcigpYCBpbnN0ZWFkLgogICAqLwogICB0cmFjZUhlYWRlcnMoKSB7CiAgICByZXR1cm4gdGhpcy5fY2FsbEV4dGVuc2lvbk1ldGhvZCgndHJhY2VIZWFkZXJzJyk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIHRvcCBsZXZlbCBgY2FwdHVyZVNlc3Npb25gIGluc3RlYWQuCiAgICovCiAgIGNhcHR1cmVTZXNzaW9uKGVuZFNlc3Npb24gPSBmYWxzZSkgewogICAgLy8gYm90aCBzZW5kIHRoZSB1cGRhdGUgYW5kIHB1bGwgdGhlIHNlc3Npb24gZnJvbSB0aGUgc2NvcGUKICAgIGlmIChlbmRTZXNzaW9uKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgICByZXR1cm4gdGhpcy5lbmRTZXNzaW9uKCk7CiAgICB9CgogICAgLy8gb25seSBzZW5kIHRoZSB1cGRhdGUKICAgIHRoaXMuX3NlbmRTZXNzaW9uVXBkYXRlKCk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSB0b3AgbGV2ZWwgYGVuZFNlc3Npb25gIGluc3RlYWQuCiAgICovCiAgIGVuZFNlc3Npb24oKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIGNvbnN0IGxheWVyID0gdGhpcy5nZXRTdGFja1RvcCgpOwogICAgY29uc3Qgc2NvcGUgPSBsYXllci5zY29wZTsKICAgIGNvbnN0IHNlc3Npb24gPSBzY29wZS5nZXRTZXNzaW9uKCk7CiAgICBpZiAoc2Vzc2lvbikgewogICAgICBjbG9zZVNlc3Npb24oc2Vzc2lvbik7CiAgICB9CiAgICB0aGlzLl9zZW5kU2Vzc2lvblVwZGF0ZSgpOwoKICAgIC8vIHRoZSBzZXNzaW9uIGlzIG92ZXI7IHRha2UgaXQgb2ZmIG9mIHRoZSBzY29wZQogICAgc2NvcGUuc2V0U2Vzc2lvbigpOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKiBAZGVwcmVjYXRlZCBVc2UgdG9wIGxldmVsIGBzdGFydFNlc3Npb25gIGluc3RlYWQuCiAgICovCiAgIHN0YXJ0U2Vzc2lvbihjb250ZXh0KSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIGNvbnN0IHsgc2NvcGUsIGNsaWVudCB9ID0gdGhpcy5nZXRTdGFja1RvcCgpOwogICAgY29uc3QgeyByZWxlYXNlLCBlbnZpcm9ubWVudCA9IERFRkFVTFRfRU5WSVJPTk1FTlQgfSA9IChjbGllbnQgJiYgY2xpZW50LmdldE9wdGlvbnMoKSkgfHwge307CgogICAgLy8gV2lsbCBmZXRjaCB1c2VyQWdlbnQgaWYgY2FsbGVkIGZyb20gYnJvd3NlciBzZGsKICAgIGNvbnN0IHsgdXNlckFnZW50IH0gPSBHTE9CQUxfT0JKLm5hdmlnYXRvciB8fCB7fTsKCiAgICBjb25zdCBzZXNzaW9uID0gbWFrZVNlc3Npb24oewogICAgICByZWxlYXNlLAogICAgICBlbnZpcm9ubWVudCwKICAgICAgdXNlcjogc2NvcGUuZ2V0VXNlcigpLAogICAgICAuLi4odXNlckFnZW50ICYmIHsgdXNlckFnZW50IH0pLAogICAgICAuLi5jb250ZXh0LAogICAgfSk7CgogICAgLy8gRW5kIGV4aXN0aW5nIHNlc3Npb24gaWYgdGhlcmUncyBvbmUKICAgIGNvbnN0IGN1cnJlbnRTZXNzaW9uID0gc2NvcGUuZ2V0U2Vzc2lvbiAmJiBzY29wZS5nZXRTZXNzaW9uKCk7CiAgICBpZiAoY3VycmVudFNlc3Npb24gJiYgY3VycmVudFNlc3Npb24uc3RhdHVzID09PSAnb2snKSB7CiAgICAgIHVwZGF0ZVNlc3Npb24oY3VycmVudFNlc3Npb24sIHsgc3RhdHVzOiAnZXhpdGVkJyB9KTsKICAgIH0KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5lbmRTZXNzaW9uKCk7CgogICAgLy8gQWZ0ZXJ3YXJkcyB3ZSBzZXQgdGhlIG5ldyBzZXNzaW9uIG9uIHRoZSBzY29wZQogICAgc2NvcGUuc2V0U2Vzc2lvbihzZXNzaW9uKTsKCiAgICByZXR1cm4gc2Vzc2lvbjsKICB9CgogIC8qKgogICAqIFJldHVybnMgaWYgZGVmYXVsdCBQSUkgc2hvdWxkIGJlIHNlbnQgdG8gU2VudHJ5IGFuZCBwcm9wYWdhdGVkIGluIG91cmdvaW5nIHJlcXVlc3RzCiAgICogd2hlbiBUcmFjaW5nIGlzIHVzZWQuCiAgICoKICAgKiBAZGVwcmVjYXRlZCBVc2UgdG9wLWxldmVsIGBnZXRDbGllbnQoKS5nZXRPcHRpb25zKCkuc2VuZERlZmF1bHRQaWlgIGluc3RlYWQuIFRoaXMgZnVuY3Rpb24KICAgKiBvbmx5IHVubmVjZXNzYXJpbHkgaW5jcmVhc2VkIEFQSSBzdXJmYWNlIGJ1dCBvbmx5IHdyYXBwZWQgYWNjZXNzaW5nIHRoZSBvcHRpb24uCiAgICovCiAgIHNob3VsZFNlbmREZWZhdWx0UGlpKCkgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBjb25zdCBjbGllbnQgPSB0aGlzLmdldENsaWVudCgpOwogICAgY29uc3Qgb3B0aW9ucyA9IGNsaWVudCAmJiBjbGllbnQuZ2V0T3B0aW9ucygpOwogICAgcmV0dXJuIEJvb2xlYW4ob3B0aW9ucyAmJiBvcHRpb25zLnNlbmREZWZhdWx0UGlpKTsKICB9CgogIC8qKgogICAqIFNlbmRzIHRoZSBjdXJyZW50IFNlc3Npb24gb24gdGhlIHNjb3BlCiAgICovCiAgIF9zZW5kU2Vzc2lvblVwZGF0ZSgpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgY29uc3QgeyBzY29wZSwgY2xpZW50IH0gPSB0aGlzLmdldFN0YWNrVG9wKCk7CgogICAgY29uc3Qgc2Vzc2lvbiA9IHNjb3BlLmdldFNlc3Npb24oKTsKICAgIGlmIChzZXNzaW9uICYmIGNsaWVudCAmJiBjbGllbnQuY2FwdHVyZVNlc3Npb24pIHsKICAgICAgY2xpZW50LmNhcHR1cmVTZXNzaW9uKHNlc3Npb24pOwogICAgfQogIH0KCiAgLyoqCiAgICogQ2FsbHMgZ2xvYmFsIGV4dGVuc2lvbiBtZXRob2QgYW5kIGJpbmRpbmcgY3VycmVudCBpbnN0YW5jZSB0byB0aGUgZnVuY3Rpb24gY2FsbAogICAqLwogIC8vIEB0cy1leHBlY3QtZXJyb3IgRnVuY3Rpb24gbGFja3MgZW5kaW5nIHJldHVybiBzdGF0ZW1lbnQgYW5kIHJldHVybiB0eXBlIGRvZXMgbm90IGluY2x1ZGUgJ3VuZGVmaW5lZCcuIHRzKDIzNjYpCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkKICAgX2NhbGxFeHRlbnNpb25NZXRob2QobWV0aG9kLCAuLi5hcmdzKSB7CiAgICBjb25zdCBjYXJyaWVyID0gZ2V0TWFpbkNhcnJpZXIoKTsKICAgIGNvbnN0IHNlbnRyeSA9IGNhcnJpZXIuX19TRU5UUllfXzsKICAgIGlmIChzZW50cnkgJiYgc2VudHJ5LmV4dGVuc2lvbnMgJiYgdHlwZW9mIHNlbnRyeS5leHRlbnNpb25zW21ldGhvZF0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgcmV0dXJuIHNlbnRyeS5leHRlbnNpb25zW21ldGhvZF0uYXBwbHkodGhpcywgYXJncyk7CiAgICB9CiAgICBERUJVR19CVUlMRCAmJiBsb2dnZXIud2FybihgRXh0ZW5zaW9uIG1ldGhvZCAke21ldGhvZH0gY291bGRuJ3QgYmUgZm91bmQsIGRvaW5nIG5vdGhpbmcuYCk7CiAgfQp9CgovKioKICogUmV0dXJucyB0aGUgZ2xvYmFsIHNoaW0gcmVnaXN0cnkuCiAqCiAqIEZJWE1FOiBUaGlzIGZ1bmN0aW9uIGlzIHByb2JsZW1hdGljLCBiZWNhdXNlIGRlc3BpdGUgYWx3YXlzIHJldHVybmluZyBhIHZhbGlkIENhcnJpZXIsCiAqIGl0IGhhcyBhbiBvcHRpb25hbCBgX19TRU5UUllfX2AgcHJvcGVydHksIHdoaWNoIHRoZW4gaW4gdHVybiByZXF1aXJlcyB1cyB0byBhbHdheXMgcGVyZm9ybSBhbiB1bm5lY2Vzc2FyeSBjaGVjawogKiBhdCB0aGUgY2FsbC1zaXRlLiBXZSBhbHdheXMgYWNjZXNzIHRoZSBjYXJyaWVyIHRocm91Z2ggdGhpcyBmdW5jdGlvbiwgc28gd2UgY2FuIGd1YXJhbnRlZSB0aGF0IGBfX1NFTlRSWV9fYCBpcyB0aGVyZS4KICoqLwpmdW5jdGlvbiBnZXRNYWluQ2FycmllcigpIHsKICBHTE9CQUxfT0JKLl9fU0VOVFJZX18gPSBHTE9CQUxfT0JKLl9fU0VOVFJZX18gfHwgewogICAgZXh0ZW5zaW9uczoge30sCiAgICBodWI6IHVuZGVmaW5lZCwKICB9OwogIHJldHVybiBHTE9CQUxfT0JKOwp9CgovKioKICogUmVwbGFjZXMgdGhlIGN1cnJlbnQgbWFpbiBodWIgd2l0aCB0aGUgcGFzc2VkIG9uZSBvbiB0aGUgZ2xvYmFsIG9iamVjdAogKgogKiBAcmV0dXJucyBUaGUgb2xkIHJlcGxhY2VkIGh1YgogKgogKiBAZGVwcmVjYXRlZCBVc2UgYHNldEN1cnJlbnRDbGllbnQoKWAgaW5zdGVhZC4KICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpmdW5jdGlvbiBtYWtlTWFpbihodWIpIHsKICBjb25zdCByZWdpc3RyeSA9IGdldE1haW5DYXJyaWVyKCk7CiAgY29uc3Qgb2xkSHViID0gZ2V0SHViRnJvbUNhcnJpZXIocmVnaXN0cnkpOwogIHNldEh1Yk9uQ2FycmllcihyZWdpc3RyeSwgaHViKTsKICByZXR1cm4gb2xkSHViOwp9CgovKioKICogUmV0dXJucyB0aGUgZGVmYXVsdCBodWIgaW5zdGFuY2UuCiAqCiAqIElmIGEgaHViIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCBpbiB0aGUgZ2xvYmFsIGNhcnJpZXIgYnV0IHRoaXMgbW9kdWxlCiAqIGNvbnRhaW5zIGEgbW9yZSByZWNlbnQgdmVyc2lvbiwgaXQgcmVwbGFjZXMgdGhlIHJlZ2lzdGVyZWQgdmVyc2lvbi4KICogT3RoZXJ3aXNlLCB0aGUgY3VycmVudGx5IHJlZ2lzdGVyZWQgaHViIHdpbGwgYmUgcmV0dXJuZWQuCiAqCiAqIEBkZXByZWNhdGVkIFVzZSB0aGUgcmVzcGVjdGl2ZSByZXBsYWNlbWVudCBtZXRob2QgZGlyZWN0bHkgaW5zdGVhZC4KICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpmdW5jdGlvbiBnZXRDdXJyZW50SHViKCkgewogIC8vIEdldCBtYWluIGNhcnJpZXIgKGdsb2JhbCBmb3IgZXZlcnkgZW52aXJvbm1lbnQpCiAgY29uc3QgcmVnaXN0cnkgPSBnZXRNYWluQ2FycmllcigpOwoKICBpZiAocmVnaXN0cnkuX19TRU5UUllfXyAmJiByZWdpc3RyeS5fX1NFTlRSWV9fLmFjcykgewogICAgY29uc3QgaHViID0gcmVnaXN0cnkuX19TRU5UUllfXy5hY3MuZ2V0Q3VycmVudEh1YigpOwoKICAgIGlmIChodWIpIHsKICAgICAgcmV0dXJuIGh1YjsKICAgIH0KICB9CgogIC8vIFJldHVybiBodWIgdGhhdCBsaXZlcyBvbiBhIGdsb2JhbCBvYmplY3QKICByZXR1cm4gZ2V0R2xvYmFsSHViKHJlZ2lzdHJ5KTsKfQoKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCmZ1bmN0aW9uIGdldEdsb2JhbEh1YihyZWdpc3RyeSA9IGdldE1haW5DYXJyaWVyKCkpIHsKICAvLyBJZiB0aGVyZSdzIG5vIGh1Yiwgb3IgaXRzIGFuIG9sZCBBUEksIGFzc2lnbiBhIG5ldyBvbmUKCiAgaWYgKAogICAgIWhhc0h1Yk9uQ2FycmllcihyZWdpc3RyeSkgfHwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgZ2V0SHViRnJvbUNhcnJpZXIocmVnaXN0cnkpLmlzT2xkZXJUaGFuKEFQSV9WRVJTSU9OKQogICkgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBzZXRIdWJPbkNhcnJpZXIocmVnaXN0cnksIG5ldyBIdWIoKSk7CiAgfQoKICAvLyBSZXR1cm4gaHViIHRoYXQgbGl2ZXMgb24gYSBnbG9iYWwgb2JqZWN0CiAgcmV0dXJuIGdldEh1YkZyb21DYXJyaWVyKHJlZ2lzdHJ5KTsKfQoKLyoqCiAqIFRoaXMgd2lsbCB0ZWxsIHdoZXRoZXIgYSBjYXJyaWVyIGhhcyBhIGh1YiBvbiBpdCBvciBub3QKICogQHBhcmFtIGNhcnJpZXIgb2JqZWN0CiAqLwpmdW5jdGlvbiBoYXNIdWJPbkNhcnJpZXIoY2FycmllcikgewogIHJldHVybiAhIShjYXJyaWVyICYmIGNhcnJpZXIuX19TRU5UUllfXyAmJiBjYXJyaWVyLl9fU0VOVFJZX18uaHViKTsKfQoKLyoqCiAqIFRoaXMgd2lsbCBjcmVhdGUgYSBuZXcge0BsaW5rIEh1Yn0gYW5kIGFkZCB0byB0aGUgcGFzc2VkIG9iamVjdCBvbgogKiBfX1NFTlRSWV9fLmh1Yi4KICogQHBhcmFtIGNhcnJpZXIgb2JqZWN0CiAqIEBoaWRkZW4KICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpmdW5jdGlvbiBnZXRIdWJGcm9tQ2FycmllcihjYXJyaWVyKSB7CiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgcmV0dXJuIGdldEdsb2JhbFNpbmdsZXRvbignaHViJywgKCkgPT4gbmV3IEh1YigpLCBjYXJyaWVyKTsKfQoKLyoqCiAqIFRoaXMgd2lsbCBzZXQgcGFzc2VkIHtAbGluayBIdWJ9IG9uIHRoZSBwYXNzZWQgb2JqZWN0J3MgX19TRU5UUllfXy5odWIgYXR0cmlidXRlCiAqIEBwYXJhbSBjYXJyaWVyIG9iamVjdAogKiBAcGFyYW0gaHViIEh1YgogKiBAcmV0dXJucyBBIGJvb2xlYW4gaW5kaWNhdGluZyBzdWNjZXNzIG9yIGZhaWx1cmUKICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpmdW5jdGlvbiBzZXRIdWJPbkNhcnJpZXIoY2FycmllciwgaHViKSB7CiAgaWYgKCFjYXJyaWVyKSByZXR1cm4gZmFsc2U7CiAgY29uc3QgX19TRU5UUllfXyA9IChjYXJyaWVyLl9fU0VOVFJZX18gPSBjYXJyaWVyLl9fU0VOVFJZX18gfHwge30pOwogIF9fU0VOVFJZX18uaHViID0gaHViOwogIHJldHVybiB0cnVlOwp9CgovKioKICogQXBwbHkgU2RrSW5mbyAobmFtZSwgdmVyc2lvbiwgcGFja2FnZXMsIGludGVncmF0aW9ucykgdG8gdGhlIGNvcnJlc3BvbmRpbmcgZXZlbnQga2V5LgogKiBNZXJnZSB3aXRoIGV4aXN0aW5nIGRhdGEgaWYgYW55LgogKiovCmZ1bmN0aW9uIGVuaGFuY2VFdmVudFdpdGhTZGtJbmZvKGV2ZW50LCBzZGtJbmZvKSB7CiAgaWYgKCFzZGtJbmZvKSB7CiAgICByZXR1cm4gZXZlbnQ7CiAgfQogIGV2ZW50LnNkayA9IGV2ZW50LnNkayB8fCB7fTsKICBldmVudC5zZGsubmFtZSA9IGV2ZW50LnNkay5uYW1lIHx8IHNka0luZm8ubmFtZTsKICBldmVudC5zZGsudmVyc2lvbiA9IGV2ZW50LnNkay52ZXJzaW9uIHx8IHNka0luZm8udmVyc2lvbjsKICBldmVudC5zZGsuaW50ZWdyYXRpb25zID0gWy4uLihldmVudC5zZGsuaW50ZWdyYXRpb25zIHx8IFtdKSwgLi4uKHNka0luZm8uaW50ZWdyYXRpb25zIHx8IFtdKV07CiAgZXZlbnQuc2RrLnBhY2thZ2VzID0gWy4uLihldmVudC5zZGsucGFja2FnZXMgfHwgW10pLCAuLi4oc2RrSW5mby5wYWNrYWdlcyB8fCBbXSldOwogIHJldHVybiBldmVudDsKfQoKLyoqIENyZWF0ZXMgYW4gZW52ZWxvcGUgZnJvbSBhIFNlc3Npb24gKi8KZnVuY3Rpb24gY3JlYXRlU2Vzc2lvbkVudmVsb3BlKAogIHNlc3Npb24sCiAgZHNuLAogIG1ldGFkYXRhLAogIHR1bm5lbCwKKSB7CiAgY29uc3Qgc2RrSW5mbyA9IGdldFNka01ldGFkYXRhRm9yRW52ZWxvcGVIZWFkZXIobWV0YWRhdGEpOwogIGNvbnN0IGVudmVsb3BlSGVhZGVycyA9IHsKICAgIHNlbnRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAgIC4uLihzZGtJbmZvICYmIHsgc2RrOiBzZGtJbmZvIH0pLAogICAgLi4uKCEhdHVubmVsICYmIGRzbiAmJiB7IGRzbjogZHNuVG9TdHJpbmcoZHNuKSB9KSwKICB9OwoKICBjb25zdCBlbnZlbG9wZUl0ZW0gPQogICAgJ2FnZ3JlZ2F0ZXMnIGluIHNlc3Npb24gPyBbeyB0eXBlOiAnc2Vzc2lvbnMnIH0sIHNlc3Npb25dIDogW3sgdHlwZTogJ3Nlc3Npb24nIH0sIHNlc3Npb24udG9KU09OKCldOwoKICByZXR1cm4gY3JlYXRlRW52ZWxvcGUoZW52ZWxvcGVIZWFkZXJzLCBbZW52ZWxvcGVJdGVtXSk7Cn0KCi8qKgogKiBDcmVhdGUgYW4gRW52ZWxvcGUgZnJvbSBhbiBldmVudC4KICovCmZ1bmN0aW9uIGNyZWF0ZUV2ZW50RW52ZWxvcGUoCiAgZXZlbnQsCiAgZHNuLAogIG1ldGFkYXRhLAogIHR1bm5lbCwKKSB7CiAgY29uc3Qgc2RrSW5mbyA9IGdldFNka01ldGFkYXRhRm9yRW52ZWxvcGVIZWFkZXIobWV0YWRhdGEpOwoKICAvKgogICAgTm90ZTogRHVlIHRvIFRTLCBldmVudC50eXBlIG1heSBiZSBgcmVwbGF5X2V2ZW50YCwgdGhlb3JldGljYWxseS4KICAgIEluIHByYWN0aWNlLCB3ZSBuZXZlciBjYWxsIGBjcmVhdGVFdmVudEVudmVsb3BlYCB3aXRoIGByZXBsYXlfZXZlbnRgIHR5cGUsCiAgICBhbmQgd2UnZCBoYXZlIHRvIGFkanV0IGEgbG9vb3Qgb2YgdHlwZXMgdG8gbWFrZSB0aGlzIHdvcmsgcHJvcGVybHkuCiAgICBXZSB3YW50IHRvIGF2b2lkIGNhc3RpbmcgdGhpcyBhcm91bmQsIGFzIHRoYXQgY291bGQgbGVhZCB0byBidWdzIChlLmcuIHdoZW4gd2UgYWRkIGFub3RoZXIgdHlwZSkKICAgIFNvIHRoZSBzYWZlIGNob2ljZSBpcyB0byByZWFsbHkgZ3VhcmQgYWdhaW5zdCB0aGUgcmVwbGF5X2V2ZW50IHR5cGUgaGVyZS4KICAqLwogIGNvbnN0IGV2ZW50VHlwZSA9IGV2ZW50LnR5cGUgJiYgZXZlbnQudHlwZSAhPT0gJ3JlcGxheV9ldmVudCcgPyBldmVudC50eXBlIDogJ2V2ZW50JzsKCiAgZW5oYW5jZUV2ZW50V2l0aFNka0luZm8oZXZlbnQsIG1ldGFkYXRhICYmIG1ldGFkYXRhLnNkayk7CgogIGNvbnN0IGVudmVsb3BlSGVhZGVycyA9IGNyZWF0ZUV2ZW50RW52ZWxvcGVIZWFkZXJzKGV2ZW50LCBzZGtJbmZvLCB0dW5uZWwsIGRzbik7CgogIC8vIFByZXZlbnQgdGhpcyBkYXRhICh3aGljaCwgaWYgaXQgZXhpc3RzLCB3YXMgdXNlZCBpbiBlYXJsaWVyIHN0ZXBzIGluIHRoZSBwcm9jZXNzaW5nIHBpcGVsaW5lKSBmcm9tIGJlaW5nIHNlbnQgdG8KICAvLyBzZW50cnkuIChOb3RlOiBPdXIgdXNlIG9mIHRoaXMgcHJvcGVydHkgY29tZXMgYW5kIGdvZXMgd2l0aCB3aGF0ZXZlciB3ZSBtaWdodCBiZSBkZWJ1Z2dpbmcsIHdoYXRldmVyIGhhY2tzIHdlIG1heQogIC8vIGhhdmUgdGVtcG9yYXJpbHkgYWRkZWQsIGV0Yy4gRXZlbiBpZiB3ZSBkb24ndCBoYXBwZW4gdG8gYmUgdXNpbmcgaXQgYXQgc29tZSBwb2ludCBpbiB0aGUgZnV0dXJlLCBsZXQncyBub3QgZ2V0IHJpZAogIC8vIG9mIHRoaXMgYGRlbGV0ZWAsIGxlc3Qgd2UgbWlzcyBwdXR0aW5nIGl0IGJhY2sgaW4gdGhlIG5leHQgdGltZSB0aGUgcHJvcGVydHkgaXMgaW4gdXNlLikKICBkZWxldGUgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhOwoKICBjb25zdCBldmVudEl0ZW0gPSBbeyB0eXBlOiBldmVudFR5cGUgfSwgZXZlbnRdOwogIHJldHVybiBjcmVhdGVFbnZlbG9wZShlbnZlbG9wZUhlYWRlcnMsIFtldmVudEl0ZW1dKTsKfQoKY29uc3QgU0VOVFJZX0FQSV9WRVJTSU9OID0gJzcnOwoKLyoqIFJldHVybnMgdGhlIHByZWZpeCB0byBjb25zdHJ1Y3QgU2VudHJ5IGluZ2VzdGlvbiBBUEkgZW5kcG9pbnRzLiAqLwpmdW5jdGlvbiBnZXRCYXNlQXBpRW5kcG9pbnQoZHNuKSB7CiAgY29uc3QgcHJvdG9jb2wgPSBkc24ucHJvdG9jb2wgPyBgJHtkc24ucHJvdG9jb2x9OmAgOiAnJzsKICBjb25zdCBwb3J0ID0gZHNuLnBvcnQgPyBgOiR7ZHNuLnBvcnR9YCA6ICcnOwogIHJldHVybiBgJHtwcm90b2NvbH0vLyR7ZHNuLmhvc3R9JHtwb3J0fSR7ZHNuLnBhdGggPyBgLyR7ZHNuLnBhdGh9YCA6ICcnfS9hcGkvYDsKfQoKLyoqIFJldHVybnMgdGhlIGluZ2VzdCBBUEkgZW5kcG9pbnQgZm9yIHRhcmdldC4gKi8KZnVuY3Rpb24gX2dldEluZ2VzdEVuZHBvaW50KGRzbikgewogIHJldHVybiBgJHtnZXRCYXNlQXBpRW5kcG9pbnQoZHNuKX0ke2Rzbi5wcm9qZWN0SWR9L2VudmVsb3BlL2A7Cn0KCi8qKiBSZXR1cm5zIGEgVVJMLWVuY29kZWQgc3RyaW5nIHdpdGggYXV0aCBjb25maWcgc3VpdGFibGUgZm9yIGEgcXVlcnkgc3RyaW5nLiAqLwpmdW5jdGlvbiBfZW5jb2RlZEF1dGgoZHNuLCBzZGtJbmZvKSB7CiAgcmV0dXJuIHVybEVuY29kZSh7CiAgICAvLyBXZSBzZW5kIG9ubHkgdGhlIG1pbmltdW0gc2V0IG9mIHJlcXVpcmVkIGluZm9ybWF0aW9uLiBTZWUKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvaXNzdWVzLzI1NzIuCiAgICBzZW50cnlfa2V5OiBkc24ucHVibGljS2V5LAogICAgc2VudHJ5X3ZlcnNpb246IFNFTlRSWV9BUElfVkVSU0lPTiwKICAgIC4uLihzZGtJbmZvICYmIHsgc2VudHJ5X2NsaWVudDogYCR7c2RrSW5mby5uYW1lfS8ke3Nka0luZm8udmVyc2lvbn1gIH0pLAogIH0pOwp9CgovKioKICogUmV0dXJucyB0aGUgZW52ZWxvcGUgZW5kcG9pbnQgVVJMIHdpdGggYXV0aCBpbiB0aGUgcXVlcnkgc3RyaW5nLgogKgogKiBTZW5kaW5nIGF1dGggYXMgcGFydCBvZiB0aGUgcXVlcnkgc3RyaW5nIGFuZCBub3QgYXMgY3VzdG9tIEhUVFAgaGVhZGVycyBhdm9pZHMgQ09SUyBwcmVmbGlnaHQgcmVxdWVzdHMuCiAqLwpmdW5jdGlvbiBnZXRFbnZlbG9wZUVuZHBvaW50V2l0aFVybEVuY29kZWRBdXRoKAogIGRzbiwKICAvLyBUT0RPICh2OCk6IFJlbW92ZSBgdHVubmVsT3JPcHRpb25zYCBpbiBmYXZvciBvZiBgb3B0aW9uc2AsIGFuZCB1c2UgdGhlIHN1YnN0aXR1dGUgY29kZSBiZWxvdwogIC8vIG9wdGlvbnM6IENsaWVudE9wdGlvbnMgPSB7fSBhcyBDbGllbnRPcHRpb25zLAogIHR1bm5lbE9yT3B0aW9ucyA9IHt9ICwKKSB7CiAgLy8gVE9ETyAodjgpOiBVc2UgdGhpcyBjb2RlIGluc3RlYWQKICAvLyBjb25zdCB7IHR1bm5lbCwgX21ldGFkYXRhID0ge30gfSA9IG9wdGlvbnM7CiAgLy8gcmV0dXJuIHR1bm5lbCA/IHR1bm5lbCA6IGAke19nZXRJbmdlc3RFbmRwb2ludChkc24pfT8ke19lbmNvZGVkQXV0aChkc24sIF9tZXRhZGF0YS5zZGspfWA7CgogIGNvbnN0IHR1bm5lbCA9IHR5cGVvZiB0dW5uZWxPck9wdGlvbnMgPT09ICdzdHJpbmcnID8gdHVubmVsT3JPcHRpb25zIDogdHVubmVsT3JPcHRpb25zLnR1bm5lbDsKICBjb25zdCBzZGtJbmZvID0KICAgIHR5cGVvZiB0dW5uZWxPck9wdGlvbnMgPT09ICdzdHJpbmcnIHx8ICF0dW5uZWxPck9wdGlvbnMuX21ldGFkYXRhID8gdW5kZWZpbmVkIDogdHVubmVsT3JPcHRpb25zLl9tZXRhZGF0YS5zZGs7CgogIHJldHVybiB0dW5uZWwgPyB0dW5uZWwgOiBgJHtfZ2V0SW5nZXN0RW5kcG9pbnQoZHNuKX0/JHtfZW5jb2RlZEF1dGgoZHNuLCBzZGtJbmZvKX1gOwp9Cgpjb25zdCBERUZBVUxUX1RSQU5TUE9SVF9CVUZGRVJfU0laRSA9IDMwOwoKLyoqCiAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYSBTZW50cnkgYFRyYW5zcG9ydGAKICoKICogQHBhcmFtIG9wdGlvbnMKICogQHBhcmFtIG1ha2VSZXF1ZXN0CiAqLwpmdW5jdGlvbiBjcmVhdGVUcmFuc3BvcnQoCiAgb3B0aW9ucywKICBtYWtlUmVxdWVzdCwKICBidWZmZXIgPSBtYWtlUHJvbWlzZUJ1ZmZlcigKICAgIG9wdGlvbnMuYnVmZmVyU2l6ZSB8fCBERUZBVUxUX1RSQU5TUE9SVF9CVUZGRVJfU0laRSwKICApLAopIHsKICBsZXQgcmF0ZUxpbWl0cyA9IHt9OwogIGNvbnN0IGZsdXNoID0gKHRpbWVvdXQpID0+IGJ1ZmZlci5kcmFpbih0aW1lb3V0KTsKCiAgZnVuY3Rpb24gc2VuZChlbnZlbG9wZSkgewogICAgY29uc3QgZmlsdGVyZWRFbnZlbG9wZUl0ZW1zID0gW107CgogICAgLy8gRHJvcCByYXRlIGxpbWl0ZWQgaXRlbXMgZnJvbSBlbnZlbG9wZQogICAgZm9yRWFjaEVudmVsb3BlSXRlbShlbnZlbG9wZSwgKGl0ZW0sIHR5cGUpID0+IHsKICAgICAgY29uc3QgZGF0YUNhdGVnb3J5ID0gZW52ZWxvcGVJdGVtVHlwZVRvRGF0YUNhdGVnb3J5KHR5cGUpOwogICAgICBpZiAoaXNSYXRlTGltaXRlZChyYXRlTGltaXRzLCBkYXRhQ2F0ZWdvcnkpKSB7CiAgICAgICAgY29uc3QgZXZlbnQgPSBnZXRFdmVudEZvckVudmVsb3BlSXRlbShpdGVtLCB0eXBlKTsKICAgICAgICBvcHRpb25zLnJlY29yZERyb3BwZWRFdmVudCgncmF0ZWxpbWl0X2JhY2tvZmYnLCBkYXRhQ2F0ZWdvcnksIGV2ZW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaWx0ZXJlZEVudmVsb3BlSXRlbXMucHVzaChpdGVtKTsKICAgICAgfQogICAgfSk7CgogICAgLy8gU2tpcCBzZW5kaW5nIGlmIGVudmVsb3BlIGlzIGVtcHR5IGFmdGVyIGZpbHRlcmluZyBvdXQgcmF0ZSBsaW1pdGVkIGV2ZW50cwogICAgaWYgKGZpbHRlcmVkRW52ZWxvcGVJdGVtcy5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIHJlc29sdmVkU3luY1Byb21pc2UoKTsKICAgIH0KCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQogICAgY29uc3QgZmlsdGVyZWRFbnZlbG9wZSA9IGNyZWF0ZUVudmVsb3BlKGVudmVsb3BlWzBdLCBmaWx0ZXJlZEVudmVsb3BlSXRlbXMgKTsKCiAgICAvLyBDcmVhdGVzIGNsaWVudCByZXBvcnQgZm9yIGVhY2ggaXRlbSBpbiBhbiBlbnZlbG9wZQogICAgY29uc3QgcmVjb3JkRW52ZWxvcGVMb3NzID0gKHJlYXNvbikgPT4gewogICAgICBmb3JFYWNoRW52ZWxvcGVJdGVtKGZpbHRlcmVkRW52ZWxvcGUsIChpdGVtLCB0eXBlKSA9PiB7CiAgICAgICAgY29uc3QgZXZlbnQgPSBnZXRFdmVudEZvckVudmVsb3BlSXRlbShpdGVtLCB0eXBlKTsKICAgICAgICBvcHRpb25zLnJlY29yZERyb3BwZWRFdmVudChyZWFzb24sIGVudmVsb3BlSXRlbVR5cGVUb0RhdGFDYXRlZ29yeSh0eXBlKSwgZXZlbnQpOwogICAgICB9KTsKICAgIH07CgogICAgY29uc3QgcmVxdWVzdFRhc2sgPSAoKSA9PgogICAgICBtYWtlUmVxdWVzdCh7IGJvZHk6IHNlcmlhbGl6ZUVudmVsb3BlKGZpbHRlcmVkRW52ZWxvcGUsIG9wdGlvbnMudGV4dEVuY29kZXIpIH0pLnRoZW4oCiAgICAgICAgcmVzcG9uc2UgPT4gewogICAgICAgICAgLy8gV2UgZG9uJ3Qgd2FudCB0byB0aHJvdyBvbiBOT0sgcmVzcG9uc2VzLCBidXQgd2Ugd2FudCB0byBhdCBsZWFzdCBsb2cgdGhlbQogICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgIT09IHVuZGVmaW5lZCAmJiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA8IDIwMCB8fCByZXNwb25zZS5zdGF0dXNDb2RlID49IDMwMCkpIHsKICAgICAgICAgICAgREVCVUdfQlVJTEQgJiYgbG9nZ2VyLndhcm4oYFNlbnRyeSByZXNwb25kZWQgd2l0aCBzdGF0dXMgY29kZSAke3Jlc3BvbnNlLnN0YXR1c0NvZGV9IHRvIHNlbnQgZXZlbnQuYCk7CiAgICAgICAgICB9CgogICAgICAgICAgcmF0ZUxpbWl0cyA9IHVwZGF0ZVJhdGVMaW1pdHMocmF0ZUxpbWl0cywgcmVzcG9uc2UpOwogICAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgICAgIH0sCiAgICAgICAgZXJyb3IgPT4gewogICAgICAgICAgcmVjb3JkRW52ZWxvcGVMb3NzKCduZXR3b3JrX2Vycm9yJyk7CiAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICB9LAogICAgICApOwoKICAgIHJldHVybiBidWZmZXIuYWRkKHJlcXVlc3RUYXNrKS50aGVuKAogICAgICByZXN1bHQgPT4gcmVzdWx0LAogICAgICBlcnJvciA9PiB7CiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgU2VudHJ5RXJyb3IpIHsKICAgICAgICAgIERFQlVHX0JVSUxEICYmIGxvZ2dlci5lcnJvcignU2tpcHBlZCBzZW5kaW5nIGV2ZW50IGJlY2F1c2UgYnVmZmVyIGlzIGZ1bGwuJyk7CiAgICAgICAgICByZWNvcmRFbnZlbG9wZUxvc3MoJ3F1ZXVlX292ZXJmbG93Jyk7CiAgICAgICAgICByZXR1cm4gcmVzb2x2ZWRTeW5jUHJvbWlzZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICB9CiAgICAgIH0sCiAgICApOwogIH0KCiAgLy8gV2UgdXNlIHRoaXMgdG8gaWRlbnRpZmlmeSBpZiB0aGUgdHJhbnNwb3J0IGlzIHRoZSBiYXNlIHRyYW5zcG9ydAogIC8vIFRPRE8gKHY4KTogUmVtb3ZlIHRoaXMgYWdhaW4gYXMgd2UnbGwgbm8gbG9uZ2VyIG5lZWQgaXQKICBzZW5kLl9fc2VudHJ5X19iYXNlVHJhbnNwb3J0X18gPSB0cnVlOwoKICByZXR1cm4gewogICAgc2VuZCwKICAgIGZsdXNoLAogIH07Cn0KCmZ1bmN0aW9uIGdldEV2ZW50Rm9yRW52ZWxvcGVJdGVtKGl0ZW0sIHR5cGUpIHsKICBpZiAodHlwZSAhPT0gJ2V2ZW50JyAmJiB0eXBlICE9PSAndHJhbnNhY3Rpb24nKSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoaXRlbSkgPyAoaXRlbSApWzFdIDogdW5kZWZpbmVkOwp9CgovKiogbm9ybWFsaXplcyBXaW5kb3dzIHBhdGhzICovCmZ1bmN0aW9uIG5vcm1hbGl6ZVdpbmRvd3NQYXRoKHBhdGgpIHsKICByZXR1cm4gcGF0aAogICAgLnJlcGxhY2UoL15bQS1aXTovLCAnJykgLy8gcmVtb3ZlIFdpbmRvd3Mtc3R5bGUgcHJlZml4CiAgICAucmVwbGFjZSgvXFwvZywgJy8nKTsgLy8gcmVwbGFjZSBhbGwgYFxgIGluc3RhbmNlcyB3aXRoIGAvYAp9CgovKiogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgZ2V0cyB0aGUgbW9kdWxlIG5hbWUgZnJvbSBhIGZpbGVuYW1lICovCmZ1bmN0aW9uIGNyZWF0ZUdldE1vZHVsZUZyb21GaWxlbmFtZSgKICBiYXNlUGF0aCA9IHByb2Nlc3MuYXJndlsxXSA/IGRpcm5hbWUocHJvY2Vzcy5hcmd2WzFdKSA6IHByb2Nlc3MuY3dkKCksCiAgaXNXaW5kb3dzID0gc2VwID09PSAnXFwnLAopIHsKICBjb25zdCBub3JtYWxpemVkQmFzZSA9IGlzV2luZG93cyA/IG5vcm1hbGl6ZVdpbmRvd3NQYXRoKGJhc2VQYXRoKSA6IGJhc2VQYXRoOwoKICByZXR1cm4gKGZpbGVuYW1lKSA9PiB7CiAgICBpZiAoIWZpbGVuYW1lKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBub3JtYWxpemVkRmlsZW5hbWUgPSBpc1dpbmRvd3MgPyBub3JtYWxpemVXaW5kb3dzUGF0aChmaWxlbmFtZSkgOiBmaWxlbmFtZTsKCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0CiAgICBsZXQgeyBkaXIsIGJhc2U6IGZpbGUsIGV4dCB9ID0gcG9zaXgucGFyc2Uobm9ybWFsaXplZEZpbGVuYW1lKTsKCiAgICBpZiAoZXh0ID09PSAnLmpzJyB8fCBleHQgPT09ICcubWpzJyB8fCBleHQgPT09ICcuY2pzJykgewogICAgICBmaWxlID0gZmlsZS5zbGljZSgwLCBleHQubGVuZ3RoICogLTEpOwogICAgfQoKICAgIGlmICghZGlyKSB7CiAgICAgIC8vIE5vIGRpcm5hbWUgd2hhdHNvZXZlcgogICAgICBkaXIgPSAnLic7CiAgICB9CgogICAgY29uc3QgbiA9IGRpci5sYXN0SW5kZXhPZignL25vZGVfbW9kdWxlcycpOwogICAgaWYgKG4gPiAtMSkgewogICAgICByZXR1cm4gYCR7ZGlyLnNsaWNlKG4gKyAxNCkucmVwbGFjZSgvXC8vZywgJy4nKX06JHtmaWxlfWA7CiAgICB9CgogICAgLy8gTGV0J3Mgc2VlIGlmIGl0J3MgYSBwYXJ0IG9mIHRoZSBtYWluIG1vZHVsZQogICAgLy8gVG8gYmUgYSBwYXJ0IG9mIG1haW4gbW9kdWxlLCBpdCBoYXMgdG8gc2hhcmUgdGhlIHNhbWUgYmFzZQogICAgaWYgKGRpci5zdGFydHNXaXRoKG5vcm1hbGl6ZWRCYXNlKSkgewogICAgICBsZXQgbW9kdWxlTmFtZSA9IGRpci5zbGljZShub3JtYWxpemVkQmFzZS5sZW5ndGggKyAxKS5yZXBsYWNlKC9cLy9nLCAnLicpOwoKICAgICAgaWYgKG1vZHVsZU5hbWUpIHsKICAgICAgICBtb2R1bGVOYW1lICs9ICc6JzsKICAgICAgfQogICAgICBtb2R1bGVOYW1lICs9IGZpbGU7CgogICAgICByZXR1cm4gbW9kdWxlTmFtZTsKICAgIH0KCiAgICByZXR1cm4gZmlsZTsKICB9Owp9CgpmdW5jdGlvbiBfbnVsbGlzaENvYWxlc2NlJDIobGhzLCByaHNGbikgeyBpZiAobGhzICE9IG51bGwpIHsgcmV0dXJuIGxoczsgfSBlbHNlIHsgcmV0dXJuIHJoc0ZuKCk7IH0gfS8qKgogKiBUaGlzIGNvZGUgd2FzIG9yaWdpbmFsbHkgZm9ya2VkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL1Rvb1RhbGxOYXRlL3Byb3h5LWFnZW50cy90cmVlL2IxMzMyOTVmZDE2ZjY0NzU1NzhiNmIxNWJkOWI0ZTMzZWNiMGQwYjcKICogV2l0aCB0aGUgZm9sbG93aW5nIGxpY2VuY2U6CiAqCiAqIChUaGUgTUlUIExpY2Vuc2UpCiAqCiAqIENvcHlyaWdodCAoYykgMjAxMyBOYXRoYW4gUmFqbGljaCA8bmF0aGFuQHRvb3RhbGxuYXRlLm5ldD4qCiAqCiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZwogKiBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKICogJ1NvZnR3YXJlJyksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwogKiB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCiAqIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0bwogKiBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8KICogdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOioKICoKICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUKICogaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuKgogKgogKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgJ0FTIElTJywgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwKICogRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCiAqIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4KICogSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkKICogQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwKICogVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUKICogU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCiAqLwoKY29uc3QgSU5URVJOQUwgPSBTeW1ib2woJ0FnZW50QmFzZUludGVybmFsU3RhdGUnKTsKCmNsYXNzIEFnZW50IGV4dGVuZHMgaHR0cC5BZ2VudCB7CgogIC8vIFNldCBieSBgaHR0cC5BZ2VudGAgLSBtaXNzaW5nIGZyb20gYEB0eXBlcy9ub2RlYAoKICBjb25zdHJ1Y3RvcihvcHRzKSB7CiAgICBzdXBlcihvcHRzKTsKICAgIHRoaXNbSU5URVJOQUxdID0ge307CiAgfQoKICAvKioKICAgKiBEZXRlcm1pbmUgd2hldGhlciB0aGlzIGlzIGFuIGBodHRwYCBvciBgaHR0cHNgIHJlcXVlc3QuCiAgICovCiAgaXNTZWN1cmVFbmRwb2ludChvcHRpb25zKSB7CiAgICBpZiAob3B0aW9ucykgewogICAgICAvLyBGaXJzdCBjaGVjayB0aGUgYHNlY3VyZUVuZHBvaW50YCBwcm9wZXJ0eSBleHBsaWNpdGx5LCBzaW5jZSB0aGlzCiAgICAgIC8vIG1lYW5zIHRoYXQgYSBwYXJlbnQgYEFnZW50YCBpcyAicGFzc2luZyB0aHJvdWdoIiB0byB0aGlzIGluc3RhbmNlLgogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSwgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzCiAgICAgIGlmICh0eXBlb2YgKG9wdGlvbnMgKS5zZWN1cmVFbmRwb2ludCA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMuc2VjdXJlRW5kcG9pbnQ7CiAgICAgIH0KCiAgICAgIC8vIElmIG5vIGV4cGxpY2l0IGBzZWN1cmVgIGVuZHBvaW50LCBjaGVjayBpZiBgcHJvdG9jb2xgIHByb3BlcnR5IGlzCiAgICAgIC8vIHNldC4gVGhpcyB3aWxsIHVzdWFsbHkgYmUgdGhlIGNhc2Ugc2luY2UgdXNpbmcgYSBmdWxsIHN0cmluZyBVUkwKICAgICAgLy8gb3IgYFVSTGAgaW5zdGFuY2Ugc2hvdWxkIGJlIHRoZSBtb3N0IGNvbW1vbiB1c2FnZS4KICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnByb3RvY29sID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiBvcHRpb25zLnByb3RvY29sID09PSAnaHR0cHM6JzsKICAgICAgfQogICAgfQoKICAgIC8vIEZpbmFsbHksIGlmIG5vIGBwcm90b2NvbGAgcHJvcGVydHkgd2FzIHNldCwgdGhlbiBmYWxsIGJhY2sgdG8KICAgIC8vIGNoZWNraW5nIHRoZSBzdGFjayB0cmFjZSBvZiB0aGUgY3VycmVudCBjYWxsIHN0YWNrLCBhbmQgdHJ5IHRvCiAgICAvLyBkZXRlY3QgdGhlICJodHRwcyIgbW9kdWxlLgogICAgY29uc3QgeyBzdGFjayB9ID0gbmV3IEVycm9yKCk7CiAgICBpZiAodHlwZW9mIHN0YWNrICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHN0YWNrLnNwbGl0KCdcbicpLnNvbWUobCA9PiBsLmluZGV4T2YoJyhodHRwcy5qczonKSAhPT0gLTEgfHwgbC5pbmRleE9mKCdub2RlOmh0dHBzOicpICE9PSAtMSk7CiAgfQoKICBjcmVhdGVTb2NrZXQocmVxLCBvcHRpb25zLCBjYikgewogICAgY29uc3QgY29ubmVjdE9wdHMgPSB7CiAgICAgIC4uLm9wdGlvbnMsCiAgICAgIHNlY3VyZUVuZHBvaW50OiB0aGlzLmlzU2VjdXJlRW5kcG9pbnQob3B0aW9ucyksCiAgICB9OwogICAgUHJvbWlzZS5yZXNvbHZlKCkKICAgICAgLnRoZW4oKCkgPT4gdGhpcy5jb25uZWN0KHJlcSwgY29ubmVjdE9wdHMpKQogICAgICAudGhlbihzb2NrZXQgPT4gewogICAgICAgIGlmIChzb2NrZXQgaW5zdGFuY2VvZiBodHRwLkFnZW50KSB7CiAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIGBhZGRSZXF1ZXN0KClgIGlzbid0IGRlZmluZWQgaW4gYEB0eXBlcy9ub2RlYAogICAgICAgICAgcmV0dXJuIHNvY2tldC5hZGRSZXF1ZXN0KHJlcSwgY29ubmVjdE9wdHMpOwogICAgICAgIH0KICAgICAgICB0aGlzW0lOVEVSTkFMXS5jdXJyZW50U29ja2V0ID0gc29ja2V0OwogICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgYGNyZWF0ZVNvY2tldCgpYCBpc24ndCBkZWZpbmVkIGluIGBAdHlwZXMvbm9kZWAKICAgICAgICBzdXBlci5jcmVhdGVTb2NrZXQocmVxLCBvcHRpb25zLCBjYik7CiAgICAgIH0sIGNiKTsKICB9CgogIGNyZWF0ZUNvbm5lY3Rpb24oKSB7CiAgICBjb25zdCBzb2NrZXQgPSB0aGlzW0lOVEVSTkFMXS5jdXJyZW50U29ja2V0OwogICAgdGhpc1tJTlRFUk5BTF0uY3VycmVudFNvY2tldCA9IHVuZGVmaW5lZDsKICAgIGlmICghc29ja2V0KSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc29ja2V0IHdhcyByZXR1cm5lZCBpbiB0aGUgYGNvbm5lY3QoKWAgZnVuY3Rpb24nKTsKICAgIH0KICAgIHJldHVybiBzb2NrZXQ7CiAgfQoKICBnZXQgZGVmYXVsdFBvcnQoKSB7CiAgICByZXR1cm4gX251bGxpc2hDb2FsZXNjZSQyKHRoaXNbSU5URVJOQUxdLmRlZmF1bHRQb3J0LCAoKSA9PiAoICh0aGlzLnByb3RvY29sID09PSAnaHR0cHM6JyA/IDQ0MyA6IDgwKSkpOwogIH0KCiAgc2V0IGRlZmF1bHRQb3J0KHYpIHsKICAgIGlmICh0aGlzW0lOVEVSTkFMXSkgewogICAgICB0aGlzW0lOVEVSTkFMXS5kZWZhdWx0UG9ydCA9IHY7CiAgICB9CiAgfQoKICBnZXQgcHJvdG9jb2woKSB7CiAgICByZXR1cm4gX251bGxpc2hDb2FsZXNjZSQyKHRoaXNbSU5URVJOQUxdLnByb3RvY29sLCAoKSA9PiAoICh0aGlzLmlzU2VjdXJlRW5kcG9pbnQoKSA/ICdodHRwczonIDogJ2h0dHA6JykpKTsKICB9CgogIHNldCBwcm90b2NvbCh2KSB7CiAgICBpZiAodGhpc1tJTlRFUk5BTF0pIHsKICAgICAgdGhpc1tJTlRFUk5BTF0ucHJvdG9jb2wgPSB2OwogICAgfQogIH0KfQoKZnVuY3Rpb24gZGVidWckMSguLi5hcmdzKSB7CiAgbG9nZ2VyLmxvZygnW2h0dHBzLXByb3h5LWFnZW50OnBhcnNlLXByb3h5LXJlc3BvbnNlXScsIC4uLmFyZ3MpOwp9CgpmdW5jdGlvbiBwYXJzZVByb3h5UmVzcG9uc2Uoc29ja2V0KSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIC8vIHdlIG5lZWQgdG8gYnVmZmVyIGFueSBIVFRQIHRyYWZmaWMgdGhhdCBoYXBwZW5zIHdpdGggdGhlIHByb3h5IGJlZm9yZSB3ZSBnZXQKICAgIC8vIHRoZSBDT05ORUNUIHJlc3BvbnNlLCBzbyB0aGF0IGlmIHRoZSByZXNwb25zZSBpcyBhbnl0aGluZyBvdGhlciB0aGFuIGFuICIyMDAiCiAgICAvLyByZXNwb25zZSBjb2RlLCB0aGVuIHdlIGNhbiByZS1wbGF5IHRoZSAiZGF0YSIgZXZlbnRzIG9uIHRoZSBzb2NrZXQgb25jZSB0aGUKICAgIC8vIEhUVFAgcGFyc2VyIGlzIGhvb2tlZCB1cC4uLgogICAgbGV0IGJ1ZmZlcnNMZW5ndGggPSAwOwogICAgY29uc3QgYnVmZmVycyA9IFtdOwoKICAgIGZ1bmN0aW9uIHJlYWQoKSB7CiAgICAgIGNvbnN0IGIgPSBzb2NrZXQucmVhZCgpOwogICAgICBpZiAoYikgb25kYXRhKGIpOwogICAgICBlbHNlIHNvY2tldC5vbmNlKCdyZWFkYWJsZScsIHJlYWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7CiAgICAgIHNvY2tldC5yZW1vdmVMaXN0ZW5lcignZW5kJywgb25lbmQpOwogICAgICBzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25lcnJvcik7CiAgICAgIHNvY2tldC5yZW1vdmVMaXN0ZW5lcigncmVhZGFibGUnLCByZWFkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbmVuZCgpIHsKICAgICAgY2xlYW51cCgpOwogICAgICBkZWJ1ZyQxKCdvbmVuZCcpOwogICAgICByZWplY3QobmV3IEVycm9yKCdQcm94eSBjb25uZWN0aW9uIGVuZGVkIGJlZm9yZSByZWNlaXZpbmcgQ09OTkVDVCByZXNwb25zZScpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbmVycm9yKGVycikgewogICAgICBjbGVhbnVwKCk7CiAgICAgIGRlYnVnJDEoJ29uZXJyb3IgJW8nLCBlcnIpOwogICAgICByZWplY3QoZXJyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbmRhdGEoYikgewogICAgICBidWZmZXJzLnB1c2goYik7CiAgICAgIGJ1ZmZlcnNMZW5ndGggKz0gYi5sZW5ndGg7CgogICAgICBjb25zdCBidWZmZXJlZCA9IEJ1ZmZlci5jb25jYXQoYnVmZmVycywgYnVmZmVyc0xlbmd0aCk7CiAgICAgIGNvbnN0IGVuZE9mSGVhZGVycyA9IGJ1ZmZlcmVkLmluZGV4T2YoJ1xyXG5cclxuJyk7CgogICAgICBpZiAoZW5kT2ZIZWFkZXJzID09PSAtMSkgewogICAgICAgIC8vIGtlZXAgYnVmZmVyaW5nCiAgICAgICAgZGVidWckMSgnaGF2ZSBub3QgcmVjZWl2ZWQgZW5kIG9mIEhUVFAgaGVhZGVycyB5ZXQuLi4nKTsKICAgICAgICByZWFkKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBoZWFkZXJQYXJ0cyA9IGJ1ZmZlcmVkLnNsaWNlKDAsIGVuZE9mSGVhZGVycykudG9TdHJpbmcoJ2FzY2lpJykuc3BsaXQoJ1xyXG4nKTsKICAgICAgY29uc3QgZmlyc3RMaW5lID0gaGVhZGVyUGFydHMuc2hpZnQoKTsKICAgICAgaWYgKCFmaXJzdExpbmUpIHsKICAgICAgICBzb2NrZXQuZGVzdHJveSgpOwogICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdObyBoZWFkZXIgcmVjZWl2ZWQgZnJvbSBwcm94eSBDT05ORUNUIHJlc3BvbnNlJykpOwogICAgICB9CiAgICAgIGNvbnN0IGZpcnN0TGluZVBhcnRzID0gZmlyc3RMaW5lLnNwbGl0KCcgJyk7CiAgICAgIGNvbnN0IHN0YXR1c0NvZGUgPSArZmlyc3RMaW5lUGFydHNbMV07CiAgICAgIGNvbnN0IHN0YXR1c1RleHQgPSBmaXJzdExpbmVQYXJ0cy5zbGljZSgyKS5qb2luKCcgJyk7CiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTsKICAgICAgZm9yIChjb25zdCBoZWFkZXIgb2YgaGVhZGVyUGFydHMpIHsKICAgICAgICBpZiAoIWhlYWRlcikgY29udGludWU7CiAgICAgICAgY29uc3QgZmlyc3RDb2xvbiA9IGhlYWRlci5pbmRleE9mKCc6Jyk7CiAgICAgICAgaWYgKGZpcnN0Q29sb24gPT09IC0xKSB7CiAgICAgICAgICBzb2NrZXQuZGVzdHJveSgpOwogICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoYEludmFsaWQgaGVhZGVyIGZyb20gcHJveHkgQ09OTkVDVCByZXNwb25zZTogIiR7aGVhZGVyfSJgKSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGtleSA9IGhlYWRlci5zbGljZSgwLCBmaXJzdENvbG9uKS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGNvbnN0IHZhbHVlID0gaGVhZGVyLnNsaWNlKGZpcnN0Q29sb24gKyAxKS50cmltU3RhcnQoKTsKICAgICAgICBjb25zdCBjdXJyZW50ID0gaGVhZGVyc1trZXldOwogICAgICAgIGlmICh0eXBlb2YgY3VycmVudCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIGhlYWRlcnNba2V5XSA9IFtjdXJyZW50LCB2YWx1ZV07CiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGN1cnJlbnQpKSB7CiAgICAgICAgICBjdXJyZW50LnB1c2godmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoZWFkZXJzW2tleV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZGVidWckMSgnZ290IHByb3h5IHNlcnZlciByZXNwb25zZTogJW8gJW8nLCBmaXJzdExpbmUsIGhlYWRlcnMpOwogICAgICBjbGVhbnVwKCk7CiAgICAgIHJlc29sdmUoewogICAgICAgIGNvbm5lY3Q6IHsKICAgICAgICAgIHN0YXR1c0NvZGUsCiAgICAgICAgICBzdGF0dXNUZXh0LAogICAgICAgICAgaGVhZGVycywKICAgICAgICB9LAogICAgICAgIGJ1ZmZlcmVkLAogICAgICB9KTsKICAgIH0KCiAgICBzb2NrZXQub24oJ2Vycm9yJywgb25lcnJvcik7CiAgICBzb2NrZXQub24oJ2VuZCcsIG9uZW5kKTsKCiAgICByZWFkKCk7CiAgfSk7Cn0KCmZ1bmN0aW9uIF9udWxsaXNoQ29hbGVzY2UkMShsaHMsIHJoc0ZuKSB7IGlmIChsaHMgIT0gbnVsbCkgeyByZXR1cm4gbGhzOyB9IGVsc2UgeyByZXR1cm4gcmhzRm4oKTsgfSB9IGZ1bmN0aW9uIF9vcHRpb25hbENoYWluJDEob3BzKSB7IGxldCBsYXN0QWNjZXNzTEhTID0gdW5kZWZpbmVkOyBsZXQgdmFsdWUgPSBvcHNbMF07IGxldCBpID0gMTsgd2hpbGUgKGkgPCBvcHMubGVuZ3RoKSB7IGNvbnN0IG9wID0gb3BzW2ldOyBjb25zdCBmbiA9IG9wc1tpICsgMV07IGkgKz0gMjsgaWYgKChvcCA9PT0gJ29wdGlvbmFsQWNjZXNzJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpICYmIHZhbHVlID09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBpZiAob3AgPT09ICdhY2Nlc3MnIHx8IG9wID09PSAnb3B0aW9uYWxBY2Nlc3MnKSB7IGxhc3RBY2Nlc3NMSFMgPSB2YWx1ZTsgdmFsdWUgPSBmbih2YWx1ZSk7IH0gZWxzZSBpZiAob3AgPT09ICdjYWxsJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpIHsgdmFsdWUgPSBmbigoLi4uYXJncykgPT4gdmFsdWUuY2FsbChsYXN0QWNjZXNzTEhTLCAuLi5hcmdzKSk7IGxhc3RBY2Nlc3NMSFMgPSB1bmRlZmluZWQ7IH0gfSByZXR1cm4gdmFsdWU7IH0KCmZ1bmN0aW9uIGRlYnVnKC4uLmFyZ3MpIHsKICBsb2dnZXIubG9nKCdbaHR0cHMtcHJveHktYWdlbnRdJywgLi4uYXJncyk7Cn0KCi8qKgogKiBUaGUgYEh0dHBzUHJveHlBZ2VudGAgaW1wbGVtZW50cyBhbiBIVFRQIEFnZW50IHN1YmNsYXNzIHRoYXQgY29ubmVjdHMgdG8KICogdGhlIHNwZWNpZmllZCAiSFRUUChzKSBwcm94eSBzZXJ2ZXIiIGluIG9yZGVyIHRvIHByb3h5IEhUVFBTIHJlcXVlc3RzLgogKgogKiBPdXRnb2luZyBIVFRQIHJlcXVlc3RzIGFyZSBmaXJzdCB0dW5uZWxlZCB0aHJvdWdoIHRoZSBwcm94eSBzZXJ2ZXIgdXNpbmcgdGhlCiAqIGBDT05ORUNUYCBIVFRQIHJlcXVlc3QgbWV0aG9kIHRvIGVzdGFibGlzaCBhIGNvbm5lY3Rpb24gdG8gdGhlIHByb3h5IHNlcnZlciwKICogYW5kIHRoZW4gdGhlIHByb3h5IHNlcnZlciBjb25uZWN0cyB0byB0aGUgZGVzdGluYXRpb24gdGFyZ2V0IGFuZCBpc3N1ZXMgdGhlCiAqIEhUVFAgcmVxdWVzdCBmcm9tIHRoZSBwcm94eSBzZXJ2ZXIuCiAqCiAqIGBodHRwczpgIHJlcXVlc3RzIGhhdmUgdGhlaXIgc29ja2V0IGNvbm5lY3Rpb24gdXBncmFkZWQgdG8gVExTIG9uY2UKICogdGhlIGNvbm5lY3Rpb24gdG8gdGhlIHByb3h5IHNlcnZlciBoYXMgYmVlbiBlc3RhYmxpc2hlZC4KICovCmNsYXNzIEh0dHBzUHJveHlBZ2VudCBleHRlbmRzIEFnZW50IHsKICBzdGF0aWMgX19pbml0U3RhdGljKCkge3RoaXMucHJvdG9jb2xzID0gWydodHRwJywgJ2h0dHBzJ107IH0KCiAgY29uc3RydWN0b3IocHJveHksIG9wdHMpIHsKICAgIHN1cGVyKG9wdHMpOwogICAgdGhpcy5vcHRpb25zID0ge307CiAgICB0aGlzLnByb3h5ID0gdHlwZW9mIHByb3h5ID09PSAnc3RyaW5nJyA/IG5ldyBVUkwocHJveHkpIDogcHJveHk7CiAgICB0aGlzLnByb3h5SGVhZGVycyA9IF9udWxsaXNoQ29hbGVzY2UkMShfb3B0aW9uYWxDaGFpbiQxKFtvcHRzLCAnb3B0aW9uYWxBY2Nlc3MnLCBfMiA9PiBfMi5oZWFkZXJzXSksICgpID0+ICgge30pKTsKICAgIGRlYnVnKCdDcmVhdGluZyBuZXcgSHR0cHNQcm94eUFnZW50IGluc3RhbmNlOiAlbycsIHRoaXMucHJveHkuaHJlZik7CgogICAgLy8gVHJpbSBvZmYgdGhlIGJyYWNrZXRzIGZyb20gSVB2NiBhZGRyZXNzZXMKICAgIGNvbnN0IGhvc3QgPSAodGhpcy5wcm94eS5ob3N0bmFtZSB8fCB0aGlzLnByb3h5Lmhvc3QpLnJlcGxhY2UoL15cW3xcXSQvZywgJycpOwogICAgY29uc3QgcG9ydCA9IHRoaXMucHJveHkucG9ydCA/IHBhcnNlSW50KHRoaXMucHJveHkucG9ydCwgMTApIDogdGhpcy5wcm94eS5wcm90b2NvbCA9PT0gJ2h0dHBzOicgPyA0NDMgOiA4MDsKICAgIHRoaXMuY29ubmVjdE9wdHMgPSB7CiAgICAgIC8vIEF0dGVtcHQgdG8gbmVnb3RpYXRlIGh0dHAvMS4xIGZvciBwcm94eSBzZXJ2ZXJzIHRoYXQgc3VwcG9ydCBodHRwLzIKICAgICAgQUxQTlByb3RvY29sczogWydodHRwLzEuMSddLAogICAgICAuLi4ob3B0cyA/IG9taXQob3B0cywgJ2hlYWRlcnMnKSA6IG51bGwpLAogICAgICBob3N0LAogICAgICBwb3J0LAogICAgfTsKICB9CgogIC8qKgogICAqIENhbGxlZCB3aGVuIHRoZSBub2RlLWNvcmUgSFRUUCBjbGllbnQgbGlicmFyeSBpcyBjcmVhdGluZyBhCiAgICogbmV3IEhUVFAgcmVxdWVzdC4KICAgKi8KICBhc3luYyBjb25uZWN0KHJlcSwgb3B0cykgewogICAgY29uc3QgeyBwcm94eSB9ID0gdGhpczsKCiAgICBpZiAoIW9wdHMuaG9zdCkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdObyAiaG9zdCIgcHJvdmlkZWQnKTsKICAgIH0KCiAgICAvLyBDcmVhdGUgYSBzb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgcHJveHkgc2VydmVyLgogICAgbGV0IHNvY2tldDsKICAgIGlmIChwcm94eS5wcm90b2NvbCA9PT0gJ2h0dHBzOicpIHsKICAgICAgZGVidWcoJ0NyZWF0aW5nIGB0bHMuU29ja2V0YDogJW8nLCB0aGlzLmNvbm5lY3RPcHRzKTsKICAgICAgY29uc3Qgc2VydmVybmFtZSA9IHRoaXMuY29ubmVjdE9wdHMuc2VydmVybmFtZSB8fCB0aGlzLmNvbm5lY3RPcHRzLmhvc3Q7CiAgICAgIHNvY2tldCA9IHRscy5jb25uZWN0KHsKICAgICAgICAuLi50aGlzLmNvbm5lY3RPcHRzLAogICAgICAgIHNlcnZlcm5hbWU6IHNlcnZlcm5hbWUgJiYgbmV0LmlzSVAoc2VydmVybmFtZSkgPyB1bmRlZmluZWQgOiBzZXJ2ZXJuYW1lLAogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGRlYnVnKCdDcmVhdGluZyBgbmV0LlNvY2tldGA6ICVvJywgdGhpcy5jb25uZWN0T3B0cyk7CiAgICAgIHNvY2tldCA9IG5ldC5jb25uZWN0KHRoaXMuY29ubmVjdE9wdHMpOwogICAgfQoKICAgIGNvbnN0IGhlYWRlcnMgPQogICAgICB0eXBlb2YgdGhpcy5wcm94eUhlYWRlcnMgPT09ICdmdW5jdGlvbicgPyB0aGlzLnByb3h5SGVhZGVycygpIDogeyAuLi50aGlzLnByb3h5SGVhZGVycyB9OwogICAgY29uc3QgaG9zdCA9IG5ldC5pc0lQdjYob3B0cy5ob3N0KSA/IGBbJHtvcHRzLmhvc3R9XWAgOiBvcHRzLmhvc3Q7CiAgICBsZXQgcGF5bG9hZCA9IGBDT05ORUNUICR7aG9zdH06JHtvcHRzLnBvcnR9IEhUVFAvMS4xXHJcbmA7CgogICAgLy8gSW5qZWN0IHRoZSBgUHJveHktQXV0aG9yaXphdGlvbmAgaGVhZGVyIGlmIG5lY2Vzc2FyeS4KICAgIGlmIChwcm94eS51c2VybmFtZSB8fCBwcm94eS5wYXNzd29yZCkgewogICAgICBjb25zdCBhdXRoID0gYCR7ZGVjb2RlVVJJQ29tcG9uZW50KHByb3h5LnVzZXJuYW1lKX06JHtkZWNvZGVVUklDb21wb25lbnQocHJveHkucGFzc3dvcmQpfWA7CiAgICAgIGhlYWRlcnNbJ1Byb3h5LUF1dGhvcml6YXRpb24nXSA9IGBCYXNpYyAke0J1ZmZlci5mcm9tKGF1dGgpLnRvU3RyaW5nKCdiYXNlNjQnKX1gOwogICAgfQoKICAgIGhlYWRlcnMuSG9zdCA9IGAke2hvc3R9OiR7b3B0cy5wb3J0fWA7CgogICAgaWYgKCFoZWFkZXJzWydQcm94eS1Db25uZWN0aW9uJ10pIHsKICAgICAgaGVhZGVyc1snUHJveHktQ29ubmVjdGlvbiddID0gdGhpcy5rZWVwQWxpdmUgPyAnS2VlcC1BbGl2ZScgOiAnY2xvc2UnOwogICAgfQogICAgZm9yIChjb25zdCBuYW1lIG9mIE9iamVjdC5rZXlzKGhlYWRlcnMpKSB7CiAgICAgIHBheWxvYWQgKz0gYCR7bmFtZX06ICR7aGVhZGVyc1tuYW1lXX1cclxuYDsKICAgIH0KCiAgICBjb25zdCBwcm94eVJlc3BvbnNlUHJvbWlzZSA9IHBhcnNlUHJveHlSZXNwb25zZShzb2NrZXQpOwoKICAgIHNvY2tldC53cml0ZShgJHtwYXlsb2FkfVxyXG5gKTsKCiAgICBjb25zdCB7IGNvbm5lY3QsIGJ1ZmZlcmVkIH0gPSBhd2FpdCBwcm94eVJlc3BvbnNlUHJvbWlzZTsKICAgIHJlcS5lbWl0KCdwcm94eUNvbm5lY3QnLCBjb25uZWN0KTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnQKICAgIC8vIEB0cy1pZ25vcmUgTm90IEV2ZW50RW1pdHRlciBpbiBOb2RlIHR5cGVzCiAgICB0aGlzLmVtaXQoJ3Byb3h5Q29ubmVjdCcsIGNvbm5lY3QsIHJlcSk7CgogICAgaWYgKGNvbm5lY3Quc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgIHJlcS5vbmNlKCdzb2NrZXQnLCByZXN1bWUpOwoKICAgICAgaWYgKG9wdHMuc2VjdXJlRW5kcG9pbnQpIHsKICAgICAgICAvLyBUaGUgcHJveHkgaXMgY29ubmVjdGluZyB0byBhIFRMUyBzZXJ2ZXIsIHNvIHVwZ3JhZGUKICAgICAgICAvLyB0aGlzIHNvY2tldCBjb25uZWN0aW9uIHRvIGEgVExTIGNvbm5lY3Rpb24uCiAgICAgICAgZGVidWcoJ1VwZ3JhZGluZyBzb2NrZXQgY29ubmVjdGlvbiB0byBUTFMnKTsKICAgICAgICBjb25zdCBzZXJ2ZXJuYW1lID0gb3B0cy5zZXJ2ZXJuYW1lIHx8IG9wdHMuaG9zdDsKICAgICAgICByZXR1cm4gdGxzLmNvbm5lY3QoewogICAgICAgICAgLi4ub21pdChvcHRzLCAnaG9zdCcsICdwYXRoJywgJ3BvcnQnKSwKICAgICAgICAgIHNvY2tldCwKICAgICAgICAgIHNlcnZlcm5hbWU6IG5ldC5pc0lQKHNlcnZlcm5hbWUpID8gdW5kZWZpbmVkIDogc2VydmVybmFtZSwKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNvY2tldDsKICAgIH0KCiAgICAvLyBTb21lIG90aGVyIHN0YXR1cyBjb2RlIHRoYXQncyBub3QgMjAwLi4uIG5lZWQgdG8gcmUtcGxheSB0aGUgSFRUUAogICAgLy8gaGVhZGVyICJkYXRhIiBldmVudHMgb250byB0aGUgc29ja2V0IG9uY2UgdGhlIEhUVFAgbWFjaGluZXJ5IGlzCiAgICAvLyBhdHRhY2hlZCBzbyB0aGF0IHRoZSBub2RlIGNvcmUgYGh0dHBgIGNhbiBwYXJzZSBhbmQgaGFuZGxlIHRoZQogICAgLy8gZXJyb3Igc3RhdHVzIGNvZGUuCgogICAgLy8gQ2xvc2UgdGhlIG9yaWdpbmFsIHNvY2tldCwgYW5kIGEgbmV3ICJmYWtlIiBzb2NrZXQgaXMgcmV0dXJuZWQKICAgIC8vIGluc3RlYWQsIHNvIHRoYXQgdGhlIHByb3h5IGRvZXNuJ3QgZ2V0IHRoZSBIVFRQIHJlcXVlc3QKICAgIC8vIHdyaXR0ZW4gdG8gaXQgKHdoaWNoIG1heSBjb250YWluIGBBdXRob3JpemF0aW9uYCBoZWFkZXJzIG9yIG90aGVyCiAgICAvLyBzZW5zaXRpdmUgZGF0YSkuCiAgICAvLwogICAgLy8gU2VlOiBodHRwczovL2hhY2tlcm9uZS5jb20vcmVwb3J0cy81NDE1MDIKICAgIHNvY2tldC5kZXN0cm95KCk7CgogICAgY29uc3QgZmFrZVNvY2tldCA9IG5ldyBuZXQuU29ja2V0KHsgd3JpdGFibGU6IGZhbHNlIH0pOwogICAgZmFrZVNvY2tldC5yZWFkYWJsZSA9IHRydWU7CgogICAgLy8gTmVlZCB0byB3YWl0IGZvciB0aGUgInNvY2tldCIgZXZlbnQgdG8gcmUtcGxheSB0aGUgImRhdGEiIGV2ZW50cy4KICAgIHJlcS5vbmNlKCdzb2NrZXQnLCAocykgPT4gewogICAgICBkZWJ1ZygnUmVwbGF5aW5nIHByb3h5IGJ1ZmZlciBmb3IgZmFpbGVkIHJlcXVlc3QnKTsKICAgICAgLy8gUmVwbGF5IHRoZSAiYnVmZmVyZWQiIEJ1ZmZlciBvbnRvIHRoZSBmYWtlIGBzb2NrZXRgLCBzaW5jZSBhdAogICAgICAvLyB0aGlzIHBvaW50IHRoZSBIVFRQIG1vZHVsZSBtYWNoaW5lcnkgaGFzIGJlZW4gaG9va2VkIHVwIGZvcgogICAgICAvLyB0aGUgdXNlci4KICAgICAgcy5wdXNoKGJ1ZmZlcmVkKTsKICAgICAgcy5wdXNoKG51bGwpOwogICAgfSk7CgogICAgcmV0dXJuIGZha2VTb2NrZXQ7CiAgfQp9IEh0dHBzUHJveHlBZ2VudC5fX2luaXRTdGF0aWMoKTsKCmZ1bmN0aW9uIHJlc3VtZShzb2NrZXQpIHsKICBzb2NrZXQucmVzdW1lKCk7Cn0KCmZ1bmN0aW9uIG9taXQoCiAgb2JqLAogIC4uLmtleXMKKQoKIHsKICBjb25zdCByZXQgPSB7fQoKOwogIGxldCBrZXk7CiAgZm9yIChrZXkgaW4gb2JqKSB7CiAgICBpZiAoIWtleXMuaW5jbHVkZXMoa2V5KSkgewogICAgICByZXRba2V5XSA9IG9ialtrZXldOwogICAgfQogIH0KICByZXR1cm4gcmV0Owp9CgpmdW5jdGlvbiBfbnVsbGlzaENvYWxlc2NlKGxocywgcmhzRm4pIHsgaWYgKGxocyAhPSBudWxsKSB7IHJldHVybiBsaHM7IH0gZWxzZSB7IHJldHVybiByaHNGbigpOyB9IH0KLy8gRXN0aW1hdGVkIG1heGltdW0gc2l6ZSBmb3IgcmVhc29uYWJsZSBzdGFuZGFsb25lIGV2ZW50CmNvbnN0IEdaSVBfVEhSRVNIT0xEID0gMTAyNCAqIDMyOwoKLyoqCiAqIEdldHMgYSBzdHJlYW0gZnJvbSBhIFVpbnQ4QXJyYXkgb3Igc3RyaW5nCiAqIFJlYWRhYmxlLmZyb20gaXMgaWRlYWwgYnV0IHdhcyBhZGRlZCBpbiBub2RlLmpzIHYxMi4zLjAgYW5kIHYxMC4xNy4wCiAqLwpmdW5jdGlvbiBzdHJlYW1Gcm9tQm9keShib2R5KSB7CiAgcmV0dXJuIG5ldyBSZWFkYWJsZSh7CiAgICByZWFkKCkgewogICAgICB0aGlzLnB1c2goYm9keSk7CiAgICAgIHRoaXMucHVzaChudWxsKTsKICAgIH0sCiAgfSk7Cn0KCi8qKgogKiBDcmVhdGVzIGEgVHJhbnNwb3J0IHRoYXQgdXNlcyBuYXRpdmUgdGhlIG5hdGl2ZSAnaHR0cCcgYW5kICdodHRwcycgbW9kdWxlcyB0byBzZW5kIGV2ZW50cyB0byBTZW50cnkuCiAqLwpmdW5jdGlvbiBtYWtlTm9kZVRyYW5zcG9ydChvcHRpb25zKSB7CiAgbGV0IHVybFNlZ21lbnRzOwoKICB0cnkgewogICAgdXJsU2VnbWVudHMgPSBuZXcgVVJMKG9wdGlvbnMudXJsKTsKICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlU2FuZGJveCgoKSA9PiB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlCiAgICAgIGNvbnNvbGUud2FybigKICAgICAgICAnW0BzZW50cnkvbm9kZV06IEludmFsaWQgZHNuIG9yIHR1bm5lbCBvcHRpb24sIHdpbGwgbm90IHNlbmQgYW55IGV2ZW50cy4gVGhlIHR1bm5lbCBvcHRpb24gbXVzdCBiZSBhIGZ1bGwgVVJMIHdoZW4gdXNlZC4nLAogICAgICApOwogICAgfSk7CiAgICByZXR1cm4gY3JlYXRlVHJhbnNwb3J0KG9wdGlvbnMsICgpID0+IFByb21pc2UucmVzb2x2ZSh7fSkpOwogIH0KCiAgY29uc3QgaXNIdHRwcyA9IHVybFNlZ21lbnRzLnByb3RvY29sID09PSAnaHR0cHM6JzsKCiAgLy8gUHJveHkgcHJpb3JpdGl6YXRpb246IGh0dHAgPT4gYG9wdGlvbnMucHJveHlgIHwgYHByb2Nlc3MuZW52Lmh0dHBfcHJveHlgCiAgLy8gUHJveHkgcHJpb3JpdGl6YXRpb246IGh0dHBzID0+IGBvcHRpb25zLnByb3h5YCB8IGBwcm9jZXNzLmVudi5odHRwc19wcm94eWAgfCBgcHJvY2Vzcy5lbnYuaHR0cF9wcm94eWAKICBjb25zdCBwcm94eSA9IGFwcGx5Tm9Qcm94eU9wdGlvbigKICAgIHVybFNlZ21lbnRzLAogICAgb3B0aW9ucy5wcm94eSB8fCAoaXNIdHRwcyA/IHByb2Nlc3MuZW52Lmh0dHBzX3Byb3h5IDogdW5kZWZpbmVkKSB8fCBwcm9jZXNzLmVudi5odHRwX3Byb3h5LAogICk7CgogIGNvbnN0IG5hdGl2ZUh0dHBNb2R1bGUgPSBpc0h0dHBzID8gaHR0cHMgOiBodHRwOwogIGNvbnN0IGtlZXBBbGl2ZSA9IG9wdGlvbnMua2VlcEFsaXZlID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IG9wdGlvbnMua2VlcEFsaXZlOwoKICAvLyBUT0RPKHY3KTogRXZhbHVhdGUgaWYgd2UgY2FuIHNldCBrZWVwQWxpdmUgdG8gdHJ1ZS4gVGhpcyB3b3VsZCBpbnZvbHZlIHRlc3RpbmcgZm9yIG1lbW9yeSBsZWFrcyBpbiBvbGRlciBub2RlCiAgLy8gdmVyc2lvbnMoPj0gOCkgYXMgdGhleSBoYWQgbWVtb3J5IGxlYWtzIHdoZW4gdXNpbmcgaXQ6ICMyNTU1CiAgY29uc3QgYWdlbnQgPSBwcm94eQogICAgPyAobmV3IEh0dHBzUHJveHlBZ2VudChwcm94eSkgKQogICAgOiBuZXcgbmF0aXZlSHR0cE1vZHVsZS5BZ2VudCh7IGtlZXBBbGl2ZSwgbWF4U29ja2V0czogMzAsIHRpbWVvdXQ6IDIwMDAgfSk7CgogIGNvbnN0IHJlcXVlc3RFeGVjdXRvciA9IGNyZWF0ZVJlcXVlc3RFeGVjdXRvcihvcHRpb25zLCBfbnVsbGlzaENvYWxlc2NlKG9wdGlvbnMuaHR0cE1vZHVsZSwgKCkgPT4gKCBuYXRpdmVIdHRwTW9kdWxlKSksIGFnZW50KTsKICByZXR1cm4gY3JlYXRlVHJhbnNwb3J0KG9wdGlvbnMsIHJlcXVlc3RFeGVjdXRvcik7Cn0KCi8qKgogKiBIb25vcnMgdGhlIGBub19wcm94eWAgZW52IHZhcmlhYmxlIHdpdGggdGhlIGhpZ2hlc3QgcHJpb3JpdHkgdG8gYWxsb3cgZm9yIGhvc3RzIGV4Y2x1c2lvbi4KICoKICogQHBhcmFtIHRyYW5zcG9ydFVybCBUaGUgVVJMIHRoZSB0cmFuc3BvcnQgaW50ZW5kcyB0byBzZW5kIGV2ZW50cyB0by4KICogQHBhcmFtIHByb3h5IFRoZSBjbGllbnQgY29uZmlndXJlZCBwcm94eS4KICogQHJldHVybnMgQSBwcm94eSB0aGUgdHJhbnNwb3J0IHNob3VsZCB1c2UuCiAqLwpmdW5jdGlvbiBhcHBseU5vUHJveHlPcHRpb24odHJhbnNwb3J0VXJsU2VnbWVudHMsIHByb3h5KSB7CiAgY29uc3QgeyBub19wcm94eSB9ID0gcHJvY2Vzcy5lbnY7CgogIGNvbnN0IHVybElzRXhlbXB0RnJvbVByb3h5ID0KICAgIG5vX3Byb3h5ICYmCiAgICBub19wcm94eQogICAgICAuc3BsaXQoJywnKQogICAgICAuc29tZSgKICAgICAgICBleGVtcHRpb24gPT4gdHJhbnNwb3J0VXJsU2VnbWVudHMuaG9zdC5lbmRzV2l0aChleGVtcHRpb24pIHx8IHRyYW5zcG9ydFVybFNlZ21lbnRzLmhvc3RuYW1lLmVuZHNXaXRoKGV4ZW1wdGlvbiksCiAgICAgICk7CgogIGlmICh1cmxJc0V4ZW1wdEZyb21Qcm94eSkgewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9IGVsc2UgewogICAgcmV0dXJuIHByb3h5OwogIH0KfQoKLyoqCiAqIENyZWF0ZXMgYSBSZXF1ZXN0RXhlY3V0b3IgdG8gYmUgdXNlZCB3aXRoIGBjcmVhdGVUcmFuc3BvcnRgLgogKi8KZnVuY3Rpb24gY3JlYXRlUmVxdWVzdEV4ZWN1dG9yKAogIG9wdGlvbnMsCiAgaHR0cE1vZHVsZSwKICBhZ2VudCwKKSB7CiAgY29uc3QgeyBob3N0bmFtZSwgcGF0aG5hbWUsIHBvcnQsIHByb3RvY29sLCBzZWFyY2ggfSA9IG5ldyBVUkwob3B0aW9ucy51cmwpOwogIHJldHVybiBmdW5jdGlvbiBtYWtlUmVxdWVzdChyZXF1ZXN0KSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBsZXQgYm9keSA9IHN0cmVhbUZyb21Cb2R5KHJlcXVlc3QuYm9keSk7CgogICAgICBjb25zdCBoZWFkZXJzID0geyAuLi5vcHRpb25zLmhlYWRlcnMgfTsKCiAgICAgIGlmIChyZXF1ZXN0LmJvZHkubGVuZ3RoID4gR1pJUF9USFJFU0hPTEQpIHsKICAgICAgICBoZWFkZXJzWydjb250ZW50LWVuY29kaW5nJ10gPSAnZ3ppcCc7CiAgICAgICAgYm9keSA9IGJvZHkucGlwZShjcmVhdGVHemlwKCkpOwogICAgICB9CgogICAgICBjb25zdCByZXEgPSBodHRwTW9kdWxlLnJlcXVlc3QoCiAgICAgICAgewogICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICBhZ2VudCwKICAgICAgICAgIGhlYWRlcnMsCiAgICAgICAgICBob3N0bmFtZSwKICAgICAgICAgIHBhdGg6IGAke3BhdGhuYW1lfSR7c2VhcmNofWAsCiAgICAgICAgICBwb3J0LAogICAgICAgICAgcHJvdG9jb2wsCiAgICAgICAgICBjYTogb3B0aW9ucy5jYUNlcnRzLAogICAgICAgIH0sCiAgICAgICAgcmVzID0+IHsKICAgICAgICAgIHJlcy5vbignZGF0YScsICgpID0+IHsKICAgICAgICAgICAgLy8gRHJhaW4gc29ja2V0CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXMub24oJ2VuZCcsICgpID0+IHsKICAgICAgICAgICAgLy8gRHJhaW4gc29ja2V0CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXMuc2V0RW5jb2RpbmcoJ3V0ZjgnKTsKCiAgICAgICAgICAvLyAiS2V5LXZhbHVlIHBhaXJzIG9mIGhlYWRlciBuYW1lcyBhbmQgdmFsdWVzLiBIZWFkZXIgbmFtZXMgYXJlIGxvd2VyLWNhc2VkLiIKICAgICAgICAgIC8vIGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvaHR0cC5odG1sI2h0dHBfbWVzc2FnZV9oZWFkZXJzCiAgICAgICAgICBjb25zdCByZXRyeUFmdGVySGVhZGVyID0gX251bGxpc2hDb2FsZXNjZShyZXMuaGVhZGVyc1sncmV0cnktYWZ0ZXInXSwgKCkgPT4gKCBudWxsKSk7CiAgICAgICAgICBjb25zdCByYXRlTGltaXRzSGVhZGVyID0gX251bGxpc2hDb2FsZXNjZShyZXMuaGVhZGVyc1sneC1zZW50cnktcmF0ZS1saW1pdHMnXSwgKCkgPT4gKCBudWxsKSk7CgogICAgICAgICAgcmVzb2x2ZSh7CiAgICAgICAgICAgIHN0YXR1c0NvZGU6IHJlcy5zdGF0dXNDb2RlLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgJ3JldHJ5LWFmdGVyJzogcmV0cnlBZnRlckhlYWRlciwKICAgICAgICAgICAgICAneC1zZW50cnktcmF0ZS1saW1pdHMnOiBBcnJheS5pc0FycmF5KHJhdGVMaW1pdHNIZWFkZXIpID8gcmF0ZUxpbWl0c0hlYWRlclswXSA6IHJhdGVMaW1pdHNIZWFkZXIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICApOwoKICAgICAgcmVxLm9uKCdlcnJvcicsIHJlamVjdCk7CiAgICAgIGJvZHkucGlwZShyZXEpOwogICAgfSk7CiAgfTsKfQoKZnVuY3Rpb24gX29wdGlvbmFsQ2hhaW4ob3BzKSB7IGxldCBsYXN0QWNjZXNzTEhTID0gdW5kZWZpbmVkOyBsZXQgdmFsdWUgPSBvcHNbMF07IGxldCBpID0gMTsgd2hpbGUgKGkgPCBvcHMubGVuZ3RoKSB7IGNvbnN0IG9wID0gb3BzW2ldOyBjb25zdCBmbiA9IG9wc1tpICsgMV07IGkgKz0gMjsgaWYgKChvcCA9PT0gJ29wdGlvbmFsQWNjZXNzJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpICYmIHZhbHVlID09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBpZiAob3AgPT09ICdhY2Nlc3MnIHx8IG9wID09PSAnb3B0aW9uYWxBY2Nlc3MnKSB7IGxhc3RBY2Nlc3NMSFMgPSB2YWx1ZTsgdmFsdWUgPSBmbih2YWx1ZSk7IH0gZWxzZSBpZiAob3AgPT09ICdjYWxsJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpIHsgdmFsdWUgPSBmbigoLi4uYXJncykgPT4gdmFsdWUuY2FsbChsYXN0QWNjZXNzTEhTLCAuLi5hcmdzKSk7IGxhc3RBY2Nlc3NMSFMgPSB1bmRlZmluZWQ7IH0gfSByZXR1cm4gdmFsdWU7IH0KY29uc3Qgb3B0aW9ucyA9IHdvcmtlckRhdGE7CmxldCBzZXNzaW9uOwpsZXQgaGFzU2VudEFuckV2ZW50ID0gZmFsc2U7CgpmdW5jdGlvbiBsb2cobXNnKSB7CiAgaWYgKG9wdGlvbnMuZGVidWcpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlCiAgICBjb25zb2xlLmxvZyhgW0FOUiBXb3JrZXJdICR7bXNnfWApOwogIH0KfQoKY29uc3QgdXJsID0gZ2V0RW52ZWxvcGVFbmRwb2ludFdpdGhVcmxFbmNvZGVkQXV0aChvcHRpb25zLmRzbik7CmNvbnN0IHRyYW5zcG9ydCA9IG1ha2VOb2RlVHJhbnNwb3J0KHsKICB1cmwsCiAgcmVjb3JkRHJvcHBlZEV2ZW50OiAoKSA9PiB7CiAgICAvLwogIH0sCn0pOwoKYXN5bmMgZnVuY3Rpb24gc2VuZEFibm9ybWFsU2Vzc2lvbigpIHsKICAvLyBvZiB3ZSBoYXZlIGFuIGV4aXN0aW5nIHNlc3Npb24gcGFzc2VkIGZyb20gdGhlIG1haW4gdGhyZWFkLCBzZW5kIGl0IGFzIGFibm9ybWFsCiAgaWYgKHNlc3Npb24pIHsKICAgIGxvZygnU2VuZGluZyBhYm5vcm1hbCBzZXNzaW9uJyk7CiAgICB1cGRhdGVTZXNzaW9uKHNlc3Npb24sIHsgc3RhdHVzOiAnYWJub3JtYWwnLCBhYm5vcm1hbF9tZWNoYW5pc206ICdhbnJfZm9yZWdyb3VuZCcgfSk7CgogICAgY29uc3QgZW52ZWxvcGUgPSBjcmVhdGVTZXNzaW9uRW52ZWxvcGUoc2Vzc2lvbiwgb3B0aW9ucy5kc24sIG9wdGlvbnMuc2RrTWV0YWRhdGEpOwogICAgLy8gTG9nIHRoZSBlbnZlbG9wZSBzbyB0byBhaWQgaW4gdGVzdGluZwogICAgbG9nKEpTT04uc3RyaW5naWZ5KGVudmVsb3BlKSk7CgogICAgYXdhaXQgdHJhbnNwb3J0LnNlbmQoZW52ZWxvcGUpOwoKICAgIHRyeSB7CiAgICAgIC8vIE5vdGlmeSB0aGUgbWFpbiBwcm9jZXNzIHRoYXQgdGhlIHNlc3Npb24gaGFzIGVuZGVkIHNvIHRoZSBzZXNzaW9uIGNhbiBiZSBjbGVhcmVkIGZyb20gdGhlIHNjb3BlCiAgICAgIF9vcHRpb25hbENoYWluKFtwYXJlbnRQb3J0LCAnb3B0aW9uYWxBY2Nlc3MnLCBfMiA9PiBfMi5wb3N0TWVzc2FnZSwgJ2NhbGwnLCBfMyA9PiBfMygnc2Vzc2lvbi1lbmRlZCcpXSk7CiAgICB9IGNhdGNoIChfKSB7CiAgICAgIC8vIGlnbm9yZQogICAgfQogIH0KfQoKbG9nKCdTdGFydGVkJyk7CgpmdW5jdGlvbiBwcmVwYXJlU3RhY2tGcmFtZXMoc3RhY2tGcmFtZXMpIHsKICBpZiAoIXN0YWNrRnJhbWVzKSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgLy8gU3RyaXAgU2VudHJ5IGZyYW1lcyBhbmQgcmV2ZXJzZSB0aGUgc3RhY2sgZnJhbWVzIHNvIHRoZXkgYXJlIGluIHRoZSBjb3JyZWN0IG9yZGVyCiAgY29uc3Qgc3RyaXBwZWRGcmFtZXMgPSBzdHJpcFNlbnRyeUZyYW1lc0FuZFJldmVyc2Uoc3RhY2tGcmFtZXMpOwoKICAvLyBJZiB3ZSBoYXZlIGFuIGFwcCByb290IHBhdGgsIHJld3JpdGUgdGhlIGZpbGVuYW1lcyB0byBiZSByZWxhdGl2ZSB0byB0aGUgYXBwIHJvb3QKICBpZiAob3B0aW9ucy5hcHBSb290UGF0aCkgewogICAgZm9yIChjb25zdCBmcmFtZSBvZiBzdHJpcHBlZEZyYW1lcykgewogICAgICBpZiAoIWZyYW1lLmZpbGVuYW1lKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZyYW1lLmZpbGVuYW1lID0gbm9ybWFsaXplVXJsVG9CYXNlKGZyYW1lLmZpbGVuYW1lLCBvcHRpb25zLmFwcFJvb3RQYXRoKTsKICAgIH0KICB9CgogIHJldHVybiBzdHJpcHBlZEZyYW1lczsKfQoKZnVuY3Rpb24gYXBwbHlTY29wZVRvRXZlbnQoZXZlbnQsIHNjb3BlKSB7CiAgYXBwbHlTY29wZURhdGFUb0V2ZW50KGV2ZW50LCBzY29wZSk7CgogIGlmICghX29wdGlvbmFsQ2hhaW4oW2V2ZW50LCAnYWNjZXNzJywgXzQgPT4gXzQuY29udGV4dHMsICdvcHRpb25hbEFjY2VzcycsIF81ID0+IF81LnRyYWNlXSkpIHsKICAgIGNvbnN0IHsgdHJhY2VJZCwgc3BhbklkLCBwYXJlbnRTcGFuSWQgfSA9IHNjb3BlLnByb3BhZ2F0aW9uQ29udGV4dDsKICAgIGV2ZW50LmNvbnRleHRzID0gewogICAgICB0cmFjZTogewogICAgICAgIHRyYWNlX2lkOiB0cmFjZUlkLAogICAgICAgIHNwYW5faWQ6IHNwYW5JZCwKICAgICAgICBwYXJlbnRfc3Bhbl9pZDogcGFyZW50U3BhbklkLAogICAgICB9LAogICAgICAuLi5ldmVudC5jb250ZXh0cywKICAgIH07CiAgfQp9Cgphc3luYyBmdW5jdGlvbiBzZW5kQW5yRXZlbnQoZnJhbWVzLCBzY29wZSkgewogIGlmIChoYXNTZW50QW5yRXZlbnQpIHsKICAgIHJldHVybjsKICB9CgogIGhhc1NlbnRBbnJFdmVudCA9IHRydWU7CgogIGF3YWl0IHNlbmRBYm5vcm1hbFNlc3Npb24oKTsKCiAgbG9nKCdTZW5kaW5nIGV2ZW50Jyk7CgogIGNvbnN0IGV2ZW50ID0gewogICAgZXZlbnRfaWQ6IHV1aWQ0KCksCiAgICBjb250ZXh0czogb3B0aW9ucy5jb250ZXh0cywKICAgIHJlbGVhc2U6IG9wdGlvbnMucmVsZWFzZSwKICAgIGVudmlyb25tZW50OiBvcHRpb25zLmVudmlyb25tZW50LAogICAgZGlzdDogb3B0aW9ucy5kaXN0LAogICAgcGxhdGZvcm06ICdub2RlJywKICAgIGxldmVsOiAnZXJyb3InLAogICAgZXhjZXB0aW9uOiB7CiAgICAgIHZhbHVlczogWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICdBcHBsaWNhdGlvbk5vdFJlc3BvbmRpbmcnLAogICAgICAgICAgdmFsdWU6IGBBcHBsaWNhdGlvbiBOb3QgUmVzcG9uZGluZyBmb3IgYXQgbGVhc3QgJHtvcHRpb25zLmFuclRocmVzaG9sZH0gbXNgLAogICAgICAgICAgc3RhY2t0cmFjZTogeyBmcmFtZXM6IHByZXBhcmVTdGFja0ZyYW1lcyhmcmFtZXMpIH0sCiAgICAgICAgICAvLyBUaGlzIGVuc3VyZXMgdGhlIFVJIGRvZXNuJ3Qgc2F5ICdDcmFzaGVkIGluJyBmb3IgdGhlIHN0YWNrIHRyYWNlCiAgICAgICAgICBtZWNoYW5pc206IHsgdHlwZTogJ0FOUicgfSwKICAgICAgICB9LAogICAgICBdLAogICAgfSwKICAgIHRhZ3M6IG9wdGlvbnMuc3RhdGljVGFncywKICB9OwoKICBpZiAoc2NvcGUpIHsKICAgIGFwcGx5U2NvcGVUb0V2ZW50KGV2ZW50LCBzY29wZSk7CiAgfQoKICBjb25zdCBlbnZlbG9wZSA9IGNyZWF0ZUV2ZW50RW52ZWxvcGUoZXZlbnQsIG9wdGlvbnMuZHNuLCBvcHRpb25zLnNka01ldGFkYXRhKTsKICAvLyBMb2cgdGhlIGVudmVsb3BlIHRvIGFpZCBpbiB0ZXN0aW5nCiAgbG9nKEpTT04uc3RyaW5naWZ5KGVudmVsb3BlKSk7CgogIGF3YWl0IHRyYW5zcG9ydC5zZW5kKGVudmVsb3BlKTsKICBhd2FpdCB0cmFuc3BvcnQuZmx1c2goMjAwMCk7CgogIC8vIERlbGF5IGZvciA1IHNlY29uZHMgc28gdGhhdCBzdGRpbyBjYW4gZmx1c2ggaW4gdGhlIG1haW4gZXZlbnQgbG9vcCBldmVyIHJlc3RhcnRzLgogIC8vIFRoaXMgaXMgbWFpbmx5IGZvciB0aGUgYmVuZWZpdCBvZiBsb2dnaW5nL2RlYnVnZ2luZyBpc3N1ZXMuCiAgc2V0VGltZW91dCgoKSA9PiB7CiAgICBwcm9jZXNzLmV4aXQoMCk7CiAgfSwgNTAwMCk7Cn0KCmxldCBkZWJ1Z2dlclBhdXNlOwoKaWYgKG9wdGlvbnMuY2FwdHVyZVN0YWNrVHJhY2UpIHsKICBsb2coJ0Nvbm5lY3RpbmcgdG8gZGVidWdnZXInKTsKCiAgY29uc3Qgc2Vzc2lvbiA9IG5ldyBTZXNzaW9uKCkgOwogIHNlc3Npb24uY29ubmVjdFRvTWFpblRocmVhZCgpOwoKICBsb2coJ0Nvbm5lY3RlZCB0byBkZWJ1Z2dlcicpOwoKICAvLyBDb2xsZWN0IHNjcmlwdElkIC0+IHVybCBtYXAgc28gd2UgY2FuIGxvb2sgdXAgdGhlIGZpbGVuYW1lcyBsYXRlcgogIGNvbnN0IHNjcmlwdHMgPSBuZXcgTWFwKCk7CgogIHNlc3Npb24ub24oJ0RlYnVnZ2VyLnNjcmlwdFBhcnNlZCcsIGV2ZW50ID0+IHsKICAgIHNjcmlwdHMuc2V0KGV2ZW50LnBhcmFtcy5zY3JpcHRJZCwgZXZlbnQucGFyYW1zLnVybCk7CiAgfSk7CgogIHNlc3Npb24ub24oJ0RlYnVnZ2VyLnBhdXNlZCcsIGV2ZW50ID0+IHsKICAgIGlmIChldmVudC5wYXJhbXMucmVhc29uICE9PSAnb3RoZXInKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0cnkgewogICAgICBsb2coJ0RlYnVnZ2VyIHBhdXNlZCcpOwoKICAgICAgLy8gY29weSB0aGUgZnJhbWVzCiAgICAgIGNvbnN0IGNhbGxGcmFtZXMgPSBbLi4uZXZlbnQucGFyYW1zLmNhbGxGcmFtZXNdOwoKICAgICAgY29uc3QgZ2V0TW9kdWxlTmFtZSA9IG9wdGlvbnMuYXBwUm9vdFBhdGggPyBjcmVhdGVHZXRNb2R1bGVGcm9tRmlsZW5hbWUob3B0aW9ucy5hcHBSb290UGF0aCkgOiAoKSA9PiB1bmRlZmluZWQ7CiAgICAgIGNvbnN0IHN0YWNrRnJhbWVzID0gY2FsbEZyYW1lcy5tYXAoZnJhbWUgPT4KICAgICAgICBjYWxsRnJhbWVUb1N0YWNrRnJhbWUoZnJhbWUsIHNjcmlwdHMuZ2V0KGZyYW1lLmxvY2F0aW9uLnNjcmlwdElkKSwgZ2V0TW9kdWxlTmFtZSksCiAgICAgICk7CgogICAgICAvLyBFdmFsdWF0ZSBhIHNjcmlwdCBpbiB0aGUgY3VycmVudGx5IHBhdXNlZCBjb250ZXh0CiAgICAgIHNlc3Npb24ucG9zdCgKICAgICAgICAnUnVudGltZS5ldmFsdWF0ZScsCiAgICAgICAgewogICAgICAgICAgLy8gR3JhYiB0aGUgdHJhY2UgY29udGV4dCBmcm9tIHRoZSBjdXJyZW50IHNjb3BlCiAgICAgICAgICBleHByZXNzaW9uOiAnZ2xvYmFsLl9fU0VOVFJZX0dFVF9TQ09QRVNfXygpOycsCiAgICAgICAgICAvLyBEb24ndCByZS10cmlnZ2VyIHRoZSBkZWJ1Z2dlciBpZiB0aGlzIGNhdXNlcyBhbiBlcnJvcgogICAgICAgICAgc2lsZW50OiB0cnVlLAogICAgICAgICAgLy8gU2VyaWFsaXplIHRoZSByZXN1bHQgdG8ganNvbiBvdGhlcndpc2Ugb25seSBwcmltaXRpdmVzIGFyZSBzdXBwb3J0ZWQKICAgICAgICAgIHJldHVybkJ5VmFsdWU6IHRydWUsCiAgICAgICAgfSwKICAgICAgICAoZXJyLCBwYXJhbSkgPT4gewogICAgICAgICAgaWYgKGVycikgewogICAgICAgICAgICBsb2coYEVycm9yIGV4ZWN1dGluZyBzY3JpcHQ6ICcke2Vyci5tZXNzYWdlfSdgKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBzY29wZXMgPSBwYXJhbSAmJiBwYXJhbS5yZXN1bHQgPyAocGFyYW0ucmVzdWx0LnZhbHVlICkgOiB1bmRlZmluZWQ7CgogICAgICAgICAgc2Vzc2lvbi5wb3N0KCdEZWJ1Z2dlci5yZXN1bWUnKTsKICAgICAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIuZGlzYWJsZScpOwoKICAgICAgICAgIHNlbmRBbnJFdmVudChzdGFja0ZyYW1lcywgc2NvcGVzKS50aGVuKG51bGwsICgpID0+IHsKICAgICAgICAgICAgbG9nKCdTZW5kaW5nIEFOUiBldmVudCBmYWlsZWQuJyk7CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICApOwogICAgfSBjYXRjaCAoZSkgewogICAgICBzZXNzaW9uLnBvc3QoJ0RlYnVnZ2VyLnJlc3VtZScpOwogICAgICBzZXNzaW9uLnBvc3QoJ0RlYnVnZ2VyLmRpc2FibGUnKTsKICAgICAgdGhyb3cgZTsKICAgIH0KICB9KTsKCiAgZGVidWdnZXJQYXVzZSA9ICgpID0+IHsKICAgIHRyeSB7CiAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIuZW5hYmxlJywgKCkgPT4gewogICAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIucGF1c2UnKTsKICAgICAgfSk7CiAgICB9IGNhdGNoIChfKSB7CiAgICAgIC8vCiAgICB9CiAgfTsKfQoKZnVuY3Rpb24gY3JlYXRlSHJUaW1lcigpIHsKICAvLyBUT0RPICh2OCk6IFdlIGNhbiB1c2UgcHJvY2Vzcy5ocnRpbWUuYmlnaW50KCkgYWZ0ZXIgd2UgZHJvcCBub2RlIHY4CiAgbGV0IGxhc3RQb2xsID0gcHJvY2Vzcy5ocnRpbWUoKTsKCiAgcmV0dXJuIHsKICAgIGdldFRpbWVNczogKCkgPT4gewogICAgICBjb25zdCBbc2Vjb25kcywgbmFub1NlY29uZHNdID0gcHJvY2Vzcy5ocnRpbWUobGFzdFBvbGwpOwogICAgICByZXR1cm4gTWF0aC5mbG9vcihzZWNvbmRzICogMWUzICsgbmFub1NlY29uZHMgLyAxZTYpOwogICAgfSwKICAgIHJlc2V0OiAoKSA9PiB7CiAgICAgIGxhc3RQb2xsID0gcHJvY2Vzcy5ocnRpbWUoKTsKICAgIH0sCiAgfTsKfQoKZnVuY3Rpb24gd2F0Y2hkb2dUaW1lb3V0KCkgewogIGxvZygnV2F0Y2hkb2cgdGltZW91dCcpOwoKICBpZiAoZGVidWdnZXJQYXVzZSkgewogICAgbG9nKCdQYXVzaW5nIGRlYnVnZ2VyIHRvIGNhcHR1cmUgc3RhY2sgdHJhY2UnKTsKICAgIGRlYnVnZ2VyUGF1c2UoKTsKICB9IGVsc2UgewogICAgbG9nKCdDYXB0dXJpbmcgZXZlbnQgd2l0aG91dCBhIHN0YWNrIHRyYWNlJyk7CiAgICBzZW5kQW5yRXZlbnQoKS50aGVuKG51bGwsICgpID0+IHsKICAgICAgbG9nKCdTZW5kaW5nIEFOUiBldmVudCBmYWlsZWQgb24gd2F0Y2hkb2cgdGltZW91dC4nKTsKICAgIH0pOwogIH0KfQoKY29uc3QgeyBwb2xsIH0gPSB3YXRjaGRvZ1RpbWVyKGNyZWF0ZUhyVGltZXIsIG9wdGlvbnMucG9sbEludGVydmFsLCBvcHRpb25zLmFuclRocmVzaG9sZCwgd2F0Y2hkb2dUaW1lb3V0KTsKCl9vcHRpb25hbENoYWluKFtwYXJlbnRQb3J0LCAnb3B0aW9uYWxBY2Nlc3MnLCBfNiA9PiBfNi5vbiwgJ2NhbGwnLCBfNyA9PiBfNygnbWVzc2FnZScsIChtc2cpID0+IHsKICBpZiAobXNnLnNlc3Npb24pIHsKICAgIHNlc3Npb24gPSBtYWtlU2Vzc2lvbihtc2cuc2Vzc2lvbik7CiAgfQoKICBwb2xsKCk7Cn0pXSk7"});var jg=I((Mg,kV)=>{"use strict";var{_optionalChain:m7,_optionalChainDelete:_V}=R();Object.defineProperty(Mg,"__esModule",{value:!0});var p7=require("url"),pr=j(),qg=R(),SC=ki(),f7=XV(),h7=50,C7=5e3;function WC(e,...t){qg.logger.log(`[ANR] ${e}`,...t)}function b7(){return qg.GLOBAL_OBJ}function y7(){let e=pr.getGlobalScope().getScopeData();return pr.mergeScopeData(e,pr.getIsolationScope().getScopeData()),pr.mergeScopeData(e,pr.getCurrentScope().getScopeData()),e.attachments=[],e.eventProcessors=[],e}function G7(){return qg.dynamicRequire(kV,"worker_threads")}async function B7(e){let t={message:"ANR"},n={};for(let r of e.getEventProcessors()){if(t===null)break;t=await r(t,n)}return m7([t,"optionalAccess",r=>r.contexts])||{}}var FV="Anr",A7=(e={})=>{if(SC.NODE_VERSION.major<16||SC.NODE_VERSION.major===16&&SC.NODE_VERSION.minor<17)throw new Error("ANR detection requires Node 16.17.0 or later");let t,n,r=b7();return r.__SENTRY_GET_SCOPES__=y7,{name:FV,setupOnce(){},startWorker:()=>{t||n&&(t=v7(n,e))},stopWorker:()=>{t&&t.then(i=>{i(),t=void 0})},setup(i){n=i,setImmediate(()=>this.startWorker())}}},TV=pr.defineIntegration(A7),Z7=pr.convertIntegrationFnToClass(FV,TV);async function v7(e,t){let n=e.getDsn();if(!n)return()=>{};let r=await B7(e);_V([r,"access",u=>u.app,"optionalAccess",u=>delete u.app_memory]),_V([r,"access",u=>u.device,"optionalAccess",u=>delete u.free_memory]);let i=e.getOptions(),o=e.getSdkMetadata()||{};o.sdk&&(o.sdk.integrations=i.integrations.map(u=>u.name));let s={debug:qg.logger.isEnabled(),dsn:n,environment:i.environment||"production",release:i.release,dist:i.dist,sdkMetadata:o,appRootPath:t.appRootPath,pollInterval:t.pollInterval||h7,anrThreshold:t.anrThreshold||C7,captureStackTrace:!!t.captureStackTrace,staticTags:t.staticTags||{},contexts:r};if(s.captureStackTrace){let u=require("inspector");u.url()||u.open(0)}let{Worker:a}=G7(),c=new a(new p7.URL(`data:application/javascript;base64,${f7.base64WorkerScript}`),{workerData:s});process.on("exit",()=>{c.terminate()});let l=setInterval(()=>{try{let u=pr.getCurrentScope().getSession(),d=u?{...u,toJSON:void 0}:void 0;c.postMessage({session:d})}catch{}},s.pollInterval);return l.unref(),c.on("message",u=>{u==="session-ended"&&(WC("ANR event sent from ANR worker. Clearing session in this thread."),pr.getCurrentScope().setSession(void 0))}),c.once("error",u=>{clearInterval(l),WC("ANR worker error",u)}),c.once("exit",u=>{clearInterval(l),WC("ANR worker exit",u)}),c.unref(),()=>{c.terminate(),clearInterval(l)}}Mg.Anr=Z7;Mg.anrIntegration=TV});var KV=I(RC=>{"use strict";Object.defineProperty(RC,"__esModule",{value:!0});var S7=j(),W7=jg();function R7(e){let t=S7.getClient();return new W7.Anr(e).setup(t),Promise.resolve()}RC.enableAnrDetection=R7});var NC=I(VC=>{"use strict";var{_optionalChain:UV}=R();Object.defineProperty(VC,"__esModule",{value:!0});var ss=j(),xV=R();function V7(e={}){return function({path:t,type:n,next:r,rawInput:i}){let o=UV([ss.getClient,"call",l=>l(),"optionalAccess",l=>l.getOptions,"call",l=>l()]),s=ss.getCurrentScope().getTransaction();if(s){s.updateName(`trpc/${t}`),s.setAttribute(ss.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,"route"),s.op="rpc.server";let l={procedure_type:n};(e.attachRpcInput!==void 0?e.attachRpcInput:UV([o,"optionalAccess",u=>u.sendDefaultPii]))&&(l.input=xV.normalize(i)),s.setContext("trpc",l)}function a(l){l.ok||ss.captureException(l.error,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}})}let c;try{c=r()}catch(l){throw ss.captureException(l,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}}),l}return xV.isThenable(c)?Promise.resolve(c).then(l=>{a(l)},l=>{ss.captureException(l,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}})}):a(c),c}}VC.trpcMiddleware=V7});var JV=I(Pg=>{"use strict";Object.defineProperty(Pg,"__esModule",{value:!0});var LV=R();function N7(e,t){return LV.extractRequestData(e,{include:t})}function w7(e,t,n={}){return LV.addRequestDataToEvent(e,t,{include:n})}Pg.extractRequestData=N7;Pg.parseRequest=w7});var OV=I(Jr=>{"use strict";var{_optionalChain:Qg}=R();Object.defineProperty(Jr,"__esModule",{value:!0});var Ue=j(),as=R(),E7=$a(),$g=AC(),H7=NC(),zV=JV();function Y7(){return function(t,n,r){let i=Qg([Ue.getClient,"call",u=>u(),"optionalAccess",u=>u.getOptions,"call",u=>u()]);if(!i||i.instrumenter!=="sentry"||Qg([t,"access",u=>u.method,"optionalAccess",u=>u.toUpperCase,"call",u=>u()])==="OPTIONS"||Qg([t,"access",u=>u.method,"optionalAccess",u=>u.toUpperCase,"call",u=>u()])==="HEAD")return r();let o=t.headers&&as.isString(t.headers["sentry-trace"])?t.headers["sentry-trace"]:void 0,s=Qg([t,"access",u=>u.headers,"optionalAccess",u=>u.baggage]);if(!Ue.hasTracingEnabled(i))return r();let[a,c]=as.extractPathForTransaction(t,{path:!0,method:!0}),l=Ue.continueTrace({sentryTrace:o,baggage:s},u=>Ue.startTransaction({name:a,op:"http.server",origin:"auto.http.node.tracingHandler",...u,data:{[Ue.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:c},metadata:{...u.metadata,request:t}},{request:as.extractRequestData(t)}));Ue.getCurrentScope().setSpan(l),n.__sentry_transaction=l,n.once("finish",()=>{setImmediate(()=>{as.addRequestDataToTransaction(l,t),Ue.setHttpStatus(l,n.statusCode),l.end()})}),r()}}function X7(e={}){let t;if("include"in e)t={include:e.include};else{let{ip:n,request:r,transaction:i,user:o}=e;(n||r||i||o)&&(t={include:as.dropUndefinedKeys({ip:n,request:r,transaction:i,user:o})})}return t}function _7(e){let t=X7(e),n=Ue.getClient();if(n&&$g.isAutoSessionTrackingEnabled(n)){n.initSessionFlusher();let r=Ue.getCurrentScope();r.getSession()&&r.setSession()}return function(i,o,s){if(e&&e.flushTimeout&&e.flushTimeout>0){let a=o.end;o.end=function(c,l,u){Ue.flush(e.flushTimeout).then(()=>{a.call(this,c,l,u)}).then(null,d=>{E7.DEBUG_BUILD&&as.logger.error(d),a.call(this,c,l,u)})}}Ue.runWithAsyncContext(()=>{let a=Ue.getCurrentScope();a.setSDKProcessingMetadata({request:i,requestDataOptionsFromExpressHandler:t});let c=Ue.getClient();$g.isAutoSessionTrackingEnabled(c)&&a.setRequestSession({status:"ok"}),o.once("finish",()=>{let l=Ue.getClient();$g.isAutoSessionTrackingEnabled(l)&&setImmediate(()=>{l&&l._captureRequestSession&&l._captureRequestSession()})}),s()})}}function F7(e){let t=e.status||e.statusCode||e.status_code||e.output&&e.output.statusCode;return t?parseInt(t,10):500}function T7(e){return F7(e)>=500}function k7(e){return function(n,r,i,o){if((e&&e.shouldHandleError||T7)(n)){Ue.withScope(a=>{a.setSDKProcessingMetadata({request:r});let c=i.__sentry_transaction;c&&!Ue.getActiveSpan()&&a.setSpan(c);let l=Ue.getClient();if(l&&$g.isAutoSessionTrackingEnabled(l)&&l._sessionFlusher!==void 0){let g=a.getRequestSession();g&&g.status!==void 0&&(g.status="crashed")}let u=Ue.captureException(n,{mechanism:{type:"middleware",handled:!1}});i.sentry=u,o(n)});return}o(n)}}var K7=H7.trpcMiddleware;Jr.extractRequestData=zV.extractRequestData;Jr.parseRequest=zV.parseRequest;Jr.errorHandler=k7;Jr.requestHandler=_7;Jr.tracingHandler=Y7;Jr.trpcMiddleware=K7});var wC=I(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});var vt=j(),qV=R();function DV(e){return e&&e.statusCode!==void 0}function U7(e){return e&&e.error!==void 0}function x7(e){vt.captureException(e,{mechanism:{type:"hapi",handled:!1,data:{function:"hapiErrorPlugin"}}})}var MV={name:"SentryHapiErrorPlugin",version:vt.SDK_VERSION,register:async function(e){e.events.on("request",(n,r)=>{let i=vt.getActiveTransaction();U7(r)&&x7(r.error),i&&(i.setStatus("internal_error"),i.end())})}},jV={name:"SentryHapiTracingPlugin",version:vt.SDK_VERSION,register:async function(e){let t=e;t.ext("onPreHandler",(n,r)=>{let i=vt.continueTrace({sentryTrace:n.headers["sentry-trace"]||void 0,baggage:n.headers.baggage||void 0},o=>vt.startTransaction({...o,op:"hapi.request",name:n.route.path,description:`${n.route.method} ${n.path}`}));return vt.getCurrentScope().setSpan(i),r.continue}),t.ext("onPreResponse",(n,r)=>{let i=vt.getActiveTransaction();if(n.response&&DV(n.response)&&i){let o=n.response;o.header("sentry-trace",vt.spanToTraceHeader(i));let s=qV.dynamicSamplingContextToSentryBaggageHeader(vt.getDynamicSamplingContextFromSpan(i));s&&o.header("baggage",s)}return r.continue}),t.ext("onPostHandler",(n,r)=>{let i=vt.getActiveTransaction();return i&&(n.response&&DV(n.response)&&vt.setHttpStatus(i,n.response.statusCode),i.end()),r.continue})}},PV="Hapi",L7=(e={})=>{let t=e.server;return{name:PV,setupOnce(){t&&qV.fill(t,"start",n=>async function(){return await this.register(jV),await this.register(MV),n.apply(this)})}}},QV=vt.defineIntegration(L7),J7=vt.convertIntegrationFnToClass(PV,QV);cs.Hapi=J7;cs.hapiErrorPlugin=MV;cs.hapiIntegration=QV;cs.hapiTracingPlugin=jV});var $V=I(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});var z7=Wg(),O7=Eg(),D7=Ug(),q7=Lg(),M7=Tg(),j7=wg(),P7=Rg(),Q7=j(),$7=_g(),e6=Og(),t6=Jg(),n6=jg(),r6=wC();ut.Console=z7.Console;ut.Http=O7.Http;ut.OnUncaughtException=D7.OnUncaughtException;ut.OnUnhandledRejection=q7.OnUnhandledRejection;ut.Modules=M7.Modules;ut.ContextLines=j7.ContextLines;ut.Context=P7.Context;ut.RequestData=Q7.RequestData;ut.LocalVariables=$7.LocalVariables;ut.Undici=e6.Undici;ut.Spotlight=t6.Spotlight;ut.Anr=n6.Anr;ut.Hapi=r6.Hapi});var eN=I(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});var Di=zh();fr.Apollo=Di.Apollo;fr.Express=Di.Express;fr.GraphQL=Di.GraphQL;fr.Mongo=Di.Mongo;fr.Mysql=Di.Mysql;fr.Postgres=Di.Postgres;fr.Prisma=Di.Prisma});var rN=I(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});var qi=j(),Mi=R(),tN="CaptureConsole",i6=(e={})=>{let t=e.levels||Mi.CONSOLE_LEVELS;return{name:tN,setupOnce(){},setup(n){"console"in Mi.GLOBAL_OBJ&&Mi.addConsoleInstrumentationHandler(({args:r,level:i})=>{qi.getClient()!==n||!t.includes(i)||s6(r,i)})}}},nN=qi.defineIntegration(i6),o6=qi.convertIntegrationFnToClass(tN,nN);function s6(e,t){let n={level:Mi.severityLevelFromString(t),extra:{arguments:e}};qi.withScope(r=>{if(r.addEventProcessor(s=>(s.logger="console",Mi.addExceptionMechanism(s,{handled:!1,type:"console"}),s)),t==="assert"&&e[0]===!1){let s=`Assertion failed: ${Mi.safeJoin(e.slice(1)," ")||"console.assert"}`;r.setExtra("arguments",e.slice(1)),qi.captureMessage(s,n);return}let i=e.find(s=>s instanceof Error);if(t==="error"&&i){qi.captureException(i,n);return}let o=Mi.safeJoin(e," ");qi.captureMessage(o,n)})}ed.CaptureConsole=o6;ed.captureConsoleIntegration=nN});var aN=I(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});var iN=j(),a6=R(),oN="Debug",c6=(e={})=>{let t={debugger:!1,stringify:!1,...e};return{name:oN,setupOnce(){},setup(n){n.on&&n.on("beforeSendEvent",(r,i)=>{if(t.debugger)debugger;a6.consoleSandbox(()=>{t.stringify?(console.log(JSON.stringify(r,null,2)),i&&Object.keys(i).length&&console.log(JSON.stringify(i,null,2))):(console.log(r),i&&Object.keys(i).length&&console.log(i))})})}}},sN=iN.defineIntegration(c6),u6=iN.convertIntegrationFnToClass(oN,sN);td.Debug=u6;td.debugIntegration=sN});var sc=I(EC=>{"use strict";Object.defineProperty(EC,"__esModule",{value:!0});var l6=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;EC.DEBUG_BUILD=l6});var fN=I(ac=>{"use strict";Object.defineProperty(ac,"__esModule",{value:!0});var lN=j(),g6=R(),d6=sc(),gN="Dedupe",I6=()=>{let e;return{name:gN,setupOnce(){},processEvent(t){if(t.type)return t;try{if(IN(t,e))return d6.DEBUG_BUILD&&g6.logger.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}},dN=lN.defineIntegration(I6),m6=lN.convertIntegrationFnToClass(gN,dN);function IN(e,t){return t?!!(p6(e,t)||f6(e,t)):!1}function p6(e,t){let n=e.message,r=t.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!pN(e,t)||!mN(e,t))}function f6(e,t){let n=cN(t),r=cN(e);return!(!n||!r||n.type!==r.type||n.value!==r.value||!pN(e,t)||!mN(e,t))}function mN(e,t){let n=uN(e),r=uN(t);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let i=0;i<r.length;i++){let o=r[i],s=n[i];if(o.filename!==s.filename||o.lineno!==s.lineno||o.colno!==s.colno||o.function!==s.function)return!1}return!0}function pN(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function cN(e){return e.exception&&e.exception.values&&e.exception.values[0]}function uN(e){let t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch{return}}ac.Dedupe=m6;ac._shouldDropEvent=IN;ac.dedupeIntegration=dN});var yN=I(nd=>{"use strict";Object.defineProperty(nd,"__esModule",{value:!0});var hN=j(),zr=R(),h6=sc(),CN="ExtraErrorData",C6=(e={})=>{let t=e.depth||3,n=e.captureErrorCause||!1;return{name:CN,setupOnce(){},processEvent(r,i){return y6(r,i,t,n)}}},bN=hN.defineIntegration(C6),b6=hN.convertIntegrationFnToClass(CN,bN);function y6(e,t={},n,r){if(!t.originalException||!zr.isError(t.originalException))return e;let i=t.originalException.name||t.originalException.constructor.name,o=G6(t.originalException,r);if(o){let s={...e.contexts},a=zr.normalize(o,n);return zr.isPlainObject(a)&&(zr.addNonEnumerableProperty(a,"__sentry_skip_normalization__",!0),s[i]=a),{...e,contexts:s}}return e}function G6(e,t){try{let n=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],r={};for(let i of Object.keys(e)){if(n.indexOf(i)!==-1)continue;let o=e[i];r[i]=zr.isError(o)?o.toString():o}if(t&&e.cause!==void 0&&(r.cause=zr.isError(e.cause)?e.cause.toString():e.cause),typeof e.toJSON=="function"){let i=e.toJSON();for(let o of Object.keys(i)){let s=i[o];r[o]=zr.isError(s)?s.toString():s}}return r}catch(n){h6.DEBUG_BUILD&&zr.logger.error("Unable to extract extra data from the Error object:",n)}return null}nd.ExtraErrorData=b6;nd.extraErrorDataIntegration=bN});var BN=I((GN,HC)=>{"use strict";(function(e){if(typeof GN=="object"&&typeof HC<"u")HC.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t=this,t.localforage=e()}})(function(){var e,t,n;return function r(i,o,s){function a(u,d){if(!o[u]){if(!i[u]){var g=typeof require=="function"&&require;if(!d&&g)return g(u,!0);if(c)return c(u,!0);var m=new Error("Cannot find module '"+u+"'");throw m.code="MODULE_NOT_FOUND",m}var h=o[u]={exports:{}};i[u][0].call(h.exports,function(b){var y=i[u][1][b];return a(y||b)},h,h.exports,r,i,o,s)}return o[u].exports}for(var c=typeof require=="function"&&require,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(r,i,o){(function(s){"use strict";var a=s.MutationObserver||s.WebKitMutationObserver,c;if(a){var l=0,u=new a(b),d=s.document.createTextNode("");u.observe(d,{characterData:!0}),c=function(){d.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var g=new s.MessageChannel;g.port1.onmessage=b,c=function(){g.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?c=function(){var v=s.document.createElement("script");v.onreadystatechange=function(){b(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},s.document.documentElement.appendChild(v)}:c=function(){setTimeout(b,0)};var m,h=[];function b(){m=!0;for(var v,H,F=h.length;F;){for(H=h,h=[],v=-1;++v<F;)H[v]();F=h.length}m=!1}i.exports=y;function y(v){h.push(v)===1&&!m&&c()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(r,i,o){"use strict";var s=r(1);function a(){}var c={},l=["REJECTED"],u=["FULFILLED"],d=["PENDING"];i.exports=g;function g(V){if(typeof V!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,V!==a&&y(this,V)}g.prototype.catch=function(V){return this.then(null,V)},g.prototype.then=function(V,x){if(typeof V!="function"&&this.state===u||typeof x!="function"&&this.state===l)return this;var O=new this.constructor(a);if(this.state!==d){var k=this.state===u?V:x;h(O,k,this.outcome)}else this.queue.push(new m(O,V,x));return O};function m(V,x,O){this.promise=V,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof O=="function"&&(this.onRejected=O,this.callRejected=this.otherCallRejected)}m.prototype.callFulfilled=function(V){c.resolve(this.promise,V)},m.prototype.otherCallFulfilled=function(V){h(this.promise,this.onFulfilled,V)},m.prototype.callRejected=function(V){c.reject(this.promise,V)},m.prototype.otherCallRejected=function(V){h(this.promise,this.onRejected,V)};function h(V,x,O){s(function(){var k;try{k=x(O)}catch(D){return c.reject(V,D)}k===V?c.reject(V,new TypeError("Cannot resolve promise with itself")):c.resolve(V,k)})}c.resolve=function(V,x){var O=v(b,x);if(O.status==="error")return c.reject(V,O.value);var k=O.value;if(k)y(V,k);else{V.state=u,V.outcome=x;for(var D=-1,M=V.queue.length;++D<M;)V.queue[D].callFulfilled(x)}return V},c.reject=function(V,x){V.state=l,V.outcome=x;for(var O=-1,k=V.queue.length;++O<k;)V.queue[O].callRejected(x);return V};function b(V){var x=V&&V.then;if(V&&(typeof V=="object"||typeof V=="function")&&typeof x=="function")return function(){x.apply(V,arguments)}}function y(V,x){var O=!1;function k(ie){O||(O=!0,c.reject(V,ie))}function D(ie){O||(O=!0,c.resolve(V,ie))}function M(){x(D,k)}var re=v(M);re.status==="error"&&k(re.value)}function v(V,x){var O={};try{O.value=V(x),O.status="success"}catch(k){O.status="error",O.value=k}return O}g.resolve=H;function H(V){return V instanceof this?V:c.resolve(new this(a),V)}g.reject=F;function F(V){var x=new this(a);return c.reject(x,V)}g.all=Q;function Q(V){var x=this;if(Object.prototype.toString.call(V)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=V.length,k=!1;if(!O)return this.resolve([]);for(var D=new Array(O),M=0,re=-1,ie=new this(a);++re<O;)ue(V[re],re);return ie;function ue(X,K){x.resolve(X).then(T,function(P){k||(k=!0,c.reject(ie,P))});function T(P){D[K]=P,++M===O&&!k&&(k=!0,c.resolve(ie,D))}}}g.race=te;function te(V){var x=this;if(Object.prototype.toString.call(V)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=V.length,k=!1;if(!O)return this.resolve([]);for(var D=-1,M=new this(a);++D<O;)re(V[D]);return M;function re(ie){x.resolve(ie).then(function(ue){k||(k=!0,c.resolve(M,ue))},function(ue){k||(k=!0,c.reject(M,ue))})}}},{1:1}],3:[function(r,i,o){(function(s){"use strict";typeof s.Promise!="function"&&(s.Promise=r(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(r,i,o){"use strict";var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p};function a(p,C){if(!(p instanceof C))throw new TypeError("Cannot call a class as a function")}function c(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=c();function u(){try{if(!l||!l.open)return!1;var p=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),C=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!p||C)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(p,C){p=p||[],C=C||{};try{return new Blob(p,C)}catch(G){if(G.name!=="TypeError")throw G;for(var f=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,B=new f,A=0;A<p.length;A+=1)B.append(p[A]);return B.getBlob(C.type)}}typeof Promise>"u"&&r(3);var g=Promise;function m(p,C){C&&p.then(function(f){C(null,f)},function(f){C(f)})}function h(p,C,f){typeof C=="function"&&p.then(C),typeof f=="function"&&p.catch(f)}function b(p){return typeof p!="string"&&(console.warn(p+" used as a key, but it is not a string."),p=String(p)),p}function y(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var v="local-forage-detect-blob-support",H=void 0,F={},Q=Object.prototype.toString,te="readonly",V="readwrite";function x(p){for(var C=p.length,f=new ArrayBuffer(C),B=new Uint8Array(f),A=0;A<C;A++)B[A]=p.charCodeAt(A);return f}function O(p){return new g(function(C){var f=p.transaction(v,V),B=d([""]);f.objectStore(v).put(B,"key"),f.onabort=function(A){A.preventDefault(),A.stopPropagation(),C(!1)},f.oncomplete=function(){var A=navigator.userAgent.match(/Chrome\/(\d+)/),G=navigator.userAgent.match(/Edge\//);C(G||!A||parseInt(A[1],10)>=43)}}).catch(function(){return!1})}function k(p){return typeof H=="boolean"?g.resolve(H):O(p).then(function(C){return H=C,H})}function D(p){var C=F[p.name],f={};f.promise=new g(function(B,A){f.resolve=B,f.reject=A}),C.deferredOperations.push(f),C.dbReady?C.dbReady=C.dbReady.then(function(){return f.promise}):C.dbReady=f.promise}function M(p){var C=F[p.name],f=C.deferredOperations.pop();if(f)return f.resolve(),f.promise}function re(p,C){var f=F[p.name],B=f.deferredOperations.pop();if(B)return B.reject(C),B.promise}function ie(p,C){return new g(function(f,B){if(F[p.name]=F[p.name]||Hs(),p.db)if(C)D(p),p.db.close();else return f(p.db);var A=[p.name];C&&A.push(p.version);var G=l.open.apply(l,A);C&&(G.onupgradeneeded=function(W){var w=G.result;try{w.createObjectStore(p.storeName),W.oldVersion<=1&&w.createObjectStore(v)}catch(E){if(E.name==="ConstraintError")console.warn('The database "'+p.name+'" has been upgraded from version '+W.oldVersion+" to version "+W.newVersion+', but the storage "'+p.storeName+'" already exists.');else throw E}}),G.onerror=function(W){W.preventDefault(),B(G.error)},G.onsuccess=function(){var W=G.result;W.onversionchange=function(w){w.target.close()},f(W),M(p)}})}function ue(p){return ie(p,!1)}function X(p){return ie(p,!0)}function K(p,C){if(!p.db)return!0;var f=!p.db.objectStoreNames.contains(p.storeName),B=p.version<p.db.version,A=p.version>p.db.version;if(B&&(p.version!==C&&console.warn('The database "'+p.name+`" can't be downgraded from version `+p.db.version+" to version "+p.version+"."),p.version=p.db.version),A||f){if(f){var G=p.db.version+1;G>p.version&&(p.version=G)}return!0}return!1}function T(p){return new g(function(C,f){var B=new FileReader;B.onerror=f,B.onloadend=function(A){var G=btoa(A.target.result||"");C({__local_forage_encoded_blob:!0,data:G,type:p.type})},B.readAsBinaryString(p)})}function P(p){var C=x(atob(p.data));return d([C],{type:p.type})}function q(p){return p&&p.__local_forage_encoded_blob}function Bn(p){var C=this,f=C._initReady().then(function(){var B=F[C._dbInfo.name];if(B&&B.dbReady)return B.dbReady});return h(f,p,p),f}function SI(p){D(p);for(var C=F[p.name],f=C.forages,B=0;B<f.length;B++){var A=f[B];A._dbInfo.db&&(A._dbInfo.db.close(),A._dbInfo.db=null)}return p.db=null,ue(p).then(function(G){return p.db=G,K(p)?X(p):G}).then(function(G){p.db=C.db=G;for(var W=0;W<f.length;W++)f[W]._dbInfo.db=G}).catch(function(G){throw re(p,G),G})}function ln(p,C,f,B){B===void 0&&(B=1);try{var A=p.db.transaction(p.storeName,C);f(null,A)}catch(G){if(B>0&&(!p.db||G.name==="InvalidStateError"||G.name==="NotFoundError"))return g.resolve().then(function(){if(!p.db||G.name==="NotFoundError"&&!p.db.objectStoreNames.contains(p.storeName)&&p.version<=p.db.version)return p.db&&(p.version=p.db.version+1),X(p)}).then(function(){return SI(p).then(function(){ln(p,C,f,B-1)})}).catch(f);f(G)}}function Hs(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function WI(p){var C=this,f={db:null};if(p)for(var B in p)f[B]=p[B];var A=F[f.name];A||(A=Hs(),F[f.name]=A),A.forages.push(C),C._initReady||(C._initReady=C.ready,C.ready=Bn);var G=[];function W(){return g.resolve()}for(var w=0;w<A.forages.length;w++){var E=A.forages[w];E!==C&&G.push(E._initReady().catch(W))}var Y=A.forages.slice(0);return g.all(G).then(function(){return f.db=A.db,ue(f)}).then(function(_){return f.db=_,K(f,C._defaultConfig.version)?X(f):_}).then(function(_){f.db=A.db=_,C._dbInfo=f;for(var L=0;L<Y.length;L++){var $=Y[L];$!==C&&($._dbInfo.db=f.db,$._dbInfo.version=f.version)}})}function lx(p,C){var f=this;p=b(p);var B=new g(function(A,G){f.ready().then(function(){ln(f._dbInfo,te,function(W,w){if(W)return G(W);try{var E=w.objectStore(f._dbInfo.storeName),Y=E.get(p);Y.onsuccess=function(){var _=Y.result;_===void 0&&(_=null),q(_)&&(_=P(_)),A(_)},Y.onerror=function(){G(Y.error)}}catch(_){G(_)}})}).catch(G)});return m(B,C),B}function gx(p,C){var f=this,B=new g(function(A,G){f.ready().then(function(){ln(f._dbInfo,te,function(W,w){if(W)return G(W);try{var E=w.objectStore(f._dbInfo.storeName),Y=E.openCursor(),_=1;Y.onsuccess=function(){var L=Y.result;if(L){var $=L.value;q($)&&($=P($));var le=p($,L.key,_++);le!==void 0?A(le):L.continue()}else A()},Y.onerror=function(){G(Y.error)}}catch(L){G(L)}})}).catch(G)});return m(B,C),B}function dx(p,C,f){var B=this;p=b(p);var A=new g(function(G,W){var w;B.ready().then(function(){return w=B._dbInfo,Q.call(C)==="[object Blob]"?k(w.db).then(function(E){return E?C:T(C)}):C}).then(function(E){ln(B._dbInfo,V,function(Y,_){if(Y)return W(Y);try{var L=_.objectStore(B._dbInfo.storeName);E===null&&(E=void 0);var $=L.put(E,p);_.oncomplete=function(){E===void 0&&(E=null),G(E)},_.onabort=_.onerror=function(){var le=$.error?$.error:$.transaction.error;W(le)}}catch(le){W(le)}})}).catch(W)});return m(A,f),A}function Ix(p,C){var f=this;p=b(p);var B=new g(function(A,G){f.ready().then(function(){ln(f._dbInfo,V,function(W,w){if(W)return G(W);try{var E=w.objectStore(f._dbInfo.storeName),Y=E.delete(p);w.oncomplete=function(){A()},w.onerror=function(){G(Y.error)},w.onabort=function(){var _=Y.error?Y.error:Y.transaction.error;G(_)}}catch(_){G(_)}})}).catch(G)});return m(B,C),B}function mx(p){var C=this,f=new g(function(B,A){C.ready().then(function(){ln(C._dbInfo,V,function(G,W){if(G)return A(G);try{var w=W.objectStore(C._dbInfo.storeName),E=w.clear();W.oncomplete=function(){B()},W.onabort=W.onerror=function(){var Y=E.error?E.error:E.transaction.error;A(Y)}}catch(Y){A(Y)}})}).catch(A)});return m(f,p),f}function px(p){var C=this,f=new g(function(B,A){C.ready().then(function(){ln(C._dbInfo,te,function(G,W){if(G)return A(G);try{var w=W.objectStore(C._dbInfo.storeName),E=w.count();E.onsuccess=function(){B(E.result)},E.onerror=function(){A(E.error)}}catch(Y){A(Y)}})}).catch(A)});return m(f,p),f}function fx(p,C){var f=this,B=new g(function(A,G){if(p<0){A(null);return}f.ready().then(function(){ln(f._dbInfo,te,function(W,w){if(W)return G(W);try{var E=w.objectStore(f._dbInfo.storeName),Y=!1,_=E.openKeyCursor();_.onsuccess=function(){var L=_.result;if(!L){A(null);return}p===0||Y?A(L.key):(Y=!0,L.advance(p))},_.onerror=function(){G(_.error)}}catch(L){G(L)}})}).catch(G)});return m(B,C),B}function hx(p){var C=this,f=new g(function(B,A){C.ready().then(function(){ln(C._dbInfo,te,function(G,W){if(G)return A(G);try{var w=W.objectStore(C._dbInfo.storeName),E=w.openKeyCursor(),Y=[];E.onsuccess=function(){var _=E.result;if(!_){B(Y);return}Y.push(_.key),_.continue()},E.onerror=function(){A(E.error)}}catch(_){A(_)}})}).catch(A)});return m(f,p),f}function Cx(p,C){C=y.apply(this,arguments);var f=this.config();p=typeof p!="function"&&p||{},p.name||(p.name=p.name||f.name,p.storeName=p.storeName||f.storeName);var B=this,A;if(!p.name)A=g.reject("Invalid arguments");else{var G=p.name===f.name&&B._dbInfo.db,W=G?g.resolve(B._dbInfo.db):ue(p).then(function(w){var E=F[p.name],Y=E.forages;E.db=w;for(var _=0;_<Y.length;_++)Y[_]._dbInfo.db=w;return w});p.storeName?A=W.then(function(w){if(w.objectStoreNames.contains(p.storeName)){var E=w.version+1;D(p);var Y=F[p.name],_=Y.forages;w.close();for(var L=0;L<_.length;L++){var $=_[L];$._dbInfo.db=null,$._dbInfo.version=E}var le=new g(function(Ie,Ne){var Se=l.open(p.name,E);Se.onerror=function(zt){var Xs=Se.result;Xs.close(),Ne(zt)},Se.onupgradeneeded=function(){var zt=Se.result;zt.deleteObjectStore(p.storeName)},Se.onsuccess=function(){var zt=Se.result;zt.close(),Ie(zt)}});return le.then(function(Ie){Y.db=Ie;for(var Ne=0;Ne<_.length;Ne++){var Se=_[Ne];Se._dbInfo.db=Ie,M(Se._dbInfo)}}).catch(function(Ie){throw(re(p,Ie)||g.resolve()).catch(function(){}),Ie})}}):A=W.then(function(w){D(p);var E=F[p.name],Y=E.forages;w.close();for(var _=0;_<Y.length;_++){var L=Y[_];L._dbInfo.db=null}var $=new g(function(le,Ie){var Ne=l.deleteDatabase(p.name);Ne.onerror=function(){var Se=Ne.result;Se&&Se.close(),Ie(Ne.error)},Ne.onblocked=function(){console.warn('dropInstance blocked for database "'+p.name+'" until all open connections are closed')},Ne.onsuccess=function(){var Se=Ne.result;Se&&Se.close(),le(Se)}});return $.then(function(le){E.db=le;for(var Ie=0;Ie<Y.length;Ie++){var Ne=Y[Ie];M(Ne._dbInfo)}}).catch(function(le){throw(re(p,le)||g.resolve()).catch(function(){}),le})})}return m(A,C),A}var bx={_driver:"asyncStorage",_initStorage:WI,_support:u(),iterate:gx,getItem:lx,setItem:dx,removeItem:Ix,clear:mx,length:px,key:fx,keys:hx,dropInstance:Cx};function yx(){return typeof openDatabase=="function"}var vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Gx="~~local_forage_type~",AG=/^~~local_forage_type~([^~]+)~/,ru="__lfsc__:",RI=ru.length,VI="arbf",NI="blob",ZG="si08",vG="ui08",SG="uic8",WG="si16",RG="si32",VG="ur16",NG="ui32",wG="fl32",EG="fl64",HG=RI+VI.length,YG=Object.prototype.toString;function XG(p){var C=p.length*.75,f=p.length,B,A=0,G,W,w,E;p[p.length-1]==="="&&(C--,p[p.length-2]==="="&&C--);var Y=new ArrayBuffer(C),_=new Uint8Array(Y);for(B=0;B<f;B+=4)G=vr.indexOf(p[B]),W=vr.indexOf(p[B+1]),w=vr.indexOf(p[B+2]),E=vr.indexOf(p[B+3]),_[A++]=G<<2|W>>4,_[A++]=(W&15)<<4|w>>2,_[A++]=(w&3)<<6|E&63;return Y}function wI(p){var C=new Uint8Array(p),f="",B;for(B=0;B<C.length;B+=3)f+=vr[C[B]>>2],f+=vr[(C[B]&3)<<4|C[B+1]>>4],f+=vr[(C[B+1]&15)<<2|C[B+2]>>6],f+=vr[C[B+2]&63];return C.length%3===2?f=f.substring(0,f.length-1)+"=":C.length%3===1&&(f=f.substring(0,f.length-2)+"=="),f}function Bx(p,C){var f="";if(p&&(f=YG.call(p)),p&&(f==="[object ArrayBuffer]"||p.buffer&&YG.call(p.buffer)==="[object ArrayBuffer]")){var B,A=ru;p instanceof ArrayBuffer?(B=p,A+=VI):(B=p.buffer,f==="[object Int8Array]"?A+=ZG:f==="[object Uint8Array]"?A+=vG:f==="[object Uint8ClampedArray]"?A+=SG:f==="[object Int16Array]"?A+=WG:f==="[object Uint16Array]"?A+=VG:f==="[object Int32Array]"?A+=RG:f==="[object Uint32Array]"?A+=NG:f==="[object Float32Array]"?A+=wG:f==="[object Float64Array]"?A+=EG:C(new Error("Failed to get type for BinaryArray"))),C(A+wI(B))}else if(f==="[object Blob]"){var G=new FileReader;G.onload=function(){var W=Gx+p.type+"~"+wI(this.result);C(ru+NI+W)},G.readAsArrayBuffer(p)}else try{C(JSON.stringify(p))}catch(W){console.error("Couldn't convert value into a JSON string: ",p),C(null,W)}}function Ax(p){if(p.substring(0,RI)!==ru)return JSON.parse(p);var C=p.substring(HG),f=p.substring(RI,HG),B;if(f===NI&&AG.test(C)){var A=C.match(AG);B=A[1],C=C.substring(A[0].length)}var G=XG(C);switch(f){case VI:return G;case NI:return d([G],{type:B});case ZG:return new Int8Array(G);case vG:return new Uint8Array(G);case SG:return new Uint8ClampedArray(G);case WG:return new Int16Array(G);case VG:return new Uint16Array(G);case RG:return new Int32Array(G);case NG:return new Uint32Array(G);case wG:return new Float32Array(G);case EG:return new Float64Array(G);default:throw new Error("Unkown type: "+f)}}var EI={serialize:Bx,deserialize:Ax,stringToBuffer:XG,bufferToString:wI};function _G(p,C,f,B){p.executeSql("CREATE TABLE IF NOT EXISTS "+C.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],f,B)}function Zx(p){var C=this,f={db:null};if(p)for(var B in p)f[B]=typeof p[B]!="string"?p[B].toString():p[B];var A=new g(function(G,W){try{f.db=openDatabase(f.name,String(f.version),f.description,f.size)}catch(w){return W(w)}f.db.transaction(function(w){_G(w,f,function(){C._dbInfo=f,G()},function(E,Y){W(Y)})},W)});return f.serializer=EI,A}function Sr(p,C,f,B,A,G){p.executeSql(f,B,A,function(W,w){w.code===w.SYNTAX_ERR?W.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[C.storeName],function(E,Y){Y.rows.length?G(E,w):_G(E,C,function(){E.executeSql(f,B,A,G)},G)},G):G(W,w)},G)}function vx(p,C){var f=this;p=b(p);var B=new g(function(A,G){f.ready().then(function(){var W=f._dbInfo;W.db.transaction(function(w){Sr(w,W,"SELECT * FROM "+W.storeName+" WHERE key = ? LIMIT 1",[p],function(E,Y){var _=Y.rows.length?Y.rows.item(0).value:null;_&&(_=W.serializer.deserialize(_)),A(_)},function(E,Y){G(Y)})})}).catch(G)});return m(B,C),B}function Sx(p,C){var f=this,B=new g(function(A,G){f.ready().then(function(){var W=f._dbInfo;W.db.transaction(function(w){Sr(w,W,"SELECT * FROM "+W.storeName,[],function(E,Y){for(var _=Y.rows,L=_.length,$=0;$<L;$++){var le=_.item($),Ie=le.value;if(Ie&&(Ie=W.serializer.deserialize(Ie)),Ie=p(Ie,le.key,$+1),Ie!==void 0){A(Ie);return}}A()},function(E,Y){G(Y)})})}).catch(G)});return m(B,C),B}function FG(p,C,f,B){var A=this;p=b(p);var G=new g(function(W,w){A.ready().then(function(){C===void 0&&(C=null);var E=C,Y=A._dbInfo;Y.serializer.serialize(C,function(_,L){L?w(L):Y.db.transaction(function($){Sr($,Y,"INSERT OR REPLACE INTO "+Y.storeName+" (key, value) VALUES (?, ?)",[p,_],function(){W(E)},function(le,Ie){w(Ie)})},function($){if($.code===$.QUOTA_ERR){if(B>0){W(FG.apply(A,[p,E,f,B-1]));return}w($)}})})}).catch(w)});return m(G,f),G}function Wx(p,C,f){return FG.apply(this,[p,C,f,1])}function Rx(p,C){var f=this;p=b(p);var B=new g(function(A,G){f.ready().then(function(){var W=f._dbInfo;W.db.transaction(function(w){Sr(w,W,"DELETE FROM "+W.storeName+" WHERE key = ?",[p],function(){A()},function(E,Y){G(Y)})})}).catch(G)});return m(B,C),B}function Vx(p){var C=this,f=new g(function(B,A){C.ready().then(function(){var G=C._dbInfo;G.db.transaction(function(W){Sr(W,G,"DELETE FROM "+G.storeName,[],function(){B()},function(w,E){A(E)})})}).catch(A)});return m(f,p),f}function Nx(p){var C=this,f=new g(function(B,A){C.ready().then(function(){var G=C._dbInfo;G.db.transaction(function(W){Sr(W,G,"SELECT COUNT(key) as c FROM "+G.storeName,[],function(w,E){var Y=E.rows.item(0).c;B(Y)},function(w,E){A(E)})})}).catch(A)});return m(f,p),f}function wx(p,C){var f=this,B=new g(function(A,G){f.ready().then(function(){var W=f._dbInfo;W.db.transaction(function(w){Sr(w,W,"SELECT key FROM "+W.storeName+" WHERE id = ? LIMIT 1",[p+1],function(E,Y){var _=Y.rows.length?Y.rows.item(0).key:null;A(_)},function(E,Y){G(Y)})})}).catch(G)});return m(B,C),B}function Ex(p){var C=this,f=new g(function(B,A){C.ready().then(function(){var G=C._dbInfo;G.db.transaction(function(W){Sr(W,G,"SELECT key FROM "+G.storeName,[],function(w,E){for(var Y=[],_=0;_<E.rows.length;_++)Y.push(E.rows.item(_).key);B(Y)},function(w,E){A(E)})})}).catch(A)});return m(f,p),f}function Hx(p){return new g(function(C,f){p.transaction(function(B){B.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(A,G){for(var W=[],w=0;w<G.rows.length;w++)W.push(G.rows.item(w).name);C({db:p,storeNames:W})},function(A,G){f(G)})},function(B){f(B)})})}function Yx(p,C){C=y.apply(this,arguments);var f=this.config();p=typeof p!="function"&&p||{},p.name||(p.name=p.name||f.name,p.storeName=p.storeName||f.storeName);var B=this,A;return p.name?A=new g(function(G){var W;p.name===f.name?W=B._dbInfo.db:W=openDatabase(p.name,"","",0),p.storeName?G({db:W,storeNames:[p.storeName]}):G(Hx(W))}).then(function(G){return new g(function(W,w){G.db.transaction(function(E){function Y(le){return new g(function(Ie,Ne){E.executeSql("DROP TABLE IF EXISTS "+le,[],function(){Ie()},function(Se,zt){Ne(zt)})})}for(var _=[],L=0,$=G.storeNames.length;L<$;L++)_.push(Y(G.storeNames[L]));g.all(_).then(function(){W()}).catch(function(le){w(le)})},function(E){w(E)})})}):A=g.reject("Invalid arguments"),m(A,C),A}var Xx={_driver:"webSQLStorage",_initStorage:Zx,_support:yx(),iterate:Sx,getItem:vx,setItem:Wx,removeItem:Rx,clear:Vx,length:Nx,key:wx,keys:Ex,dropInstance:Yx};function _x(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function TG(p,C){var f=p.name+"/";return p.storeName!==C.storeName&&(f+=p.storeName+"/"),f}function Fx(){var p="_localforage_support_test";try{return localStorage.setItem(p,!0),localStorage.removeItem(p),!1}catch{return!0}}function Tx(){return!Fx()||localStorage.length>0}function kx(p){var C=this,f={};if(p)for(var B in p)f[B]=p[B];return f.keyPrefix=TG(p,C._defaultConfig),Tx()?(C._dbInfo=f,f.serializer=EI,g.resolve()):g.reject()}function Kx(p){var C=this,f=C.ready().then(function(){for(var B=C._dbInfo.keyPrefix,A=localStorage.length-1;A>=0;A--){var G=localStorage.key(A);G.indexOf(B)===0&&localStorage.removeItem(G)}});return m(f,p),f}function Ux(p,C){var f=this;p=b(p);var B=f.ready().then(function(){var A=f._dbInfo,G=localStorage.getItem(A.keyPrefix+p);return G&&(G=A.serializer.deserialize(G)),G});return m(B,C),B}function xx(p,C){var f=this,B=f.ready().then(function(){for(var A=f._dbInfo,G=A.keyPrefix,W=G.length,w=localStorage.length,E=1,Y=0;Y<w;Y++){var _=localStorage.key(Y);if(_.indexOf(G)===0){var L=localStorage.getItem(_);if(L&&(L=A.serializer.deserialize(L)),L=p(L,_.substring(W),E++),L!==void 0)return L}}});return m(B,C),B}function Lx(p,C){var f=this,B=f.ready().then(function(){var A=f._dbInfo,G;try{G=localStorage.key(p)}catch{G=null}return G&&(G=G.substring(A.keyPrefix.length)),G});return m(B,C),B}function Jx(p){var C=this,f=C.ready().then(function(){for(var B=C._dbInfo,A=localStorage.length,G=[],W=0;W<A;W++){var w=localStorage.key(W);w.indexOf(B.keyPrefix)===0&&G.push(w.substring(B.keyPrefix.length))}return G});return m(f,p),f}function zx(p){var C=this,f=C.keys().then(function(B){return B.length});return m(f,p),f}function Ox(p,C){var f=this;p=b(p);var B=f.ready().then(function(){var A=f._dbInfo;localStorage.removeItem(A.keyPrefix+p)});return m(B,C),B}function Dx(p,C,f){var B=this;p=b(p);var A=B.ready().then(function(){C===void 0&&(C=null);var G=C;return new g(function(W,w){var E=B._dbInfo;E.serializer.serialize(C,function(Y,_){if(_)w(_);else try{localStorage.setItem(E.keyPrefix+p,Y),W(G)}catch(L){(L.name==="QuotaExceededError"||L.name==="NS_ERROR_DOM_QUOTA_REACHED")&&w(L),w(L)}})})});return m(A,f),A}function qx(p,C){if(C=y.apply(this,arguments),p=typeof p!="function"&&p||{},!p.name){var f=this.config();p.name=p.name||f.name,p.storeName=p.storeName||f.storeName}var B=this,A;return p.name?A=new g(function(G){p.storeName?G(TG(p,B._defaultConfig)):G(p.name+"/")}).then(function(G){for(var W=localStorage.length-1;W>=0;W--){var w=localStorage.key(W);w.indexOf(G)===0&&localStorage.removeItem(w)}}):A=g.reject("Invalid arguments"),m(A,C),A}var Mx={_driver:"localStorageWrapper",_initStorage:kx,_support:_x(),iterate:xx,getItem:Ux,setItem:Dx,removeItem:Ox,clear:Kx,length:zx,key:Lx,keys:Jx,dropInstance:qx},jx=function(C,f){return C===f||typeof C=="number"&&typeof f=="number"&&isNaN(C)&&isNaN(f)},Px=function(C,f){for(var B=C.length,A=0;A<B;){if(jx(C[A],f))return!0;A++}return!1},kG=Array.isArray||function(p){return Object.prototype.toString.call(p)==="[object Array]"},Ys={},KG={},Co={INDEXEDDB:bx,WEBSQL:Xx,LOCALSTORAGE:Mx},Qx=[Co.INDEXEDDB._driver,Co.WEBSQL._driver,Co.LOCALSTORAGE._driver],iu=["dropInstance"],HI=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(iu),$x={description:"",driver:Qx.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function eL(p,C){p[C]=function(){var f=arguments;return p.ready().then(function(){return p[C].apply(p,f)})}}function YI(){for(var p=1;p<arguments.length;p++){var C=arguments[p];if(C)for(var f in C)C.hasOwnProperty(f)&&(kG(C[f])?arguments[0][f]=C[f].slice():arguments[0][f]=C[f])}return arguments[0]}var tL=function(){function p(C){a(this,p);for(var f in Co)if(Co.hasOwnProperty(f)){var B=Co[f],A=B._driver;this[f]=A,Ys[A]||this.defineDriver(B)}this._defaultConfig=YI({},$x),this._config=YI({},this._defaultConfig,C),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return p.prototype.config=function(f){if((typeof f>"u"?"undefined":s(f))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var B in f){if(B==="storeName"&&(f[B]=f[B].replace(/\W/g,"_")),B==="version"&&typeof f[B]!="number")return new Error("Database version must be a number.");this._config[B]=f[B]}return"driver"in f&&f.driver?this.setDriver(this._config.driver):!0}else return typeof f=="string"?this._config[f]:this._config},p.prototype.defineDriver=function(f,B,A){var G=new g(function(W,w){try{var E=f._driver,Y=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!f._driver){w(Y);return}for(var _=HI.concat("_initStorage"),L=0,$=_.length;L<$;L++){var le=_[L],Ie=!Px(iu,le);if((Ie||f[le])&&typeof f[le]!="function"){w(Y);return}}var Ne=function(){for(var Xs=function(iL){return function(){var oL=new Error("Method "+iL+" is not implemented by the current driver"),UG=g.reject(oL);return m(UG,arguments[arguments.length-1]),UG}},XI=0,rL=iu.length;XI<rL;XI++){var _I=iu[XI];f[_I]||(f[_I]=Xs(_I))}};Ne();var Se=function(Xs){Ys[E]&&console.info("Redefining LocalForage driver: "+E),Ys[E]=f,KG[E]=Xs,W()};"_support"in f?f._support&&typeof f._support=="function"?f._support().then(Se,w):Se(!!f._support):Se(!0)}catch(zt){w(zt)}});return h(G,B,A),G},p.prototype.driver=function(){return this._driver||null},p.prototype.getDriver=function(f,B,A){var G=Ys[f]?g.resolve(Ys[f]):g.reject(new Error("Driver not found."));return h(G,B,A),G},p.prototype.getSerializer=function(f){var B=g.resolve(EI);return h(B,f),B},p.prototype.ready=function(f){var B=this,A=B._driverSet.then(function(){return B._ready===null&&(B._ready=B._initDriver()),B._ready});return h(A,f,f),A},p.prototype.setDriver=function(f,B,A){var G=this;kG(f)||(f=[f]);var W=this._getSupportedDrivers(f);function w(){G._config.driver=G.driver()}function E(L){return G._extend(L),w(),G._ready=G._initStorage(G._config),G._ready}function Y(L){return function(){var $=0;function le(){for(;$<L.length;){var Ie=L[$];return $++,G._dbInfo=null,G._ready=null,G.getDriver(Ie).then(E).catch(le)}w();var Ne=new Error("No available storage method found.");return G._driverSet=g.reject(Ne),G._driverSet}return le()}}var _=this._driverSet!==null?this._driverSet.catch(function(){return g.resolve()}):g.resolve();return this._driverSet=_.then(function(){var L=W[0];return G._dbInfo=null,G._ready=null,G.getDriver(L).then(function($){G._driver=$._driver,w(),G._wrapLibraryMethodsWithReady(),G._initDriver=Y(W)})}).catch(function(){w();var L=new Error("No available storage method found.");return G._driverSet=g.reject(L),G._driverSet}),h(this._driverSet,B,A),this._driverSet},p.prototype.supports=function(f){return!!KG[f]},p.prototype._extend=function(f){YI(this,f)},p.prototype._getSupportedDrivers=function(f){for(var B=[],A=0,G=f.length;A<G;A++){var W=f[A];this.supports(W)&&B.push(W)}return B},p.prototype._wrapLibraryMethodsWithReady=function(){for(var f=0,B=HI.length;f<B;f++)eL(this,HI[f])},p.prototype.createInstance=function(f){return new p(f)},p}(),nL=new tL;i.exports=nL},{3:3}]},{},[4])(4)})});var AN=I(YC=>{"use strict";Object.defineProperty(YC,"__esModule",{value:!0});var xn=R(),B6=BN(),ji=sc(),Or=xn.GLOBAL_OBJ,rd=class e{static __initStatic(){this.id="Offline"}constructor(t={}){this.name=e.id,this.maxStoredEvents=t.maxStoredEvents||30,this.offlineEventStore=B6.createInstance({name:"sentry/offlineEventStore"})}setupOnce(t,n){this.hub=n(),"addEventListener"in Or&&Or.addEventListener("online",()=>{this._sendEvents().catch(()=>{ji.DEBUG_BUILD&&xn.logger.warn("could not send cached events")})});let r=i=>this.hub&&this.hub.getIntegration(e)&&"navigator"in Or&&"onLine"in Or.navigator&&!Or.navigator.onLine?(ji.DEBUG_BUILD&&xn.logger.log("Event dropped due to being a offline - caching instead"),this._cacheEvent(i).then(o=>this._enforceMaxEvents()).catch(o=>{ji.DEBUG_BUILD&&xn.logger.warn("could not cache event while offline")}),null):i;r.id=this.name,t(r),"navigator"in Or&&"onLine"in Or.navigator&&Or.navigator.onLine&&this._sendEvents().catch(()=>{ji.DEBUG_BUILD&&xn.logger.warn("could not send cached events")})}async _cacheEvent(t){return this.offlineEventStore.setItem(xn.uuid4(),xn.normalize(t))}async _enforceMaxEvents(){let t=[];return this.offlineEventStore.iterate((n,r,i)=>{t.push({cacheKey:r,event:n})}).then(()=>this._purgeEvents(t.sort((n,r)=>(r.event.timestamp||0)-(n.event.timestamp||0)).slice(this.maxStoredEvents<t.length?this.maxStoredEvents:t.length).map(n=>n.cacheKey))).catch(n=>{ji.DEBUG_BUILD&&xn.logger.warn("could not enforce max events")})}async _purgeEvent(t){return this.offlineEventStore.removeItem(t)}async _purgeEvents(t){return Promise.all(t.map(n=>this._purgeEvent(n))).then()}async _sendEvents(){return this.offlineEventStore.iterate((t,n,r)=>{this.hub?(this.hub.captureEvent(t),this._purgeEvent(n).catch(i=>{ji.DEBUG_BUILD&&xn.logger.warn("could not purge event from cache")})):ji.DEBUG_BUILD&&xn.logger.warn("no hub found - could not send cached event")})}};rd.__initStatic();YC.Offline=rd});var RN=I(id=>{"use strict";Object.defineProperty(id,"__esModule",{value:!0});var cc=j(),vN=R(),A6=vN.GLOBAL_OBJ,SN="ReportingObserver",ZN=new WeakMap,Z6=(e={})=>{let t=e.types||["crash","deprecation","intervention"];function n(r){if(ZN.has(cc.getClient()))for(let i of r)cc.withScope(o=>{o.setExtra("url",i.url);let s=`ReportingObserver [${i.type}]`,a="No details available";if(i.body){let c={};for(let l in i.body)c[l]=i.body[l];if(o.setExtra("body",c),i.type==="crash"){let l=i.body;a=[l.crashId||"",l.reason||""].join(" ").trim()||a}else a=i.body.message||a}cc.captureMessage(`${s}: ${a}`)})}return{name:SN,setupOnce(){if(!vN.supportsReportingObserver())return;new A6.ReportingObserver(n,{buffered:!0,types:t}).observe()},setup(r){ZN.set(r,!0)}}},WN=cc.defineIntegration(Z6),v6=cc.convertIntegrationFnToClass(SN,WN);id.ReportingObserver=v6;id.reportingObserverIntegration=WN});var HN=I(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});var NN=j(),VN=R(),wN="RewriteFrames",S6=(e={})=>{let t=e.root,n=e.prefix||"app:///",r=e.iteratee||(s=>{if(!s.filename)return s;let a=/^[a-zA-Z]:\\/.test(s.filename)||s.filename.includes("\\")&&!s.filename.includes("/"),c=/^\//.test(s.filename);if(a||c){let l=a?s.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):s.filename,u=t?VN.relative(t,l):VN.basename(l);s.filename=`${n}${u}`}return s});function i(s){try{return{...s,exception:{...s.exception,values:s.exception.values.map(a=>({...a,...a.stacktrace&&{stacktrace:o(a.stacktrace)}}))}}}catch{return s}}function o(s){return{...s,frames:s&&s.frames&&s.frames.map(a=>r(a))}}return{name:wN,setupOnce(){},processEvent(s){let a=s;return s.exception&&Array.isArray(s.exception.values)&&(a=i(a)),a}}},EN=NN.defineIntegration(S6),W6=NN.convertIntegrationFnToClass(wN,EN);od.RewriteFrames=W6;od.rewriteFramesIntegration=EN});var FN=I(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});var YN=j(),XN="SessionTiming",R6=()=>{let e=Date.now();return{name:XN,setupOnce(){},processEvent(t){let n=Date.now();return{...t,extra:{...t.extra,"session:start":e,"session:duration":n-e,"session:end":n}}}}},_N=YN.defineIntegration(R6),V6=YN.convertIntegrationFnToClass(XN,_N);sd.SessionTiming=V6;sd.sessionTimingIntegration=_N});var kN=I(XC=>{"use strict";Object.defineProperty(XC,"__esModule",{value:!0});var N6=j(),TN="Transaction",w6=()=>({name:TN,setupOnce(){},processEvent(e){let t=H6(e);for(let n=t.length-1;n>=0;n--){let r=t[n];if(r.in_app===!0){e.transaction=Y6(r);break}}return e}}),E6=N6.convertIntegrationFnToClass(TN,w6);function H6(e){let t=e.exception&&e.exception.values&&e.exception.values[0];return t&&t.stacktrace&&t.stacktrace.frames||[]}function Y6(e){return e.module||e.function?`${e.module||"?"}/${e.function||"?"}`:"<unknown>"}XC.Transaction=E6});var ON=I(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});var hr=j(),Ln=R(),ad=sc(),KN="HttpClient",X6=(e={})=>{let t={failedRequestStatusCodes:[[500,599]],failedRequestTargets:[/.*/],...e};return{name:KN,setupOnce(){},setup(n){J6(n,t),z6(n,t)}}},UN=hr.defineIntegration(X6),_6=hr.convertIntegrationFnToClass(KN,UN);function F6(e,t,n,r){if(LN(e,n.status,n.url)){let i=O6(t,r),o,s,a,c;zN()&&([{headers:o,cookies:a},{headers:s,cookies:c}]=[{cookieHeader:"Cookie",obj:i},{cookieHeader:"Set-Cookie",obj:n}].map(({cookieHeader:u,obj:d})=>{let g=K6(d.headers),m;try{let h=g[u]||g[u.toLowerCase()]||void 0;h&&(m=xN(h))}catch{ad.DEBUG_BUILD&&Ln.logger.log(`Could not extract cookies from header ${u}`)}return{headers:g,cookies:m}}));let l=JN({url:i.url,method:i.method,status:n.status,requestHeaders:o,responseHeaders:s,requestCookies:a,responseCookies:c});hr.captureEvent(l)}}function T6(e,t,n,r){if(LN(e,t.status,t.responseURL)){let i,o,s;if(zN()){try{let c=t.getResponseHeader("Set-Cookie")||t.getResponseHeader("set-cookie")||void 0;c&&(o=xN(c))}catch{ad.DEBUG_BUILD&&Ln.logger.log("Could not extract cookies from response headers")}try{s=U6(t)}catch{ad.DEBUG_BUILD&&Ln.logger.log("Could not extract headers from response")}i=r}let a=JN({url:t.responseURL,method:n,status:t.status,requestHeaders:i,responseHeaders:s,responseCookies:o});hr.captureEvent(a)}}function k6(e){if(e){let t=e["Content-Length"]||e["content-length"];if(t)return parseInt(t,10)}}function xN(e){return e.split("; ").reduce((t,n)=>{let[r,i]=n.split("=");return t[r]=i,t},{})}function K6(e){let t={};return e.forEach((n,r)=>{t[r]=n}),t}function U6(e){let t=e.getAllResponseHeaders();return t?t.split(`\r
`).reduce((n,r)=>{let[i,o]=r.split(": ");return n[i]=o,n},{}):{}}function x6(e,t){return e.some(n=>typeof n=="string"?t.includes(n):n.test(t))}function L6(e,t){return e.some(n=>typeof n=="number"?n===t:t>=n[0]&&t<=n[1])}function J6(e,t){Ln.supportsNativeFetch()&&Ln.addFetchInstrumentationHandler(n=>{if(hr.getClient()!==e)return;let{response:r,args:i}=n,[o,s]=i;r&&F6(t,o,r,s)})}function z6(e,t){"XMLHttpRequest"in Ln.GLOBAL_OBJ&&Ln.addXhrInstrumentationHandler(n=>{if(hr.getClient()!==e)return;let r=n.xhr,i=r[Ln.SENTRY_XHR_DATA_KEY];if(!i)return;let{method:o,request_headers:s}=i;try{T6(t,r,o,s)}catch(a){ad.DEBUG_BUILD&&Ln.logger.warn("Error while extracting response event form XHR response",a)}})}function LN(e,t,n){return L6(e.failedRequestStatusCodes,t)&&x6(e.failedRequestTargets,n)&&!hr.isSentryRequestUrl(n,hr.getClient())}function JN(e){let t=`HTTP Client Error with status code: ${e.status}`,n={message:t,exception:{values:[{type:"Error",value:t}]},request:{url:e.url,method:e.method,headers:e.requestHeaders,cookies:e.requestCookies},contexts:{response:{status_code:e.status,headers:e.responseHeaders,cookies:e.responseCookies,body_size:k6(e.responseHeaders)}}};return Ln.addExceptionMechanism(n,{type:"http.client",handled:!1}),n}function O6(e,t){return!t&&e instanceof Request||e instanceof Request&&e.bodyUsed?e:new Request(e,t)}function zN(){let e=hr.getClient();return e?!!e.getOptions().sendDefaultPii:!1}cd.HttpClient=_6;cd.httpClientIntegration=UN});var PN=I(uc=>{"use strict";Object.defineProperty(uc,"__esModule",{value:!0});var DN=j(),FC=R(),_C=FC.GLOBAL_OBJ,D6=7,qN="ContextLines",q6=(e={})=>{let t=e.frameContextLines!=null?e.frameContextLines:D6;return{name:qN,setupOnce(){},processEvent(n){return j6(n,t)}}},MN=DN.defineIntegration(q6),M6=DN.convertIntegrationFnToClass(qN,MN);function j6(e,t){let n=_C.document,r=_C.location&&FC.stripUrlQueryAndFragment(_C.location.href);if(!n||!r)return e;let i=e.exception&&e.exception.values;if(!i||!i.length)return e;let o=n.documentElement.innerHTML;if(!o)return e;let s=["<!DOCTYPE html>","<html>",...o.split(`
`),"</html>"];return i.forEach(a=>{let c=a.stacktrace;c&&c.frames&&(c.frames=c.frames.map(l=>jN(l,s,r,t)))}),e}function jN(e,t,n,r){return e.filename!==n||!e.lineno||!t.length||FC.addContextToFrame(t,e,r),e}uc.ContextLines=M6;uc.applySourceContextToFrame=jN;uc.contextLinesIntegration=MN});var a2=I(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});var QN=rN(),$N=aN(),e2=fN(),t2=yN(),P6=AN(),n2=RN(),r2=HN(),i2=FN(),Q6=kN(),o2=ON(),s2=PN();Ae.CaptureConsole=QN.CaptureConsole;Ae.captureConsoleIntegration=QN.captureConsoleIntegration;Ae.Debug=$N.Debug;Ae.debugIntegration=$N.debugIntegration;Ae.Dedupe=e2.Dedupe;Ae.dedupeIntegration=e2.dedupeIntegration;Ae.ExtraErrorData=t2.ExtraErrorData;Ae.extraErrorDataIntegration=t2.extraErrorDataIntegration;Ae.Offline=P6.Offline;Ae.ReportingObserver=n2.ReportingObserver;Ae.reportingObserverIntegration=n2.reportingObserverIntegration;Ae.RewriteFrames=r2.RewriteFrames;Ae.rewriteFramesIntegration=r2.rewriteFramesIntegration;Ae.SessionTiming=i2.SessionTiming;Ae.sessionTimingIntegration=i2.sessionTimingIntegration;Ae.Transaction=Q6.Transaction;Ae.HttpClient=o2.HttpClient;Ae.httpClientIntegration=o2.httpClientIntegration;Ae.ContextLines=s2.ContextLines;Ae.contextLinesIntegration=s2.contextLinesIntegration});var ud=I(TC=>{"use strict";Object.defineProperty(TC,"__esModule",{value:!0});var $6=[["january","1"],["february","2"],["march","3"],["april","4"],["may","5"],["june","6"],["july","7"],["august","8"],["september","9"],["october","10"],["november","11"],["december","12"],["jan","1"],["feb","2"],["mar","3"],["apr","4"],["may","5"],["jun","6"],["jul","7"],["aug","8"],["sep","9"],["oct","10"],["nov","11"],["dec","12"],["sunday","0"],["monday","1"],["tuesday","2"],["wednesday","3"],["thursday","4"],["friday","5"],["saturday","6"],["sun","0"],["mon","1"],["tue","2"],["wed","3"],["thu","4"],["fri","5"],["sat","6"]];function eee(e){return $6.reduce((t,[n,r])=>t.replace(new RegExp(n,"gi"),r),e)}TC.replaceCronNames=eee});var g2=I(kC=>{"use strict";Object.defineProperty(kC,"__esModule",{value:!0});var c2=j(),u2=ud(),l2="Automatic instrumentation of CronJob only supports crontab string";function tee(e,t){let n=!1;return new Proxy(e,{construct(r,i){let[o,s,a,c,l,...u]=i;if(typeof o!="string")throw new Error(l2);if(n)throw new Error(`A job named '${t}' has already been scheduled`);n=!0;let d=u2.replaceCronNames(o);function g(m,h){return c2.withMonitor(t,()=>s(m,h),{schedule:{type:"crontab",value:d},timezone:l||void 0})}return new r(o,g,a,c,l,...u)},get(r,i){return i==="from"?o=>{let{cronTime:s,onTick:a,timeZone:c}=o;if(typeof s!="string")throw new Error(l2);if(n)throw new Error(`A job named '${t}' has already been scheduled`);n=!0;let l=u2.replaceCronNames(s);return o.onTick=(u,d)=>c2.withMonitor(t,()=>a(u,d),{schedule:{type:"crontab",value:l},timezone:c||void 0}),r.from(o)}:r[i]}})}kC.instrumentCron=tee});var I2=I(KC=>{"use strict";var{_optionalChain:d2}=R();Object.defineProperty(KC,"__esModule",{value:!0});var nee=j(),ree=ud();function iee(e){return new Proxy(e,{get(t,n){return n==="schedule"&&t.schedule?new Proxy(t.schedule,{apply(r,i,o){let[s,,a]=o;if(!d2([a,"optionalAccess",c=>c.name]))throw new Error('Missing "name" for scheduled job. A name is required for Sentry check-in monitoring.');return nee.withMonitor(a.name,()=>r.apply(i,o),{schedule:{type:"crontab",value:ree.replaceCronNames(s)},timezone:d2([a,"optionalAccess",c=>c.timezone])})}}):t[n]}})}KC.instrumentNodeCron=iee});var m2=I(UC=>{"use strict";Object.defineProperty(UC,"__esModule",{value:!0});var oee=j(),see=ud();function aee(e){return new Proxy(e,{get(t,n){return n==="scheduleJob"?new Proxy(t.scheduleJob,{apply(r,i,o){let[s,a]=o;if(typeof s!="string"||typeof a!="string")throw new Error("Automatic instrumentation of 'node-schedule' requires the first parameter of 'scheduleJob' to be a job name string and the second parameter to be a crontab string");let c=s,l=a;return oee.withMonitor(c,()=>r.apply(i,o),{schedule:{type:"crontab",value:see.replaceCronNames(l)}})}}):t[n]}})}UC.instrumentNodeSchedule=aee});var ld=I(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});var U=j(),cee=yR(),uee=Mh(),lee=nC(),lc=AC(),xC=R(),gee=HV(),p2=BC(),dee=KV(),Iee=OV(),mee=$V(),pee=eN(),Dr=a2(),fee=Wg(),hee=Ug(),Cee=Lg(),bee=Tg(),yee=wg(),Gee=Rg(),Bee=_g(),Aee=Jg(),Zee=jg(),f2=wC(),h2=Og(),C2=Eg(),vee=NC(),See=g2(),Wee=I2(),Ree=m2(),Vee=p2.createGetModuleFromFilename(),Nee={...U.Integrations,...mee,...pee},wee={instrumentCron:See.instrumentCron,instrumentNodeCron:Wee.instrumentNodeCron,instrumentNodeSchedule:Ree.instrumentNodeSchedule};N.Hub=U.Hub;N.SDK_VERSION=U.SDK_VERSION;N.SEMANTIC_ATTRIBUTE_SENTRY_OP=U.SEMANTIC_ATTRIBUTE_SENTRY_OP;N.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=U.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN;N.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=U.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE;N.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=U.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE;N.Scope=U.Scope;N.addBreadcrumb=U.addBreadcrumb;N.addEventProcessor=U.addEventProcessor;N.addGlobalEventProcessor=U.addGlobalEventProcessor;N.addIntegration=U.addIntegration;N.captureCheckIn=U.captureCheckIn;N.captureEvent=U.captureEvent;N.captureException=U.captureException;N.captureMessage=U.captureMessage;N.captureSession=U.captureSession;N.close=U.close;N.configureScope=U.configureScope;N.continueTrace=U.continueTrace;N.createTransport=U.createTransport;N.endSession=U.endSession;N.extractTraceparentData=U.extractTraceparentData;N.flush=U.flush;N.functionToStringIntegration=U.functionToStringIntegration;N.getActiveSpan=U.getActiveSpan;N.getActiveTransaction=U.getActiveTransaction;N.getClient=U.getClient;N.getCurrentHub=U.getCurrentHub;N.getCurrentScope=U.getCurrentScope;N.getGlobalScope=U.getGlobalScope;N.getHubFromCarrier=U.getHubFromCarrier;N.getIsolationScope=U.getIsolationScope;N.getSpanStatusFromHttpCode=U.getSpanStatusFromHttpCode;N.inboundFiltersIntegration=U.inboundFiltersIntegration;N.isInitialized=U.isInitialized;N.lastEventId=U.lastEventId;N.linkedErrorsIntegration=U.linkedErrorsIntegration;N.makeMain=U.makeMain;N.metrics=U.metrics;N.parameterize=U.parameterize;N.requestDataIntegration=U.requestDataIntegration;N.runWithAsyncContext=U.runWithAsyncContext;N.setContext=U.setContext;N.setCurrentClient=U.setCurrentClient;N.setExtra=U.setExtra;N.setExtras=U.setExtras;N.setHttpStatus=U.setHttpStatus;N.setMeasurement=U.setMeasurement;N.setTag=U.setTag;N.setTags=U.setTags;N.setUser=U.setUser;N.spanStatusfromHttpCode=U.spanStatusfromHttpCode;N.startActiveSpan=U.startActiveSpan;N.startInactiveSpan=U.startInactiveSpan;N.startSession=U.startSession;N.startSpan=U.startSpan;N.startSpanManual=U.startSpanManual;N.startTransaction=U.startTransaction;N.trace=U.trace;N.withActiveSpan=U.withActiveSpan;N.withIsolationScope=U.withIsolationScope;N.withMonitor=U.withMonitor;N.withScope=U.withScope;N.autoDiscoverNodePerformanceMonitoringIntegrations=cee.autoDiscoverNodePerformanceMonitoringIntegrations;N.NodeClient=uee.NodeClient;N.makeNodeTransport=lee.makeNodeTransport;N.defaultIntegrations=lc.defaultIntegrations;N.defaultStackParser=lc.defaultStackParser;N.getDefaultIntegrations=lc.getDefaultIntegrations;N.getSentryRelease=lc.getSentryRelease;N.init=lc.init;N.DEFAULT_USER_INCLUDES=xC.DEFAULT_USER_INCLUDES;N.addRequestDataToEvent=xC.addRequestDataToEvent;N.extractRequestData=xC.extractRequestData;N.deepReadDirSync=gee.deepReadDirSync;N.createGetModuleFromFilename=p2.createGetModuleFromFilename;N.enableAnrDetection=dee.enableAnrDetection;N.Handlers=Iee;N.captureConsoleIntegration=Dr.captureConsoleIntegration;N.debugIntegration=Dr.debugIntegration;N.dedupeIntegration=Dr.dedupeIntegration;N.extraErrorDataIntegration=Dr.extraErrorDataIntegration;N.httpClientIntegration=Dr.httpClientIntegration;N.reportingObserverIntegration=Dr.reportingObserverIntegration;N.rewriteFramesIntegration=Dr.rewriteFramesIntegration;N.sessionTimingIntegration=Dr.sessionTimingIntegration;N.consoleIntegration=fee.consoleIntegration;N.onUncaughtExceptionIntegration=hee.onUncaughtExceptionIntegration;N.onUnhandledRejectionIntegration=Cee.onUnhandledRejectionIntegration;N.modulesIntegration=bee.modulesIntegration;N.contextLinesIntegration=yee.contextLinesIntegration;N.nodeContextIntegration=Gee.nodeContextIntegration;N.localVariablesIntegration=Bee.localVariablesIntegration;N.spotlightIntegration=Aee.spotlightIntegration;N.anrIntegration=Zee.anrIntegration;N.hapiErrorPlugin=f2.hapiErrorPlugin;N.hapiIntegration=f2.hapiIntegration;N.Undici=h2.Undici;N.nativeNodeFetchintegration=h2.nativeNodeFetchintegration;N.Http=C2.Http;N.httpIntegration=C2.httpIntegration;N.trpcMiddleware=vee.trpcMiddleware;N.Integrations=Nee;N.cron=wee;N.getModuleFromFilename=Vee});function LC(){return gd>dd.length-16&&(b2.default.randomFillSync(dd),gd=0),dd.slice(gd,gd+=16)}var b2,dd,gd,y2=We(()=>{"use strict";b2=J(require("crypto")),dd=new Uint8Array(256),gd=dd.length});function G2(e,t=0){return De[e[t+0]]+De[e[t+1]]+De[e[t+2]]+De[e[t+3]]+"-"+De[e[t+4]]+De[e[t+5]]+"-"+De[e[t+6]]+De[e[t+7]]+"-"+De[e[t+8]]+De[e[t+9]]+"-"+De[e[t+10]]+De[e[t+11]]+De[e[t+12]]+De[e[t+13]]+De[e[t+14]]+De[e[t+15]]}var De,B2=We(()=>{"use strict";De=[];for(let e=0;e<256;++e)De.push((e+256).toString(16).slice(1))});var A2,JC,Z2=We(()=>{"use strict";A2=J(require("crypto")),JC={randomUUID:A2.default.randomUUID}});function Eee(e,t,n){if(JC.randomUUID&&!t&&!e)return JC.randomUUID();e=e||{};let r=e.random||(e.rng||LC)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return G2(r)}var Id,v2=We(()=>{"use strict";Z2();y2();B2();Id=Eee});var S2=We(()=>{"use strict";v2()});var W2=I((gpe,Hee)=>{Hee.exports=[{name:"Appcircle",constant:"APPCIRCLE",env:"AC_APPCIRCLE"},{name:"AppVeyor",constant:"APPVEYOR",env:"APPVEYOR",pr:"APPVEYOR_PULL_REQUEST_NUMBER"},{name:"AWS CodeBuild",constant:"CODEBUILD",env:"CODEBUILD_BUILD_ARN"},{name:"Azure Pipelines",constant:"AZURE_PIPELINES",env:"TF_BUILD",pr:{BUILD_REASON:"PullRequest"}},{name:"Bamboo",constant:"BAMBOO",env:"bamboo_planKey"},{name:"Bitbucket Pipelines",constant:"BITBUCKET",env:"BITBUCKET_COMMIT",pr:"BITBUCKET_PR_ID"},{name:"Bitrise",constant:"BITRISE",env:"BITRISE_IO",pr:"BITRISE_PULL_REQUEST"},{name:"Buddy",constant:"BUDDY",env:"BUDDY_WORKSPACE_ID",pr:"BUDDY_EXECUTION_PULL_REQUEST_ID"},{name:"Buildkite",constant:"BUILDKITE",env:"BUILDKITE",pr:{env:"BUILDKITE_PULL_REQUEST",ne:"false"}},{name:"CircleCI",constant:"CIRCLE",env:"CIRCLECI",pr:"CIRCLE_PULL_REQUEST"},{name:"Cirrus CI",constant:"CIRRUS",env:"CIRRUS_CI",pr:"CIRRUS_PR"},{name:"Codefresh",constant:"CODEFRESH",env:"CF_BUILD_ID",pr:{any:["CF_PULL_REQUEST_NUMBER","CF_PULL_REQUEST_ID"]}},{name:"Codemagic",constant:"CODEMAGIC",env:"CM_BUILD_ID",pr:"CM_PULL_REQUEST"},{name:"Codeship",constant:"CODESHIP",env:{CI_NAME:"codeship"}},{name:"Drone",constant:"DRONE",env:"DRONE",pr:{DRONE_BUILD_EVENT:"pull_request"}},{name:"dsari",constant:"DSARI",env:"DSARI"},{name:"Expo Application Services",constant:"EAS",env:"EAS_BUILD"},{name:"Gerrit",constant:"GERRIT",env:"GERRIT_PROJECT"},{name:"GitHub Actions",constant:"GITHUB_ACTIONS",env:"GITHUB_ACTIONS",pr:{GITHUB_EVENT_NAME:"pull_request"}},{name:"GitLab CI",constant:"GITLAB",env:"GITLAB_CI",pr:"CI_MERGE_REQUEST_ID"},{name:"GoCD",constant:"GOCD",env:"GO_PIPELINE_LABEL"},{name:"Google Cloud Build",constant:"GOOGLE_CLOUD_BUILD",env:"BUILDER_OUTPUT"},{name:"Harness CI",constant:"HARNESS",env:"HARNESS_BUILD_ID"},{name:"Heroku",constant:"HEROKU",env:{env:"NODE",includes:"/app/.heroku/node/bin/node"}},{name:"Hudson",constant:"HUDSON",env:"HUDSON_URL"},{name:"Jenkins",constant:"JENKINS",env:["JENKINS_URL","BUILD_ID"],pr:{any:["ghprbPullId","CHANGE_ID"]}},{name:"LayerCI",constant:"LAYERCI",env:"LAYERCI",pr:"LAYERCI_PULL_REQUEST"},{name:"Magnum CI",constant:"MAGNUM",env:"MAGNUM"},{name:"Netlify CI",constant:"NETLIFY",env:"NETLIFY",pr:{env:"PULL_REQUEST",ne:"false"}},{name:"Nevercode",constant:"NEVERCODE",env:"NEVERCODE",pr:{env:"NEVERCODE_PULL_REQUEST",ne:"false"}},{name:"ReleaseHub",constant:"RELEASEHUB",env:"RELEASE_BUILD_ID"},{name:"Render",constant:"RENDER",env:"RENDER",pr:{IS_PULL_REQUEST:"true"}},{name:"Sail CI",constant:"SAIL",env:"SAILCI",pr:"SAIL_PULL_REQUEST_NUMBER"},{name:"Screwdriver",constant:"SCREWDRIVER",env:"SCREWDRIVER",pr:{env:"SD_PULL_REQUEST",ne:"false"}},{name:"Semaphore",constant:"SEMAPHORE",env:"SEMAPHORE",pr:"PULL_REQUEST_NUMBER"},{name:"Shippable",constant:"SHIPPABLE",env:"SHIPPABLE",pr:{IS_PULL_REQUEST:"true"}},{name:"Solano CI",constant:"SOLANO",env:"TDDIUM",pr:"TDDIUM_PR_ID"},{name:"Sourcehut",constant:"SOURCEHUT",env:{CI_NAME:"sourcehut"}},{name:"Strider CD",constant:"STRIDER",env:"STRIDER"},{name:"TaskCluster",constant:"TASKCLUSTER",env:["TASK_ID","RUN_ID"]},{name:"TeamCity",constant:"TEAMCITY",env:"TEAMCITY_VERSION"},{name:"Travis CI",constant:"TRAVIS",env:"TRAVIS",pr:{env:"TRAVIS_PULL_REQUEST",ne:"false"}},{name:"Vercel",constant:"VERCEL",env:{any:["NOW_BUILDER","VERCEL"]},pr:"VERCEL_GIT_PULL_REQUEST_ID"},{name:"Visual Studio App Center",constant:"APPCENTER",env:"APPCENTER_BUILD_ID"},{name:"Woodpecker",constant:"WOODPECKER",env:{CI:"woodpecker"},pr:{CI_BUILD_EVENT:"pull_request"}},{name:"Xcode Cloud",constant:"XCODE_CLOUD",env:"CI_XCODE_PROJECT",pr:"CI_PULL_REQUEST_NUMBER"},{name:"Xcode Server",constant:"XCODE_SERVER",env:"XCS"}]});var N2=I(Ut=>{"use strict";var V2=W2(),_e=process.env;Object.defineProperty(Ut,"_vendors",{value:V2.map(function(e){return e.constant})});Ut.name=null;Ut.isPR=null;V2.forEach(function(e){let n=(Array.isArray(e.env)?e.env:[e.env]).every(function(r){return R2(r)});if(Ut[e.constant]=n,!!n)switch(Ut.name=e.name,typeof e.pr){case"string":Ut.isPR=!!_e[e.pr];break;case"object":"env"in e.pr?Ut.isPR=e.pr.env in _e&&_e[e.pr.env]!==e.pr.ne:"any"in e.pr?Ut.isPR=e.pr.any.some(function(r){return!!_e[r]}):Ut.isPR=R2(e.pr);break;default:Ut.isPR=null}});Ut.isCI=!!(_e.CI!=="false"&&(_e.BUILD_ID||_e.BUILD_NUMBER||_e.CI||_e.CI_APP_ID||_e.CI_BUILD_ID||_e.CI_BUILD_NUMBER||_e.CI_NAME||_e.CONTINUOUS_INTEGRATION||_e.RUN_ID||Ut.name));function R2(e){return typeof e=="string"?!!_e[e]:"env"in e?_e[e.env]&&_e[e.env].includes(e.includes):"any"in e?e.any.some(function(t){return!!_e[t]}):Object.keys(e).every(function(t){return _e[t]===e[t]})}});var E2=I((Ipe,w2)=>{"use strict";var us=1e3,ls=us*60,gs=ls*60,Pi=gs*24,Yee=Pi*7,Xee=Pi*365.25;w2.exports=function(e,t){t=t||{};var n=typeof e;if(n==="string"&&e.length>0)return _ee(e);if(n==="number"&&isFinite(e))return t.long?Tee(e):Fee(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function _ee(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*Xee;case"weeks":case"week":case"w":return n*Yee;case"days":case"day":case"d":return n*Pi;case"hours":case"hour":case"hrs":case"hr":case"h":return n*gs;case"minutes":case"minute":case"mins":case"min":case"m":return n*ls;case"seconds":case"second":case"secs":case"sec":case"s":return n*us;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function Fee(e){var t=Math.abs(e);return t>=Pi?Math.round(e/Pi)+"d":t>=gs?Math.round(e/gs)+"h":t>=ls?Math.round(e/ls)+"m":t>=us?Math.round(e/us)+"s":e+"ms"}function Tee(e){var t=Math.abs(e);return t>=Pi?md(e,t,Pi,"day"):t>=gs?md(e,t,gs,"hour"):t>=ls?md(e,t,ls,"minute"):t>=us?md(e,t,us,"second"):e+" ms"}function md(e,t,n,r){var i=t>=n*1.5;return Math.round(e/n)+" "+r+(i?"s":"")}});var zC=I((mpe,H2)=>{"use strict";function kee(e){n.debug=n,n.default=n,n.coerce=c,n.disable=o,n.enable=i,n.enabled=s,n.humanize=E2(),n.destroy=l,Object.keys(e).forEach(u=>{n[u]=e[u]}),n.names=[],n.skips=[],n.formatters={};function t(u){let d=0;for(let g=0;g<u.length;g++)d=(d<<5)-d+u.charCodeAt(g),d|=0;return n.colors[Math.abs(d)%n.colors.length]}n.selectColor=t;function n(u){let d,g=null,m,h;function b(...y){if(!b.enabled)return;let v=b,H=Number(new Date),F=H-(d||H);v.diff=F,v.prev=d,v.curr=H,d=H,y[0]=n.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let Q=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(V,x)=>{if(V==="%%")return"%";Q++;let O=n.formatters[x];if(typeof O=="function"){let k=y[Q];V=O.call(v,k),y.splice(Q,1),Q--}return V}),n.formatArgs.call(v,y),(v.log||n.log).apply(v,y)}return b.namespace=u,b.useColors=n.useColors(),b.color=n.selectColor(u),b.extend=r,b.destroy=n.destroy,Object.defineProperty(b,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(m!==n.namespaces&&(m=n.namespaces,h=n.enabled(u)),h),set:y=>{g=y}}),typeof n.init=="function"&&n.init(b),b}function r(u,d){let g=n(this.namespace+(typeof d>"u"?":":d)+u);return g.log=this.log,g}function i(u){n.save(u),n.namespaces=u,n.names=[],n.skips=[];let d,g=(typeof u=="string"?u:"").split(/[\s,]+/),m=g.length;for(d=0;d<m;d++)g[d]&&(u=g[d].replace(/\*/g,".*?"),u[0]==="-"?n.skips.push(new RegExp("^"+u.slice(1)+"$")):n.names.push(new RegExp("^"+u+"$")))}function o(){let u=[...n.names.map(a),...n.skips.map(a).map(d=>"-"+d)].join(",");return n.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let d,g;for(d=0,g=n.skips.length;d<g;d++)if(n.skips[d].test(u))return!1;for(d=0,g=n.names.length;d<g;d++)if(n.names[d].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}H2.exports=kee});var Y2=I((xt,pd)=>{"use strict";xt.formatArgs=Uee;xt.save=xee;xt.load=Lee;xt.useColors=Kee;xt.storage=Jee();xt.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();xt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Kee(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Uee(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+pd.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let n=0,r=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(n++,i==="%c"&&(r=n))}),e.splice(r,0,t)}xt.log=console.debug||console.log||(()=>{});function xee(e){try{e?xt.storage.setItem("debug",e):xt.storage.removeItem("debug")}catch{}}function Lee(){let e;try{e=xt.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function Jee(){try{return localStorage}catch{}}pd.exports=zC()(xt);var{formatters:zee}=pd.exports;zee.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var _2=I((ppe,X2)=>{"use strict";X2.exports=(e,t=process.argv)=>{let n=e.startsWith("-")?"":e.length===1?"-":"--",r=t.indexOf(n+e),i=t.indexOf("--");return r!==-1&&(i===-1||r<i)}});var k2=I((fpe,T2)=>{"use strict";var Oee=require("os"),F2=require("tty"),nn=_2(),{env:xe}=process,qr;nn("no-color")||nn("no-colors")||nn("color=false")||nn("color=never")?qr=0:(nn("color")||nn("colors")||nn("color=true")||nn("color=always"))&&(qr=1);"FORCE_COLOR"in xe&&(xe.FORCE_COLOR==="true"?qr=1:xe.FORCE_COLOR==="false"?qr=0:qr=xe.FORCE_COLOR.length===0?1:Math.min(parseInt(xe.FORCE_COLOR,10),3));function OC(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function DC(e,t){if(qr===0)return 0;if(nn("color=16m")||nn("color=full")||nn("color=truecolor"))return 3;if(nn("color=256"))return 2;if(e&&!t&&qr===void 0)return 0;let n=qr||0;if(xe.TERM==="dumb")return n;if(process.platform==="win32"){let r=Oee.release().split(".");return Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in xe)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(r=>r in xe)||xe.CI_NAME==="codeship"?1:n;if("TEAMCITY_VERSION"in xe)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(xe.TEAMCITY_VERSION)?1:0;if(xe.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in xe){let r=parseInt((xe.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(xe.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(xe.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(xe.TERM)||"COLORTERM"in xe?1:n}function Dee(e){let t=DC(e,e&&e.isTTY);return OC(t)}T2.exports={supportsColor:Dee,stdout:OC(DC(!0,F2.isatty(1))),stderr:OC(DC(!0,F2.isatty(2)))}});var U2=I((qe,hd)=>{"use strict";var qee=require("tty"),fd=require("util");qe.init=tte;qe.log=Qee;qe.formatArgs=jee;qe.save=$ee;qe.load=ete;qe.useColors=Mee;qe.destroy=fd.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");qe.colors=[6,2,3,4,5,1];try{let e=k2();e&&(e.stderr||e).level>=2&&(qe.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}qe.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let n=t.substring(6).toLowerCase().replace(/_([a-z])/g,(i,o)=>o.toUpperCase()),r=process.env[t];return/^(yes|on|true|enabled)$/i.test(r)?r=!0:/^(no|off|false|disabled)$/i.test(r)?r=!1:r==="null"?r=null:r=Number(r),e[n]=r,e},{});function Mee(){return"colors"in qe.inspectOpts?!!qe.inspectOpts.colors:qee.isatty(process.stderr.fd)}function jee(e){let{namespace:t,useColors:n}=this;if(n){let r=this.color,i="\x1B[3"+(r<8?r:"8;5;"+r),o=`  ${i};1m${t} \x1B[0m`;e[0]=o+e[0].split(`
`).join(`
`+o),e.push(i+"m+"+hd.exports.humanize(this.diff)+"\x1B[0m")}else e[0]=Pee()+t+" "+e[0]}function Pee(){return qe.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Qee(...e){return process.stderr.write(fd.format(...e)+`
`)}function $ee(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function ete(){return process.env.DEBUG}function tte(e){e.inspectOpts={};let t=Object.keys(qe.inspectOpts);for(let n=0;n<t.length;n++)e.inspectOpts[t[n]]=qe.inspectOpts[t[n]]}hd.exports=zC()(qe);var{formatters:K2}=hd.exports;K2.o=function(e){return this.inspectOpts.colors=this.useColors,fd.inspect(e,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};K2.O=function(e){return this.inspectOpts.colors=this.useColors,fd.inspect(e,this.inspectOpts)}});var Fe=I((hpe,qC)=>{"use strict";typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?qC.exports=Y2():qC.exports=U2()});var L2=I((Cpe,x2)=>{"use strict";x2.exports=nte;function ds(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function nte(e){if(e=e||{},e.circles)return rte(e);return e.proto?r:n;function t(i,o){for(var s=Object.keys(i),a=new Array(s.length),c=0;c<s.length;c++){var l=s[c],u=i[l];typeof u!="object"||u===null?a[l]=u:u instanceof Date?a[l]=new Date(u):ArrayBuffer.isView(u)?a[l]=ds(u):a[l]=o(u)}return a}function n(i){if(typeof i!="object"||i===null)return i;if(i instanceof Date)return new Date(i);if(Array.isArray(i))return t(i,n);if(i instanceof Map)return new Map(t(Array.from(i),n));if(i instanceof Set)return new Set(t(Array.from(i),n));var o={};for(var s in i)if(Object.hasOwnProperty.call(i,s)!==!1){var a=i[s];typeof a!="object"||a===null?o[s]=a:a instanceof Date?o[s]=new Date(a):a instanceof Map?o[s]=new Map(t(Array.from(a),n)):a instanceof Set?o[s]=new Set(t(Array.from(a),n)):ArrayBuffer.isView(a)?o[s]=ds(a):o[s]=n(a)}return o}function r(i){if(typeof i!="object"||i===null)return i;if(i instanceof Date)return new Date(i);if(Array.isArray(i))return t(i,r);if(i instanceof Map)return new Map(t(Array.from(i),r));if(i instanceof Set)return new Set(t(Array.from(i),r));var o={};for(var s in i){var a=i[s];typeof a!="object"||a===null?o[s]=a:a instanceof Date?o[s]=new Date(a):a instanceof Map?o[s]=new Map(t(Array.from(a),r)):a instanceof Set?o[s]=new Set(t(Array.from(a),r)):ArrayBuffer.isView(a)?o[s]=ds(a):o[s]=r(a)}return o}}function rte(e){var t=[],n=[];return e.proto?o:i;function r(s,a){for(var c=Object.keys(s),l=new Array(c.length),u=0;u<c.length;u++){var d=c[u],g=s[d];if(typeof g!="object"||g===null)l[d]=g;else if(g instanceof Date)l[d]=new Date(g);else if(ArrayBuffer.isView(g))l[d]=ds(g);else{var m=t.indexOf(g);m!==-1?l[d]=n[m]:l[d]=a(g)}}return l}function i(s){if(typeof s!="object"||s===null)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return r(s,i);if(s instanceof Map)return new Map(r(Array.from(s),i));if(s instanceof Set)return new Set(r(Array.from(s),i));var a={};t.push(s),n.push(a);for(var c in s)if(Object.hasOwnProperty.call(s,c)!==!1){var l=s[c];if(typeof l!="object"||l===null)a[c]=l;else if(l instanceof Date)a[c]=new Date(l);else if(l instanceof Map)a[c]=new Map(r(Array.from(l),i));else if(l instanceof Set)a[c]=new Set(r(Array.from(l),i));else if(ArrayBuffer.isView(l))a[c]=ds(l);else{var u=t.indexOf(l);u!==-1?a[c]=n[u]:a[c]=i(l)}}return t.pop(),n.pop(),a}function o(s){if(typeof s!="object"||s===null)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return r(s,o);if(s instanceof Map)return new Map(r(Array.from(s),o));if(s instanceof Set)return new Set(r(Array.from(s),o));var a={};t.push(s),n.push(a);for(var c in s){var l=s[c];if(typeof l!="object"||l===null)a[c]=l;else if(l instanceof Date)a[c]=new Date(l);else if(l instanceof Map)a[c]=new Map(r(Array.from(l),o));else if(l instanceof Set)a[c]=new Set(r(Array.from(l),o));else if(ArrayBuffer.isView(l))a[c]=ds(l);else{var u=t.indexOf(l);u!==-1?a[c]=n[u]:a[c]=o(l)}}return t.pop(),n.pop(),a}}});var $i=I((bpe,D2)=>{"use strict";var ite=require("util"),Qi=Fe()("log4js:configuration"),Cd=[],bd=[],J2=e=>!e,z2=e=>e&&typeof e=="object"&&!Array.isArray(e),ote=e=>/^[A-Za-z][A-Za-z0-9_]*$/g.test(e),ste=e=>e&&typeof e=="number"&&Number.isInteger(e),ate=e=>{bd.push(e),Qi(`Added listener, now ${bd.length} listeners`)},cte=e=>{Cd.push(e),Qi(`Added pre-processing listener, now ${Cd.length} listeners`)},O2=(e,t,n)=>{(Array.isArray(t)?t:[t]).forEach(i=>{if(i)throw new Error(`Problem with log4js configuration: (${ite.inspect(e,{depth:5})}) - ${n}`)})},ute=e=>{Qi("New configuration to be validated: ",e),O2(e,J2(z2(e)),"must be an object."),Qi(`Calling pre-processing listeners (${Cd.length})`),Cd.forEach(t=>t(e)),Qi("Configuration pre-processing finished."),Qi(`Calling configuration listeners (${bd.length})`),bd.forEach(t=>t(e)),Qi("Configuration finished.")};D2.exports={configure:ute,addListener:ate,addPreProcessingListener:cte,throwExceptionIf:O2,anObject:z2,anInteger:ste,validIdentifier:ote,not:J2}});var yd=I((ype,rn)=>{"use strict";function q2(e,t){for(var n=e.toString();n.length<t;)n="0"+n;return n}function eo(e){return q2(e,2)}function lte(e){var t=Math.abs(e),n=String(Math.floor(t/60)),r=String(t%60);return n=("0"+n).slice(-2),r=("0"+r).slice(-2),e===0?"Z":(e<0?"+":"-")+n+":"+r}function M2(e,t){typeof e!="string"&&(t=e,e=rn.exports.ISO8601_FORMAT),t||(t=rn.exports.now());var n=eo(t.getDate()),r=eo(t.getMonth()+1),i=eo(t.getFullYear()),o=eo(i.substring(2,4)),s=e.indexOf("yyyy")>-1?i:o,a=eo(t.getHours()),c=eo(t.getMinutes()),l=eo(t.getSeconds()),u=q2(t.getMilliseconds(),3),d=lte(t.getTimezoneOffset()),g=e.replace(/dd/g,n).replace(/MM/g,r).replace(/y{1,4}/g,s).replace(/hh/g,a).replace(/mm/g,c).replace(/ss/g,l).replace(/SSS/g,u).replace(/O/g,d);return g}function Mr(e,t,n,r){e["set"+(r?"":"UTC")+t](n)}function gte(e,t,n){var r=e.indexOf("O")<0,i=!1,o=[{pattern:/y{1,4}/,regexp:"\\d{1,4}",fn:function(d,g){Mr(d,"FullYear",g,r)}},{pattern:/MM/,regexp:"\\d{1,2}",fn:function(d,g){Mr(d,"Month",g-1,r),d.getMonth()!==g-1&&(i=!0)}},{pattern:/dd/,regexp:"\\d{1,2}",fn:function(d,g){i&&Mr(d,"Month",d.getMonth()-1,r),Mr(d,"Date",g,r)}},{pattern:/hh/,regexp:"\\d{1,2}",fn:function(d,g){Mr(d,"Hours",g,r)}},{pattern:/mm/,regexp:"\\d\\d",fn:function(d,g){Mr(d,"Minutes",g,r)}},{pattern:/ss/,regexp:"\\d\\d",fn:function(d,g){Mr(d,"Seconds",g,r)}},{pattern:/SSS/,regexp:"\\d\\d\\d",fn:function(d,g){Mr(d,"Milliseconds",g,r)}},{pattern:/O/,regexp:"[+-]\\d{1,2}:?\\d{2}?|Z",fn:function(d,g){g==="Z"?g=0:g=g.replace(":","");var m=Math.abs(g),h=(g>0?-1:1)*(m%100+Math.floor(m/100)*60);d.setUTCMinutes(d.getUTCMinutes()+h)}}],s=o.reduce(function(d,g){return g.pattern.test(d.regexp)?(g.index=d.regexp.match(g.pattern).index,d.regexp=d.regexp.replace(g.pattern,"("+g.regexp+")")):g.index=-1,d},{regexp:e,index:[]}),a=o.filter(function(d){return d.index>-1});a.sort(function(d,g){return d.index-g.index});var c=new RegExp(s.regexp),l=c.exec(t);if(l){var u=n||rn.exports.now();return a.forEach(function(d,g){d.fn(u,l[g+1])}),u}throw new Error("String '"+t+"' could not be parsed as '"+e+"'")}function dte(e,t,n){if(!e)throw new Error("pattern must be supplied");return gte(e,t,n)}function Ite(){return new Date}rn.exports=M2;rn.exports.asString=M2;rn.exports.parse=dte;rn.exports.now=Ite;rn.exports.ISO8601_FORMAT="yyyy-MM-ddThh:mm:ss.SSS";rn.exports.ISO8601_WITH_TZ_OFFSET_FORMAT="yyyy-MM-ddThh:mm:ss.SSSO";rn.exports.DATETIME_FORMAT="dd MM yyyy hh:mm:ss.SSS";rn.exports.ABSOLUTETIME_FORMAT="hh:mm:ss.SSS"});var jC=I((Gpe,aw)=>{"use strict";var jr=yd(),j2=require("os"),dc=require("util"),gc=require("path"),P2=require("url"),Q2=Fe()("log4js:layouts"),$2={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[90,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[91,39],yellow:[33,39]};function ew(e){return e?`\x1B[${$2[e][0]}m`:""}function tw(e){return e?`\x1B[${$2[e][1]}m`:""}function mte(e,t){return ew(t)+e+tw(t)}function nw(e,t){return mte(dc.format("[%s] [%s] %s - ",jr.asString(e.startTime),e.level.toString(),e.categoryName),t)}function rw(e){return nw(e)+dc.format(...e.data)}function Gd(e){return nw(e,e.level.colour)+dc.format(...e.data)}function iw(e){return dc.format(...e.data)}function ow(e){return e.data[0]}function sw(e,t){let n="%r %p %c - %m%n",r=/%(-?[0-9]+)?(\.?-?[0-9]+)?([[\]cdhmnprzxXyflosCMAF%])(\{([^}]+)\})?|([^%]+)/;e=e||n;function i(X,K){let T=X.categoryName;if(K){let P=parseInt(K,10),q=T.split(".");P<q.length&&(T=q.slice(q.length-P).join("."))}return T}function o(X,K){let T=jr.ISO8601_FORMAT;if(K)switch(T=K,T){case"ISO8601":case"ISO8601_FORMAT":T=jr.ISO8601_FORMAT;break;case"ISO8601_WITH_TZ_OFFSET":case"ISO8601_WITH_TZ_OFFSET_FORMAT":T=jr.ISO8601_WITH_TZ_OFFSET_FORMAT;break;case"ABSOLUTE":process.emitWarning("Pattern %d{ABSOLUTE} is deprecated in favor of %d{ABSOLUTETIME}. Please use %d{ABSOLUTETIME} instead.","DeprecationWarning","log4js-node-DEP0003"),Q2("[log4js-node-DEP0003]","DEPRECATION: Pattern %d{ABSOLUTE} is deprecated and replaced by %d{ABSOLUTETIME}.");case"ABSOLUTETIME":case"ABSOLUTETIME_FORMAT":T=jr.ABSOLUTETIME_FORMAT;break;case"DATE":process.emitWarning("Pattern %d{DATE} is deprecated due to the confusion it causes when used. Please use %d{DATETIME} instead.","DeprecationWarning","log4js-node-DEP0004"),Q2("[log4js-node-DEP0004]","DEPRECATION: Pattern %d{DATE} is deprecated and replaced by %d{DATETIME}.");case"DATETIME":case"DATETIME_FORMAT":T=jr.DATETIME_FORMAT;break}return jr.asString(T,X.startTime)}function s(){return j2.hostname().toString()}function a(X,K){let T=X.data;if(K){let[P,q]=K.split(",");T=T.slice(P,q)}return dc.format(...T)}function c(){return j2.EOL}function l(X){return X.level.toString()}function u(X){return jr.asString("hh:mm:ss",X.startTime)}function d(X){return ew(X.level.colour)}function g(X){return tw(X.level.colour)}function m(){return"%"}function h(X){return X&&X.pid?X.pid.toString():process.pid.toString()}function b(){return h()}function y(X,K){return typeof t[K]<"u"?typeof t[K]=="function"?t[K](X):t[K]:null}function v(X,K){let T=X.context[K];return typeof T<"u"?typeof T=="function"?T(X):T:null}function H(X,K){let T=X.fileName||"";if(T=function(q){let Bn="file://";return q.startsWith(Bn)&&(typeof P2.fileURLToPath=="function"?q=P2.fileURLToPath(q):(q=gc.normalize(q.replace(new RegExp(`^${Bn}`),"")),process.platform==="win32"&&(q.startsWith("\\")?q=q.slice(1):q=gc.sep+gc.sep+q))),q}(T),K){let q=parseInt(K,10),Bn=T.split(gc.sep);Bn.length>q&&(T=Bn.slice(-q).join(gc.sep))}return T}function F(X){return X.lineNumber?`${X.lineNumber}`:""}function Q(X){return X.columnNumber?`${X.columnNumber}`:""}function te(X){return X.callStack||""}function V(X){return X.className||""}function x(X){return X.functionName||""}function O(X){return X.functionAlias||""}function k(X){return X.callerName||""}let D={c:i,d:o,h:s,m:a,n:c,p:l,r:u,"[":d,"]":g,y:b,z:h,"%":m,x:y,X:v,f:H,l:F,o:Q,s:te,C:V,M:x,A:O,F:k};function M(X,K,T){return D[X](K,T)}function re(X,K){let T;return X?(T=parseInt(X.slice(1),10),T>0?K.slice(0,T):K.slice(T)):K}function ie(X,K){let T;if(X)if(X.charAt(0)==="-")for(T=parseInt(X.slice(1),10);K.length<T;)K+=" ";else for(T=parseInt(X,10);K.length<T;)K=` ${K}`;return K}function ue(X,K,T){let P=X;return P=re(K,P),P=ie(T,P),P}return function(X){let K="",T,P=e;for(;(T=r.exec(P))!==null;){let q=T[1],Bn=T[2],SI=T[3],ln=T[5],Hs=T[6];if(Hs)K+=Hs.toString();else{let WI=M(SI,X,ln);K+=ue(WI,Bn,q)}P=P.slice(T.index+T[0].length)}return K}}var MC={messagePassThrough(){return iw},basic(){return rw},colored(){return Gd},coloured(){return Gd},pattern(e){return sw(e&&e.pattern,e&&e.tokens)},dummy(){return ow}};aw.exports={basicLayout:rw,messagePassThroughLayout:iw,patternLayout:sw,colouredLayout:Gd,coloredLayout:Gd,dummyLayout:ow,addLayout(e,t){MC[e]=t},layout(e,t){return MC[e]&&MC[e](t)}}});var to=I((Bpe,uw)=>{"use strict";var He=$i(),cw=["white","grey","black","blue","cyan","green","magenta","red","yellow"],Is=class e{constructor(t,n,r){this.level=t,this.levelStr=n,this.colour=r}toString(){return this.levelStr}static getLevel(t,n){return t?t instanceof e?t:(t instanceof Object&&t.levelStr&&(t=t.levelStr),e[t.toString().toUpperCase()]||n):n}static addLevels(t){t&&(Object.keys(t).forEach(r=>{let i=r.toUpperCase();e[i]=new e(t[r].value,i,t[r].colour);let o=e.levels.findIndex(s=>s.levelStr===i);o>-1?e.levels[o]=e[i]:e.levels.push(e[i])}),e.levels.sort((r,i)=>r.level-i.level))}isLessThanOrEqualTo(t){return typeof t=="string"&&(t=e.getLevel(t)),this.level<=t.level}isGreaterThanOrEqualTo(t){return typeof t=="string"&&(t=e.getLevel(t)),this.level>=t.level}isEqualTo(t){return typeof t=="string"&&(t=e.getLevel(t)),this.level===t.level}};Is.levels=[];Is.addLevels({ALL:{value:Number.MIN_VALUE,colour:"grey"},TRACE:{value:5e3,colour:"blue"},DEBUG:{value:1e4,colour:"cyan"},INFO:{value:2e4,colour:"green"},WARN:{value:3e4,colour:"yellow"},ERROR:{value:4e4,colour:"red"},FATAL:{value:5e4,colour:"magenta"},MARK:{value:9007199254740992,colour:"grey"},OFF:{value:Number.MAX_VALUE,colour:"grey"}});He.addListener(e=>{let t=e.levels;t&&(He.throwExceptionIf(e,He.not(He.anObject(t)),"levels must be an object"),Object.keys(t).forEach(r=>{He.throwExceptionIf(e,He.not(He.validIdentifier(r)),`level name "${r}" is not a valid identifier (must start with a letter, only contain A-Z,a-z,0-9,_)`),He.throwExceptionIf(e,He.not(He.anObject(t[r])),`level "${r}" must be an object`),He.throwExceptionIf(e,He.not(t[r].value),`level "${r}" must have a 'value' property`),He.throwExceptionIf(e,He.not(He.anInteger(t[r].value)),`level "${r}".value must have an integer value`),He.throwExceptionIf(e,He.not(t[r].colour),`level "${r}" must have a 'colour' property`),He.throwExceptionIf(e,He.not(cw.indexOf(t[r].colour)>-1),`level "${r}".colour must be one of ${cw.join(", ")}`)}))});He.addListener(e=>{Is.addLevels(e.levels)});uw.exports=Is});var bw=I(mc=>{"use strict";var{parse:dw,stringify:Iw}=JSON,{keys:pte}=Object,Ic=String,mw="string",lw={},Bd="object",pw=(e,t)=>t,fte=e=>e instanceof Ic?Ic(e):e,hte=(e,t)=>typeof t===mw?new Ic(t):t,fw=(e,t,n,r)=>{let i=[];for(let o=pte(n),{length:s}=o,a=0;a<s;a++){let c=o[a],l=n[c];if(l instanceof Ic){let u=e[l];typeof u===Bd&&!t.has(u)?(t.add(u),n[c]=lw,i.push({k:c,a:[e,t,u,r]})):n[c]=r.call(n,c,u)}else n[c]!==lw&&(n[c]=r.call(n,c,l))}for(let{length:o}=i,s=0;s<o;s++){let{k:a,a:c}=i[s];n[a]=r.call(n,a,fw.apply(null,c))}return n},gw=(e,t,n)=>{let r=Ic(t.push(n)-1);return e.set(n,r),r},hw=(e,t)=>{let n=dw(e,hte).map(fte),r=n[0],i=t||pw,o=typeof r===Bd&&r?fw(n,new Set,r,i):r;return i.call({"":o},"",o)};mc.parse=hw;var Cw=(e,t,n)=>{let r=t&&typeof t===Bd?(u,d)=>u===""||-1<t.indexOf(u)?d:void 0:t||pw,i=new Map,o=[],s=[],a=+gw(i,o,r.call({"":e},"",e)),c=!a;for(;a<o.length;)c=!0,s[a]=Iw(o[a++],l,n);return"["+s.join(",")+"]";function l(u,d){if(c)return c=!c,d;let g=r.call(this,u,d);switch(typeof g){case Bd:if(g===null)return g;case mw:return i.get(g)||gw(i,o,g)}return g}};mc.stringify=Cw;var Cte=e=>dw(Cw(e));mc.toJSON=Cte;var bte=e=>hw(Iw(e));mc.fromJSON=bte});var $C=I((Zpe,Aw)=>{"use strict";var yw=bw(),Gw=to(),PC=class{constructor(){let t={__LOG4JS_undefined__:void 0,__LOG4JS_NaN__:+"abc",__LOG4JS_Infinity__:1/0,"__LOG4JS_-Infinity__":-1/0};this.deMap=t,this.serMap={},Object.keys(this.deMap).forEach(n=>{let r=this.deMap[n];this.serMap[r]=n})}canSerialise(t){return typeof t=="string"?!1:t in this.serMap}serialise(t){return this.canSerialise(t)?this.serMap[t]:t}canDeserialise(t){return t in this.deMap}deserialise(t){return this.canDeserialise(t)?this.deMap[t]:t}},Bw=new PC,QC=class e{constructor(t,n,r,i,o,s){if(this.startTime=new Date,this.categoryName=t,this.data=r,this.level=n,this.context=Object.assign({},i),this.pid=process.pid,this.error=s,typeof o<"u"){if(!o||typeof o!="object"||Array.isArray(o))throw new TypeError("Invalid location type passed to LoggingEvent constructor");this.constructor._getLocationKeys().forEach(a=>{typeof o[a]<"u"&&(this[a]=o[a])})}}static _getLocationKeys(){return["fileName","lineNumber","columnNumber","callStack","className","functionName","functionAlias","callerName"]}serialise(){return yw.stringify(this,(t,n)=>(n instanceof Error&&(n=Object.assign({message:n.message,stack:n.stack},n)),Bw.serialise(n)))}static deserialise(t){let n;try{let r=yw.parse(t,(i,o)=>{if(o&&o.message&&o.stack){let s=new Error(o);Object.keys(o).forEach(a=>{s[a]=o[a]}),o=s}return Bw.deserialise(o)});this._getLocationKeys().forEach(i=>{typeof r[i]<"u"&&(r.location||(r.location={}),r.location[i]=r[i])}),n=new e(r.categoryName,Gw.getLevel(r.level.levelStr),r.data,r.context,r.location,r.error),n.startTime=new Date(r.startTime),n.pid=r.pid,r.cluster&&(n.cluster=r.cluster)}catch(r){n=new e("log4js",Gw.ERROR,["Unable to parse log:",t,"because: ",r])}return n}};Aw.exports=QC});var Zd=I((vpe,Sw)=>{"use strict";var on=Fe()("log4js:clustering"),yte=$C(),Gte=$i(),ms=!1,sn=null;try{sn=require("cluster")}catch{on("cluster module not present"),ms=!0}var tb=[],fc=!1,pc="NODE_APP_INSTANCE",Zw=()=>fc&&process.env[pc]==="0",eb=()=>ms||sn&&sn.isMaster||Zw(),vw=e=>{tb.forEach(t=>t(e))},Ad=(e,t)=>{if(on("cluster message received from worker ",e,": ",t),e.topic&&e.data&&(t=e,e=void 0),t&&t.topic&&t.topic==="log4js:message"){on("received message: ",t.data);let n=yte.deserialise(t.data);vw(n)}};ms||Gte.addListener(e=>{tb.length=0,{pm2:fc,disableClustering:ms,pm2InstanceVar:pc="NODE_APP_INSTANCE"}=e,on(`clustering disabled ? ${ms}`),on(`cluster.isMaster ? ${sn&&sn.isMaster}`),on(`pm2 enabled ? ${fc}`),on(`pm2InstanceVar = ${pc}`),on(`process.env[${pc}] = ${process.env[pc]}`),fc&&process.removeListener("message",Ad),sn&&sn.removeListener&&sn.removeListener("message",Ad),ms||e.disableClustering?on("Not listening for cluster messages, because clustering disabled."):Zw()?(on("listening for PM2 broadcast messages"),process.on("message",Ad)):sn&&sn.isMaster?(on("listening for cluster messages"),sn.on("message",Ad)):on("not listening for messages, because we are not a master process")});Sw.exports={onlyOnMaster:(e,t)=>eb()?e():t,isMaster:eb,send:e=>{eb()?vw(e):(fc||(e.cluster={workerId:sn.worker.id,worker:process.pid}),process.send({topic:"log4js:message",data:e.serialise()}))},onMessage:e=>{tb.push(e)}}});var Vw=I((Spe,Rw)=>{"use strict";function Bte(e){if(typeof e=="number"&&Number.isInteger(e))return e;let t={K:1024,M:1024*1024,G:1024*1024*1024},n=Object.keys(t),r=e.slice(-1).toLocaleUpperCase(),i=e.slice(0,-1).trim();if(n.indexOf(r)<0||!Number.isInteger(Number(i)))throw Error(`maxLogSize: "${e}" is invalid`);return i*t[r]}function Ate(e,t){let n=Object.assign({},t);return Object.keys(e).forEach(r=>{n[r]&&(n[r]=e[r](t[r]))}),n}function nb(e){return Ate({maxLogSize:Bte},e)}var Ww={dateFile:nb,file:nb,fileSync:nb};Rw.exports.modifyConfig=e=>Ww[e.type]?Ww[e.type](e):e});var ww=I((Wpe,Nw)=>{"use strict";var Zte=console.log.bind(console);function vte(e,t){return n=>{Zte(e(n,t))}}function Ste(e,t){let n=t.colouredLayout;return e.layout&&(n=t.layout(e.layout.type,e.layout)),vte(n,e.timezoneOffset)}Nw.exports.configure=Ste});var Hw=I(Ew=>{"use strict";function Wte(e,t){return n=>{process.stdout.write(`${e(n,t)}
`)}}function Rte(e,t){let n=t.colouredLayout;return e.layout&&(n=t.layout(e.layout.type,e.layout)),Wte(n,e.timezoneOffset)}Ew.configure=Rte});var Xw=I((Vpe,Yw)=>{"use strict";function Vte(e,t){return n=>{process.stderr.write(`${e(n,t)}
`)}}function Nte(e,t){let n=t.colouredLayout;return e.layout&&(n=t.layout(e.layout.type,e.layout)),Vte(n,e.timezoneOffset)}Yw.exports.configure=Nte});var Fw=I((Npe,_w)=>{"use strict";function wte(e,t,n,r){let i=r.getLevel(e),o=r.getLevel(t,r.FATAL);return s=>{let a=s.level;i.isLessThanOrEqualTo(a)&&o.isGreaterThanOrEqualTo(a)&&n(s)}}function Ete(e,t,n,r){let i=n(e.appender);return wte(e.level,e.maxLevel,i,r)}_w.exports.configure=Ete});var Kw=I((wpe,kw)=>{"use strict";var Tw=Fe()("log4js:categoryFilter");function Hte(e,t){return typeof e=="string"&&(e=[e]),n=>{Tw(`Checking ${n.categoryName} against ${e}`),e.indexOf(n.categoryName)===-1&&(Tw("Not excluded, sending to appender"),t(n))}}function Yte(e,t,n){let r=n(e.appender);return Hte(e.exclude,r)}kw.exports.configure=Yte});var Lw=I((Epe,xw)=>{"use strict";var Uw=Fe()("log4js:noLogFilter");function Xte(e){return e.filter(n=>n!=null&&n!=="")}function _te(e,t){return n=>{Uw(`Checking data: ${n.data} against filters: ${e}`),typeof e=="string"&&(e=[e]),e=Xte(e);let r=new RegExp(e.join("|"),"i");(e.length===0||n.data.findIndex(i=>r.test(i))<0)&&(Uw("Not excluded, sending to appender"),t(n))}}function Fte(e,t,n){let r=n(e.appender);return _te(e.exclude,r)}xw.exports.configure=Fte});var St=I(rb=>{"use strict";rb.fromCallback=function(e){return Object.defineProperty(function(){if(typeof arguments[arguments.length-1]=="function")e.apply(this,arguments);else return new Promise((t,n)=>{arguments[arguments.length]=(r,i)=>{if(r)return n(r);t(i)},arguments.length++,e.apply(this,arguments)})},"name",{value:e.name})};rb.fromPromise=function(e){return Object.defineProperty(function(){let t=arguments[arguments.length-1];if(typeof t!="function")return e.apply(this,arguments);e.apply(this,arguments).then(n=>t(null,n),t)},"name",{value:e.name})}});var ib=I(no=>{"use strict";var Jw=St().fromCallback,an=z(),Tte=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","lchmod","link","lstat","mkdir","mkdtemp","open","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof an[e]=="function");Object.keys(an).forEach(e=>{e!=="promises"&&(no[e]=an[e])});Tte.forEach(e=>{no[e]=Jw(an[e])});no.exists=function(e,t){return typeof t=="function"?an.exists(e,t):new Promise(n=>an.exists(e,n))};no.read=function(e,t,n,r,i,o){return typeof o=="function"?an.read(e,t,n,r,i,o):new Promise((s,a)=>{an.read(e,t,n,r,i,(c,l,u)=>{if(c)return a(c);s({bytesRead:l,buffer:u})})})};no.write=function(e,t,...n){return typeof n[n.length-1]=="function"?an.write(e,t,...n):new Promise((r,i)=>{an.write(e,t,...n,(o,s,a)=>{if(o)return i(o);r({bytesWritten:s,buffer:a})})})};typeof an.realpath.native=="function"&&(no.realpath.native=Jw(an.realpath.native))});var sb=I((Xpe,Ow)=>{"use strict";var ob=require("path");function zw(e){return e=ob.normalize(ob.resolve(e)).split(ob.sep),e.length>0?e[0]:null}var kte=/[<>:"|?*]/;function Kte(e){let t=zw(e);return e=e.replace(t,""),kte.test(e)}Ow.exports={getRootPath:zw,invalidWin32Path:Kte}});var qw=I((_pe,Dw)=>{"use strict";var Ute=z(),ab=require("path"),xte=sb().invalidWin32Path,Lte=parseInt("0777",8);function cb(e,t,n,r){if(typeof t=="function"?(n=t,t={}):(!t||typeof t!="object")&&(t={mode:t}),process.platform==="win32"&&xte(e)){let s=new Error(e+" contains invalid WIN32 path characters.");return s.code="EINVAL",n(s)}let i=t.mode,o=t.fs||Ute;i===void 0&&(i=Lte&~process.umask()),r||(r=null),n=n||function(){},e=ab.resolve(e),o.mkdir(e,i,s=>{if(!s)return r=r||e,n(null,r);switch(s.code){case"ENOENT":if(ab.dirname(e)===e)return n(s);cb(ab.dirname(e),t,(a,c)=>{a?n(a,c):cb(e,t,n,c)});break;default:o.stat(e,(a,c)=>{a||!c.isDirectory()?n(s,r):n(null,r)});break}})}Dw.exports=cb});var jw=I((Fpe,Mw)=>{"use strict";var Jte=z(),ub=require("path"),zte=sb().invalidWin32Path,Ote=parseInt("0777",8);function lb(e,t,n){(!t||typeof t!="object")&&(t={mode:t});let r=t.mode,i=t.fs||Jte;if(process.platform==="win32"&&zte(e)){let o=new Error(e+" contains invalid WIN32 path characters.");throw o.code="EINVAL",o}r===void 0&&(r=Ote&~process.umask()),n||(n=null),e=ub.resolve(e);try{i.mkdirSync(e,r),n=n||e}catch(o){if(o.code==="ENOENT"){if(ub.dirname(e)===e)throw o;n=lb(ub.dirname(e),t,n),lb(e,t,n)}else{let s;try{s=i.statSync(e)}catch{throw o}if(!s.isDirectory())throw o}}return n}Mw.exports=lb});var Lt=I((Tpe,Pw)=>{"use strict";var Dte=St().fromCallback,gb=Dte(qw()),db=jw();Pw.exports={mkdirs:gb,mkdirsSync:db,mkdirp:gb,mkdirpSync:db,ensureDir:gb,ensureDirSync:db}});var Ib=I((kpe,$w)=>{"use strict";var nt=z(),Qw=require("os"),vd=require("path");function qte(){let e=vd.join("millis-test-sync"+Date.now().toString()+Math.random().toString().slice(2));e=vd.join(Qw.tmpdir(),e);let t=new Date(1435410243862);nt.writeFileSync(e,"https://github.com/jprichardson/node-fs-extra/pull/141");let n=nt.openSync(e,"r+");return nt.futimesSync(n,t,t),nt.closeSync(n),nt.statSync(e).mtime>1435410243e3}function Mte(e){let t=vd.join("millis-test"+Date.now().toString()+Math.random().toString().slice(2));t=vd.join(Qw.tmpdir(),t);let n=new Date(1435410243862);nt.writeFile(t,"https://github.com/jprichardson/node-fs-extra/pull/141",r=>{if(r)return e(r);nt.open(t,"r+",(i,o)=>{if(i)return e(i);nt.futimes(o,n,n,s=>{if(s)return e(s);nt.close(o,a=>{if(a)return e(a);nt.stat(t,(c,l)=>{if(c)return e(c);e(null,l.mtime>1435410243e3)})})})})})}function jte(e){if(typeof e=="number")return Math.floor(e/1e3)*1e3;if(e instanceof Date)return new Date(Math.floor(e.getTime()/1e3)*1e3);throw new Error("fs-extra: timeRemoveMillis() unknown parameter type")}function Pte(e,t,n,r){nt.open(e,"r+",(i,o)=>{if(i)return r(i);nt.futimes(o,t,n,s=>{nt.close(o,a=>{r&&r(s||a)})})})}function Qte(e,t,n){let r=nt.openSync(e,"r+");return nt.futimesSync(r,t,n),nt.closeSync(r)}$w.exports={hasMillisRes:Mte,hasMillisResSync:qte,timeRemoveMillis:jte,utimesMillis:Pte,utimesMillisSync:Qte}});var bc=I((Kpe,oE)=>{"use strict";var cn=z(),Wt=require("path"),eE=10,tE=5,$te=0,pb=process.versions.node.split("."),nE=Number.parseInt(pb[0],10),rE=Number.parseInt(pb[1],10),ene=Number.parseInt(pb[2],10);function hc(){if(nE>eE)return!0;if(nE===eE){if(rE>tE)return!0;if(rE===tE&&ene>=$te)return!0}return!1}function tne(e,t,n){hc()?cn.stat(e,{bigint:!0},(r,i)=>{if(r)return n(r);cn.stat(t,{bigint:!0},(o,s)=>o?o.code==="ENOENT"?n(null,{srcStat:i,destStat:null}):n(o):n(null,{srcStat:i,destStat:s}))}):cn.stat(e,(r,i)=>{if(r)return n(r);cn.stat(t,(o,s)=>o?o.code==="ENOENT"?n(null,{srcStat:i,destStat:null}):n(o):n(null,{srcStat:i,destStat:s}))})}function nne(e,t){let n,r;hc()?n=cn.statSync(e,{bigint:!0}):n=cn.statSync(e);try{hc()?r=cn.statSync(t,{bigint:!0}):r=cn.statSync(t)}catch(i){if(i.code==="ENOENT")return{srcStat:n,destStat:null};throw i}return{srcStat:n,destStat:r}}function rne(e,t,n,r){tne(e,t,(i,o)=>{if(i)return r(i);let{srcStat:s,destStat:a}=o;return a&&a.ino&&a.dev&&a.ino===s.ino&&a.dev===s.dev?r(new Error("Source and destination must not be the same.")):s.isDirectory()&&fb(e,t)?r(new Error(Cc(e,t,n))):r(null,{srcStat:s,destStat:a})})}function ine(e,t,n){let{srcStat:r,destStat:i}=nne(e,t);if(i&&i.ino&&i.dev&&i.ino===r.ino&&i.dev===r.dev)throw new Error("Source and destination must not be the same.");if(r.isDirectory()&&fb(e,t))throw new Error(Cc(e,t,n));return{srcStat:r,destStat:i}}function mb(e,t,n,r,i){let o=Wt.resolve(Wt.dirname(e)),s=Wt.resolve(Wt.dirname(n));if(s===o||s===Wt.parse(s).root)return i();hc()?cn.stat(s,{bigint:!0},(a,c)=>a?a.code==="ENOENT"?i():i(a):c.ino&&c.dev&&c.ino===t.ino&&c.dev===t.dev?i(new Error(Cc(e,n,r))):mb(e,t,s,r,i)):cn.stat(s,(a,c)=>a?a.code==="ENOENT"?i():i(a):c.ino&&c.dev&&c.ino===t.ino&&c.dev===t.dev?i(new Error(Cc(e,n,r))):mb(e,t,s,r,i))}function iE(e,t,n,r){let i=Wt.resolve(Wt.dirname(e)),o=Wt.resolve(Wt.dirname(n));if(o===i||o===Wt.parse(o).root)return;let s;try{hc()?s=cn.statSync(o,{bigint:!0}):s=cn.statSync(o)}catch(a){if(a.code==="ENOENT")return;throw a}if(s.ino&&s.dev&&s.ino===t.ino&&s.dev===t.dev)throw new Error(Cc(e,n,r));return iE(e,t,o,r)}function fb(e,t){let n=Wt.resolve(e).split(Wt.sep).filter(i=>i),r=Wt.resolve(t).split(Wt.sep).filter(i=>i);return n.reduce((i,o,s)=>i&&r[s]===o,!0)}function Cc(e,t,n){return`Cannot ${n} '${e}' to a subdirectory of itself, '${t}'.`}oE.exports={checkPaths:rne,checkPathsSync:ine,checkParentPaths:mb,checkParentPathsSync:iE,isSrcSubdir:fb}});var aE=I((Upe,sE)=>{"use strict";sE.exports=function(e){if(typeof Buffer.allocUnsafe=="function")try{return Buffer.allocUnsafe(e)}catch{return new Buffer(e)}return new Buffer(e)}});var dE=I((xpe,gE)=>{"use strict";var be=z(),yc=require("path"),one=Lt().mkdirsSync,sne=Ib().utimesMillisSync,Gc=bc();function ane(e,t,n){typeof n=="function"&&(n={filter:n}),n=n||{},n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;

    see https://github.com/jprichardson/node-fs-extra/issues/269`);let{srcStat:r,destStat:i}=Gc.checkPathsSync(e,t,"copy");return Gc.checkParentPathsSync(e,r,t,"copy"),cne(i,e,t,n)}function cne(e,t,n,r){if(r.filter&&!r.filter(t,n))return;let i=yc.dirname(n);return be.existsSync(i)||one(i),cE(e,t,n,r)}function cE(e,t,n,r){if(!(r.filter&&!r.filter(t,n)))return une(e,t,n,r)}function une(e,t,n,r){let o=(r.dereference?be.statSync:be.lstatSync)(t);if(o.isDirectory())return Ine(o,e,t,n,r);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return lne(o,e,t,n,r);if(o.isSymbolicLink())return fne(e,t,n,r)}function lne(e,t,n,r,i){return t?gne(e,n,r,i):uE(e,n,r,i)}function gne(e,t,n,r){if(r.overwrite)return be.unlinkSync(n),uE(e,t,n,r);if(r.errorOnExist)throw new Error(`'${n}' already exists`)}function uE(e,t,n,r){return typeof be.copyFileSync=="function"?(be.copyFileSync(t,n),be.chmodSync(n,e.mode),r.preserveTimestamps?sne(n,e.atime,e.mtime):void 0):dne(e,t,n,r)}function dne(e,t,n,r){let o=aE()(65536),s=be.openSync(t,"r"),a=be.openSync(n,"w",e.mode),c=0;for(;c<e.size;){let l=be.readSync(s,o,0,65536,c);be.writeSync(a,o,0,l),c+=l}r.preserveTimestamps&&be.futimesSync(a,e.atime,e.mtime),be.closeSync(s),be.closeSync(a)}function Ine(e,t,n,r,i){if(!t)return mne(e,n,r,i);if(t&&!t.isDirectory())throw new Error(`Cannot overwrite non-directory '${r}' with directory '${n}'.`);return lE(n,r,i)}function mne(e,t,n,r){return be.mkdirSync(n),lE(t,n,r),be.chmodSync(n,e.mode)}function lE(e,t,n){be.readdirSync(e).forEach(r=>pne(r,e,t,n))}function pne(e,t,n,r){let i=yc.join(t,e),o=yc.join(n,e),{destStat:s}=Gc.checkPathsSync(i,o,"copy");return cE(s,i,o,r)}function fne(e,t,n,r){let i=be.readlinkSync(t);if(r.dereference&&(i=yc.resolve(process.cwd(),i)),e){let o;try{o=be.readlinkSync(n)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return be.symlinkSync(i,n);throw s}if(r.dereference&&(o=yc.resolve(process.cwd(),o)),Gc.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(be.statSync(n).isDirectory()&&Gc.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return hne(i,n)}else return be.symlinkSync(i,n)}function hne(e,t){return be.unlinkSync(t),be.symlinkSync(e,t)}gE.exports=ane});var hb=I((Lpe,IE)=>{"use strict";IE.exports={copySync:dE()}});var Jn=I((Jpe,pE)=>{"use strict";var Cne=St().fromPromise,mE=ib();function bne(e){return mE.access(e).then(()=>!0).catch(()=>!1)}pE.exports={pathExists:Cne(bne),pathExistsSync:mE.existsSync}});var ZE=I((zpe,AE)=>{"use strict";var Me=z(),Bc=require("path"),yne=Lt().mkdirs,Gne=Jn().pathExists,Bne=Ib().utimesMillis,Ac=bc();function Ane(e,t,n,r){typeof n=="function"&&!r?(r=n,n={}):typeof n=="function"&&(n={filter:n}),r=r||function(){},n=n||{},n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;

    see https://github.com/jprichardson/node-fs-extra/issues/269`),Ac.checkPaths(e,t,"copy",(i,o)=>{if(i)return r(i);let{srcStat:s,destStat:a}=o;Ac.checkParentPaths(e,s,t,"copy",c=>c?r(c):n.filter?CE(fE,a,e,t,n,r):fE(a,e,t,n,r))})}function fE(e,t,n,r,i){let o=Bc.dirname(n);Gne(o,(s,a)=>{if(s)return i(s);if(a)return Cb(e,t,n,r,i);yne(o,c=>c?i(c):Cb(e,t,n,r,i))})}function CE(e,t,n,r,i,o){Promise.resolve(i.filter(n,r)).then(s=>s?e(t,n,r,i,o):o(),s=>o(s))}function Cb(e,t,n,r,i){return r.filter?CE(hE,e,t,n,r,i):hE(e,t,n,r,i)}function hE(e,t,n,r,i){(r.dereference?Me.stat:Me.lstat)(t,(s,a)=>{if(s)return i(s);if(a.isDirectory())return Wne(a,e,t,n,r,i);if(a.isFile()||a.isCharacterDevice()||a.isBlockDevice())return Zne(a,e,t,n,r,i);if(a.isSymbolicLink())return Nne(e,t,n,r,i)})}function Zne(e,t,n,r,i,o){return t?vne(e,n,r,i,o):bE(e,n,r,i,o)}function vne(e,t,n,r,i){if(r.overwrite)Me.unlink(n,o=>o?i(o):bE(e,t,n,r,i));else return r.errorOnExist?i(new Error(`'${n}' already exists`)):i()}function bE(e,t,n,r,i){return typeof Me.copyFile=="function"?Me.copyFile(t,n,o=>o?i(o):yE(e,n,r,i)):Sne(e,t,n,r,i)}function Sne(e,t,n,r,i){let o=Me.createReadStream(t);o.on("error",s=>i(s)).once("open",()=>{let s=Me.createWriteStream(n,{mode:e.mode});s.on("error",a=>i(a)).on("open",()=>o.pipe(s)).once("close",()=>yE(e,n,r,i))})}function yE(e,t,n,r){Me.chmod(t,e.mode,i=>i?r(i):n.preserveTimestamps?Bne(t,e.atime,e.mtime,r):r())}function Wne(e,t,n,r,i,o){return t?t&&!t.isDirectory()?o(new Error(`Cannot overwrite non-directory '${r}' with directory '${n}'.`)):GE(n,r,i,o):Rne(e,n,r,i,o)}function Rne(e,t,n,r,i){Me.mkdir(n,o=>{if(o)return i(o);GE(t,n,r,s=>s?i(s):Me.chmod(n,e.mode,i))})}function GE(e,t,n,r){Me.readdir(e,(i,o)=>i?r(i):BE(o,e,t,n,r))}function BE(e,t,n,r,i){let o=e.pop();return o?Vne(e,o,t,n,r,i):i()}function Vne(e,t,n,r,i,o){let s=Bc.join(n,t),a=Bc.join(r,t);Ac.checkPaths(s,a,"copy",(c,l)=>{if(c)return o(c);let{destStat:u}=l;Cb(u,s,a,i,d=>d?o(d):BE(e,n,r,i,o))})}function Nne(e,t,n,r,i){Me.readlink(t,(o,s)=>{if(o)return i(o);if(r.dereference&&(s=Bc.resolve(process.cwd(),s)),e)Me.readlink(n,(a,c)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?Me.symlink(s,n,i):i(a):(r.dereference&&(c=Bc.resolve(process.cwd(),c)),Ac.isSrcSubdir(s,c)?i(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${c}'.`)):e.isDirectory()&&Ac.isSrcSubdir(c,s)?i(new Error(`Cannot overwrite '${c}' with '${s}'.`)):wne(s,n,i)));else return Me.symlink(s,n,i)})}function wne(e,t,n){Me.unlink(t,r=>r?n(r):Me.symlink(e,t,n))}AE.exports=Ane});var bb=I((Ope,vE)=>{"use strict";var Ene=St().fromCallback;vE.exports={copy:Ene(ZE())}});var YE=I((Dpe,HE)=>{"use strict";var SE=z(),NE=require("path"),ce=require("assert"),Zc=process.platform==="win32";function wE(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(n=>{e[n]=e[n]||SE[n],n=n+"Sync",e[n]=e[n]||SE[n]}),e.maxBusyTries=e.maxBusyTries||3}function yb(e,t,n){let r=0;typeof t=="function"&&(n=t,t={}),ce(e,"rimraf: missing path"),ce.strictEqual(typeof e,"string","rimraf: path should be a string"),ce.strictEqual(typeof n,"function","rimraf: callback function required"),ce(t,"rimraf: invalid options argument provided"),ce.strictEqual(typeof t,"object","rimraf: options should be object"),wE(t),WE(e,t,function i(o){if(o){if((o.code==="EBUSY"||o.code==="ENOTEMPTY"||o.code==="EPERM")&&r<t.maxBusyTries){r++;let s=r*100;return setTimeout(()=>WE(e,t,i),s)}o.code==="ENOENT"&&(o=null)}n(o)})}function WE(e,t,n){ce(e),ce(t),ce(typeof n=="function"),t.lstat(e,(r,i)=>{if(r&&r.code==="ENOENT")return n(null);if(r&&r.code==="EPERM"&&Zc)return RE(e,t,r,n);if(i&&i.isDirectory())return Sd(e,t,r,n);t.unlink(e,o=>{if(o){if(o.code==="ENOENT")return n(null);if(o.code==="EPERM")return Zc?RE(e,t,o,n):Sd(e,t,o,n);if(o.code==="EISDIR")return Sd(e,t,o,n)}return n(o)})})}function RE(e,t,n,r){ce(e),ce(t),ce(typeof r=="function"),n&&ce(n instanceof Error),t.chmod(e,438,i=>{i?r(i.code==="ENOENT"?null:n):t.stat(e,(o,s)=>{o?r(o.code==="ENOENT"?null:n):s.isDirectory()?Sd(e,t,n,r):t.unlink(e,r)})})}function VE(e,t,n){let r;ce(e),ce(t),n&&ce(n instanceof Error);try{t.chmodSync(e,438)}catch(i){if(i.code==="ENOENT")return;throw n}try{r=t.statSync(e)}catch(i){if(i.code==="ENOENT")return;throw n}r.isDirectory()?Wd(e,t,n):t.unlinkSync(e)}function Sd(e,t,n,r){ce(e),ce(t),n&&ce(n instanceof Error),ce(typeof r=="function"),t.rmdir(e,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?Hne(e,t,r):i&&i.code==="ENOTDIR"?r(n):r(i)})}function Hne(e,t,n){ce(e),ce(t),ce(typeof n=="function"),t.readdir(e,(r,i)=>{if(r)return n(r);let o=i.length,s;if(o===0)return t.rmdir(e,n);i.forEach(a=>{yb(NE.join(e,a),t,c=>{if(!s){if(c)return n(s=c);--o===0&&t.rmdir(e,n)}})})})}function EE(e,t){let n;t=t||{},wE(t),ce(e,"rimraf: missing path"),ce.strictEqual(typeof e,"string","rimraf: path should be a string"),ce(t,"rimraf: missing options"),ce.strictEqual(typeof t,"object","rimraf: options should be object");try{n=t.lstatSync(e)}catch(r){if(r.code==="ENOENT")return;r.code==="EPERM"&&Zc&&VE(e,t,r)}try{n&&n.isDirectory()?Wd(e,t,null):t.unlinkSync(e)}catch(r){if(r.code==="ENOENT")return;if(r.code==="EPERM")return Zc?VE(e,t,r):Wd(e,t,r);if(r.code!=="EISDIR")throw r;Wd(e,t,r)}}function Wd(e,t,n){ce(e),ce(t),n&&ce(n instanceof Error);try{t.rmdirSync(e)}catch(r){if(r.code==="ENOTDIR")throw n;if(r.code==="ENOTEMPTY"||r.code==="EEXIST"||r.code==="EPERM")Yne(e,t);else if(r.code!=="ENOENT")throw r}}function Yne(e,t){if(ce(e),ce(t),t.readdirSync(e).forEach(n=>EE(NE.join(e,n),t)),Zc){let n=Date.now();do try{return t.rmdirSync(e,t)}catch{}while(Date.now()-n<500)}else return t.rmdirSync(e,t)}HE.exports=yb;yb.sync=EE});var vc=I((qpe,_E)=>{"use strict";var Xne=St().fromCallback,XE=YE();_E.exports={remove:Xne(XE),removeSync:XE.sync}});var JE=I((Mpe,LE)=>{"use strict";var _ne=St().fromCallback,kE=z(),KE=require("path"),UE=Lt(),xE=vc(),FE=_ne(function(t,n){n=n||function(){},kE.readdir(t,(r,i)=>{if(r)return UE.mkdirs(t,n);i=i.map(s=>KE.join(t,s)),o();function o(){let s=i.pop();if(!s)return n();xE.remove(s,a=>{if(a)return n(a);o()})}})});function TE(e){let t;try{t=kE.readdirSync(e)}catch{return UE.mkdirsSync(e)}t.forEach(n=>{n=KE.join(e,n),xE.removeSync(n)})}LE.exports={emptyDirSync:TE,emptydirSync:TE,emptyDir:FE,emptydir:FE}});var qE=I((jpe,DE)=>{"use strict";var Fne=St().fromCallback,zE=require("path"),Sc=z(),OE=Lt(),Tne=Jn().pathExists;function kne(e,t){function n(){Sc.writeFile(e,"",r=>{if(r)return t(r);t()})}Sc.stat(e,(r,i)=>{if(!r&&i.isFile())return t();let o=zE.dirname(e);Tne(o,(s,a)=>{if(s)return t(s);if(a)return n();OE.mkdirs(o,c=>{if(c)return t(c);n()})})})}function Kne(e){let t;try{t=Sc.statSync(e)}catch{}if(t&&t.isFile())return;let n=zE.dirname(e);Sc.existsSync(n)||OE.mkdirsSync(n),Sc.writeFileSync(e,"")}DE.exports={createFile:Fne(kne),createFileSync:Kne}});var $E=I((Ppe,QE)=>{"use strict";var Une=St().fromCallback,jE=require("path"),ro=z(),PE=Lt(),ME=Jn().pathExists;function xne(e,t,n){function r(i,o){ro.link(i,o,s=>{if(s)return n(s);n(null)})}ME(t,(i,o)=>{if(i)return n(i);if(o)return n(null);ro.lstat(e,s=>{if(s)return s.message=s.message.replace("lstat","ensureLink"),n(s);let a=jE.dirname(t);ME(a,(c,l)=>{if(c)return n(c);if(l)return r(e,t);PE.mkdirs(a,u=>{if(u)return n(u);r(e,t)})})})})}function Lne(e,t){if(ro.existsSync(t))return;try{ro.lstatSync(e)}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let r=jE.dirname(t);return ro.existsSync(r)||PE.mkdirsSync(r),ro.linkSync(e,t)}QE.exports={createLink:Une(xne),createLinkSync:Lne}});var tH=I((Qpe,eH)=>{"use strict";var Pr=require("path"),Wc=z(),Jne=Jn().pathExists;function zne(e,t,n){if(Pr.isAbsolute(e))return Wc.lstat(e,r=>r?(r.message=r.message.replace("lstat","ensureSymlink"),n(r)):n(null,{toCwd:e,toDst:e}));{let r=Pr.dirname(t),i=Pr.join(r,e);return Jne(i,(o,s)=>o?n(o):s?n(null,{toCwd:i,toDst:e}):Wc.lstat(e,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),n(a)):n(null,{toCwd:e,toDst:Pr.relative(r,e)})))}}function One(e,t){let n;if(Pr.isAbsolute(e)){if(n=Wc.existsSync(e),!n)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}else{let r=Pr.dirname(t),i=Pr.join(r,e);if(n=Wc.existsSync(i),n)return{toCwd:i,toDst:e};if(n=Wc.existsSync(e),!n)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:Pr.relative(r,e)}}}eH.exports={symlinkPaths:zne,symlinkPathsSync:One}});var iH=I(($pe,rH)=>{"use strict";var nH=z();function Dne(e,t,n){if(n=typeof t=="function"?t:n,t=typeof t=="function"?!1:t,t)return n(null,t);nH.lstat(e,(r,i)=>{if(r)return n(null,"file");t=i&&i.isDirectory()?"dir":"file",n(null,t)})}function qne(e,t){let n;if(t)return t;try{n=nH.lstatSync(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}rH.exports={symlinkType:Dne,symlinkTypeSync:qne}});var gH=I((efe,lH)=>{"use strict";var Mne=St().fromCallback,sH=require("path"),ps=z(),aH=Lt(),jne=aH.mkdirs,Pne=aH.mkdirsSync,cH=tH(),Qne=cH.symlinkPaths,$ne=cH.symlinkPathsSync,uH=iH(),ere=uH.symlinkType,tre=uH.symlinkTypeSync,oH=Jn().pathExists;function nre(e,t,n,r){r=typeof n=="function"?n:r,n=typeof n=="function"?!1:n,oH(t,(i,o)=>{if(i)return r(i);if(o)return r(null);Qne(e,t,(s,a)=>{if(s)return r(s);e=a.toDst,ere(a.toCwd,n,(c,l)=>{if(c)return r(c);let u=sH.dirname(t);oH(u,(d,g)=>{if(d)return r(d);if(g)return ps.symlink(e,t,l,r);jne(u,m=>{if(m)return r(m);ps.symlink(e,t,l,r)})})})})})}function rre(e,t,n){if(ps.existsSync(t))return;let i=$ne(e,t);e=i.toDst,n=tre(i.toCwd,n);let o=sH.dirname(t);return ps.existsSync(o)||Pne(o),ps.symlinkSync(e,t,n)}lH.exports={createSymlink:Mne(nre),createSymlinkSync:rre}});var IH=I((tfe,dH)=>{"use strict";var Rd=qE(),Vd=$E(),Nd=gH();dH.exports={createFile:Rd.createFile,createFileSync:Rd.createFileSync,ensureFile:Rd.createFile,ensureFileSync:Rd.createFileSync,createLink:Vd.createLink,createLinkSync:Vd.createLinkSync,ensureLink:Vd.createLink,ensureLinkSync:Vd.createLinkSync,createSymlink:Nd.createSymlink,createSymlinkSync:Nd.createSymlinkSync,ensureSymlink:Nd.createSymlink,ensureSymlinkSync:Nd.createSymlinkSync}});var hH=I((nfe,fH)=>{"use strict";var fs;try{fs=z()}catch{fs=require("fs")}function ire(e,t,n){n==null&&(n=t,t={}),typeof t=="string"&&(t={encoding:t}),t=t||{};var r=t.fs||fs,i=!0;"throws"in t&&(i=t.throws),r.readFile(e,t,function(o,s){if(o)return n(o);s=pH(s);var a;try{a=JSON.parse(s,t?t.reviver:null)}catch(c){return i?(c.message=e+": "+c.message,n(c)):n(null,null)}n(null,a)})}function ore(e,t){t=t||{},typeof t=="string"&&(t={encoding:t});var n=t.fs||fs,r=!0;"throws"in t&&(r=t.throws);try{var i=n.readFileSync(e,t);return i=pH(i),JSON.parse(i,t.reviver)}catch(o){if(r)throw o.message=e+": "+o.message,o;return null}}function mH(e,t){var n,r=`
`;typeof t=="object"&&t!==null&&(t.spaces&&(n=t.spaces),t.EOL&&(r=t.EOL));var i=JSON.stringify(e,t?t.replacer:null,n);return i.replace(/\n/g,r)+r}function sre(e,t,n,r){r==null&&(r=n,n={}),n=n||{};var i=n.fs||fs,o="";try{o=mH(t,n)}catch(s){r&&r(s,null);return}i.writeFile(e,o,n,r)}function are(e,t,n){n=n||{};var r=n.fs||fs,i=mH(t,n);return r.writeFileSync(e,i,n)}function pH(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e=e.replace(/^\uFEFF/,""),e}var cre={readFile:ire,readFileSync:ore,writeFile:sre,writeFileSync:are};fH.exports=cre});var Ed=I((rfe,bH)=>{"use strict";var CH=St().fromCallback,wd=hH();bH.exports={readJson:CH(wd.readFile),readJsonSync:wd.readFileSync,writeJson:CH(wd.writeFile),writeJsonSync:wd.writeFileSync}});var BH=I((ife,GH)=>{"use strict";var ure=require("path"),lre=Lt(),gre=Jn().pathExists,yH=Ed();function dre(e,t,n,r){typeof n=="function"&&(r=n,n={});let i=ure.dirname(e);gre(i,(o,s)=>{if(o)return r(o);if(s)return yH.writeJson(e,t,n,r);lre.mkdirs(i,a=>{if(a)return r(a);yH.writeJson(e,t,n,r)})})}GH.exports=dre});var ZH=I((ofe,AH)=>{"use strict";var Ire=z(),mre=require("path"),pre=Lt(),fre=Ed();function hre(e,t,n){let r=mre.dirname(e);Ire.existsSync(r)||pre.mkdirsSync(r),fre.writeJsonSync(e,t,n)}AH.exports=hre});var SH=I((sfe,vH)=>{"use strict";var Cre=St().fromCallback,lt=Ed();lt.outputJson=Cre(BH());lt.outputJsonSync=ZH();lt.outputJSON=lt.outputJson;lt.outputJSONSync=lt.outputJsonSync;lt.writeJSON=lt.writeJson;lt.writeJSONSync=lt.writeJsonSync;lt.readJSON=lt.readJson;lt.readJSONSync=lt.readJsonSync;vH.exports=lt});var EH=I((afe,wH)=>{"use strict";var VH=z(),bre=require("path"),yre=hb().copySync,NH=vc().removeSync,Gre=Lt().mkdirpSync,WH=bc();function Bre(e,t,n){n=n||{};let r=n.overwrite||n.clobber||!1,{srcStat:i}=WH.checkPathsSync(e,t,"move");return WH.checkParentPathsSync(e,i,t,"move"),Gre(bre.dirname(t)),Are(e,t,r)}function Are(e,t,n){if(n)return NH(t),RH(e,t,n);if(VH.existsSync(t))throw new Error("dest already exists.");return RH(e,t,n)}function RH(e,t,n){try{VH.renameSync(e,t)}catch(r){if(r.code!=="EXDEV")throw r;return Zre(e,t,n)}}function Zre(e,t,n){return yre(e,t,{overwrite:n,errorOnExist:!0}),NH(e)}wH.exports=Bre});var YH=I((cfe,HH)=>{"use strict";HH.exports={moveSync:EH()}});var kH=I((ufe,TH)=>{"use strict";var vre=z(),Sre=require("path"),Wre=bb().copy,FH=vc().remove,Rre=Lt().mkdirp,Vre=Jn().pathExists,XH=bc();function Nre(e,t,n,r){typeof n=="function"&&(r=n,n={});let i=n.overwrite||n.clobber||!1;XH.checkPaths(e,t,"move",(o,s)=>{if(o)return r(o);let{srcStat:a}=s;XH.checkParentPaths(e,a,t,"move",c=>{if(c)return r(c);Rre(Sre.dirname(t),l=>l?r(l):wre(e,t,i,r))})})}function wre(e,t,n,r){if(n)return FH(t,i=>i?r(i):_H(e,t,n,r));Vre(t,(i,o)=>i?r(i):o?r(new Error("dest already exists.")):_H(e,t,n,r))}function _H(e,t,n,r){vre.rename(e,t,i=>i?i.code!=="EXDEV"?r(i):Ere(e,t,n,r):r())}function Ere(e,t,n,r){Wre(e,t,{overwrite:n,errorOnExist:!0},o=>o?r(o):FH(e,r))}TH.exports=Nre});var UH=I((lfe,KH)=>{"use strict";var Hre=St().fromCallback;KH.exports={move:Hre(kH())}});var zH=I((gfe,JH)=>{"use strict";var Yre=St().fromCallback,Rc=z(),xH=require("path"),LH=Lt(),Xre=Jn().pathExists;function _re(e,t,n,r){typeof n=="function"&&(r=n,n="utf8");let i=xH.dirname(e);Xre(i,(o,s)=>{if(o)return r(o);if(s)return Rc.writeFile(e,t,n,r);LH.mkdirs(i,a=>{if(a)return r(a);Rc.writeFile(e,t,n,r)})})}function Fre(e,...t){let n=xH.dirname(e);if(Rc.existsSync(n))return Rc.writeFileSync(e,...t);LH.mkdirsSync(n),Rc.writeFileSync(e,...t)}JH.exports={outputFile:Yre(_re),outputFileSync:Fre}});var Bb=I((dfe,Gb)=>{"use strict";Gb.exports=Object.assign({},ib(),hb(),bb(),JE(),IH(),SH(),Lt(),YH(),UH(),zH(),Jn(),vc());var OH=require("fs");Object.getOwnPropertyDescriptor(OH,"promises")&&Object.defineProperty(Gb.exports,"promises",{get(){return OH.promises}})});var qH=I((Ife,DH)=>{"use strict";DH.exports=()=>new Date});var jH=I((mfe,MH)=>{"use strict";var Tre=Fe()("streamroller:fileNameFormatter"),kre=require("path"),Kre=".gz",Ure=".";MH.exports=({file:e,keepFileExt:t,needsIndex:n,alwaysIncludeDate:r,compress:i,fileNameSep:o})=>{let s=o||Ure,a=kre.join(e.dir,e.name),c=m=>m+e.ext,l=(m,h,b)=>(n||!b)&&h?m+s+h:m,u=(m,h,b)=>(h>0||r)&&b?m+s+b:m,d=(m,h)=>h&&i?m+Kre:m,g=t?[u,l,c,d]:[c,u,l,d];return({date:m,index:h})=>(Tre(`_formatFileName: date=${m}, index=${h}`),g.reduce((b,y)=>y(b,h,m),a))}});var eY=I((pfe,$H)=>{"use strict";var io=Fe()("streamroller:fileNameParser"),PH=".gz",QH=yd(),xre=".";$H.exports=({file:e,keepFileExt:t,pattern:n,fileNameSep:r})=>{let i=r||xre,o=(g,m)=>g.endsWith(PH)?(io("it is gzipped"),m.isCompressed=!0,g.slice(0,-1*PH.length)):g,s="__NOT_MATCHING__",d=[o,t?g=>g.startsWith(e.name)&&g.endsWith(e.ext)?(io("it starts and ends with the right things"),g.slice(e.name.length+1,-1*e.ext.length)):s:g=>g.startsWith(e.base)?(io("it starts with the right things"),g.slice(e.base.length+1)):s,n?(g,m)=>{let h=g.split(i),b=h[h.length-1];io("items: ",h,", indexStr: ",b);let y=g;b!==void 0&&b.match(/^\d+$/)?(y=g.slice(0,-1*(b.length+1)),io(`dateStr is ${y}`),n&&!y&&(y=b,b="0")):b="0";try{let v=QH.parse(n,y,new Date(0,0));return QH.asString(n,v)!==y?g:(m.index=parseInt(b,10),m.date=y,m.timestamp=v.getTime(),"")}catch(v){return io(`Problem parsing ${y} as ${n}, error was: `,v),g}}:(g,m)=>g.match(/^\d+$/)?(io("it has an index"),m.index=parseInt(g,10),""):g];return g=>{let m={filename:g,index:0,isCompressed:!1};return d.reduce((b,y)=>y(b,m),g)?null:m}}});var nY=I((ffe,tY)=>{"use strict";var Rt=Fe()("streamroller:moveAndMaybeCompressFile"),Cr=Bb(),Lre=require("zlib"),Jre=function(e){let t={mode:parseInt("0600",8),compress:!1},n=Object.assign({},t,e);return Rt(`_parseOption: moveAndMaybeCompressFile called with option=${JSON.stringify(n)}`),n},zre=async(e,t,n)=>{if(n=Jre(n),e===t){Rt("moveAndMaybeCompressFile: source and target are the same, not doing anything");return}if(await Cr.pathExists(e))if(Rt(`moveAndMaybeCompressFile: moving file from ${e} to ${t} ${n.compress?"with":"without"} compress`),n.compress)await new Promise((r,i)=>{let o=!1,s=Cr.createWriteStream(t,{mode:n.mode,flags:"wx"}).on("open",()=>{o=!0;let a=Cr.createReadStream(e).on("open",()=>{a.pipe(Lre.createGzip()).pipe(s)}).on("error",c=>{Rt(`moveAndMaybeCompressFile: error reading ${e}`,c),s.destroy(c)})}).on("finish",()=>{Rt(`moveAndMaybeCompressFile: finished compressing ${t}, deleting ${e}`),Cr.unlink(e).then(r).catch(a=>{Rt(`moveAndMaybeCompressFile: error deleting ${e}, truncating instead`,a),Cr.truncate(e).then(r).catch(c=>{Rt(`moveAndMaybeCompressFile: error truncating ${e}`,c),i(c)})})}).on("error",a=>{o?(Rt(`moveAndMaybeCompressFile: error writing ${t}, deleting`,a),Cr.unlink(t).then(()=>{i(a)}).catch(c=>{Rt(`moveAndMaybeCompressFile: error deleting ${t}`,c),i(c)})):(Rt(`moveAndMaybeCompressFile: error creating ${t}`,a),i(a))})}).catch(()=>{});else{Rt(`moveAndMaybeCompressFile: renaming ${e} to ${t}`);try{await Cr.move(e,t,{overwrite:!0})}catch(r){if(Rt(`moveAndMaybeCompressFile: error renaming ${e} to ${t}`,r),r.code!=="ENOENT"){Rt("moveAndMaybeCompressFile: trying copy+truncate instead");try{await Cr.copy(e,t,{overwrite:!0}),await Cr.truncate(e)}catch(i){Rt("moveAndMaybeCompressFile: error copy+truncate",i)}}}}};tY.exports=zre});var Xd=I((hfe,rY)=>{"use strict";var Jt=Fe()("streamroller:RollingFileWriteStream"),so=Bb(),oo=require("path"),Ore=require("os"),Hd=qH(),Yd=yd(),{Writable:Dre}=require("stream"),qre=jH(),Mre=eY(),jre=nY(),Pre=e=>(Jt(`deleteFiles: files to delete: ${e}`),Promise.all(e.map(t=>so.unlink(t).catch(n=>{Jt(`deleteFiles: error when unlinking ${t}, ignoring. Error was ${n}`)})))),Ab=class extends Dre{constructor(t,n){if(Jt(`constructor: creating RollingFileWriteStream. path=${t}`),typeof t!="string"||t.length===0)throw new Error(`Invalid filename: ${t}`);if(t.endsWith(oo.sep))throw new Error(`Filename is a directory: ${t}`);t.indexOf(`~${oo.sep}`)===0&&(t=t.replace("~",Ore.homedir())),super(n),this.options=this._parseOption(n),this.fileObject=oo.parse(t),this.fileObject.dir===""&&(this.fileObject=oo.parse(oo.join(process.cwd(),t))),this.fileFormatter=qre({file:this.fileObject,alwaysIncludeDate:this.options.alwaysIncludePattern,needsIndex:this.options.maxSize<Number.MAX_SAFE_INTEGER,compress:this.options.compress,keepFileExt:this.options.keepFileExt,fileNameSep:this.options.fileNameSep}),this.fileNameParser=Mre({file:this.fileObject,keepFileExt:this.options.keepFileExt,pattern:this.options.pattern,fileNameSep:this.options.fileNameSep}),this.state={currentSize:0},this.options.pattern&&(this.state.currentDate=Yd(this.options.pattern,Hd())),this.filename=this.fileFormatter({index:0,date:this.state.currentDate}),["a","a+","as","as+"].includes(this.options.flags)&&this._setExistingSizeAndDate(),Jt(`constructor: create new file ${this.filename}, state=${JSON.stringify(this.state)}`),this._renewWriteStream()}_setExistingSizeAndDate(){try{let t=so.statSync(this.filename);this.state.currentSize=t.size,this.options.pattern&&(this.state.currentDate=Yd(this.options.pattern,t.mtime))}catch{return}}_parseOption(t){let n={maxSize:0,numToKeep:Number.MAX_SAFE_INTEGER,encoding:"utf8",mode:parseInt("0600",8),flags:"a",compress:!1,keepFileExt:!1,alwaysIncludePattern:!1},r=Object.assign({},n,t);if(!r.maxSize)delete r.maxSize;else if(r.maxSize<=0)throw new Error(`options.maxSize (${r.maxSize}) should be > 0`);if(r.numBackups||r.numBackups===0){if(r.numBackups<0)throw new Error(`options.numBackups (${r.numBackups}) should be >= 0`);if(r.numBackups>=Number.MAX_SAFE_INTEGER)throw new Error(`options.numBackups (${r.numBackups}) should be < Number.MAX_SAFE_INTEGER`);r.numToKeep=r.numBackups+1}else if(r.numToKeep<=0)throw new Error(`options.numToKeep (${r.numToKeep}) should be > 0`);return Jt(`_parseOption: creating stream with option=${JSON.stringify(r)}`),r}_final(t){this.currentFileStream.end("",this.options.encoding,t)}_write(t,n,r){this._shouldRoll().then(()=>{Jt(`_write: writing chunk. file=${this.currentFileStream.path} state=${JSON.stringify(this.state)} chunk=${t}`),this.currentFileStream.write(t,n,i=>{this.state.currentSize+=t.length,r(i)})})}async _shouldRoll(){(this._dateChanged()||this._tooBig())&&(Jt(`_shouldRoll: rolling because dateChanged? ${this._dateChanged()} or tooBig? ${this._tooBig()}`),await this._roll())}_dateChanged(){return this.state.currentDate&&this.state.currentDate!==Yd(this.options.pattern,Hd())}_tooBig(){return this.state.currentSize>=this.options.maxSize}_roll(){return Jt("_roll: closing the current stream"),new Promise((t,n)=>{this.currentFileStream.end("",this.options.encoding,()=>{this._moveOldFiles().then(t).catch(n)})})}async _moveOldFiles(){let t=await this._getExistingFiles(),n=this.state.currentDate?t.filter(r=>r.date===this.state.currentDate):t;for(let r=n.length;r>=0;r--){Jt(`_moveOldFiles: i = ${r}`);let i=this.fileFormatter({date:this.state.currentDate,index:r}),o=this.fileFormatter({date:this.state.currentDate,index:r+1}),s={compress:this.options.compress&&r===0,mode:this.options.mode};await jre(i,o,s)}this.state.currentSize=0,this.state.currentDate=this.state.currentDate?Yd(this.options.pattern,Hd()):null,Jt(`_moveOldFiles: finished rolling files. state=${JSON.stringify(this.state)}`),this._renewWriteStream(),await new Promise((r,i)=>{this.currentFileStream.write("","utf8",()=>{this._clean().then(r).catch(i)})})}async _getExistingFiles(){let t=await so.readdir(this.fileObject.dir).catch(()=>[]);Jt(`_getExistingFiles: files=${t}`);let n=t.map(i=>this.fileNameParser(i)).filter(i=>i),r=i=>(i.timestamp?i.timestamp:Hd().getTime())-i.index;return n.sort((i,o)=>r(i)-r(o)),n}_renewWriteStream(){let t=this.fileFormatter({date:this.state.currentDate,index:0}),n=o=>{try{return so.mkdirSync(o,{recursive:!0})}catch(s){if(s.code==="ENOENT")return n(oo.dirname(o)),n(o);if(s.code!=="EEXIST"&&s.code!=="EROFS")throw s;try{if(so.statSync(o).isDirectory())return o;throw s}catch{throw s}}};n(this.fileObject.dir);let r={flags:this.options.flags,encoding:this.options.encoding,mode:this.options.mode},i=function(o,s,a){return o[a]=o[s],delete o[s],o};so.appendFileSync(t,"",i({...r},"flags","flag")),this.currentFileStream=so.createWriteStream(t,r),this.currentFileStream.on("error",o=>{this.emit("error",o)})}async _clean(){let t=await this._getExistingFiles();if(Jt(`_clean: numToKeep = ${this.options.numToKeep}, existingFiles = ${t.length}`),Jt("_clean: existing files are: ",t),this._tooManyFiles(t.length)){let n=t.slice(0,t.length-this.options.numToKeep).map(r=>oo.format({dir:this.fileObject.dir,base:r.filename}));await Pre(n)}}_tooManyFiles(t){return this.options.numToKeep>0&&t>this.options.numToKeep}};rY.exports=Ab});var oY=I((Cfe,iY)=>{"use strict";var Qre=Xd(),Zb=class extends Qre{constructor(t,n,r,i){i||(i={}),n&&(i.maxSize=n),!i.numBackups&&i.numBackups!==0&&(!r&&r!==0&&(r=1),i.numBackups=r),super(t,i),this.backups=i.numBackups,this.size=this.options.maxSize}get theStream(){return this.currentFileStream}};iY.exports=Zb});var aY=I((bfe,sY)=>{"use strict";var $re=Xd(),vb=class extends $re{constructor(t,n,r){n&&typeof n=="object"&&(r=n,n=null),r||(r={}),n||(n="yyyy-MM-dd"),r.pattern=n,!r.numBackups&&r.numBackups!==0?(!r.daysToKeep&&r.daysToKeep!==0?r.daysToKeep=1:process.emitWarning("options.daysToKeep is deprecated due to the confusion it causes when used together with file size rolling. Please use options.numBackups instead.","DeprecationWarning","streamroller-DEP0001"),r.numBackups=r.daysToKeep):r.daysToKeep=r.numBackups,super(t,r),this.mode=this.options.mode}get theStream(){return this.currentFileStream}};sY.exports=vb});var Sb=I((yfe,cY)=>{"use strict";cY.exports={RollingFileWriteStream:Xd(),RollingFileStream:oY(),DateRollingFileStream:aY()}});var IY=I((Gfe,dY)=>{"use strict";var uY=Fe()("log4js:file"),Wb=require("path"),eie=Sb(),gY=require("os"),tie=gY.EOL,_d=!1,Fd=new Set;function lY(){Fd.forEach(e=>{e.sighupHandler()})}function nie(e,t,n,r,i,o){if(typeof e!="string"||e.length===0)throw new Error(`Invalid filename: ${e}`);if(e.endsWith(Wb.sep))throw new Error(`Filename is a directory: ${e}`);e.indexOf(`~${Wb.sep}`)===0&&(e=e.replace("~",gY.homedir())),e=Wb.normalize(e),r=!r&&r!==0?5:r,uY("Creating file appender (",e,", ",n,", ",r,", ",i,", ",o,")");function s(l,u,d,g){let m=new eie.RollingFileStream(l,u,d,g);return m.on("error",h=>{console.error("log4js.fileAppender - Writing to file %s, error happened ",l,h)}),m.on("drain",()=>{process.emit("log4js:pause",!1)}),m}let a=s(e,n,r,i),c=function(l){if(a.writable){if(i.removeColor===!0){let u=/\x1b[[0-9;]*m/g;l.data=l.data.map(d=>typeof d=="string"?d.replace(u,""):d)}a.write(t(l,o)+tie,"utf8")||process.emit("log4js:pause",!0)}};return c.reopen=function(){a.end(()=>{a=s(e,n,r,i)})},c.sighupHandler=function(){uY("SIGHUP handler called."),c.reopen()},c.shutdown=function(l){Fd.delete(c),Fd.size===0&&_d&&(process.removeListener("SIGHUP",lY),_d=!1),a.end("","utf-8",l)},Fd.add(c),_d||(process.on("SIGHUP",lY),_d=!0),c}function rie(e,t){let n=t.basicLayout;return e.layout&&(n=t.layout(e.layout.type,e.layout)),e.mode=e.mode||384,nie(e.filename,n,e.maxLogSize,e.backups,e,e.timezoneOffset)}dY.exports.configure=rie});var pY=I((Bfe,mY)=>{"use strict";var iie=Sb(),oie=require("os"),sie=oie.EOL;function aie(e,t,n){let r=new iie.DateRollingFileStream(e,t,n);return r.on("error",i=>{console.error("log4js.dateFileAppender - Writing to file %s, error happened ",e,i)}),r.on("drain",()=>{process.emit("log4js:pause",!1)}),r}function cie(e,t,n,r,i){r.maxSize=r.maxLogSize;let o=aie(e,t,r),s=function(a){o.writable&&(o.write(n(a,i)+sie,"utf8")||process.emit("log4js:pause",!0))};return s.shutdown=function(a){o.end("","utf-8",a)},s}function uie(e,t){let n=t.basicLayout;return e.layout&&(n=t.layout(e.layout.type,e.layout)),e.alwaysIncludePattern||(e.alwaysIncludePattern=!1),e.mode=e.mode||384,cie(e.filename,e.pattern,n,e,e.timezoneOffset)}mY.exports.configure=uie});var bY=I((Afe,CY)=>{"use strict";var br=Fe()("log4js:fileSync"),On=require("path"),zn=require("fs"),fY=require("os"),lie=fY.EOL;function hY(e,t){let n=r=>{try{return zn.mkdirSync(r,{recursive:!0})}catch(i){if(i.code==="ENOENT")return n(On.dirname(r)),n(r);if(i.code!=="EEXIST"&&i.code!=="EROFS")throw i;try{if(zn.statSync(r).isDirectory())return r;throw i}catch{throw i}}};n(On.dirname(e)),zn.appendFileSync(e,"",{mode:t.mode,flag:t.flags})}var Rb=class{constructor(t,n,r,i){if(br("In RollingFileStream"),n<0)throw new Error(`maxLogSize (${n}) should be > 0`);this.filename=t,this.size=n,this.backups=r,this.options=i,this.currentSize=0;function o(s){let a=0;try{a=zn.statSync(s).size}catch{hY(s,i)}return a}this.currentSize=o(this.filename)}shouldRoll(){return br("should roll with current size %d, and max size %d",this.currentSize,this.size),this.currentSize>=this.size}roll(t){let n=this,r=new RegExp(`^${On.basename(t)}`);function i(l){return r.test(l)}function o(l){return parseInt(l.slice(`${On.basename(t)}.`.length),10)||0}function s(l,u){return o(l)-o(u)}function a(l){let u=o(l);if(br(`Index of ${l} is ${u}`),n.backups===0)zn.truncateSync(t,0);else if(u<n.backups){try{zn.unlinkSync(`${t}.${u+1}`)}catch{}br(`Renaming ${l} -> ${t}.${u+1}`),zn.renameSync(On.join(On.dirname(t),l),`${t}.${u+1}`)}}function c(){br("Renaming the old files"),zn.readdirSync(On.dirname(t)).filter(i).sort(s).reverse().forEach(a)}br("Rolling, rolling, rolling"),c()}write(t,n){let r=this;function i(){br("writing the chunk to the file"),r.currentSize+=t.length,zn.appendFileSync(r.filename,t)}br("in write"),this.shouldRoll()&&(this.currentSize=0,this.roll(this.filename)),i()}};function gie(e,t,n,r,i,o){if(typeof e!="string"||e.length===0)throw new Error(`Invalid filename: ${e}`);if(e.endsWith(On.sep))throw new Error(`Filename is a directory: ${e}`);e.indexOf(`~${On.sep}`)===0&&(e=e.replace("~",fY.homedir())),e=On.normalize(e),r=!r&&r!==0?5:r,br("Creating fileSync appender (",e,", ",n,", ",r,", ",i,", ",o,")");function s(c,l,u){let d;return l?d=new Rb(c,l,u,i):d=(g=>(hY(g,i),{write(m){zn.appendFileSync(g,m)}}))(c),d}let a=s(e,n,r);return c=>{a.write(t(c,o)+lie)}}function die(e,t){let n=t.basicLayout;e.layout&&(n=t.layout(e.layout.type,e.layout));let r={flags:e.flags||"a",encoding:e.encoding||"utf8",mode:e.mode||384};return gie(e.filename,n,e.maxLogSize,e.backups,r,e.timezoneOffset)}CY.exports.configure=die});var GY=I((Zfe,yY)=>{"use strict";var Dn=Fe()("log4js:tcp"),Iie=require("net");function mie(e,t){let n=!1,r=[],i,o=3,s="__LOG4JS__";function a(d){Dn("Writing log event to socket"),n=i.write(`${t(d)}${s}`,"utf8")}function c(){let d;for(Dn("emptying buffer");d=r.shift();)a(d)}function l(){Dn(`appender creating socket to ${e.host||"localhost"}:${e.port||5e3}`),s=`${e.endMsg||"__LOG4JS__"}`,i=Iie.createConnection(e.port||5e3,e.host||"localhost"),i.on("connect",()=>{Dn("socket connected"),c(),n=!0}),i.on("drain",()=>{Dn("drain event received, emptying buffer"),n=!0,c()}),i.on("timeout",i.end.bind(i)),i.on("error",d=>{Dn("connection error",d),n=!1,c()}),i.on("close",l)}l();function u(d){n?a(d):(Dn("buffering log event because it cannot write at the moment"),r.push(d))}return u.shutdown=function(d){Dn("shutdown called"),r.length&&o?(Dn("buffer has items, waiting 100ms to empty"),o-=1,setTimeout(()=>{u.shutdown(d)},100)):(i.removeAllListeners("close"),i.end(d))},u}function pie(e,t){Dn(`configure with config = ${e}`);let n=function(r){return r.serialise()};return e.layout&&(n=t.layout(e.layout.type,e.layout)),mie(e,n)}yY.exports.configure=pie});var wb=I((vfe,Nb)=>{"use strict";var Vb=require("path"),Qr=Fe()("log4js:appenders"),un=$i(),BY=Zd(),fie=to(),hie=jC(),Cie=Vw(),Cn=new Map;Cn.set("console",ww());Cn.set("stdout",Hw());Cn.set("stderr",Xw());Cn.set("logLevelFilter",Fw());Cn.set("categoryFilter",Kw());Cn.set("noLogFilter",Lw());Cn.set("file",IY());Cn.set("dateFile",pY());Cn.set("fileSync",bY());Cn.set("tcp",GY());var Vc=new Map,Td=(e,t)=>{let n;try{let r=`${e}.cjs`;n=require.resolve(r),Qr("Loading module from ",r)}catch{n=e,Qr("Loading module from ",e)}try{return require(n)}catch(r){un.throwExceptionIf(t,r.code!=="MODULE_NOT_FOUND",`appender "${e}" could not be loaded (error was: ${r})`);return}},bie=(e,t)=>Cn.get(e)||Td(`./${e}`,t)||Td(e,t)||require.main&&require.main.filename&&Td(Vb.join(Vb.dirname(require.main.filename),e),t)||Td(Vb.join(process.cwd(),e),t),kd=new Set,AY=(e,t)=>{if(Vc.has(e))return Vc.get(e);if(!t.appenders[e])return!1;if(kd.has(e))throw new Error(`Dependency loop detected for appender ${e}.`);kd.add(e),Qr(`Creating appender ${e}`);let n=yie(e,t);return kd.delete(e),Vc.set(e,n),n},yie=(e,t)=>{let n=t.appenders[e],r=n.type.configure?n.type:bie(n.type,t);return un.throwExceptionIf(t,un.not(r),`appender "${e}" is not valid (type "${n.type}" could not be found)`),r.appender&&(process.emitWarning(`Appender ${n.type} exports an appender function.`,"DeprecationWarning","log4js-node-DEP0001"),Qr("[log4js-node-DEP0001]",`DEPRECATION: Appender ${n.type} exports an appender function.`)),r.shutdown&&(process.emitWarning(`Appender ${n.type} exports a shutdown function.`,"DeprecationWarning","log4js-node-DEP0002"),Qr("[log4js-node-DEP0002]",`DEPRECATION: Appender ${n.type} exports a shutdown function.`)),Qr(`${e}: clustering.isMaster ? ${BY.isMaster()}`),Qr(`${e}: appenderModule is ${require("util").inspect(r)}`),BY.onlyOnMaster(()=>(Qr(`calling appenderModule.configure for ${e} / ${n.type}`),r.configure(Cie.modifyConfig(n),hie,i=>AY(i,t),fie)),()=>{})},ZY=e=>{if(Vc.clear(),kd.clear(),!e)return;let t=[];Object.values(e.categories).forEach(n=>{t.push(...n.appenders)}),Object.keys(e.appenders).forEach(n=>{(t.includes(n)||e.appenders[n].type==="tcp-server"||e.appenders[n].type==="multiprocess")&&AY(n,e)})},vY=()=>{ZY()};vY();un.addListener(e=>{un.throwExceptionIf(e,un.not(un.anObject(e.appenders)),'must have a property "appenders" of type object.');let t=Object.keys(e.appenders);un.throwExceptionIf(e,un.not(t.length),"must define at least one appender."),t.forEach(n=>{un.throwExceptionIf(e,un.not(e.appenders[n].type),`appender "${n}" is not valid (must be an object with property "type")`)})});un.addListener(ZY);Nb.exports=Vc;Nb.exports.init=vY});var Yb=I((Sfe,Kd)=>{"use strict";var Nc=Fe()("log4js:categories"),Ze=$i(),Eb=to(),SY=wb(),$r=new Map;function WY(e,t,n){if(t.inherit===!1)return;let r=n.lastIndexOf(".");if(r<0)return;let i=n.slice(0,r),o=e.categories[i];o||(o={inherit:!0,appenders:[]}),WY(e,o,i),!e.categories[i]&&o.appenders&&o.appenders.length&&o.level&&(e.categories[i]=o),t.appenders=t.appenders||[],t.level=t.level||o.level,o.appenders.forEach(s=>{t.appenders.includes(s)||t.appenders.push(s)}),t.parent=o}function Gie(e){if(!e.categories)return;Object.keys(e.categories).forEach(n=>{let r=e.categories[n];WY(e,r,n)})}Ze.addPreProcessingListener(e=>Gie(e));Ze.addListener(e=>{Ze.throwExceptionIf(e,Ze.not(Ze.anObject(e.categories)),'must have a property "categories" of type object.');let t=Object.keys(e.categories);Ze.throwExceptionIf(e,Ze.not(t.length),"must define at least one category."),t.forEach(n=>{let r=e.categories[n];Ze.throwExceptionIf(e,[Ze.not(r.appenders),Ze.not(r.level)],`category "${n}" is not valid (must be an object with properties "appenders" and "level")`),Ze.throwExceptionIf(e,Ze.not(Array.isArray(r.appenders)),`category "${n}" is not valid (appenders must be an array of appender names)`),Ze.throwExceptionIf(e,Ze.not(r.appenders.length),`category "${n}" is not valid (appenders must contain at least one appender name)`),Object.prototype.hasOwnProperty.call(r,"enableCallStack")&&Ze.throwExceptionIf(e,typeof r.enableCallStack!="boolean",`category "${n}" is not valid (enableCallStack must be boolean type)`),r.appenders.forEach(i=>{Ze.throwExceptionIf(e,Ze.not(SY.get(i)),`category "${n}" is not valid (appender "${i}" is not defined)`)}),Ze.throwExceptionIf(e,Ze.not(Eb.getLevel(r.level)),`category "${n}" is not valid (level "${r.level}" not recognised; valid levels are ${Eb.levels.join(", ")})`)}),Ze.throwExceptionIf(e,Ze.not(e.categories.default),'must define a "default" category.')});var Hb=e=>{if($r.clear(),!e)return;Object.keys(e.categories).forEach(n=>{let r=e.categories[n],i=[];r.appenders.forEach(o=>{i.push(SY.get(o)),Nc(`Creating category ${n}`),$r.set(n,{appenders:i,level:Eb.getLevel(r.level),enableCallStack:r.enableCallStack||!1})})})},RY=()=>{Hb()};RY();Ze.addListener(Hb);var hs=e=>{if(Nc(`configForCategory: searching for config for ${e}`),$r.has(e))return Nc(`configForCategory: ${e} exists in config, returning it`),$r.get(e);let t;return e.indexOf(".")>0?(Nc(`configForCategory: ${e} has hierarchy, cloning from parents`),t={...hs(e.slice(0,e.lastIndexOf(".")))}):($r.has("default")||Hb({categories:{default:{appenders:["out"],level:"OFF"}}}),Nc("configForCategory: cloning default category"),t={...$r.get("default")}),$r.set(e,t),t},Bie=e=>hs(e).appenders,Aie=e=>hs(e).level,Zie=(e,t)=>{hs(e).level=t},vie=e=>hs(e).enableCallStack===!0,Sie=(e,t)=>{hs(e).enableCallStack=t};Kd.exports=$r;Kd.exports=Object.assign(Kd.exports,{appendersForCategory:Bie,getLevelForCategory:Aie,setLevelForCategory:Zie,getEnableCallStackForCategory:vie,setEnableCallStackForCategory:Sie,init:RY})});var XY=I((Wfe,YY)=>{"use strict";var VY=Fe()("log4js:logger"),Wie=$C(),qn=to(),Rie=Zd(),Ud=Yb(),wY=$i(),Vie=/^(?:\s*)at (?:(.+) \()?(?:([^(]+?):(\d+):(\d+))\)?$/,Xb=1,EY=3;function NY(e,t=EY+Xb){try{let n=e.stack.split(`
`).slice(t);if(!n.length)return null;let r=Vie.exec(n[0]);if(r&&r.length===5){let i="",o="",s="";return r[1]&&r[1]!==""&&([o,s]=r[1].replace(/[[\]]/g,"").split(" as "),s=s||"",o.includes(".")&&([i,o]=o.split("."))),{fileName:r[2],lineNumber:parseInt(r[3],10),columnNumber:parseInt(r[4],10),callStack:n.join(`
`),className:i,functionName:o,functionAlias:s,callerName:r[1]||""}}else console.error("log4js.logger - defaultParseCallStack error")}catch(n){console.error("log4js.logger - defaultParseCallStack error",n)}return null}var wc=class{constructor(t){if(!t)throw new Error("No category provided.");this.category=t,this.context={},this.callStackSkipIndex=0,this.parseCallStack=NY,VY(`Logger created (${this.category}, ${this.level})`)}get level(){return qn.getLevel(Ud.getLevelForCategory(this.category),qn.OFF)}set level(t){Ud.setLevelForCategory(this.category,qn.getLevel(t,this.level))}get useCallStack(){return Ud.getEnableCallStackForCategory(this.category)}set useCallStack(t){Ud.setEnableCallStackForCategory(this.category,t===!0)}get callStackLinesToSkip(){return this.callStackSkipIndex}set callStackLinesToSkip(t){if(typeof t!="number")throw new TypeError("Must be a number");if(t<0)throw new RangeError("Must be >= 0");this.callStackSkipIndex=t}log(t,...n){let r=qn.getLevel(t);r?this.isLevelEnabled(r)&&this._log(r,n):wY.validIdentifier(t)&&n.length>0?(this.log(qn.WARN,"log4js:logger.log: valid log-level not found as first parameter given:",t),this.log(qn.INFO,`[${t}]`,...n)):this.log(qn.INFO,t,...n)}isLevelEnabled(t){return this.level.isLessThanOrEqualTo(t)}_log(t,n){VY(`sending log data (${t}) to appenders`);let r=n.find(s=>s instanceof Error),i;if(this.useCallStack){try{r&&(i=this.parseCallStack(r,this.callStackSkipIndex+Xb))}catch{}i=i||this.parseCallStack(new Error,this.callStackSkipIndex+EY+Xb)}let o=new Wie(this.category,t,n,this.context,i,r);Rie.send(o)}addContext(t,n){this.context[t]=n}removeContext(t){delete this.context[t]}clearContext(){this.context={}}setParseCallStackFunction(t){if(typeof t=="function")this.parseCallStack=t;else if(typeof t>"u")this.parseCallStack=NY;else throw new TypeError("Invalid type passed to setParseCallStackFunction")}};function HY(e){let t=qn.getLevel(e),r=t.toString().toLowerCase().replace(/_([a-z])/g,o=>o[1].toUpperCase()),i=r[0].toUpperCase()+r.slice(1);wc.prototype[`is${i}Enabled`]=function(){return this.isLevelEnabled(t)},wc.prototype[r]=function(...o){this.log(t,...o)}}qn.levels.forEach(HY);wY.addListener(()=>{qn.levels.forEach(HY)});YY.exports=wc});var TY=I((Rfe,FY)=>{"use strict";var Cs=to(),Nie=':remote-addr - - ":method :url HTTP/:http-version" :status :content-length ":referrer" ":user-agent"';function wie(e){return e.originalUrl||e.url}function Eie(e,t,n){let r=o=>{let s=o.concat();for(let a=0;a<s.length;++a)for(let c=a+1;c<s.length;++c)s[a].token==s[c].token&&s.splice(c--,1);return s},i=[];return i.push({token:":url",replacement:wie(e)}),i.push({token:":protocol",replacement:e.protocol}),i.push({token:":hostname",replacement:e.hostname}),i.push({token:":method",replacement:e.method}),i.push({token:":status",replacement:t.__statusCode||t.statusCode}),i.push({token:":response-time",replacement:t.responseTime}),i.push({token:":date",replacement:new Date().toUTCString()}),i.push({token:":referrer",replacement:e.headers.referer||e.headers.referrer||""}),i.push({token:":http-version",replacement:`${e.httpVersionMajor}.${e.httpVersionMinor}`}),i.push({token:":remote-addr",replacement:e.headers["x-forwarded-for"]||e.ip||e._remoteAddress||e.socket&&(e.socket.remoteAddress||e.socket.socket&&e.socket.socket.remoteAddress)}),i.push({token:":user-agent",replacement:e.headers["user-agent"]}),i.push({token:":content-length",replacement:t.getHeader("content-length")||t.__headers&&t.__headers["Content-Length"]||"-"}),i.push({token:/:req\[([^\]]+)]/g,replacement(o,s){return e.headers[s.toLowerCase()]}}),i.push({token:/:res\[([^\]]+)]/g,replacement(o,s){return t.getHeader(s.toLowerCase())||t.__headers&&t.__headers[s]}}),r(n.concat(i))}function _Y(e,t){for(let n=0;n<t.length;n++)e=e.replace(t[n].token,t[n].replacement);return e}function Hie(e){let t=null;if(e instanceof RegExp&&(t=e),typeof e=="string"&&(t=new RegExp(e)),Array.isArray(e)){let n=e.map(r=>r.source?r.source:r);t=new RegExp(n.join("|"))}return t}function Yie(e,t,n){let r=t;if(n){let i=n.find(o=>{let s=!1;return o.from&&o.to?s=e>=o.from&&e<=o.to:s=o.codes.indexOf(e)!==-1,s});i&&(r=Cs.getLevel(i.level,r))}return r}FY.exports=function(t,n){typeof n=="string"||typeof n=="function"?n={format:n}:n=n||{};let r=t,i=Cs.getLevel(n.level,Cs.INFO),o=n.format||Nie;return(s,a,c)=>{if(typeof s._logging<"u")return c();if(typeof n.nolog!="function"){let l=Hie(n.nolog);if(l&&l.test(s.originalUrl))return c()}if(r.isLevelEnabled(i)||n.level==="auto"){let l=new Date,{writeHead:u}=a;s._logging=!0,a.writeHead=(m,h)=>{a.writeHead=u,a.writeHead(m,h),a.__statusCode=m,a.__headers=h||{}};let d=!1,g=()=>{if(d)return;if(d=!0,typeof n.nolog=="function"&&n.nolog(s,a)===!0){s._logging=!1;return}a.responseTime=new Date-l,a.statusCode&&n.level==="auto"&&(i=Cs.INFO,a.statusCode>=300&&(i=Cs.WARN),a.statusCode>=400&&(i=Cs.ERROR)),i=Yie(a.statusCode,i,n.statusRules);let m=Eie(s,a,n.tokens||[]);if(n.context&&r.addContext("res",a),typeof o=="function"){let h=o(s,a,b=>_Y(b,m));h&&r.log(i,h)}else r.log(i,_Y(o,m));n.context&&r.removeContext("res")};a.on("end",g),a.on("finish",g),a.on("error",g),a.on("close",g)}return c()}}});var LY=I((Vfe,xY)=>{"use strict";var kY=Fe()("log4js:recording"),xd=[];function Xie(){return function(e){kY(`received logEvent, number of events now ${xd.length+1}`),kY("log event was ",e),xd.push(e)}}function KY(){return xd.slice()}function UY(){xd.length=0}xY.exports={configure:Xie,replay:KY,playback:KY,reset:UY,erase:UY}});var jY=I((Nfe,MY)=>{"use strict";var ei=Fe()("log4js:main"),_ie=require("fs"),Fie=L2()({proto:!0}),Tie=$i(),kie=jC(),Kie=to(),JY=wb(),zY=Yb(),Uie=XY(),xie=Zd(),Lie=TY(),Jie=LY(),bs=!1;function zie(e){if(!bs)return;ei("Received log event ",e),zY.appendersForCategory(e.categoryName).forEach(n=>{n(e)})}function Oie(e){ei(`Loading configuration from ${e}`);try{return JSON.parse(_ie.readFileSync(e,"utf8"))}catch(t){throw new Error(`Problem reading config from file "${e}". Error was ${t.message}`,t)}}function OY(e){bs&&DY();let t=e;return typeof t=="string"&&(t=Oie(e)),ei(`Configuration is ${t}`),Tie.configure(Fie(t)),xie.onMessage(zie),bs=!0,qY}function Die(){return bs}function qie(){return Jie}function DY(e=()=>{}){if(typeof e!="function")throw new TypeError("Invalid callback passed to shutdown");ei("Shutdown called. Disabling all log writing."),bs=!1;let t=Array.from(JY.values());JY.init(),zY.init();let n=t.reduce((s,a)=>a.shutdown?s+1:s,0);n===0&&(ei("No appenders with shutdown functions found."),e());let r=0,i;ei(`Found ${n} appenders with shutdown functions.`);function o(s){i=i||s,r+=1,ei(`Appender shutdowns complete: ${r} / ${n}`),r>=n&&(ei("All shutdown functions completed."),e(i))}t.filter(s=>s.shutdown).forEach(s=>s.shutdown(o))}function Mie(e){return bs||OY(process.env.LOG4JS_CONFIG||{appenders:{out:{type:"stdout"}},categories:{default:{appenders:["out"],level:"OFF"}}}),new Uie(e||"default")}var qY={getLogger:Mie,configure:OY,isConfigured:Die,shutdown:DY,connectLogger:Lie,levels:Kie,addLayout:kie.addLayout,recording:qie};MY.exports=qY});var ge=I(_b=>{"use strict";_b.fromCallback=function(e){return Object.defineProperty(function(...t){if(typeof t[t.length-1]=="function")e.apply(this,t);else return new Promise((n,r)=>{t.push((i,o)=>i!=null?r(i):n(o)),e.apply(this,t)})},"name",{value:e.name})};_b.fromPromise=function(e){return Object.defineProperty(function(...t){let n=t[t.length-1];if(typeof n!="function")return e.apply(this,t);t.pop(),e.apply(this,t).then(r=>n(null,r),n)},"name",{value:e.name})}});var dt=I(yr=>{"use strict";var PY=ge().fromCallback,gt=z(),jie=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof gt[e]=="function");Object.assign(yr,gt);jie.forEach(e=>{yr[e]=PY(gt[e])});yr.exists=function(e,t){return typeof t=="function"?gt.exists(e,t):new Promise(n=>gt.exists(e,n))};yr.read=function(e,t,n,r,i,o){return typeof o=="function"?gt.read(e,t,n,r,i,o):new Promise((s,a)=>{gt.read(e,t,n,r,i,(c,l,u)=>{if(c)return a(c);s({bytesRead:l,buffer:u})})})};yr.write=function(e,t,...n){return typeof n[n.length-1]=="function"?gt.write(e,t,...n):new Promise((r,i)=>{gt.write(e,t,...n,(o,s,a)=>{if(o)return i(o);r({bytesWritten:s,buffer:a})})})};yr.readv=function(e,t,...n){return typeof n[n.length-1]=="function"?gt.readv(e,t,...n):new Promise((r,i)=>{gt.readv(e,t,...n,(o,s,a)=>{if(o)return i(o);r({bytesRead:s,buffers:a})})})};yr.writev=function(e,t,...n){return typeof n[n.length-1]=="function"?gt.writev(e,t,...n):new Promise((r,i)=>{gt.writev(e,t,...n,(o,s,a)=>{if(o)return i(o);r({bytesWritten:s,buffers:a})})})};typeof gt.realpath.native=="function"?yr.realpath.native=PY(gt.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var $Y=I((Hfe,QY)=>{"use strict";var Pie=require("path");QY.exports.checkPath=function(t){if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(Pie.parse(t).root,""))){let r=new Error(`Path contains invalid characters: ${t}`);throw r.code="EINVAL",r}}});var rX=I((Yfe,Fb)=>{"use strict";var eX=dt(),{checkPath:tX}=$Y(),nX=e=>{let t={mode:511};return typeof e=="number"?e:{...t,...e}.mode};Fb.exports.makeDir=async(e,t)=>(tX(e),eX.mkdir(e,{mode:nX(t),recursive:!0}));Fb.exports.makeDirSync=(e,t)=>(tX(e),eX.mkdirSync(e,{mode:nX(t),recursive:!0}))});var bn=I((Xfe,iX)=>{"use strict";var Qie=ge().fromPromise,{makeDir:$ie,makeDirSync:Tb}=rX(),kb=Qie($ie);iX.exports={mkdirs:kb,mkdirsSync:Tb,mkdirp:kb,mkdirpSync:Tb,ensureDir:kb,ensureDirSync:Tb}});var ti=I((_fe,sX)=>{"use strict";var eoe=ge().fromPromise,oX=dt();function toe(e){return oX.access(e).then(()=>!0).catch(()=>!1)}sX.exports={pathExists:eoe(toe),pathExistsSync:oX.existsSync}});var Kb=I((Ffe,aX)=>{"use strict";var ys=dt(),noe=ge().fromPromise;async function roe(e,t,n){let r=await ys.open(e,"r+"),i=null;try{await ys.futimes(r,t,n)}finally{try{await ys.close(r)}catch(o){i=o}}if(i)throw i}function ioe(e,t,n){let r=ys.openSync(e,"r+");return ys.futimesSync(r,t,n),ys.closeSync(r)}aX.exports={utimesMillis:noe(roe),utimesMillisSync:ioe}});var ao=I((Tfe,gX)=>{"use strict";var Gs=dt(),Le=require("path"),cX=ge().fromPromise;function ooe(e,t,n){let r=n.dereference?i=>Gs.stat(i,{bigint:!0}):i=>Gs.lstat(i,{bigint:!0});return Promise.all([r(e),r(t).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,o])=>({srcStat:i,destStat:o}))}function soe(e,t,n){let r,i=n.dereference?s=>Gs.statSync(s,{bigint:!0}):s=>Gs.lstatSync(s,{bigint:!0}),o=i(e);try{r=i(t)}catch(s){if(s.code==="ENOENT")return{srcStat:o,destStat:null};throw s}return{srcStat:o,destStat:r}}async function aoe(e,t,n,r){let{srcStat:i,destStat:o}=await ooe(e,t,r);if(o){if(Ec(i,o)){let s=Le.basename(e),a=Le.basename(t);if(n==="move"&&s!==a&&s.toLowerCase()===a.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(i.isDirectory()&&Ub(e,t))throw new Error(Ld(e,t,n));return{srcStat:i,destStat:o}}function coe(e,t,n,r){let{srcStat:i,destStat:o}=soe(e,t,r);if(o){if(Ec(i,o)){let s=Le.basename(e),a=Le.basename(t);if(n==="move"&&s!==a&&s.toLowerCase()===a.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(i.isDirectory()&&Ub(e,t))throw new Error(Ld(e,t,n));return{srcStat:i,destStat:o}}async function uX(e,t,n,r){let i=Le.resolve(Le.dirname(e)),o=Le.resolve(Le.dirname(n));if(o===i||o===Le.parse(o).root)return;let s;try{s=await Gs.stat(o,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(Ec(t,s))throw new Error(Ld(e,n,r));return uX(e,t,o,r)}function lX(e,t,n,r){let i=Le.resolve(Le.dirname(e)),o=Le.resolve(Le.dirname(n));if(o===i||o===Le.parse(o).root)return;let s;try{s=Gs.statSync(o,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(Ec(t,s))throw new Error(Ld(e,n,r));return lX(e,t,o,r)}function Ec(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function Ub(e,t){let n=Le.resolve(e).split(Le.sep).filter(i=>i),r=Le.resolve(t).split(Le.sep).filter(i=>i);return n.every((i,o)=>r[o]===i)}function Ld(e,t,n){return`Cannot ${n} '${e}' to a subdirectory of itself, '${t}'.`}gX.exports={checkPaths:cX(aoe),checkPathsSync:coe,checkParentPaths:cX(uX),checkParentPathsSync:lX,isSrcSubdir:Ub,areIdentical:Ec}});var fX=I((kfe,pX)=>{"use strict";var rt=dt(),Hc=require("path"),{mkdirs:uoe}=bn(),{pathExists:loe}=ti(),{utimesMillis:goe}=Kb(),Yc=ao();async function doe(e,t,n={}){typeof n=="function"&&(n={filter:n}),n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:r,destStat:i}=await Yc.checkPaths(e,t,"copy",n);if(await Yc.checkParentPaths(e,r,t,"copy"),!await IX(e,t,n))return;let s=Hc.dirname(t);await loe(s)||await uoe(s),await mX(i,e,t,n)}async function IX(e,t,n){return n.filter?n.filter(e,t):!0}async function mX(e,t,n,r){let o=await(r.dereference?rt.stat:rt.lstat)(t);if(o.isDirectory())return foe(o,e,t,n,r);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return Ioe(o,e,t,n,r);if(o.isSymbolicLink())return hoe(e,t,n,r);throw o.isSocket()?new Error(`Cannot copy a socket file: ${t}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}async function Ioe(e,t,n,r,i){if(!t)return dX(e,n,r,i);if(i.overwrite)return await rt.unlink(r),dX(e,n,r,i);if(i.errorOnExist)throw new Error(`'${r}' already exists`)}async function dX(e,t,n,r){if(await rt.copyFile(t,n),r.preserveTimestamps){moe(e.mode)&&await poe(n,e.mode);let i=await rt.stat(t);await goe(n,i.atime,i.mtime)}return rt.chmod(n,e.mode)}function moe(e){return(e&128)===0}function poe(e,t){return rt.chmod(e,t|128)}async function foe(e,t,n,r,i){t||await rt.mkdir(r);let o=await rt.readdir(n);await Promise.all(o.map(async s=>{let a=Hc.join(n,s),c=Hc.join(r,s);if(!await IX(a,c,i))return;let{destStat:u}=await Yc.checkPaths(a,c,"copy",i);return mX(u,a,c,i)})),t||await rt.chmod(r,e.mode)}async function hoe(e,t,n,r){let i=await rt.readlink(t);if(r.dereference&&(i=Hc.resolve(process.cwd(),i)),!e)return rt.symlink(i,n);let o=null;try{o=await rt.readlink(n)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return rt.symlink(i,n);throw s}if(r.dereference&&(o=Hc.resolve(process.cwd(),o)),Yc.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(Yc.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return await rt.unlink(n),rt.symlink(i,n)}pX.exports=doe});var GX=I((Kfe,yX)=>{"use strict";var It=z(),Xc=require("path"),Coe=bn().mkdirsSync,boe=Kb().utimesMillisSync,_c=ao();function yoe(e,t,n){typeof n=="function"&&(n={filter:n}),n=n||{},n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:r,destStat:i}=_c.checkPathsSync(e,t,"copy",n);if(_c.checkParentPathsSync(e,r,t,"copy"),n.filter&&!n.filter(e,t))return;let o=Xc.dirname(t);return It.existsSync(o)||Coe(o),hX(i,e,t,n)}function hX(e,t,n,r){let o=(r.dereference?It.statSync:It.lstatSync)(t);if(o.isDirectory())return Woe(o,e,t,n,r);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return Goe(o,e,t,n,r);if(o.isSymbolicLink())return Noe(e,t,n,r);throw o.isSocket()?new Error(`Cannot copy a socket file: ${t}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}function Goe(e,t,n,r,i){return t?Boe(e,n,r,i):CX(e,n,r,i)}function Boe(e,t,n,r){if(r.overwrite)return It.unlinkSync(n),CX(e,t,n,r);if(r.errorOnExist)throw new Error(`'${n}' already exists`)}function CX(e,t,n,r){return It.copyFileSync(t,n),r.preserveTimestamps&&Aoe(e.mode,t,n),xb(n,e.mode)}function Aoe(e,t,n){return Zoe(e)&&voe(n,e),Soe(t,n)}function Zoe(e){return(e&128)===0}function voe(e,t){return xb(e,t|128)}function xb(e,t){return It.chmodSync(e,t)}function Soe(e,t){let n=It.statSync(e);return boe(t,n.atime,n.mtime)}function Woe(e,t,n,r,i){return t?bX(n,r,i):Roe(e.mode,n,r,i)}function Roe(e,t,n,r){return It.mkdirSync(n),bX(t,n,r),xb(n,e)}function bX(e,t,n){It.readdirSync(e).forEach(r=>Voe(r,e,t,n))}function Voe(e,t,n,r){let i=Xc.join(t,e),o=Xc.join(n,e);if(r.filter&&!r.filter(i,o))return;let{destStat:s}=_c.checkPathsSync(i,o,"copy",r);return hX(s,i,o,r)}function Noe(e,t,n,r){let i=It.readlinkSync(t);if(r.dereference&&(i=Xc.resolve(process.cwd(),i)),e){let o;try{o=It.readlinkSync(n)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return It.symlinkSync(i,n);throw s}if(r.dereference&&(o=Xc.resolve(process.cwd(),o)),_c.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(_c.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return woe(i,n)}else return It.symlinkSync(i,n)}function woe(e,t){return It.unlinkSync(t),It.symlinkSync(e,t)}yX.exports=yoe});var Jd=I((Ufe,BX)=>{"use strict";var Eoe=ge().fromPromise;BX.exports={copy:Eoe(fX()),copySync:GX()}});var Fc=I((xfe,ZX)=>{"use strict";var AX=z(),Hoe=ge().fromCallback;function Yoe(e,t){AX.rm(e,{recursive:!0,force:!0},t)}function Xoe(e){AX.rmSync(e,{recursive:!0,force:!0})}ZX.exports={remove:Hoe(Yoe),removeSync:Xoe}});var EX=I((Lfe,wX)=>{"use strict";var _oe=ge().fromPromise,WX=dt(),RX=require("path"),VX=bn(),NX=Fc(),vX=_oe(async function(t){let n;try{n=await WX.readdir(t)}catch{return VX.mkdirs(t)}return Promise.all(n.map(r=>NX.remove(RX.join(t,r))))});function SX(e){let t;try{t=WX.readdirSync(e)}catch{return VX.mkdirsSync(e)}t.forEach(n=>{n=RX.join(e,n),NX.removeSync(n)})}wX.exports={emptyDirSync:SX,emptydirSync:SX,emptyDir:vX,emptydir:vX}});var _X=I((Jfe,XX)=>{"use strict";var Foe=ge().fromPromise,HX=require("path"),Gr=dt(),YX=bn();async function Toe(e){let t;try{t=await Gr.stat(e)}catch{}if(t&&t.isFile())return;let n=HX.dirname(e),r=null;try{r=await Gr.stat(n)}catch(i){if(i.code==="ENOENT"){await YX.mkdirs(n),await Gr.writeFile(e,"");return}else throw i}r.isDirectory()?await Gr.writeFile(e,""):await Gr.readdir(n)}function koe(e){let t;try{t=Gr.statSync(e)}catch{}if(t&&t.isFile())return;let n=HX.dirname(e);try{Gr.statSync(n).isDirectory()||Gr.readdirSync(n)}catch(r){if(r&&r.code==="ENOENT")YX.mkdirsSync(n);else throw r}Gr.writeFileSync(e,"")}XX.exports={createFile:Foe(Toe),createFileSync:koe}});var UX=I((zfe,KX)=>{"use strict";var Koe=ge().fromPromise,FX=require("path"),ni=dt(),TX=bn(),{pathExists:Uoe}=ti(),{areIdentical:kX}=ao();async function xoe(e,t){let n;try{n=await ni.lstat(t)}catch{}let r;try{r=await ni.lstat(e)}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}if(n&&kX(r,n))return;let i=FX.dirname(t);await Uoe(i)||await TX.mkdirs(i),await ni.link(e,t)}function Loe(e,t){let n;try{n=ni.lstatSync(t)}catch{}try{let o=ni.lstatSync(e);if(n&&kX(o,n))return}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let r=FX.dirname(t);return ni.existsSync(r)||TX.mkdirsSync(r),ni.linkSync(e,t)}KX.exports={createLink:Koe(xoe),createLinkSync:Loe}});var LX=I((Ofe,xX)=>{"use strict";var ri=require("path"),Tc=dt(),{pathExists:Joe}=ti(),zoe=ge().fromPromise;async function Ooe(e,t){if(ri.isAbsolute(e)){try{await Tc.lstat(e)}catch(o){throw o.message=o.message.replace("lstat","ensureSymlink"),o}return{toCwd:e,toDst:e}}let n=ri.dirname(t),r=ri.join(n,e);if(await Joe(r))return{toCwd:r,toDst:e};try{await Tc.lstat(e)}catch(o){throw o.message=o.message.replace("lstat","ensureSymlink"),o}return{toCwd:e,toDst:ri.relative(n,e)}}function Doe(e,t){if(ri.isAbsolute(e)){if(!Tc.existsSync(e))throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}let n=ri.dirname(t),r=ri.join(n,e);if(Tc.existsSync(r))return{toCwd:r,toDst:e};if(!Tc.existsSync(e))throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:ri.relative(n,e)}}xX.exports={symlinkPaths:zoe(Ooe),symlinkPathsSync:Doe}});var OX=I((Dfe,zX)=>{"use strict";var JX=dt(),qoe=ge().fromPromise;async function Moe(e,t){if(t)return t;let n;try{n=await JX.lstat(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}function joe(e,t){if(t)return t;let n;try{n=JX.lstatSync(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}zX.exports={symlinkType:qoe(Moe),symlinkTypeSync:joe}});var jX=I((qfe,MX)=>{"use strict";var Poe=ge().fromPromise,DX=require("path"),Mn=dt(),{mkdirs:Qoe,mkdirsSync:$oe}=bn(),{symlinkPaths:ese,symlinkPathsSync:tse}=LX(),{symlinkType:nse,symlinkTypeSync:rse}=OX(),{pathExists:ise}=ti(),{areIdentical:qX}=ao();async function ose(e,t,n){let r;try{r=await Mn.lstat(t)}catch{}if(r&&r.isSymbolicLink()){let[a,c]=await Promise.all([Mn.stat(e),Mn.stat(t)]);if(qX(a,c))return}let i=await ese(e,t);e=i.toDst;let o=await nse(i.toCwd,n),s=DX.dirname(t);return await ise(s)||await Qoe(s),Mn.symlink(e,t,o)}function sse(e,t,n){let r;try{r=Mn.lstatSync(t)}catch{}if(r&&r.isSymbolicLink()){let a=Mn.statSync(e),c=Mn.statSync(t);if(qX(a,c))return}let i=tse(e,t);e=i.toDst,n=rse(i.toCwd,n);let o=DX.dirname(t);return Mn.existsSync(o)||$oe(o),Mn.symlinkSync(e,t,n)}MX.exports={createSymlink:Poe(ose),createSymlinkSync:sse}});var i_=I((Mfe,r_)=>{"use strict";var{createFile:PX,createFileSync:QX}=_X(),{createLink:$X,createLinkSync:e_}=UX(),{createSymlink:t_,createSymlinkSync:n_}=jX();r_.exports={createFile:PX,createFileSync:QX,ensureFile:PX,ensureFileSync:QX,createLink:$X,createLinkSync:e_,ensureLink:$X,ensureLinkSync:e_,createSymlink:t_,createSymlinkSync:n_,ensureSymlink:t_,ensureSymlinkSync:n_}});var Bs=I((jfe,o_)=>{"use strict";function ase(e,{EOL:t=`
`,finalEOL:n=!0,replacer:r=null,spaces:i}={}){let o=n?t:"";return JSON.stringify(e,r,i).replace(/\n/g,t)+o}function cse(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}o_.exports={stringify:ase,stripBom:cse}});var Lb=I((Pfe,c_)=>{"use strict";var As;try{As=z()}catch{As=require("fs")}var zd=ge(),{stringify:s_,stripBom:a_}=Bs();async function use(e,t={}){typeof t=="string"&&(t={encoding:t});let n=t.fs||As,r="throws"in t?t.throws:!0,i=await zd.fromCallback(n.readFile)(e,t);i=a_(i);let o;try{o=JSON.parse(i,t?t.reviver:null)}catch(s){if(r)throw s.message=`${e}: ${s.message}`,s;return null}return o}var lse=zd.fromPromise(use);function gse(e,t={}){typeof t=="string"&&(t={encoding:t});let n=t.fs||As,r="throws"in t?t.throws:!0;try{let i=n.readFileSync(e,t);return i=a_(i),JSON.parse(i,t.reviver)}catch(i){if(r)throw i.message=`${e}: ${i.message}`,i;return null}}async function dse(e,t,n={}){let r=n.fs||As,i=s_(t,n);await zd.fromCallback(r.writeFile)(e,i,n)}var Ise=zd.fromPromise(dse);function mse(e,t,n={}){let r=n.fs||As,i=s_(t,n);return r.writeFileSync(e,i,n)}var pse={readFile:lse,readFileSync:gse,writeFile:Ise,writeFileSync:mse};c_.exports=pse});var l_=I((Qfe,u_)=>{"use strict";var Od=Lb();u_.exports={readJson:Od.readFile,readJsonSync:Od.readFileSync,writeJson:Od.writeFile,writeJsonSync:Od.writeFileSync}});var Dd=I(($fe,I_)=>{"use strict";var fse=ge().fromPromise,Jb=dt(),g_=require("path"),d_=bn(),hse=ti().pathExists;async function Cse(e,t,n="utf-8"){let r=g_.dirname(e);return await hse(r)||await d_.mkdirs(r),Jb.writeFile(e,t,n)}function bse(e,...t){let n=g_.dirname(e);Jb.existsSync(n)||d_.mkdirsSync(n),Jb.writeFileSync(e,...t)}I_.exports={outputFile:fse(Cse),outputFileSync:bse}});var p_=I((ehe,m_)=>{"use strict";var{stringify:yse}=Bs(),{outputFile:Gse}=Dd();async function Bse(e,t,n={}){let r=yse(t,n);await Gse(e,r,n)}m_.exports=Bse});var h_=I((the,f_)=>{"use strict";var{stringify:Ase}=Bs(),{outputFileSync:Zse}=Dd();function vse(e,t,n){let r=Ase(t,n);Zse(e,r,n)}f_.exports=vse});var b_=I((nhe,C_)=>{"use strict";var Sse=ge().fromPromise,mt=l_();mt.outputJson=Sse(p_());mt.outputJsonSync=h_();mt.outputJSON=mt.outputJson;mt.outputJSONSync=mt.outputJsonSync;mt.writeJSON=mt.writeJson;mt.writeJSONSync=mt.writeJsonSync;mt.readJSON=mt.readJson;mt.readJSONSync=mt.readJsonSync;C_.exports=mt});var Z_=I((rhe,A_)=>{"use strict";var Wse=dt(),y_=require("path"),{copy:Rse}=Jd(),{remove:B_}=Fc(),{mkdirp:Vse}=bn(),{pathExists:Nse}=ti(),G_=ao();async function wse(e,t,n={}){let r=n.overwrite||n.clobber||!1,{srcStat:i,isChangingCase:o=!1}=await G_.checkPaths(e,t,"move",n);await G_.checkParentPaths(e,i,t,"move");let s=y_.dirname(t);return y_.parse(s).root!==s&&await Vse(s),Ese(e,t,r,o)}async function Ese(e,t,n,r){if(!r){if(n)await B_(t);else if(await Nse(t))throw new Error("dest already exists.")}try{await Wse.rename(e,t)}catch(i){if(i.code!=="EXDEV")throw i;await Hse(e,t,n)}}async function Hse(e,t,n){return await Rse(e,t,{overwrite:n,errorOnExist:!0,preserveTimestamps:!0}),B_(e)}A_.exports=wse});var V_=I((ihe,R_)=>{"use strict";var S_=z(),Ob=require("path"),Yse=Jd().copySync,W_=Fc().removeSync,Xse=bn().mkdirpSync,v_=ao();function _se(e,t,n){n=n||{};let r=n.overwrite||n.clobber||!1,{srcStat:i,isChangingCase:o=!1}=v_.checkPathsSync(e,t,"move",n);return v_.checkParentPathsSync(e,i,t,"move"),Fse(t)||Xse(Ob.dirname(t)),Tse(e,t,r,o)}function Fse(e){let t=Ob.dirname(e);return Ob.parse(t).root===t}function Tse(e,t,n,r){if(r)return zb(e,t,n);if(n)return W_(t),zb(e,t,n);if(S_.existsSync(t))throw new Error("dest already exists.");return zb(e,t,n)}function zb(e,t,n){try{S_.renameSync(e,t)}catch(r){if(r.code!=="EXDEV")throw r;return kse(e,t,n)}}function kse(e,t,n){return Yse(e,t,{overwrite:n,errorOnExist:!0,preserveTimestamps:!0}),W_(e)}R_.exports=_se});var w_=I((ohe,N_)=>{"use strict";var Kse=ge().fromPromise;N_.exports={move:Kse(Z_()),moveSync:V_()}});var co=I((she,E_)=>{"use strict";E_.exports={...dt(),...Jd(),...EX(),...i_(),...b_(),...bn(),...w_(),...Dd(),...ti(),...Fc()}});var F_=I((ahe,__)=>{"use strict";__.exports=X_;X_.sync=xse;var H_=require("fs");function Use(e,t){var n=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!n||(n=n.split(";"),n.indexOf("")!==-1))return!0;for(var r=0;r<n.length;r++){var i=n[r].toLowerCase();if(i&&e.substr(-i.length).toLowerCase()===i)return!0}return!1}function Y_(e,t,n){return!e.isSymbolicLink()&&!e.isFile()?!1:Use(t,n)}function X_(e,t,n){H_.stat(e,function(r,i){n(r,r?!1:Y_(i,e,t))})}function xse(e,t){return Y_(H_.statSync(e),e,t)}});var x_=I((che,U_)=>{"use strict";U_.exports=k_;k_.sync=Lse;var T_=require("fs");function k_(e,t,n){T_.stat(e,function(r,i){n(r,r?!1:K_(i,t))})}function Lse(e,t){return K_(T_.statSync(e),t)}function K_(e,t){return e.isFile()&&Jse(e,t)}function Jse(e,t){var n=e.mode,r=e.uid,i=e.gid,o=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),s=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),l=parseInt("001",8),u=a|c,d=n&l||n&c&&i===s||n&a&&r===o||n&u&&o===0;return d}});var J_=I((lhe,L_)=>{"use strict";var uhe=require("fs"),qd;process.platform==="win32"||global.TESTING_WINDOWS?qd=F_():qd=x_();L_.exports=Db;Db.sync=zse;function Db(e,t,n){if(typeof t=="function"&&(n=t,t={}),!n){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(r,i){Db(e,t||{},function(o,s){o?i(o):r(s)})})}qd(e,t||{},function(r,i){r&&(r.code==="EACCES"||t&&t.ignoreErrors)&&(r=null,i=!1),n(r,i)})}function zse(e,t){try{return qd.sync(e,t||{})}catch(n){if(t&&t.ignoreErrors||n.code==="EACCES")return!1;throw n}}});var P_=I((ghe,j_)=>{"use strict";var Zs=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",z_=require("path"),Ose=Zs?";":":",O_=J_(),D_=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),q_=(e,t)=>{let n=t.colon||Ose,r=e.match(/\//)||Zs&&e.match(/\\/)?[""]:[...Zs?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(n)],i=Zs?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=Zs?i.split(n):[""];return Zs&&e.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:r,pathExt:o,pathExtExe:i}},M_=(e,t,n)=>{typeof t=="function"&&(n=t,t={}),t||(t={});let{pathEnv:r,pathExt:i,pathExtExe:o}=q_(e,t),s=[],a=l=>new Promise((u,d)=>{if(l===r.length)return t.all&&s.length?u(s):d(D_(e));let g=r[l],m=/^".*"$/.test(g)?g.slice(1,-1):g,h=z_.join(m,e),b=!m&&/^\.[\\\/]/.test(e)?e.slice(0,2)+h:h;u(c(b,l,0))}),c=(l,u,d)=>new Promise((g,m)=>{if(d===i.length)return g(a(u+1));let h=i[d];O_(l+h,{pathExt:o},(b,y)=>{if(!b&&y)if(t.all)s.push(l+h);else return g(l+h);return g(c(l,u,d+1))})});return n?a(0).then(l=>n(null,l),n):a(0)},Dse=(e,t)=>{t=t||{};let{pathEnv:n,pathExt:r,pathExtExe:i}=q_(e,t),o=[];for(let s=0;s<n.length;s++){let a=n[s],c=/^".*"$/.test(a)?a.slice(1,-1):a,l=z_.join(c,e),u=!c&&/^\.[\\\/]/.test(e)?e.slice(0,2)+l:l;for(let d=0;d<r.length;d++){let g=u+r[d];try{if(O_.sync(g,{pathExt:i}))if(t.all)o.push(g);else return g}catch{}}}if(t.all&&o.length)return o;if(t.nothrow)return null;throw D_(e)};j_.exports=M_;M_.sync=Dse});var $_=I((dhe,qb)=>{"use strict";var Q_=(e={})=>{let t=e.env||process.env;return(e.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(r=>r.toUpperCase()==="PATH")||"Path"};qb.exports=Q_;qb.exports.default=Q_});var rF=I((Ihe,nF)=>{"use strict";var eF=require("path"),qse=P_(),Mse=$_();function tF(e,t){let n=e.options.env||process.env,r=process.cwd(),i=e.options.cwd!=null,o=i&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(e.options.cwd)}catch{}let s;try{s=qse.sync(e.command,{path:n[Mse({env:n})],pathExt:t?eF.delimiter:void 0})}catch{}finally{o&&process.chdir(r)}return s&&(s=eF.resolve(i?e.options.cwd:"",s)),s}function jse(e){return tF(e)||tF(e,!0)}nF.exports=jse});var iF=I((mhe,jb)=>{"use strict";var Mb=/([()\][%!^"`<>&|;, *?])/g;function Pse(e){return e=e.replace(Mb,"^$1"),e}function Qse(e,t){return e=`${e}`,e=e.replace(/(\\*)"/g,'$1$1\\"'),e=e.replace(/(\\*)$/,"$1$1"),e=`"${e}"`,e=e.replace(Mb,"^$1"),t&&(e=e.replace(Mb,"^$1")),e}jb.exports.command=Pse;jb.exports.argument=Qse});var sF=I((phe,oF)=>{"use strict";oF.exports=/^#!(.*)/});var cF=I((fhe,aF)=>{"use strict";var $se=sF();aF.exports=(e="")=>{let t=e.match($se);if(!t)return null;let[n,r]=t[0].replace(/#! ?/,"").split(" "),i=n.split("/").pop();return i==="env"?r:r?`${i} ${r}`:i}});var lF=I((hhe,uF)=>{"use strict";var Pb=require("fs"),eae=cF();function tae(e){let n=Buffer.alloc(150),r;try{r=Pb.openSync(e,"r"),Pb.readSync(r,n,0,150,0),Pb.closeSync(r)}catch{}return eae(n.toString())}uF.exports=tae});var mF=I((Che,IF)=>{"use strict";var nae=require("path"),gF=rF(),dF=iF(),rae=lF(),iae=process.platform==="win32",oae=/\.(?:com|exe)$/i,sae=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function aae(e){e.file=gF(e);let t=e.file&&rae(e.file);return t?(e.args.unshift(e.file),e.command=t,gF(e)):e.file}function cae(e){if(!iae)return e;let t=aae(e),n=!oae.test(t);if(e.options.forceShell||n){let r=sae.test(t);e.command=nae.normalize(e.command),e.command=dF.command(e.command),e.args=e.args.map(o=>dF.argument(o,r));let i=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${i}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}function uae(e,t,n){t&&!Array.isArray(t)&&(n=t,t=null),t=t?t.slice(0):[],n=Object.assign({},n);let r={command:e,args:t,options:n,file:void 0,original:{command:e,args:t}};return n.shell?r:cae(r)}IF.exports=uae});var hF=I((bhe,fF)=>{"use strict";var Qb=process.platform==="win32";function $b(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function lae(e,t){if(!Qb)return;let n=e.emit;e.emit=function(r,i){if(r==="exit"){let o=pF(i,t,"spawn");if(o)return n.call(e,"error",o)}return n.apply(e,arguments)}}function pF(e,t){return Qb&&e===1&&!t.file?$b(t.original,"spawn"):null}function gae(e,t){return Qb&&e===1&&!t.file?$b(t.original,"spawnSync"):null}fF.exports={hookChildProcess:lae,verifyENOENT:pF,verifyENOENTSync:gae,notFoundError:$b}});var yF=I((yhe,vs)=>{"use strict";var CF=require("child_process"),ey=mF(),ty=hF();function bF(e,t,n){let r=ey(e,t,n),i=CF.spawn(r.command,r.args,r.options);return ty.hookChildProcess(i,r),i}function dae(e,t,n){let r=ey(e,t,n),i=CF.spawnSync(r.command,r.args,r.options);return i.error=i.error||ty.verifyENOENTSync(i.status,r),i}vs.exports=bF;vs.exports.spawn=bF;vs.exports.sync=dae;vs.exports._parse=ey;vs.exports._enoent=ty});var BF=I((Ghe,GF)=>{"use strict";var kc;GF.exports=function(){if(!kc){try{kc=Fe()("follow-redirects")}catch{}typeof kc!="function"&&(kc=function(){})}kc.apply(null,arguments)}});var WF=I((Bhe,Iy)=>{"use strict";var Uc=require("url"),Kc=Uc.URL,Iae=require("http"),mae=require("https"),sy=require("stream").Writable,ay=require("assert"),AF=BF();(function(){var t=typeof process<"u",n=typeof window<"u"&&typeof document<"u",r=lo(Error.captureStackTrace);!t&&(n||!r)&&console.warn("The follow-redirects package should be excluded from browser builds.")})();var cy=!1;try{ay(new Kc(""))}catch(e){cy=e.code==="ERR_INVALID_URL"}var pae=["auth","host","hostname","href","path","pathname","port","protocol","query","search","hash"],uy=["abort","aborted","connect","error","socket","timeout"],ly=Object.create(null);uy.forEach(function(e){ly[e]=function(t,n,r){this._redirectable.emit(e,t,n,r)}});var ry=xc("ERR_INVALID_URL","Invalid URL",TypeError),iy=xc("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),fae=xc("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded",iy),hae=xc("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),Cae=xc("ERR_STREAM_WRITE_AFTER_END","write after end"),bae=sy.prototype.destroy||vF;function Vt(e,t){sy.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var n=this;this._onNativeResponse=function(r){try{n._processResponse(r)}catch(i){n.emit("error",i instanceof iy?i:new iy({cause:i}))}},this._performRequest()}Vt.prototype=Object.create(sy.prototype);Vt.prototype.abort=function(){dy(this._currentRequest),this._currentRequest.abort(),this.emit("abort")};Vt.prototype.destroy=function(e){return dy(this._currentRequest,e),bae.call(this,e),this};Vt.prototype.write=function(e,t,n){if(this._ending)throw new Cae;if(!uo(e)&&!Bae(e))throw new TypeError("data should be a string, Buffer or Uint8Array");if(lo(t)&&(n=t,t=null),e.length===0){n&&n();return}this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,n)):(this.emit("error",new hae),this.abort())};Vt.prototype.end=function(e,t,n){if(lo(e)?(n=e,e=t=null):lo(t)&&(n=t,t=null),!e)this._ended=this._ending=!0,this._currentRequest.end(null,null,n);else{var r=this,i=this._currentRequest;this.write(e,t,function(){r._ended=!0,i.end(null,null,n)}),this._ending=!0}};Vt.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)};Vt.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)};Vt.prototype.setTimeout=function(e,t){var n=this;function r(s){s.setTimeout(e),s.removeListener("timeout",s.destroy),s.addListener("timeout",s.destroy)}function i(s){n._timeout&&clearTimeout(n._timeout),n._timeout=setTimeout(function(){n.emit("timeout"),o()},e),r(s)}function o(){n._timeout&&(clearTimeout(n._timeout),n._timeout=null),n.removeListener("abort",o),n.removeListener("error",o),n.removeListener("response",o),n.removeListener("close",o),t&&n.removeListener("timeout",t),n.socket||n._currentRequest.removeListener("socket",i)}return t&&this.on("timeout",t),this.socket?i(this.socket):this._currentRequest.once("socket",i),this.on("socket",r),this.on("abort",o),this.on("error",o),this.on("response",o),this.on("close",o),this};["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach(function(e){Vt.prototype[e]=function(t,n){return this._currentRequest[e](t,n)}});["aborted","connection","socket"].forEach(function(e){Object.defineProperty(Vt.prototype,e,{get:function(){return this._currentRequest[e]}})});Vt.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}};Vt.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(!t)throw new TypeError("Unsupported protocol "+e);if(this._options.agents){var n=e.slice(0,-1);this._options.agent=this._options.agents[n]}var r=this._currentRequest=t.request(this._options,this._onNativeResponse);r._redirectable=this;for(var i of uy)r.on(i,ly[i]);if(this._currentUrl=/^\//.test(this._options.path)?Uc.format(this._options):this._options.path,this._isRedirect){var o=0,s=this,a=this._requestBodyBuffers;(function c(l){if(r===s._currentRequest)if(l)s.emit("error",l);else if(o<a.length){var u=a[o++];r.finished||r.write(u.data,u.encoding,c)}else s._ended&&r.end()})()}};Vt.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var n=e.headers.location;if(!n||this._options.followRedirects===!1||t<300||t>=400){e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),this._requestBodyBuffers=[];return}if(dy(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects)throw new fae;var r,i=this._options.beforeRedirect;i&&(r=Object.assign({Host:e.req.getHeader("host")},this._options.headers));var o=this._options.method;((t===301||t===302)&&this._options.method==="POST"||t===303&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],ny(/^content-/i,this._options.headers));var s=ny(/^host$/i,this._options.headers),a=gy(this._currentUrl),c=s||a.host,l=/^\w+:/.test(n)?this._currentUrl:Uc.format(Object.assign(a,{host:c})),u=yae(n,l);if(AF("redirecting to",u.href),this._isRedirect=!0,oy(u,this._options),(u.protocol!==a.protocol&&u.protocol!=="https:"||u.host!==c&&!Gae(u.host,c))&&ny(/^(?:(?:proxy-)?authorization|cookie)$/i,this._options.headers),lo(i)){var d={headers:e.headers,statusCode:t},g={url:l,method:o,headers:r};i(this._options,d,g),this._sanitizeOptions(this._options)}this._performRequest()};function ZF(e){var t={maxRedirects:21,maxBodyLength:10485760},n={};return Object.keys(e).forEach(function(r){var i=r+":",o=n[i]=e[r],s=t[r]=Object.create(o);function a(l,u,d){return Aae(l)?l=oy(l):uo(l)?l=oy(gy(l)):(d=u,u=SF(l),l={protocol:i}),lo(u)&&(d=u,u=null),u=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},l,u),u.nativeProtocols=n,!uo(u.host)&&!uo(u.hostname)&&(u.hostname="::1"),ay.equal(u.protocol,i,"protocol mismatch"),AF("options",u),new Vt(u,d)}function c(l,u,d){var g=s.request(l,u,d);return g.end(),g}Object.defineProperties(s,{request:{value:a,configurable:!0,enumerable:!0,writable:!0},get:{value:c,configurable:!0,enumerable:!0,writable:!0}})}),t}function vF(){}function gy(e){var t;if(cy)t=new Kc(e);else if(t=SF(Uc.parse(e)),!uo(t.protocol))throw new ry({input:e});return t}function yae(e,t){return cy?new Kc(e,t):gy(Uc.resolve(t,e))}function SF(e){if(/^\[/.test(e.hostname)&&!/^\[[:0-9a-f]+\]$/i.test(e.hostname))throw new ry({input:e.href||e});if(/^\[/.test(e.host)&&!/^\[[:0-9a-f]+\](:\d+)?$/i.test(e.host))throw new ry({input:e.href||e});return e}function oy(e,t){var n=t||{};for(var r of pae)n[r]=e[r];return n.hostname.startsWith("[")&&(n.hostname=n.hostname.slice(1,-1)),n.port!==""&&(n.port=Number(n.port)),n.path=n.search?n.pathname+n.search:n.pathname,n}function ny(e,t){var n;for(var r in t)e.test(r)&&(n=t[r],delete t[r]);return n===null||typeof n>"u"?void 0:String(n).trim()}function xc(e,t,n){function r(i){lo(Error.captureStackTrace)&&Error.captureStackTrace(this,this.constructor),Object.assign(this,i||{}),this.code=e,this.message=this.cause?t+": "+this.cause.message:t}return r.prototype=new(n||Error),Object.defineProperties(r.prototype,{constructor:{value:r,enumerable:!1},name:{value:"Error ["+e+"]",enumerable:!1}}),r}function dy(e,t){for(var n of uy)e.removeListener(n,ly[n]);e.on("error",vF),e.destroy(t)}function Gae(e,t){ay(uo(e)&&uo(t));var n=e.length-t.length-1;return n>0&&e[n]==="."&&e.endsWith(t)}function uo(e){return typeof e=="string"||e instanceof String}function lo(e){return typeof e=="function"}function Bae(e){return typeof e=="object"&&"length"in e}function Aae(e){return Kc&&e instanceof Kc}Iy.exports=ZF({http:Iae,https:mae});Iy.exports.wrap=ZF});var RF=I((Ahe,Zae)=>{Zae.exports={"com.ac":!0,"net.ac":!0,"gov.ac":!0,"org.ac":!0,"mil.ac":!0,"co.ae":!0,"net.ae":!0,"gov.ae":!0,"ac.ae":!0,"sch.ae":!0,"org.ae":!0,"mil.ae":!0,"pro.ae":!0,"name.ae":!0,"com.af":!0,"edu.af":!0,"gov.af":!0,"net.af":!0,"org.af":!0,"com.al":!0,"edu.al":!0,"gov.al":!0,"mil.al":!0,"net.al":!0,"org.al":!0,"ed.ao":!0,"gv.ao":!0,"og.ao":!0,"co.ao":!0,"pb.ao":!0,"it.ao":!0,"com.ar":!0,"edu.ar":!0,"gob.ar":!0,"gov.ar":!0,"int.ar":!0,"mil.ar":!0,"net.ar":!0,"org.ar":!0,"tur.ar":!0,"gv.at":!0,"ac.at":!0,"co.at":!0,"or.at":!0,"com.au":!0,"net.au":!0,"org.au":!0,"edu.au":!0,"gov.au":!0,"csiro.au":!0,"asn.au":!0,"id.au":!0,"vic.au":!0,"sa.au":!0,"wa.au":!0,"nt.au":!0,"tas.au":!0,"qld.au":!0,"act.au":!0,"conf.au":!0,"oz.au":!0,"org.ba":!0,"net.ba":!0,"edu.ba":!0,"gov.ba":!0,"mil.ba":!0,"unsa.ba":!0,"untz.ba":!0,"unmo.ba":!0,"unbi.ba":!0,"unze.ba":!0,"co.ba":!0,"com.ba":!0,"rs.ba":!0,"co.bb":!0,"com.bb":!0,"net.bb":!0,"org.bb":!0,"gov.bb":!0,"edu.bb":!0,"info.bb":!0,"store.bb":!0,"tv.bb":!0,"biz.bb":!0,"com.bh":!0,"info.bh":!0,"cc.bh":!0,"edu.bh":!0,"biz.bh":!0,"net.bh":!0,"org.bh":!0,"gov.bh":!0,"com.bn":!0,"edu.bn":!0,"gov.bn":!0,"net.bn":!0,"org.bn":!0,"com.bo":!0,"net.bo":!0,"org.bo":!0,"tv.bo":!0,"mil.bo":!0,"int.bo":!0,"gob.bo":!0,"gov.bo":!0,"edu.bo":!0,"adm.br":!0,"adv.br":!0,"agr.br":!0,"am.br":!0,"arq.br":!0,"art.br":!0,"ato.br":!0,"b.br":!0,"bio.br":!0,"blog.br":!0,"bmd.br":!0,"cim.br":!0,"cng.br":!0,"cnt.br":!0,"com.br":!0,"coop.br":!0,"ecn.br":!0,"edu.br":!0,"eng.br":!0,"esp.br":!0,"etc.br":!0,"eti.br":!0,"far.br":!0,"flog.br":!0,"fm.br":!0,"fnd.br":!0,"fot.br":!0,"fst.br":!0,"g12.br":!0,"ggf.br":!0,"gov.br":!0,"imb.br":!0,"ind.br":!0,"inf.br":!0,"jor.br":!0,"jus.br":!0,"lel.br":!0,"mat.br":!0,"med.br":!0,"mil.br":!0,"mus.br":!0,"net.br":!0,"nom.br":!0,"not.br":!0,"ntr.br":!0,"odo.br":!0,"org.br":!0,"ppg.br":!0,"pro.br":!0,"psc.br":!0,"psi.br":!0,"qsl.br":!0,"rec.br":!0,"slg.br":!0,"srv.br":!0,"tmp.br":!0,"trd.br":!0,"tur.br":!0,"tv.br":!0,"vet.br":!0,"vlog.br":!0,"wiki.br":!0,"zlg.br":!0,"com.bs":!0,"net.bs":!0,"org.bs":!0,"edu.bs":!0,"gov.bs":!0,"om.bz":!0,"du.bz":!0,"ov.bz":!0,"et.bz":!0,"rg.bz":!0,"ab.ca":!0,"bc.ca":!0,"mb.ca":!0,"nb.ca":!0,"nf.ca":!0,"nl.ca":!0,"ns.ca":!0,"nt.ca":!0,"nu.ca":!0,"on.ca":!0,"pe.ca":!0,"qc.ca":!0,"sk.ca":!0,"yk.ca":!0,"co.ck":!0,"org.ck":!0,"edu.ck":!0,"gov.ck":!0,"net.ck":!0,"gen.ck":!0,"biz.ck":!0,"info.ck":!0,"ac.cn":!0,"com.cn":!0,"edu.cn":!0,"gov.cn":!0,"mil.cn":!0,"net.cn":!0,"org.cn":!0,"ah.cn":!0,"bj.cn":!0,"cq.cn":!0,"fj.cn":!0,"gd.cn":!0,"gs.cn":!0,"gz.cn":!0,"gx.cn":!0,"ha.cn":!0,"hb.cn":!0,"he.cn":!0,"hi.cn":!0,"hl.cn":!0,"hn.cn":!0,"jl.cn":!0,"js.cn":!0,"jx.cn":!0,"ln.cn":!0,"nm.cn":!0,"nx.cn":!0,"qh.cn":!0,"sc.cn":!0,"sd.cn":!0,"sh.cn":!0,"sn.cn":!0,"sx.cn":!0,"tj.cn":!0,"tw.cn":!0,"xj.cn":!0,"xz.cn":!0,"yn.cn":!0,"zj.cn":!0,"com.co":!0,"org.co":!0,"edu.co":!0,"gov.co":!0,"net.co":!0,"mil.co":!0,"nom.co":!0,"ac.cr":!0,"co.cr":!0,"ed.cr":!0,"fi.cr":!0,"go.cr":!0,"or.cr":!0,"sa.cr":!0,cr:!0,"ac.cy":!0,"net.cy":!0,"gov.cy":!0,"org.cy":!0,"pro.cy":!0,"name.cy":!0,"ekloges.cy":!0,"tm.cy":!0,"ltd.cy":!0,"biz.cy":!0,"press.cy":!0,"parliament.cy":!0,"com.cy":!0,"edu.do":!0,"gob.do":!0,"gov.do":!0,"com.do":!0,"sld.do":!0,"org.do":!0,"net.do":!0,"web.do":!0,"mil.do":!0,"art.do":!0,"com.dz":!0,"org.dz":!0,"net.dz":!0,"gov.dz":!0,"edu.dz":!0,"asso.dz":!0,"pol.dz":!0,"art.dz":!0,"com.ec":!0,"info.ec":!0,"net.ec":!0,"fin.ec":!0,"med.ec":!0,"pro.ec":!0,"org.ec":!0,"edu.ec":!0,"gov.ec":!0,"mil.ec":!0,"com.eg":!0,"edu.eg":!0,"eun.eg":!0,"gov.eg":!0,"mil.eg":!0,"name.eg":!0,"net.eg":!0,"org.eg":!0,"sci.eg":!0,"com.er":!0,"edu.er":!0,"gov.er":!0,"mil.er":!0,"net.er":!0,"org.er":!0,"ind.er":!0,"rochest.er":!0,"w.er":!0,"com.es":!0,"nom.es":!0,"org.es":!0,"gob.es":!0,"edu.es":!0,"com.et":!0,"gov.et":!0,"org.et":!0,"edu.et":!0,"net.et":!0,"biz.et":!0,"name.et":!0,"info.et":!0,"ac.fj":!0,"biz.fj":!0,"com.fj":!0,"info.fj":!0,"mil.fj":!0,"name.fj":!0,"net.fj":!0,"org.fj":!0,"pro.fj":!0,"co.fk":!0,"org.fk":!0,"gov.fk":!0,"ac.fk":!0,"nom.fk":!0,"net.fk":!0,fr:!0,"tm.fr":!0,"asso.fr":!0,"nom.fr":!0,"prd.fr":!0,"presse.fr":!0,"com.fr":!0,"gouv.fr":!0,"co.gg":!0,"net.gg":!0,"org.gg":!0,"com.gh":!0,"edu.gh":!0,"gov.gh":!0,"org.gh":!0,"mil.gh":!0,"co.gl":!0,"com.gl":!0,"edu.gl":!0,"net.gl":!0,"org.gl":!0,"com.gn":!0,"ac.gn":!0,"gov.gn":!0,"org.gn":!0,"net.gn":!0,"com.gr":!0,"edu.gr":!0,"net.gr":!0,"org.gr":!0,"gov.gr":!0,"mil.gr":!0,"com.gt":!0,"edu.gt":!0,"net.gt":!0,"gob.gt":!0,"org.gt":!0,"mil.gt":!0,"ind.gt":!0,"com.gu":!0,"net.gu":!0,"gov.gu":!0,"org.gu":!0,"edu.gu":!0,"com.hk":!0,"edu.hk":!0,"gov.hk":!0,"idv.hk":!0,"net.hk":!0,"org.hk":!0,"2000.hu":!0,"agrar.hu":!0,"bolt.hu":!0,"casino.hu":!0,"city.hu":!0,"co.hu":!0,"erotica.hu":!0,"erotika.hu":!0,"film.hu":!0,"forum.hu":!0,"games.hu":!0,"hotel.hu":!0,"info.hu":!0,"ingatlan.hu":!0,"jogasz.hu":!0,"konyvelo.hu":!0,"lakas.hu":!0,"media.hu":!0,"news.hu":!0,"org.hu":!0,"priv.hu":!0,"reklam.hu":!0,"sex.hu":!0,"shop.hu":!0,"sport.hu":!0,"suli.huv":!0,"szex.hu":!0,"tm.hu":!0,"tozsde.hu":!0,"utazas.hu":!0,"video.hu":!0,"ac.id":!0,"co.id":!0,"net.id":!0,"or.id":!0,"web.id":!0,"sch.id":!0,"mil.id":!0,"go.id":!0,"war.net.id":!0,"my.id":!0,"biz.id":!0,"ac.il":!0,"co.il":!0,"org.il":!0,"net.il":!0,"k12.il":!0,"gov.il":!0,"muni.il":!0,"idf.il":!0,in:!0,"4fd.in":!0,"co.in":!0,"firm.in":!0,"net.in":!0,"org.in":!0,"gen.in":!0,"ind.in":!0,"ac.in":!0,"edu.in":!0,"res.in":!0,"ernet.in":!0,"gov.in":!0,"mil.in":!0,"nic.in":!0,iq:!0,"gov.iq":!0,"edu.iq":!0,"com.iq":!0,"mil.iq":!0,"org.iq":!0,"net.iq":!0,ir:!0,"ac.ir":!0,"co.ir":!0,"gov.ir":!0,"id.ir":!0,"net.ir":!0,"org.ir":!0,"sch.ir":!0,"dnssec.ir":!0,"gov.it":!0,"edu.it":!0,"co.je":!0,"net.je":!0,"org.je":!0,"com.jo":!0,"net.jo":!0,"gov.jo":!0,"edu.jo":!0,"org.jo":!0,"mil.jo":!0,"name.jo":!0,"sch.jo":!0,"ac.jp":!0,"ad.jp":!0,"co.jp":!0,"ed.jp":!0,"go.jp":!0,"gr.jp":!0,"lg.jp":!0,"ne.jp":!0,"or.jp":!0,"co.ke":!0,"or.ke":!0,"ne.ke":!0,"go.ke":!0,"ac.ke":!0,"sc.ke":!0,"me.ke":!0,"mobi.ke":!0,"info.ke":!0,"per.kh":!0,"com.kh":!0,"edu.kh":!0,"gov.kh":!0,"mil.kh":!0,"net.kh":!0,"org.kh":!0,"com.ki":!0,"biz.ki":!0,"de.ki":!0,"net.ki":!0,"info.ki":!0,"org.ki":!0,"gov.ki":!0,"edu.ki":!0,"mob.ki":!0,"tel.ki":!0,km:!0,"com.km":!0,"coop.km":!0,"asso.km":!0,"nom.km":!0,"presse.km":!0,"tm.km":!0,"medecin.km":!0,"notaires.km":!0,"pharmaciens.km":!0,"veterinaire.km":!0,"edu.km":!0,"gouv.km":!0,"mil.km":!0,"net.kn":!0,"org.kn":!0,"edu.kn":!0,"gov.kn":!0,kr:!0,"co.kr":!0,"ne.kr":!0,"or.kr":!0,"re.kr":!0,"pe.kr":!0,"go.kr":!0,"mil.kr":!0,"ac.kr":!0,"hs.kr":!0,"ms.kr":!0,"es.kr":!0,"sc.kr":!0,"kg.kr":!0,"seoul.kr":!0,"busan.kr":!0,"daegu.kr":!0,"incheon.kr":!0,"gwangju.kr":!0,"daejeon.kr":!0,"ulsan.kr":!0,"gyeonggi.kr":!0,"gangwon.kr":!0,"chungbuk.kr":!0,"chungnam.kr":!0,"jeonbuk.kr":!0,"jeonnam.kr":!0,"gyeongbuk.kr":!0,"gyeongnam.kr":!0,"jeju.kr":!0,"edu.kw":!0,"com.kw":!0,"net.kw":!0,"org.kw":!0,"gov.kw":!0,"com.ky":!0,"org.ky":!0,"net.ky":!0,"edu.ky":!0,"gov.ky":!0,"com.kz":!0,"edu.kz":!0,"gov.kz":!0,"mil.kz":!0,"net.kz":!0,"org.kz":!0,"com.lb":!0,"edu.lb":!0,"gov.lb":!0,"net.lb":!0,"org.lb":!0,"gov.lk":!0,"sch.lk":!0,"net.lk":!0,"int.lk":!0,"com.lk":!0,"org.lk":!0,"edu.lk":!0,"ngo.lk":!0,"soc.lk":!0,"web.lk":!0,"ltd.lk":!0,"assn.lk":!0,"grp.lk":!0,"hotel.lk":!0,"com.lr":!0,"edu.lr":!0,"gov.lr":!0,"org.lr":!0,"net.lr":!0,"com.lv":!0,"edu.lv":!0,"gov.lv":!0,"org.lv":!0,"mil.lv":!0,"id.lv":!0,"net.lv":!0,"asn.lv":!0,"conf.lv":!0,"com.ly":!0,"net.ly":!0,"gov.ly":!0,"plc.ly":!0,"edu.ly":!0,"sch.ly":!0,"med.ly":!0,"org.ly":!0,"id.ly":!0,ma:!0,"net.ma":!0,"ac.ma":!0,"org.ma":!0,"gov.ma":!0,"press.ma":!0,"co.ma":!0,"tm.mc":!0,"asso.mc":!0,"co.me":!0,"net.me":!0,"org.me":!0,"edu.me":!0,"ac.me":!0,"gov.me":!0,"its.me":!0,"priv.me":!0,"org.mg":!0,"nom.mg":!0,"gov.mg":!0,"prd.mg":!0,"tm.mg":!0,"edu.mg":!0,"mil.mg":!0,"com.mg":!0,"com.mk":!0,"org.mk":!0,"net.mk":!0,"edu.mk":!0,"gov.mk":!0,"inf.mk":!0,"name.mk":!0,"pro.mk":!0,"com.ml":!0,"net.ml":!0,"org.ml":!0,"edu.ml":!0,"gov.ml":!0,"presse.ml":!0,"gov.mn":!0,"edu.mn":!0,"org.mn":!0,"com.mo":!0,"edu.mo":!0,"gov.mo":!0,"net.mo":!0,"org.mo":!0,"com.mt":!0,"org.mt":!0,"net.mt":!0,"edu.mt":!0,"gov.mt":!0,"aero.mv":!0,"biz.mv":!0,"com.mv":!0,"coop.mv":!0,"edu.mv":!0,"gov.mv":!0,"info.mv":!0,"int.mv":!0,"mil.mv":!0,"museum.mv":!0,"name.mv":!0,"net.mv":!0,"org.mv":!0,"pro.mv":!0,"ac.mw":!0,"co.mw":!0,"com.mw":!0,"coop.mw":!0,"edu.mw":!0,"gov.mw":!0,"int.mw":!0,"museum.mw":!0,"net.mw":!0,"org.mw":!0,"com.mx":!0,"net.mx":!0,"org.mx":!0,"edu.mx":!0,"gob.mx":!0,"com.my":!0,"net.my":!0,"org.my":!0,"gov.my":!0,"edu.my":!0,"sch.my":!0,"mil.my":!0,"name.my":!0,"com.nf":!0,"net.nf":!0,"arts.nf":!0,"store.nf":!0,"web.nf":!0,"firm.nf":!0,"info.nf":!0,"other.nf":!0,"per.nf":!0,"rec.nf":!0,"com.ng":!0,"org.ng":!0,"gov.ng":!0,"edu.ng":!0,"net.ng":!0,"sch.ng":!0,"name.ng":!0,"mobi.ng":!0,"biz.ng":!0,"mil.ng":!0,"gob.ni":!0,"co.ni":!0,"com.ni":!0,"ac.ni":!0,"edu.ni":!0,"org.ni":!0,"nom.ni":!0,"net.ni":!0,"mil.ni":!0,"com.np":!0,"edu.np":!0,"gov.np":!0,"org.np":!0,"mil.np":!0,"net.np":!0,"edu.nr":!0,"gov.nr":!0,"biz.nr":!0,"info.nr":!0,"net.nr":!0,"org.nr":!0,"com.nr":!0,"com.om":!0,"co.om":!0,"edu.om":!0,"ac.om":!0,"sch.om":!0,"gov.om":!0,"net.om":!0,"org.om":!0,"mil.om":!0,"museum.om":!0,"biz.om":!0,"pro.om":!0,"med.om":!0,"edu.pe":!0,"gob.pe":!0,"nom.pe":!0,"mil.pe":!0,"sld.pe":!0,"org.pe":!0,"com.pe":!0,"net.pe":!0,"com.ph":!0,"net.ph":!0,"org.ph":!0,"mil.ph":!0,"ngo.ph":!0,"i.ph":!0,"gov.ph":!0,"edu.ph":!0,"com.pk":!0,"net.pk":!0,"edu.pk":!0,"org.pk":!0,"fam.pk":!0,"biz.pk":!0,"web.pk":!0,"gov.pk":!0,"gob.pk":!0,"gok.pk":!0,"gon.pk":!0,"gop.pk":!0,"gos.pk":!0,"pwr.pl":!0,"com.pl":!0,"biz.pl":!0,"net.pl":!0,"art.pl":!0,"edu.pl":!0,"org.pl":!0,"ngo.pl":!0,"gov.pl":!0,"info.pl":!0,"mil.pl":!0,"waw.pl":!0,"warszawa.pl":!0,"wroc.pl":!0,"wroclaw.pl":!0,"krakow.pl":!0,"katowice.pl":!0,"poznan.pl":!0,"lodz.pl":!0,"gda.pl":!0,"gdansk.pl":!0,"slupsk.pl":!0,"radom.pl":!0,"szczecin.pl":!0,"lublin.pl":!0,"bialystok.pl":!0,"olsztyn.pl":!0,"torun.pl":!0,"gorzow.pl":!0,"zgora.pl":!0,"biz.pr":!0,"com.pr":!0,"edu.pr":!0,"gov.pr":!0,"info.pr":!0,"isla.pr":!0,"name.pr":!0,"net.pr":!0,"org.pr":!0,"pro.pr":!0,"est.pr":!0,"prof.pr":!0,"ac.pr":!0,"com.ps":!0,"net.ps":!0,"org.ps":!0,"edu.ps":!0,"gov.ps":!0,"plo.ps":!0,"sec.ps":!0,"co.pw":!0,"ne.pw":!0,"or.pw":!0,"ed.pw":!0,"go.pw":!0,"belau.pw":!0,"arts.ro":!0,"com.ro":!0,"firm.ro":!0,"info.ro":!0,"nom.ro":!0,"nt.ro":!0,"org.ro":!0,"rec.ro":!0,"store.ro":!0,"tm.ro":!0,"www.ro":!0,"co.rs":!0,"org.rs":!0,"edu.rs":!0,"ac.rs":!0,"gov.rs":!0,"in.rs":!0,"com.sb":!0,"net.sb":!0,"edu.sb":!0,"org.sb":!0,"gov.sb":!0,"com.sc":!0,"net.sc":!0,"edu.sc":!0,"gov.sc":!0,"org.sc":!0,"co.sh":!0,"com.sh":!0,"org.sh":!0,"gov.sh":!0,"edu.sh":!0,"net.sh":!0,"nom.sh":!0,"com.sl":!0,"net.sl":!0,"org.sl":!0,"edu.sl":!0,"gov.sl":!0,"gov.st":!0,"saotome.st":!0,"principe.st":!0,"consulado.st":!0,"embaixada.st":!0,"org.st":!0,"edu.st":!0,"net.st":!0,"com.st":!0,"store.st":!0,"mil.st":!0,"co.st":!0,"edu.sv":!0,"gob.sv":!0,"com.sv":!0,"org.sv":!0,"red.sv":!0,"co.sz":!0,"ac.sz":!0,"org.sz":!0,"com.tr":!0,"gen.tr":!0,"org.tr":!0,"biz.tr":!0,"info.tr":!0,"av.tr":!0,"dr.tr":!0,"pol.tr":!0,"bel.tr":!0,"tsk.tr":!0,"bbs.tr":!0,"k12.tr":!0,"edu.tr":!0,"name.tr":!0,"net.tr":!0,"gov.tr":!0,"web.tr":!0,"tel.tr":!0,"tv.tr":!0,"co.tt":!0,"com.tt":!0,"org.tt":!0,"net.tt":!0,"biz.tt":!0,"info.tt":!0,"pro.tt":!0,"int.tt":!0,"coop.tt":!0,"jobs.tt":!0,"mobi.tt":!0,"travel.tt":!0,"museum.tt":!0,"aero.tt":!0,"cat.tt":!0,"tel.tt":!0,"name.tt":!0,"mil.tt":!0,"edu.tt":!0,"gov.tt":!0,"edu.tw":!0,"gov.tw":!0,"mil.tw":!0,"com.tw":!0,"net.tw":!0,"org.tw":!0,"idv.tw":!0,"game.tw":!0,"ebiz.tw":!0,"club.tw":!0,"com.mu":!0,"gov.mu":!0,"net.mu":!0,"org.mu":!0,"ac.mu":!0,"co.mu":!0,"or.mu":!0,"ac.mz":!0,"co.mz":!0,"edu.mz":!0,"org.mz":!0,"gov.mz":!0,"com.na":!0,"co.na":!0,"ac.nz":!0,"co.nz":!0,"cri.nz":!0,"geek.nz":!0,"gen.nz":!0,"govt.nz":!0,"health.nz":!0,"iwi.nz":!0,"maori.nz":!0,"mil.nz":!0,"net.nz":!0,"org.nz":!0,"parliament.nz":!0,"school.nz":!0,"abo.pa":!0,"ac.pa":!0,"com.pa":!0,"edu.pa":!0,"gob.pa":!0,"ing.pa":!0,"med.pa":!0,"net.pa":!0,"nom.pa":!0,"org.pa":!0,"sld.pa":!0,"com.pt":!0,"edu.pt":!0,"gov.pt":!0,"int.pt":!0,"net.pt":!0,"nome.pt":!0,"org.pt":!0,"publ.pt":!0,"com.py":!0,"edu.py":!0,"gov.py":!0,"mil.py":!0,"net.py":!0,"org.py":!0,"com.qa":!0,"edu.qa":!0,"gov.qa":!0,"mil.qa":!0,"net.qa":!0,"org.qa":!0,"asso.re":!0,"com.re":!0,"nom.re":!0,"ac.ru":!0,"adygeya.ru":!0,"altai.ru":!0,"amur.ru":!0,"arkhangelsk.ru":!0,"astrakhan.ru":!0,"bashkiria.ru":!0,"belgorod.ru":!0,"bir.ru":!0,"bryansk.ru":!0,"buryatia.ru":!0,"cbg.ru":!0,"chel.ru":!0,"chelyabinsk.ru":!0,"chita.ru":!0,"chukotka.ru":!0,"chuvashia.ru":!0,"com.ru":!0,"dagestan.ru":!0,"e-burg.ru":!0,"edu.ru":!0,"gov.ru":!0,"grozny.ru":!0,"int.ru":!0,"irkutsk.ru":!0,"ivanovo.ru":!0,"izhevsk.ru":!0,"jar.ru":!0,"joshkar-ola.ru":!0,"kalmykia.ru":!0,"kaluga.ru":!0,"kamchatka.ru":!0,"karelia.ru":!0,"kazan.ru":!0,"kchr.ru":!0,"kemerovo.ru":!0,"khabarovsk.ru":!0,"khakassia.ru":!0,"khv.ru":!0,"kirov.ru":!0,"koenig.ru":!0,"komi.ru":!0,"kostroma.ru":!0,"kranoyarsk.ru":!0,"kuban.ru":!0,"kurgan.ru":!0,"kursk.ru":!0,"lipetsk.ru":!0,"magadan.ru":!0,"mari.ru":!0,"mari-el.ru":!0,"marine.ru":!0,"mil.ru":!0,"mordovia.ru":!0,"mosreg.ru":!0,"msk.ru":!0,"murmansk.ru":!0,"nalchik.ru":!0,"net.ru":!0,"nnov.ru":!0,"nov.ru":!0,"novosibirsk.ru":!0,"nsk.ru":!0,"omsk.ru":!0,"orenburg.ru":!0,"org.ru":!0,"oryol.ru":!0,"penza.ru":!0,"perm.ru":!0,"pp.ru":!0,"pskov.ru":!0,"ptz.ru":!0,"rnd.ru":!0,"ryazan.ru":!0,"sakhalin.ru":!0,"samara.ru":!0,"saratov.ru":!0,"simbirsk.ru":!0,"smolensk.ru":!0,"spb.ru":!0,"stavropol.ru":!0,"stv.ru":!0,"surgut.ru":!0,"tambov.ru":!0,"tatarstan.ru":!0,"tom.ru":!0,"tomsk.ru":!0,"tsaritsyn.ru":!0,"tsk.ru":!0,"tula.ru":!0,"tuva.ru":!0,"tver.ru":!0,"tyumen.ru":!0,"udm.ru":!0,"udmurtia.ru":!0,"ulan-ude.ru":!0,"vladikavkaz.ru":!0,"vladimir.ru":!0,"vladivostok.ru":!0,"volgograd.ru":!0,"vologda.ru":!0,"voronezh.ru":!0,"vrn.ru":!0,"vyatka.ru":!0,"yakutia.ru":!0,"yamal.ru":!0,"yekaterinburg.ru":!0,"yuzhno-sakhalinsk.ru":!0,"ac.rw":!0,"co.rw":!0,"com.rw":!0,"edu.rw":!0,"gouv.rw":!0,"gov.rw":!0,"int.rw":!0,"mil.rw":!0,"net.rw":!0,"com.sa":!0,"edu.sa":!0,"gov.sa":!0,"med.sa":!0,"net.sa":!0,"org.sa":!0,"pub.sa":!0,"sch.sa":!0,"com.sd":!0,"edu.sd":!0,"gov.sd":!0,"info.sd":!0,"med.sd":!0,"net.sd":!0,"org.sd":!0,"tv.sd":!0,"a.se":!0,"ac.se":!0,"b.se":!0,"bd.se":!0,"c.se":!0,"d.se":!0,"e.se":!0,"f.se":!0,"g.se":!0,"h.se":!0,"i.se":!0,"k.se":!0,"l.se":!0,"m.se":!0,"n.se":!0,"o.se":!0,"org.se":!0,"p.se":!0,"parti.se":!0,"pp.se":!0,"press.se":!0,"r.se":!0,"s.se":!0,"t.se":!0,"tm.se":!0,"u.se":!0,"w.se":!0,"x.se":!0,"y.se":!0,"z.se":!0,"com.sg":!0,"edu.sg":!0,"gov.sg":!0,"idn.sg":!0,"net.sg":!0,"org.sg":!0,"per.sg":!0,"art.sn":!0,"com.sn":!0,"edu.sn":!0,"gouv.sn":!0,"org.sn":!0,"perso.sn":!0,"univ.sn":!0,"com.sy":!0,"edu.sy":!0,"gov.sy":!0,"mil.sy":!0,"net.sy":!0,"news.sy":!0,"org.sy":!0,"ac.th":!0,"co.th":!0,"go.th":!0,"in.th":!0,"mi.th":!0,"net.th":!0,"or.th":!0,"ac.tj":!0,"biz.tj":!0,"co.tj":!0,"com.tj":!0,"edu.tj":!0,"go.tj":!0,"gov.tj":!0,"info.tj":!0,"int.tj":!0,"mil.tj":!0,"name.tj":!0,"net.tj":!0,"nic.tj":!0,"org.tj":!0,"test.tj":!0,"web.tj":!0,"agrinet.tn":!0,"com.tn":!0,"defense.tn":!0,"edunet.tn":!0,"ens.tn":!0,"fin.tn":!0,"gov.tn":!0,"ind.tn":!0,"info.tn":!0,"intl.tn":!0,"mincom.tn":!0,"nat.tn":!0,"net.tn":!0,"org.tn":!0,"perso.tn":!0,"rnrt.tn":!0,"rns.tn":!0,"rnu.tn":!0,"tourism.tn":!0,"ac.tz":!0,"co.tz":!0,"go.tz":!0,"ne.tz":!0,"or.tz":!0,"biz.ua":!0,"cherkassy.ua":!0,"chernigov.ua":!0,"chernovtsy.ua":!0,"ck.ua":!0,"cn.ua":!0,"co.ua":!0,"com.ua":!0,"crimea.ua":!0,"cv.ua":!0,"dn.ua":!0,"dnepropetrovsk.ua":!0,"donetsk.ua":!0,"dp.ua":!0,"edu.ua":!0,"gov.ua":!0,"if.ua":!0,"in.ua":!0,"ivano-frankivsk.ua":!0,"kh.ua":!0,"kharkov.ua":!0,"kherson.ua":!0,"khmelnitskiy.ua":!0,"kiev.ua":!0,"kirovograd.ua":!0,"km.ua":!0,"kr.ua":!0,"ks.ua":!0,"kv.ua":!0,"lg.ua":!0,"lugansk.ua":!0,"lutsk.ua":!0,"lviv.ua":!0,"me.ua":!0,"mk.ua":!0,"net.ua":!0,"nikolaev.ua":!0,"od.ua":!0,"odessa.ua":!0,"org.ua":!0,"pl.ua":!0,"poltava.ua":!0,"pp.ua":!0,"rovno.ua":!0,"rv.ua":!0,"sebastopol.ua":!0,"sumy.ua":!0,"te.ua":!0,"ternopil.ua":!0,"uzhgorod.ua":!0,"vinnica.ua":!0,"vn.ua":!0,"zaporizhzhe.ua":!0,"zhitomir.ua":!0,"zp.ua":!0,"zt.ua":!0,"ac.ug":!0,"co.ug":!0,"go.ug":!0,"ne.ug":!0,"or.ug":!0,"org.ug":!0,"sc.ug":!0,"ac.uk":!0,"bl.uk":!0,"british-library.uk":!0,"co.uk":!0,"cym.uk":!0,"gov.uk":!0,"govt.uk":!0,"icnet.uk":!0,"jet.uk":!0,"lea.uk":!0,"ltd.uk":!0,"me.uk":!0,"mil.uk":!0,"mod.uk":!0,"national-library-scotland.uk":!0,"nel.uk":!0,"net.uk":!0,"nhs.uk":!0,"nic.uk":!0,"nls.uk":!0,"org.uk":!0,"orgn.uk":!0,"parliament.uk":!0,"plc.uk":!0,"police.uk":!0,"sch.uk":!0,"scot.uk":!0,"soc.uk":!0,"4fd.us":!0,"dni.us":!0,"fed.us":!0,"isa.us":!0,"kids.us":!0,"nsn.us":!0,"com.uy":!0,"edu.uy":!0,"gub.uy":!0,"mil.uy":!0,"net.uy":!0,"org.uy":!0,"co.ve":!0,"com.ve":!0,"edu.ve":!0,"gob.ve":!0,"info.ve":!0,"mil.ve":!0,"net.ve":!0,"org.ve":!0,"web.ve":!0,"co.vi":!0,"com.vi":!0,"k12.vi":!0,"net.vi":!0,"org.vi":!0,"ac.vn":!0,"biz.vn":!0,"com.vn":!0,"edu.vn":!0,"gov.vn":!0,"health.vn":!0,"info.vn":!0,"int.vn":!0,"name.vn":!0,"net.vn":!0,"org.vn":!0,"pro.vn":!0,"co.ye":!0,"com.ye":!0,"gov.ye":!0,"ltd.ye":!0,"me.ye":!0,"net.ye":!0,"org.ye":!0,"plc.ye":!0,"ac.yu":!0,"co.yu":!0,"edu.yu":!0,"gov.yu":!0,"org.yu":!0,"ac.za":!0,"agric.za":!0,"alt.za":!0,"bourse.za":!0,"city.za":!0,"co.za":!0,"cybernet.za":!0,"db.za":!0,"ecape.school.za":!0,"edu.za":!0,"fs.school.za":!0,"gov.za":!0,"gp.school.za":!0,"grondar.za":!0,"iaccess.za":!0,"imt.za":!0,"inca.za":!0,"kzn.school.za":!0,"landesign.za":!0,"law.za":!0,"lp.school.za":!0,"mil.za":!0,"mpm.school.za":!0,"ncape.school.za":!0,"net.za":!0,"ngo.za":!0,"nis.za":!0,"nom.za":!0,"nw.school.za":!0,"olivetti.za":!0,"org.za":!0,"pix.za":!0,"school.za":!0,"tm.za":!0,"wcape.school.za":!0,"web.za":!0,"ac.zm":!0,"co.zm":!0,"com.zm":!0,"edu.zm":!0,"gov.zm":!0,"net.zm":!0,"org.zm":!0,"sch.zm":!0}});var VF=I((Zhe,vae)=>{vae.exports={ad:!0,ae:!0,af:!0,ag:!0,ai:!0,al:!0,am:!0,ao:!0,aq:!0,ar:!0,as:!0,at:!0,au:!0,aw:!0,ax:!0,az:!0,ba:!0,bb:!0,bd:!0,be:!0,bf:!0,bg:!0,bh:!0,bi:!0,bj:!0,bl:!0,bm:!0,bn:!0,bo:!0,bq:!0,br:!0,bs:!0,bt:!0,bv:!0,bw:!0,by:!0,bz:!0,ca:!0,cc:!0,cd:!0,cf:!0,cg:!0,ch:!0,ci:!0,ck:!0,cl:!0,cm:!0,cn:!0,co:!0,cr:!0,cu:!0,cv:!0,cw:!0,cx:!0,cy:!0,cz:!0,de:!0,dj:!0,dk:!0,dm:!0,do:!0,dz:!0,ec:!0,ee:!0,eg:!0,er:!0,es:!0,et:!0,fi:!0,fj:!0,fk:!0,fm:!0,fo:!0,fr:!0,ga:!0,"gb (.uk)":!0,gd:!0,ge:!0,gf:!0,gg:!0,gh:!0,gi:!0,gl:!0,gm:!0,gn:!0,gp:!0,gq:!0,gr:!0,gs:!0,gt:!0,gu:!0,gw:!0,gy:!0,hk:!0,hm:!0,hn:!0,hr:!0,ht:!0,hu:!0,id:!0,ie:!0,il:!0,im:!0,in:!0,io:!0,iq:!0,ir:!0,is:!0,it:!0,je:!0,jm:!0,jo:!0,jp:!0,ke:!0,kg:!0,kh:!0,ki:!0,km:!0,kn:!0,kp:!0,kr:!0,kw:!0,ky:!0,kz:!0,la:!0,lb:!0,lc:!0,li:!0,lk:!0,lr:!0,ls:!0,lt:!0,lu:!0,lv:!0,ly:!0,ma:!0,mc:!0,md:!0,me:!0,mf:!0,mg:!0,mh:!0,mk:!0,ml:!0,mm:!0,mn:!0,mo:!0,mp:!0,mq:!0,mr:!0,ms:!0,mt:!0,mu:!0,mv:!0,mw:!0,mx:!0,my:!0,mz:!0,na:!0,nc:!0,ne:!0,nf:!0,ng:!0,ni:!0,nl:!0,no:!0,np:!0,nr:!0,nu:!0,nz:!0,om:!0,pa:!0,pe:!0,pf:!0,pg:!0,ph:!0,pk:!0,pl:!0,pm:!0,pn:!0,pr:!0,ps:!0,pt:!0,pw:!0,py:!0,qa:!0,re:!0,ro:!0,rs:!0,ru:!0,rw:!0,sa:!0,sb:!0,sc:!0,sd:!0,se:!0,sg:!0,sh:!0,si:!0,sj:!0,sk:!0,sl:!0,sm:!0,sn:!0,so:!0,sr:!0,ss:!0,st:!0,sv:!0,sx:!0,sy:!0,sz:!0,tc:!0,td:!0,tf:!0,tg:!0,th:!0,tj:!0,tk:!0,tl:!0,tm:!0,tn:!0,to:!0,tr:!0,tt:!0,tv:!0,tw:!0,tz:!0,ua:!0,ug:!0,us:!0,uy:!0,uz:!0,va:!0,vc:!0,ve:!0,vg:!0,vi:!0,vn:!0,vu:!0,wf:!0,ws:!0,ye:!0,yt:!0,za:!0,zm:!0,zw:!0}});var wF=I((vhe,NF)=>{"use strict";var Sae=require("punycode"),Wae=RF(),Rae=VF();NF.exports=function(t,n){if(typeof t!="string"||(n instanceof Object||(n={}),t=t.toLowerCase(),t.endsWith(".")&&(t=t.slice(0,t.length-1)),n.allowUnicode&&(t=Sae.toASCII(t)),t.length>253)||!/^([\u0E00-\u0E7Fa-z0-9-._*]+)$/g.test(t))return!1;if(n.topLevel&&Rae[t.replace(/\.$/,"")])return!0;let i=/(.*)\.(([\u0E00-\u0E7Fa-z0-9]+)(\.[a-z0-9]+))/,o=t.match(i),s=null,a=null;return o&&o.length>2&&Wae[o[2]]&&(s=o[2],a=o[1].split(".")),!a&&(a=t.split("."),a.length<=1||(s=a.pop(),!/^(?:xn--)?(?!^\d+$)[\u0E00-\u0E7Fa-z0-9]+$/gi.test(s)))||n.subdomain===!1&&a.length>1?!1:a.every(function(l,u){if(n.wildcard&&u===0&&l==="*"&&a.length>1)return!0;let d=/^([\u0E00-\u0E7Fa-zA-Z0-9-_]+)$/g;u===a.length-1&&(d=/^([\u0E00-\u0E7Fa-zA-Z0-9-]+)$/g);let g=(l.match(/--(--)?/g)||[]).length,m=(l.match(/xn--/g)||[]).length;return u===a.length-1&&g!==m?!1:d.test(l)&&l.length<64&&!l.startsWith("-")&&!l.endsWith("-")})}});var HF={};Ht(HF,{isRegistryModule:()=>my});function my(e){let t=e.split("/");return!(e.startsWith(".")||t.length<3||t.length>4||e.includes("github.com")||e.includes("bitbucket.org")||t.length===4&&!(0,EF.default)(t[0]))}var EF,py=We(()=>{"use strict";EF=J(wF())});var KF=I((She,fy)=>{"use strict";var Vae=/[\p{Lu}]/u,Nae=/[\p{Ll}]/u,YF=/^[\p{Lu}](?![\p{Lu}])/gu,FF=/([\p{Alpha}\p{N}_]|$)/u,TF=/[_.\- ]+/,wae=new RegExp("^"+TF.source),XF=new RegExp(TF.source+FF.source,"gu"),_F=new RegExp("\\d+"+FF.source,"gu"),Eae=(e,t,n)=>{let r=!1,i=!1,o=!1;for(let s=0;s<e.length;s++){let a=e[s];r&&Vae.test(a)?(e=e.slice(0,s)+"-"+e.slice(s),r=!1,o=i,i=!0,s++):i&&o&&Nae.test(a)?(e=e.slice(0,s-1)+"-"+e.slice(s-1),o=i,i=!1,r=!0):(r=t(a)===a&&n(a)!==a,o=i,i=n(a)===a&&t(a)!==a)}return e},Hae=(e,t)=>(YF.lastIndex=0,e.replace(YF,n=>t(n))),Yae=(e,t)=>(XF.lastIndex=0,_F.lastIndex=0,e.replace(XF,(n,r)=>t(r)).replace(_F,n=>t(n))),kF=(e,t)=>{if(!(typeof e=="string"||Array.isArray(e)))throw new TypeError("Expected the input to be `string | string[]`");if(t={pascalCase:!1,preserveConsecutiveUppercase:!1,...t},Array.isArray(e)?e=e.map(o=>o.trim()).filter(o=>o.length).join("-"):e=e.trim(),e.length===0)return"";let n=t.locale===!1?o=>o.toLowerCase():o=>o.toLocaleLowerCase(t.locale),r=t.locale===!1?o=>o.toUpperCase():o=>o.toLocaleUpperCase(t.locale);return e.length===1?t.pascalCase?r(e):n(e):(e!==n(e)&&(e=Eae(e,n,r)),e=e.replace(wae,""),t.preserveConsecutiveUppercase?e=Hae(e,n):e=n(e),t.pascalCase&&(e=r(e.charAt(0))+e.slice(1)),Yae(e,r))};fy.exports=kF;fy.exports.default=kF});var xF=I((Whe,UF)=>{"use strict";var Xae=(e,t)=>(e=e.replace(/((?<![\p{Uppercase_Letter}\d])[\p{Uppercase_Letter}\d](?![\p{Uppercase_Letter}\d]))/gu,n=>n.toLowerCase()),e.replace(new RegExp("(\\p{Uppercase_Letter}+)(\\p{Uppercase_Letter}\\p{Lowercase_Letter}+)","gu"),(n,r,i)=>r+t+i.toLowerCase()));UF.exports=(e,{separator:t="_",preserveConsecutiveUppercase:n=!1}={})=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("The `text` and `separator` arguments should be of type `string`");if(e.length<2)return n?e:e.toLowerCase();let r=`$1${t}$2`,i=e.replace(new RegExp("([\\p{Lowercase_Letter}\\d])(\\p{Uppercase_Letter})","gu"),r);return n?Xae(i,t):i.replace(new RegExp("(\\p{Uppercase_Letter})(\\p{Uppercase_Letter}\\p{Lowercase_Letter}+)","gu"),r).toLowerCase()}});var hy=I(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.toSnakeCase=ii.toPascalCase=ii.toCamelCase=void 0;var LF=KF(),_ae=xF(),Fae=["KiB","MiB","GiB"];function Tae(...e){return LF(e)}ii.toCamelCase=Tae;function kae(...e){return LF(e,{pascalCase:!0})}ii.toPascalCase=kae;var Kae=new RegExp(`(^|[^A-Z])(${Fae.map(xae).join("|")})($|[^a-z])`,"g");function Uae(e,t="_"){return e=e.replace(Kae,(r,i,o,s)=>i+n(o.toLowerCase())+s),_ae(e,{separator:t});function n(r){return r.slice(0,1).toUpperCase()+r.slice(1).toLowerCase()}}ii.toSnakeCase=Uae;function xae(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}});var go=I(oi=>{"use strict";var JF=ge().fromCallback,Nt=z(),Lae=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof Nt[e]=="function");Object.assign(oi,Nt);Lae.forEach(e=>{oi[e]=JF(Nt[e])});oi.exists=function(e,t){return typeof t=="function"?Nt.exists(e,t):new Promise(n=>Nt.exists(e,n))};oi.read=function(e,t,n,r,i,o){return typeof o=="function"?Nt.read(e,t,n,r,i,o):new Promise((s,a)=>{Nt.read(e,t,n,r,i,(c,l,u)=>{if(c)return a(c);s({bytesRead:l,buffer:u})})})};oi.write=function(e,t,...n){return typeof n[n.length-1]=="function"?Nt.write(e,t,...n):new Promise((r,i)=>{Nt.write(e,t,...n,(o,s,a)=>{if(o)return i(o);r({bytesWritten:s,buffer:a})})})};typeof Nt.writev=="function"&&(oi.writev=function(e,t,...n){return typeof n[n.length-1]=="function"?Nt.writev(e,t,...n):new Promise((r,i)=>{Nt.writev(e,t,...n,(o,s,a)=>{if(o)return i(o);r({bytesWritten:s,buffers:a})})})});typeof Nt.realpath.native=="function"?oi.realpath.native=JF(Nt.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var OF=I((Nhe,zF)=>{"use strict";var Jae=require("path");zF.exports.checkPath=function(t){if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(Jae.parse(t).root,""))){let r=new Error(`Path contains invalid characters: ${t}`);throw r.code="EINVAL",r}}});var jF=I((whe,Cy)=>{"use strict";var DF=go(),{checkPath:qF}=OF(),MF=e=>{let t={mode:511};return typeof e=="number"?e:{...t,...e}.mode};Cy.exports.makeDir=async(e,t)=>(qF(e),DF.mkdir(e,{mode:MF(t),recursive:!0}));Cy.exports.makeDirSync=(e,t)=>(qF(e),DF.mkdirSync(e,{mode:MF(t),recursive:!0}))});var yn=I((Ehe,PF)=>{"use strict";var zae=ge().fromPromise,{makeDir:Oae,makeDirSync:by}=jF(),yy=zae(Oae);PF.exports={mkdirs:yy,mkdirsSync:by,mkdirp:yy,mkdirpSync:by,ensureDir:yy,ensureDirSync:by}});var si=I((Hhe,$F)=>{"use strict";var Dae=ge().fromPromise,QF=go();function qae(e){return QF.access(e).then(()=>!0).catch(()=>!1)}$F.exports={pathExists:Dae(qae),pathExistsSync:QF.existsSync}});var Gy=I((Yhe,eT)=>{"use strict";var Ss=z();function Mae(e,t,n,r){Ss.open(e,"r+",(i,o)=>{if(i)return r(i);Ss.futimes(o,t,n,s=>{Ss.close(o,a=>{r&&r(s||a)})})})}function jae(e,t,n){let r=Ss.openSync(e,"r+");return Ss.futimesSync(r,t,n),Ss.closeSync(r)}eT.exports={utimesMillis:Mae,utimesMillisSync:jae}});var Io=I((Xhe,rT)=>{"use strict";var Ws=go(),Je=require("path"),Pae=require("util");function Qae(e,t,n){let r=n.dereference?i=>Ws.stat(i,{bigint:!0}):i=>Ws.lstat(i,{bigint:!0});return Promise.all([r(e),r(t).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,o])=>({srcStat:i,destStat:o}))}function $ae(e,t,n){let r,i=n.dereference?s=>Ws.statSync(s,{bigint:!0}):s=>Ws.lstatSync(s,{bigint:!0}),o=i(e);try{r=i(t)}catch(s){if(s.code==="ENOENT")return{srcStat:o,destStat:null};throw s}return{srcStat:o,destStat:r}}function ece(e,t,n,r,i){Pae.callbackify(Qae)(e,t,r,(o,s)=>{if(o)return i(o);let{srcStat:a,destStat:c}=s;if(c){if(Lc(a,c)){let l=Je.basename(e),u=Je.basename(t);return n==="move"&&l!==u&&l.toLowerCase()===u.toLowerCase()?i(null,{srcStat:a,destStat:c,isChangingCase:!0}):i(new Error("Source and destination must not be the same."))}if(a.isDirectory()&&!c.isDirectory())return i(new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`));if(!a.isDirectory()&&c.isDirectory())return i(new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`))}return a.isDirectory()&&By(e,t)?i(new Error(Md(e,t,n))):i(null,{srcStat:a,destStat:c})})}function tce(e,t,n,r){let{srcStat:i,destStat:o}=$ae(e,t,r);if(o){if(Lc(i,o)){let s=Je.basename(e),a=Je.basename(t);if(n==="move"&&s!==a&&s.toLowerCase()===a.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(i.isDirectory()&&By(e,t))throw new Error(Md(e,t,n));return{srcStat:i,destStat:o}}function tT(e,t,n,r,i){let o=Je.resolve(Je.dirname(e)),s=Je.resolve(Je.dirname(n));if(s===o||s===Je.parse(s).root)return i();Ws.stat(s,{bigint:!0},(a,c)=>a?a.code==="ENOENT"?i():i(a):Lc(t,c)?i(new Error(Md(e,n,r))):tT(e,t,s,r,i))}function nT(e,t,n,r){let i=Je.resolve(Je.dirname(e)),o=Je.resolve(Je.dirname(n));if(o===i||o===Je.parse(o).root)return;let s;try{s=Ws.statSync(o,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(Lc(t,s))throw new Error(Md(e,n,r));return nT(e,t,o,r)}function Lc(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function By(e,t){let n=Je.resolve(e).split(Je.sep).filter(i=>i),r=Je.resolve(t).split(Je.sep).filter(i=>i);return n.reduce((i,o,s)=>i&&r[s]===o,!0)}function Md(e,t,n){return`Cannot ${n} '${e}' to a subdirectory of itself, '${t}'.`}rT.exports={checkPaths:ece,checkPathsSync:tce,checkParentPaths:tT,checkParentPathsSync:nT,isSrcSubdir:By,areIdentical:Lc}});var gT=I((_he,lT)=>{"use strict";var wt=z(),Jc=require("path"),nce=yn().mkdirs,rce=si().pathExists,ice=Gy().utimesMillis,zc=Io();function oce(e,t,n,r){typeof n=="function"&&!r?(r=n,n={}):typeof n=="function"&&(n={filter:n}),r=r||function(){},n=n||{},n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001"),zc.checkPaths(e,t,"copy",n,(i,o)=>{if(i)return r(i);let{srcStat:s,destStat:a}=o;zc.checkParentPaths(e,s,t,"copy",c=>c?r(c):n.filter?sT(iT,a,e,t,n,r):iT(a,e,t,n,r))})}function iT(e,t,n,r,i){let o=Jc.dirname(n);rce(o,(s,a)=>{if(s)return i(s);if(a)return jd(e,t,n,r,i);nce(o,c=>c?i(c):jd(e,t,n,r,i))})}function sT(e,t,n,r,i,o){Promise.resolve(i.filter(n,r)).then(s=>s?e(t,n,r,i,o):o(),s=>o(s))}function sce(e,t,n,r,i){return r.filter?sT(jd,e,t,n,r,i):jd(e,t,n,r,i)}function jd(e,t,n,r,i){(r.dereference?wt.stat:wt.lstat)(t,(s,a)=>s?i(s):a.isDirectory()?Ice(a,e,t,n,r,i):a.isFile()||a.isCharacterDevice()||a.isBlockDevice()?ace(a,e,t,n,r,i):a.isSymbolicLink()?fce(e,t,n,r,i):a.isSocket()?i(new Error(`Cannot copy a socket file: ${t}`)):a.isFIFO()?i(new Error(`Cannot copy a FIFO pipe: ${t}`)):i(new Error(`Unknown file: ${t}`)))}function ace(e,t,n,r,i,o){return t?cce(e,n,r,i,o):aT(e,n,r,i,o)}function cce(e,t,n,r,i){if(r.overwrite)wt.unlink(n,o=>o?i(o):aT(e,t,n,r,i));else return r.errorOnExist?i(new Error(`'${n}' already exists`)):i()}function aT(e,t,n,r,i){wt.copyFile(t,n,o=>o?i(o):r.preserveTimestamps?uce(e.mode,t,n,i):Pd(n,e.mode,i))}function uce(e,t,n,r){return lce(e)?gce(n,e,i=>i?r(i):oT(e,t,n,r)):oT(e,t,n,r)}function lce(e){return(e&128)===0}function gce(e,t,n){return Pd(e,t|128,n)}function oT(e,t,n,r){dce(t,n,i=>i?r(i):Pd(n,e,r))}function Pd(e,t,n){return wt.chmod(e,t,n)}function dce(e,t,n){wt.stat(e,(r,i)=>r?n(r):ice(t,i.atime,i.mtime,n))}function Ice(e,t,n,r,i,o){return t?cT(n,r,i,o):mce(e.mode,n,r,i,o)}function mce(e,t,n,r,i){wt.mkdir(n,o=>{if(o)return i(o);cT(t,n,r,s=>s?i(s):Pd(n,e,i))})}function cT(e,t,n,r){wt.readdir(e,(i,o)=>i?r(i):uT(o,e,t,n,r))}function uT(e,t,n,r,i){let o=e.pop();return o?pce(e,o,t,n,r,i):i()}function pce(e,t,n,r,i,o){let s=Jc.join(n,t),a=Jc.join(r,t);zc.checkPaths(s,a,"copy",i,(c,l)=>{if(c)return o(c);let{destStat:u}=l;sce(u,s,a,i,d=>d?o(d):uT(e,n,r,i,o))})}function fce(e,t,n,r,i){wt.readlink(t,(o,s)=>{if(o)return i(o);if(r.dereference&&(s=Jc.resolve(process.cwd(),s)),e)wt.readlink(n,(a,c)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?wt.symlink(s,n,i):i(a):(r.dereference&&(c=Jc.resolve(process.cwd(),c)),zc.isSrcSubdir(s,c)?i(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${c}'.`)):e.isDirectory()&&zc.isSrcSubdir(c,s)?i(new Error(`Cannot overwrite '${c}' with '${s}'.`)):hce(s,n,i)));else return wt.symlink(s,n,i)})}function hce(e,t,n){wt.unlink(t,r=>r?n(r):wt.symlink(e,t,n))}lT.exports=oce});var fT=I((Fhe,pT)=>{"use strict";var it=z(),Oc=require("path"),Cce=yn().mkdirsSync,bce=Gy().utimesMillisSync,Dc=Io();function yce(e,t,n){typeof n=="function"&&(n={filter:n}),n=n||{},n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:r,destStat:i}=Dc.checkPathsSync(e,t,"copy",n);return Dc.checkParentPathsSync(e,r,t,"copy"),Gce(i,e,t,n)}function Gce(e,t,n,r){if(r.filter&&!r.filter(t,n))return;let i=Oc.dirname(n);return it.existsSync(i)||Cce(i),dT(e,t,n,r)}function Bce(e,t,n,r){if(!(r.filter&&!r.filter(t,n)))return dT(e,t,n,r)}function dT(e,t,n,r){let o=(r.dereference?it.statSync:it.lstatSync)(t);if(o.isDirectory())return Vce(o,e,t,n,r);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return Ace(o,e,t,n,r);if(o.isSymbolicLink())return Ece(e,t,n,r);throw o.isSocket()?new Error(`Cannot copy a socket file: ${t}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}function Ace(e,t,n,r,i){return t?Zce(e,n,r,i):IT(e,n,r,i)}function Zce(e,t,n,r){if(r.overwrite)return it.unlinkSync(n),IT(e,t,n,r);if(r.errorOnExist)throw new Error(`'${n}' already exists`)}function IT(e,t,n,r){return it.copyFileSync(t,n),r.preserveTimestamps&&vce(e.mode,t,n),Ay(n,e.mode)}function vce(e,t,n){return Sce(e)&&Wce(n,e),Rce(t,n)}function Sce(e){return(e&128)===0}function Wce(e,t){return Ay(e,t|128)}function Ay(e,t){return it.chmodSync(e,t)}function Rce(e,t){let n=it.statSync(e);return bce(t,n.atime,n.mtime)}function Vce(e,t,n,r,i){return t?mT(n,r,i):Nce(e.mode,n,r,i)}function Nce(e,t,n,r){return it.mkdirSync(n),mT(t,n,r),Ay(n,e)}function mT(e,t,n){it.readdirSync(e).forEach(r=>wce(r,e,t,n))}function wce(e,t,n,r){let i=Oc.join(t,e),o=Oc.join(n,e),{destStat:s}=Dc.checkPathsSync(i,o,"copy",r);return Bce(s,i,o,r)}function Ece(e,t,n,r){let i=it.readlinkSync(t);if(r.dereference&&(i=Oc.resolve(process.cwd(),i)),e){let o;try{o=it.readlinkSync(n)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return it.symlinkSync(i,n);throw s}if(r.dereference&&(o=Oc.resolve(process.cwd(),o)),Dc.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(it.statSync(n).isDirectory()&&Dc.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return Hce(i,n)}else return it.symlinkSync(i,n)}function Hce(e,t){return it.unlinkSync(t),it.symlinkSync(e,t)}pT.exports=yce});var Qd=I((The,hT)=>{"use strict";var Yce=ge().fromCallback;hT.exports={copy:Yce(gT()),copySync:fT()}});var ST=I((khe,vT)=>{"use strict";var CT=z(),BT=require("path"),fe=require("assert"),qc=process.platform==="win32";function AT(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(n=>{e[n]=e[n]||CT[n],n=n+"Sync",e[n]=e[n]||CT[n]}),e.maxBusyTries=e.maxBusyTries||3}function Zy(e,t,n){let r=0;typeof t=="function"&&(n=t,t={}),fe(e,"rimraf: missing path"),fe.strictEqual(typeof e,"string","rimraf: path should be a string"),fe.strictEqual(typeof n,"function","rimraf: callback function required"),fe(t,"rimraf: invalid options argument provided"),fe.strictEqual(typeof t,"object","rimraf: options should be object"),AT(t),bT(e,t,function i(o){if(o){if((o.code==="EBUSY"||o.code==="ENOTEMPTY"||o.code==="EPERM")&&r<t.maxBusyTries){r++;let s=r*100;return setTimeout(()=>bT(e,t,i),s)}o.code==="ENOENT"&&(o=null)}n(o)})}function bT(e,t,n){fe(e),fe(t),fe(typeof n=="function"),t.lstat(e,(r,i)=>{if(r&&r.code==="ENOENT")return n(null);if(r&&r.code==="EPERM"&&qc)return yT(e,t,r,n);if(i&&i.isDirectory())return $d(e,t,r,n);t.unlink(e,o=>{if(o){if(o.code==="ENOENT")return n(null);if(o.code==="EPERM")return qc?yT(e,t,o,n):$d(e,t,o,n);if(o.code==="EISDIR")return $d(e,t,o,n)}return n(o)})})}function yT(e,t,n,r){fe(e),fe(t),fe(typeof r=="function"),t.chmod(e,438,i=>{i?r(i.code==="ENOENT"?null:n):t.stat(e,(o,s)=>{o?r(o.code==="ENOENT"?null:n):s.isDirectory()?$d(e,t,n,r):t.unlink(e,r)})})}function GT(e,t,n){let r;fe(e),fe(t);try{t.chmodSync(e,438)}catch(i){if(i.code==="ENOENT")return;throw n}try{r=t.statSync(e)}catch(i){if(i.code==="ENOENT")return;throw n}r.isDirectory()?eI(e,t,n):t.unlinkSync(e)}function $d(e,t,n,r){fe(e),fe(t),fe(typeof r=="function"),t.rmdir(e,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?Xce(e,t,r):i&&i.code==="ENOTDIR"?r(n):r(i)})}function Xce(e,t,n){fe(e),fe(t),fe(typeof n=="function"),t.readdir(e,(r,i)=>{if(r)return n(r);let o=i.length,s;if(o===0)return t.rmdir(e,n);i.forEach(a=>{Zy(BT.join(e,a),t,c=>{if(!s){if(c)return n(s=c);--o===0&&t.rmdir(e,n)}})})})}function ZT(e,t){let n;t=t||{},AT(t),fe(e,"rimraf: missing path"),fe.strictEqual(typeof e,"string","rimraf: path should be a string"),fe(t,"rimraf: missing options"),fe.strictEqual(typeof t,"object","rimraf: options should be object");try{n=t.lstatSync(e)}catch(r){if(r.code==="ENOENT")return;r.code==="EPERM"&&qc&&GT(e,t,r)}try{n&&n.isDirectory()?eI(e,t,null):t.unlinkSync(e)}catch(r){if(r.code==="ENOENT")return;if(r.code==="EPERM")return qc?GT(e,t,r):eI(e,t,r);if(r.code!=="EISDIR")throw r;eI(e,t,r)}}function eI(e,t,n){fe(e),fe(t);try{t.rmdirSync(e)}catch(r){if(r.code==="ENOTDIR")throw n;if(r.code==="ENOTEMPTY"||r.code==="EEXIST"||r.code==="EPERM")_ce(e,t);else if(r.code!=="ENOENT")throw r}}function _ce(e,t){if(fe(e),fe(t),t.readdirSync(e).forEach(n=>ZT(BT.join(e,n),t)),qc){let n=Date.now();do try{return t.rmdirSync(e,t)}catch{}while(Date.now()-n<500)}else return t.rmdirSync(e,t)}vT.exports=Zy;Zy.sync=ZT});var Mc=I((Khe,RT)=>{"use strict";var tI=z(),Fce=ge().fromCallback,WT=ST();function Tce(e,t){if(tI.rm)return tI.rm(e,{recursive:!0,force:!0},t);WT(e,t)}function kce(e){if(tI.rmSync)return tI.rmSync(e,{recursive:!0,force:!0});WT.sync(e)}RT.exports={remove:Fce(Tce),removeSync:kce}});var _T=I((Uhe,XT)=>{"use strict";var Kce=ge().fromPromise,wT=go(),ET=require("path"),HT=yn(),YT=Mc(),VT=Kce(async function(t){let n;try{n=await wT.readdir(t)}catch{return HT.mkdirs(t)}return Promise.all(n.map(r=>YT.remove(ET.join(t,r))))});function NT(e){let t;try{t=wT.readdirSync(e)}catch{return HT.mkdirsSync(e)}t.forEach(n=>{n=ET.join(e,n),YT.removeSync(n)})}XT.exports={emptyDirSync:NT,emptydirSync:NT,emptyDir:VT,emptydir:VT}});var KT=I((xhe,kT)=>{"use strict";var Uce=ge().fromCallback,FT=require("path"),ai=z(),TT=yn();function xce(e,t){function n(){ai.writeFile(e,"",r=>{if(r)return t(r);t()})}ai.stat(e,(r,i)=>{if(!r&&i.isFile())return t();let o=FT.dirname(e);ai.stat(o,(s,a)=>{if(s)return s.code==="ENOENT"?TT.mkdirs(o,c=>{if(c)return t(c);n()}):t(s);a.isDirectory()?n():ai.readdir(o,c=>{if(c)return t(c)})})})}function Lce(e){let t;try{t=ai.statSync(e)}catch{}if(t&&t.isFile())return;let n=FT.dirname(e);try{ai.statSync(n).isDirectory()||ai.readdirSync(n)}catch(r){if(r&&r.code==="ENOENT")TT.mkdirsSync(n);else throw r}ai.writeFileSync(e,"")}kT.exports={createFile:Uce(xce),createFileSync:Lce}});var zT=I((Lhe,JT)=>{"use strict";var Jce=ge().fromCallback,UT=require("path"),ci=z(),xT=yn(),zce=si().pathExists,{areIdentical:LT}=Io();function Oce(e,t,n){function r(i,o){ci.link(i,o,s=>{if(s)return n(s);n(null)})}ci.lstat(t,(i,o)=>{ci.lstat(e,(s,a)=>{if(s)return s.message=s.message.replace("lstat","ensureLink"),n(s);if(o&&LT(a,o))return n(null);let c=UT.dirname(t);zce(c,(l,u)=>{if(l)return n(l);if(u)return r(e,t);xT.mkdirs(c,d=>{if(d)return n(d);r(e,t)})})})})}function Dce(e,t){let n;try{n=ci.lstatSync(t)}catch{}try{let o=ci.lstatSync(e);if(n&&LT(o,n))return}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let r=UT.dirname(t);return ci.existsSync(r)||xT.mkdirsSync(r),ci.linkSync(e,t)}JT.exports={createLink:Jce(Oce),createLinkSync:Dce}});var DT=I((Jhe,OT)=>{"use strict";var ui=require("path"),jc=z(),qce=si().pathExists;function Mce(e,t,n){if(ui.isAbsolute(e))return jc.lstat(e,r=>r?(r.message=r.message.replace("lstat","ensureSymlink"),n(r)):n(null,{toCwd:e,toDst:e}));{let r=ui.dirname(t),i=ui.join(r,e);return qce(i,(o,s)=>o?n(o):s?n(null,{toCwd:i,toDst:e}):jc.lstat(e,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),n(a)):n(null,{toCwd:e,toDst:ui.relative(r,e)})))}}function jce(e,t){let n;if(ui.isAbsolute(e)){if(n=jc.existsSync(e),!n)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}else{let r=ui.dirname(t),i=ui.join(r,e);if(n=jc.existsSync(i),n)return{toCwd:i,toDst:e};if(n=jc.existsSync(e),!n)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:ui.relative(r,e)}}}OT.exports={symlinkPaths:Mce,symlinkPathsSync:jce}});var jT=I((zhe,MT)=>{"use strict";var qT=z();function Pce(e,t,n){if(n=typeof t=="function"?t:n,t=typeof t=="function"?!1:t,t)return n(null,t);qT.lstat(e,(r,i)=>{if(r)return n(null,"file");t=i&&i.isDirectory()?"dir":"file",n(null,t)})}function Qce(e,t){let n;if(t)return t;try{n=qT.lstatSync(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}MT.exports={symlinkType:Pce,symlinkTypeSync:Qce}});var ik=I((Ohe,rk)=>{"use strict";var $ce=ge().fromCallback,QT=require("path"),Gn=go(),$T=yn(),eue=$T.mkdirs,tue=$T.mkdirsSync,ek=DT(),nue=ek.symlinkPaths,rue=ek.symlinkPathsSync,tk=jT(),iue=tk.symlinkType,oue=tk.symlinkTypeSync,sue=si().pathExists,{areIdentical:nk}=Io();function aue(e,t,n,r){r=typeof n=="function"?n:r,n=typeof n=="function"?!1:n,Gn.lstat(t,(i,o)=>{!i&&o.isSymbolicLink()?Promise.all([Gn.stat(e),Gn.stat(t)]).then(([s,a])=>{if(nk(s,a))return r(null);PT(e,t,n,r)}):PT(e,t,n,r)})}function PT(e,t,n,r){nue(e,t,(i,o)=>{if(i)return r(i);e=o.toDst,iue(o.toCwd,n,(s,a)=>{if(s)return r(s);let c=QT.dirname(t);sue(c,(l,u)=>{if(l)return r(l);if(u)return Gn.symlink(e,t,a,r);eue(c,d=>{if(d)return r(d);Gn.symlink(e,t,a,r)})})})})}function cue(e,t,n){let r;try{r=Gn.lstatSync(t)}catch{}if(r&&r.isSymbolicLink()){let a=Gn.statSync(e),c=Gn.statSync(t);if(nk(a,c))return}let i=rue(e,t);e=i.toDst,n=oue(i.toCwd,n);let o=QT.dirname(t);return Gn.existsSync(o)||tue(o),Gn.symlinkSync(e,t,n)}rk.exports={createSymlink:$ce(aue),createSymlinkSync:cue}});var dk=I((Dhe,gk)=>{"use strict";var{createFile:ok,createFileSync:sk}=KT(),{createLink:ak,createLinkSync:ck}=zT(),{createSymlink:uk,createSymlinkSync:lk}=ik();gk.exports={createFile:ok,createFileSync:sk,ensureFile:ok,ensureFileSync:sk,createLink:ak,createLinkSync:ck,ensureLink:ak,ensureLinkSync:ck,createSymlink:uk,createSymlinkSync:lk,ensureSymlink:uk,ensureSymlinkSync:lk}});var mk=I((qhe,Ik)=>{"use strict";var nI=Lb();Ik.exports={readJson:nI.readFile,readJsonSync:nI.readFileSync,writeJson:nI.writeFile,writeJsonSync:nI.writeFileSync}});var rI=I((Mhe,hk)=>{"use strict";var uue=ge().fromCallback,Pc=z(),pk=require("path"),fk=yn(),lue=si().pathExists;function gue(e,t,n,r){typeof n=="function"&&(r=n,n="utf8");let i=pk.dirname(e);lue(i,(o,s)=>{if(o)return r(o);if(s)return Pc.writeFile(e,t,n,r);fk.mkdirs(i,a=>{if(a)return r(a);Pc.writeFile(e,t,n,r)})})}function due(e,...t){let n=pk.dirname(e);if(Pc.existsSync(n))return Pc.writeFileSync(e,...t);fk.mkdirsSync(n),Pc.writeFileSync(e,...t)}hk.exports={outputFile:uue(gue),outputFileSync:due}});var bk=I((jhe,Ck)=>{"use strict";var{stringify:Iue}=Bs(),{outputFile:mue}=rI();async function pue(e,t,n={}){let r=Iue(t,n);await mue(e,r,n)}Ck.exports=pue});var Gk=I((Phe,yk)=>{"use strict";var{stringify:fue}=Bs(),{outputFileSync:hue}=rI();function Cue(e,t,n){let r=fue(t,n);hue(e,r,n)}yk.exports=Cue});var Ak=I((Qhe,Bk)=>{"use strict";var bue=ge().fromPromise,pt=mk();pt.outputJson=bue(bk());pt.outputJsonSync=Gk();pt.outputJSON=pt.outputJson;pt.outputJSONSync=pt.outputJsonSync;pt.writeJSON=pt.writeJson;pt.writeJSONSync=pt.writeJsonSync;pt.readJSON=pt.readJson;pt.readJSONSync=pt.readJsonSync;Bk.exports=pt});var Rk=I(($he,Wk)=>{"use strict";var yue=z(),Sy=require("path"),Gue=Qd().copy,Sk=Mc().remove,Bue=yn().mkdirp,Aue=si().pathExists,Zk=Io();function Zue(e,t,n,r){typeof n=="function"&&(r=n,n={}),n=n||{};let i=n.overwrite||n.clobber||!1;Zk.checkPaths(e,t,"move",n,(o,s)=>{if(o)return r(o);let{srcStat:a,isChangingCase:c=!1}=s;Zk.checkParentPaths(e,a,t,"move",l=>{if(l)return r(l);if(vue(t))return vk(e,t,i,c,r);Bue(Sy.dirname(t),u=>u?r(u):vk(e,t,i,c,r))})})}function vue(e){let t=Sy.dirname(e);return Sy.parse(t).root===t}function vk(e,t,n,r,i){if(r)return vy(e,t,n,i);if(n)return Sk(t,o=>o?i(o):vy(e,t,n,i));Aue(t,(o,s)=>o?i(o):s?i(new Error("dest already exists.")):vy(e,t,n,i))}function vy(e,t,n,r){yue.rename(e,t,i=>i?i.code!=="EXDEV"?r(i):Sue(e,t,n,r):r())}function Sue(e,t,n,r){Gue(e,t,{overwrite:n,errorOnExist:!0},o=>o?r(o):Sk(e,r))}Wk.exports=Zue});var Hk=I((eCe,Ek)=>{"use strict";var Nk=z(),Ry=require("path"),Wue=Qd().copySync,wk=Mc().removeSync,Rue=yn().mkdirpSync,Vk=Io();function Vue(e,t,n){n=n||{};let r=n.overwrite||n.clobber||!1,{srcStat:i,isChangingCase:o=!1}=Vk.checkPathsSync(e,t,"move",n);return Vk.checkParentPathsSync(e,i,t,"move"),Nue(t)||Rue(Ry.dirname(t)),wue(e,t,r,o)}function Nue(e){let t=Ry.dirname(e);return Ry.parse(t).root===t}function wue(e,t,n,r){if(r)return Wy(e,t,n);if(n)return wk(t),Wy(e,t,n);if(Nk.existsSync(t))throw new Error("dest already exists.");return Wy(e,t,n)}function Wy(e,t,n){try{Nk.renameSync(e,t)}catch(r){if(r.code!=="EXDEV")throw r;return Eue(e,t,n)}}function Eue(e,t,n){return Wue(e,t,{overwrite:n,errorOnExist:!0}),wk(e)}Ek.exports=Vue});var Xk=I((tCe,Yk)=>{"use strict";var Hue=ge().fromCallback;Yk.exports={move:Hue(Rk()),moveSync:Hk()}});var Fk=I((nCe,_k)=>{"use strict";_k.exports={...go(),...Qd(),..._T(),...dk(),...Ak(),...yn(),...Xk(),...rI(),...si(),...Mc()}});var kk=I(Ny=>{"use strict";Object.defineProperty(Ny,"__esModule",{value:!0});var Tk=require("path"),Vy=class{constructor(t){this.buffer="",this.filePath=t}write(t){this.buffer+=t}async save(t){let n=Fk(),r=Tk.join(t,this.filePath);return await n.mkdirs(Tk.dirname(r)),await n.writeFile(r,this.buffer),r}};Ny.default=Vy});var Kk=I(iI=>{"use strict";Object.defineProperty(iI,"__esModule",{value:!0});iI.CodeMaker=void 0;var Yue=require("util"),wy=hy(),Xue=kk(),Ey=class{constructor({indentationLevel:t=4,indentCharacter:n=" "}={}){this.currIndent=0,this.files=new Array,this.excludes=new Array,this.openBlockFormatter=r=>`${r} {`,this.closeBlockFormatter=()=>"}",this.indentation=t,this.indentCharacter=n}get currentIndentLength(){return this.currIndent*this.indentation}async save(t){let n=this.files.filter(r=>!this.excludes.includes(r.filePath)).map(r=>r.save(t));return(await Promise.all(n)).sort()}openFile(t){if(this.currentFile)throw new Error(`Cannot open file ${t} without closing the previous file ${this.currentFile.filePath}`);this.currentFile=new Xue.default(t)}closeFile(t){if(!this.currentFile)throw new Error(`Cannot close file ${t}. It was never opened`);if(this.currentFile.filePath!==t)throw new Error(`Cannot close file ${t}. The currently opened file is ${this.currentFile.filePath}`);this.files.push(this.currentFile),this.currentFile=void 0}line(t,...n){if(!this.currentFile)throw new Error("Cannot emit source lines without opening a file");t&&(t=this.makeIndent()+t,this.currentFile.write(Yue.format(t,...n))),this.currentFile.write(`
`)}indent(t){this.open(t)}unindent(t){this.close(t)}open(t){this.line(t),this.currIndent++}close(t){this.currIndent--,t!==!1&&this.line(t)}openBlock(t){this.open(this.openBlockFormatter(t))}closeBlock(t){this.close(this.closeBlockFormatter(t))}exclude(t){this.excludes.push(t)}toCamelCase(...t){return wy.toCamelCase(...t)}toPascalCase(...t){return wy.toPascalCase(...t)}toSnakeCase(t,n="_"){return wy.toSnakeCase(t,n)}getCurrentFilePath(){var t;return(t=this.currentFile)==null?void 0:t.filePath}makeIndent(){let t=this.currentIndentLength;return t<=0?"":this.indentCharacter.repeat(t)}};iI.CodeMaker=Ey});var xk=I(li=>{"use strict";var _ue=li&&li.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Uk=li&&li.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&_ue(t,e,n)};Object.defineProperty(li,"__esModule",{value:!0});Uk(Kk(),li);Uk(hy(),li)});var Fy={};Ht(Fy,{CONFIG_DEFAULTS:()=>zk,LANGUAGES:()=>Fue,Language:()=>Xy,TerraformModuleConstraint:()=>mo,TerraformProviderConstraint:()=>sI,isLocalModule:()=>Kue,logTimespan:()=>xue,parseConfig:()=>Ok,readConfigSync:()=>_y,shouldCheckCodeMakerOutput:()=>Uue});function oI(e){return Array.isArray(e)&&e.length>0}function Hy(e){return e.match(/^(\.\/|\.\.\/|\.\\\\|\.\.\\\\)(.*)/)}function Kue(e){return Hy(e)!==null}function _y(e=Yy.join(process.cwd(),kue)){let t;return aI.existsSync(e)&&(t=aI.readFileSync(e).toString()),Ok(t)}function Uue(e){return oI(e.terraformModules)||oI(e.terraformProviders)}function xue(e){ee.debug(`Start timer for ${e}...`);let t=Date.now();return function(){let i=Date.now()-t;ee.debug(`${e} took ${i}ms`)}}var aI,Yy,Lk,Jk,Xy,Fue,Tue,kue,zk,mo,sI,Ok,cI=We(()=>{"use strict";aI=J(co()),Yy=J(require("path"));po();py();Lk=require("process"),Jk=J(xk()),Xy=(o=>(o.TYPESCRIPT="typescript",o.PYTHON="python",o.CSHARP="csharp",o.JAVA="java",o.GO="go",o))(Xy||{}),Fue=["typescript","python","java","csharp","go"],Tue="CDKTF_CONTEXT_JSON",kue="cdktf.json",zk={output:"cdktf.out",codeMakerOutput:".gen"};mo=class{constructor(t){if(typeof t=="string"){let r=this.parseDependencyConstraint(t);this.name=r.name,this.source=r.source,this.fqn=r.fqn,this.version=r.version,this.namespace=r.namespace}else this.source=t.source,this.name=t.name,this.fqn=t.name,this.version=t.version,this.namespace=t.namespace;Hy(this.source)&&(this.localSourceAbsolutePath=Yy.join(process.cwd(),this.source))}get className(){return(0,Jk.toPascalCase)(this.name.replace(/[-/.]/g,"_"))}get fileName(){return this.namespace?`${this.namespace}/${this.name}`:this.name}parseDependencyConstraint(t){let n=Hy(t);if(n){let y=n[2],v=y.split("/"),H=v.pop()??y,F=v.pop();return{name:H,fqn:y,source:t,namespace:F}}let[r,i]=t.split("@"),o=r.split("//");if(my(o[0])){let y=o[0].split("/"),v=y.pop(),H=y.pop()??r,F=`${y.pop()}/${v}`;if(o.length>1){let Q=o[1].split("/"),te=Q.pop();F=`${F}/${H}/${Q.join("/")}`,H=te??H}return{name:H,source:r,version:i,namespace:F,fqn:r.replace("//","/").replace(/\./g,"-")}}let s=t,a=s.match(/^([a-zA-Z0-9]*)::(.*)/);a&&(s=a[2]);let c=s.match(/^([a-zA-Z]*):\/\/(.*)/);c&&(s=c[2]),s=s.split(":").pop()??s;let u=s.match(/^[\d]*(.*)/);u&&(s=u[1]);let d=s.match(/[^/]*\.[^/]*\/(.*)/);d&&(s=d[1]);let g=s.match(/(.*)\?.*/);g&&(s=g[1]),s=s.replace(/\.git|\.hg|\.zip/,""),o=s.split("//");let m=o[0].split("/"),h=m.pop(),b=m.pop();if(!h)throw new Error(`Module name should be properly set in ${t}`);if(o.length>1){let y=o[1].split("/"),v=y.pop();b?b=`${b}/${h}/${y.join("/")}`:b=`${h}/${y.join("/")}`,h=v??h}return{name:h,source:t,fqn:s.replace("//","/"),namespace:b}}},sI=class{constructor(t){if(typeof t=="string"){let n=this.parseDependencyConstraint(t);this.name=n.name,this.fqn=n.fqn,this.source=n.fqn,this.version=n.version,this.namespace=n.namespace}else this.name=t.name,this.fqn=t.name,this.version=t.version,this.source=t.source,this.namespace=t.namespace}parseDependencyConstraint(t){let[n,r]=t.split("@"),i=n.split("/"),o=i.pop(),s=i.pop();if(!o)throw new Error(`Provider name should be properly set in ${t}`);return{name:o,source:n,version:r==="*"?void 0:r,fqn:n,namespace:s}}},Ok=e=>{var n,r;let t={...zk,...JSON.parse(e||"{}")};return oI(t.terraformModules)&&(t.terraformModules=(n=t.terraformModules)==null?void 0:n.map(i=>new mo(i))),oI(t.terraformProviders)&&(t.terraformProviders=(r=t.terraformProviders)==null?void 0:r.map(i=>new sI(i))),t.context&&(Lk.env[Tue]=JSON.stringify(t.context)),t}});var qk=I((cCe,Dk)=>{"use strict";Dk.exports=({onlyFirst:e=!1}={})=>{let t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(t,e?void 0:"g")}});var jk=I((uCe,Mk)=>{"use strict";var Lue=qk();Mk.exports=e=>typeof e=="string"?e.replace(Lue(),""):e});var $k={};Ht($k,{HttpError:()=>uI,downcaseFirst:()=>Mue,downloadFile:()=>jue,ensureAllSettledBeforeThrowing:()=>Pue,exec:()=>ft,hasNoColorFlagOrEnv:()=>dI,mkdtemp:()=>Oue,readCDKTFManifest:()=>que,readCDKTFVersion:()=>Due,shell:()=>Jue,withTempDir:()=>zue});async function Jue(e,t=[],n={}){let r=new Array,i=new Array;try{return await ft(e,t,n,o=>{let s=n.noColor?(0,Br.default)(o.toLocaleString()):o.toLocaleString();i.push(s),console.log(s)},o=>{let s=n.noColor?(0,Br.default)(o.toLocaleString()):o.toLocaleString();r.push(s)})}catch(o){throw r.length>0&&(o.stderr=r.map(s=>s.toString()).join(""),n.noColor&&(o.stderr=(0,Br.default)(o.stderr))),i.length>0&&(o.stdout=i.join(""),n.noColor&&(o.stdout=(0,Br.default)(o.stdout))),o}}async function zue(e,t){let n=process.cwd(),r=await Te.mkdtemp(Rs.join(Ty.tmpdir(),"cdktf.")),i=Rs.join(r,e);await Te.mkdirp(i);try{process.chdir(i),await t()}finally{process.chdir(n),await Te.remove(r)}}async function Oue(e){let t=await Te.mkdtemp(Rs.join(Ty.tmpdir(),"cdktf."));try{await e(t)}finally{await Te.remove(t)}}async function Due(e){let t=Rs.join(e,"cdk.tf.json");if(Te.existsSync(t)){let n=Te.readFileSync(t,"utf8");return JSON.parse(n)["//"].metadata.version}return""}async function que(){let{output:e}=_y(),t=await Te.readFile(Rs.join(e,Qk.Manifest.fileName));return JSON.parse(t.toString())}function Mue(e){return e===""?e:`${e[0].toLocaleLowerCase()}${e.slice(1)}`}async function jue(e,t){let n=e.startsWith("http://")?gI.http:gI.https,r=Te.createWriteStream(t);return new Promise((i,o)=>{let s=n.get(e,a=>{if(a.statusCode!==200){o(new uI(`Failed to get '${e}' (${a.statusCode})`,a.statusCode));return}a.pipe(r)});r.on("finish",()=>i()),s.on("error",a=>{Te.unlink(t,()=>o(a))}),r.on("error",a=>{Te.unlink(t,()=>o(a))}),s.end()})}async function Pue(e,t){try{await e}catch(n){throw await Promise.allSettled(t),n}}function dI(){return Que("no-color")||process.env.FORCE_COLOR==="0"}function Que(e){let t=e.startsWith("-")?"":e.length===1?"-":"--",n=process.argv.indexOf(t+e),r=process.argv.indexOf("--");return n!==-1&&(r===-1||n<r)}var Pk,Te,gI,Ty,Rs,Qk,Br,ft,uI,Ns=We(()=>{"use strict";Pk=J(yF()),Te=J(co()),gI=J(WF()),Ty=J(require("os")),Rs=J(require("path"));po();Qk=require("cdktf");cI();Br=J(jk());ft=async(e,t,n,r,i,o=!0)=>(typeof n.noColor!="boolean"&&dI()&&(n.noColor=!0),new Promise((s,a)=>{var d,g,m,h;let c=(0,Pk.spawn)(e,t,n),l=new Array,u=new Array;r!==void 0?(d=c.stdout)==null||d.on("data",b=>{let y=n.noColor?(0,Br.default)(b.toLocaleString()):b.toLocaleString();lI(y),l.push(y),r(y)}):(g=c.stdout)==null||g.on("data",b=>{let y=n.noColor?(0,Br.default)(b.toLocaleString()):b.toLocaleString();lI(y),l.push(y)}),i!==void 0?(m=c.stderr)==null||m.on("data",b=>{let y=n.noColor?(0,Br.default)(b.toLocaleString()):b.toLocaleString();Vs(y),o&&i(y),u.push(y)}):(h=c.stderr)==null||h.on("data",b=>{let y=n.noColor?(0,Br.default)(b.toLocaleString()):b.toLocaleString();Vs(y),o&&process.stderr.write(y),u.push(y)}),c.once("error",b=>a(b)),c.once("close",b=>{if(b!==0){let y=new Error(`non-zero exit code ${b}`);return y.stderr=u.map(v=>v.toString()).join(""),a(y)}return s(l.join(""))})}));uI=class extends Error{constructor(n,r){super(n);this.statusCode=r;Object.setPrototypeOf(this,new.target.prototype)}}});var nK={};Ht(nK,{logFileName:()=>tK,logger:()=>ee,processLoggerDebug:()=>lI,processLoggerError:()=>Vs});var Qc,II,eK,fo,Ar,ee,tK,lI,Vs,po=We(()=>{"use strict";Qc=J(jY()),II=J(co()),eK=J(require("path")),fo=J(ld());Ns();Ar=(0,Qc.getLogger)(),ee={trace(e,...t){Ar.trace(e,...t),fo.addBreadcrumb({message:e,level:"debug"})},debug(e,...t){Ar.debug(e,...t),fo.addBreadcrumb({message:e,level:"debug"})},info(e,...t){Ar.info(e,...t),fo.addBreadcrumb({message:e,level:"info"})},warn(e,...t){Ar.warn(e,...t),fo.addBreadcrumb({message:e,level:"warning"})},error(e,...t){Ar.error(e,...t),fo.addBreadcrumb({message:e,level:"error"})},fatal(e,...t){Ar.fatal(e,...t),fo.addBreadcrumb({message:e,level:"fatal"})},setLevel(e){Ar.level=e},useDefaultLevel(){Ar.level=process.env.CDKTF_LOG_LEVEL||"INFO"}};Ar.level=process.env.CDKTF_LOG_LEVEL||"INFO";tK="cdktf.log";if(process.env.CDKTF_LOG_FILE_DIRECTORY&&II.existsSync(process.env.CDKTF_LOG_FILE_DIRECTORY)&&II.statSync(process.env.CDKTF_LOG_FILE_DIRECTORY).isDirectory())(0,Qc.configure)({appenders:{cdktf:{type:"file",filename:eK.join(process.env.CDKTF_LOG_FILE_DIRECTORY,tK)}},categories:{default:{appenders:["cdktf"],level:"debug"}}});else{let e=dI()?"basic":"colored";(0,Qc.configure)({appenders:{out:{type:"stdout",layout:{type:e}}},categories:{default:{appenders:["out"],level:"info"}}})}lI=e=>{ee.debug(e.toString())},Vs=e=>{ee.error(e.toString())}});var rK=I((ICe,$ue)=>{$ue.exports={name:"@cdktf/commons",version:"0.20.10",publishConfig:{access:"public"},description:"CDK for Terraform Common utilities",scripts:{build:"tsc",watch:"tsc -w","watch-preserve-output":"tsc -w --preserveWatchOutput",lint:"eslint . --ext .ts,.tsx","lint:fix":"eslint . --ext .ts,.tsx --fix",pretest:"yarn build","pretest:ci":"yarn build",test:"yarn lint && jest","test:ci":"yarn lint && jest --ci","jest-watch":"jest --watch",package:"./package.sh","dist-clean":"rm -rf dist"},main:"src/index.js",types:"src/index.d.ts",repository:{type:"git",url:"git://github.com/hashicorp/terraform-cdk.git",directory:"packages/@cdktf/commons"},author:{name:"HashiCorp",url:"https://hashicorp.com"},keywords:["cdk","cdktf","terraform"],license:"MPL-2.0",dependencies:{"@sentry/node":"7.119.2",cdktf:"0.20.10","ci-info":"3.9.0",codemaker:"1.102.0","cross-spawn":"7.0.3","follow-redirects":"1.15.9","fs-extra":"11.2.0","is-valid-domain":"0.1.6",log4js:"6.9.1","strip-ansi":"6.0.1",uuid:"9.0.1"},devDependencies:{"@types/follow-redirects":"1.14.4","@types/fs-extra":"11.0.4","@types/uuid":"9.0.8","@typescript-eslint/eslint-plugin":"4.33.0","@typescript-eslint/parser":"4.33.0","eslint-config-prettier":"8.10.0","eslint-plugin-react":"7.37.2","eslint-plugin-react-hooks":"4.6.2",jest:"29.7.0","lint-staged":"13.3.0","ts-jest":"29.2.5",typescript:"5.1.6"},eslintConfig:{parser:"@typescript-eslint/parser",plugins:["@typescript-eslint"],settings:{react:{version:"detect"}},extends:["eslint:recommended","plugin:@typescript-eslint/eslint-recommended","plugin:@typescript-eslint/recommended","plugin:react/recommended","plugin:react-hooks/recommended","prettier"],rules:{"@typescript-eslint/no-explicit-any":0,"@typescript-eslint/explicit-function-return-type":0,"@typescript-eslint/no-use-before-define":0,"@typescript-eslint/explicit-module-boundary-types":0,"@typescript-eslint/no-var-requires":0,"react/no-unescaped-entities":0,"no-sequences":"error","no-irregular-whitespace":["error",{skipTemplates:!0}]},ignorePatterns:["node_modules","dist","coverage"]},"lint-staged":{"src/**/*.{ts,tsx}":"tsc-files ambient.d.ts --noEmit"}}});var iK={};Ht(iK,{DISPLAY_VERSION:()=>ho});function ele(){return rK().version.replace(/\+[0-9a-f]+$/,"")}var ho,$c=We(()=>{"use strict";ho=`${ele()}`});var sK={};Ht(sK,{CDKTF_DISABLE_PLUGIN_CACHE_ENV:()=>nle,CHECKPOINT_DISABLE:()=>ky,DISABLE_VERSION_CHECK:()=>tle});function oK(e){return e==="true"||e==="1"}var tle,ky,nle,Ky=We(()=>{"use strict";tle=oK(process.env.DISABLE_VERSION_CHECK),ky=!!process.env.CHECKPOINT_DISABLE,nle=oK(process.env.CDKTF_DISABLE_PLUGIN_CACHE_ENV)});var dK={};Ht(dK,{ReportRequest:()=>mI,getProjectId:()=>lK,getUserId:()=>gK,sendTelemetry:()=>cle});function sle(){return process.env.CDKTF_HOME?di.resolve(process.env.CDKTF_HOME):di.join((gi.userInfo().homedir??gi.homedir()).trim()||"/",".cdktf")}async function ale(e,t){return new Promise((n,r)=>{let i=rle.request((0,cK.format)(e),{headers:{Accept:"application/json","Content-Length":t.length,"User-Agent":"HashiCorp/cdktf-cli"},method:"POST"},o=>{if(o.statusCode){let a=o.statusCode;if(!ole.includes(a))return r(new Error(o.statusMessage))}let s=new Array;o.on("data",a=>s.push(a)),o.on("error",a=>r(a)),o.on("end",()=>n())});i.setTimeout(1e3,()=>r(new Error("request timeout"))),i.write(t),i.end(),i.on("error",o=>r(o))})}async function cle(e,t){let n={command:e,product:"cdktf",version:`${ho}`,dateTime:new Date,language:t.language,payload:t};try{await mI(n)}catch(r){ee.error(`Could not send telemetry data: ${r}`)}}function uK(e,t,n=!1,r){let i=Id(),o;try{o=require(e)}catch{if(n){let s={};r&&(s["//"]=r.replace(/\n/g," ")),s[t]=i,eu.ensureDirSync(di.dirname(e)),eu.writeFileSync(e,JSON.stringify(s,null,2))}return i}return o[t]?o[t]:(eu.writeFileSync(e,JSON.stringify({...o,[t]:i},null,2)),i)}function lK(e=process.cwd()){return uK(di.resolve(e,"cdktf.json"),"projectId")}function gK(){return uK(di.resolve(sle(),"config.json"),"userId",!0,`This signature is a randomly generated UUID used to anonymously differentiate users in telemetry data order to inform product direction.
This signature is random, it is not based on any personally identifiable information.
To create a new signature, you can simply delete this file at any time.
See https://cdk.tf/telemetry for more
information on how to disable it.`)}async function mI(e){if(ky)return;e.runID||(e.runID=Id()),e.dateTime||(e.dateTime=new Date),e.arch||(e.arch=gi.arch()),e.os||(e.os=gi.platform());let t=Uy.default.isCI?Uy.default.name||"unknown":!1;!e.userId&&!t&&(e.userId=gK()),t&&(e.ci=t),e.projectId=e.projectId||lK();let n=JSON.stringify(e);if(n.length>aK){ee.warn(`Skipped sending telemetry as the request body size was ${n.length} bytes. The limit is ${aK} bytes`);return}try{await ale(`${ile}telemetry/${e.product}`,n)}catch(r){Vs(r.message)}}var cK,gi,Uy,di,eu,rle,ile,ole,aK,xy=We(()=>{"use strict";cK=require("url");S2();gi=J(require("os")),Uy=J(N2());po();di=J(require("path")),eu=J(co());$c();Ky();rle=require("https"),ile="https://checkpoint-api.hashicorp.com/v1/",ole=[200,201],aK=8192});var IK={};Ht(IK,{ConstructsMakerModuleTarget:()=>pI,ConstructsMakerProviderTarget:()=>fI,ConstructsMakerTarget:()=>tu});var tu,pI,fI,mK=We(()=>{"use strict";cI();tu=class{constructor(t,n){this.constraint=t;this.targetLanguage=n;this.constraint instanceof mo?this.fileName=`${this.typesPath(this.constraint.fileName)}.ts`:this.fileName=`${this.typesPath(this.constraint.name)}.ts`}static from(t,n){return t instanceof mo?new pI(t,n):new fI(t,n)}get version(){return this.constraint.version}get source(){return this.constraint.source}get name(){return this.constraint.name}get fqn(){return this.constraint.fqn}get namespace(){return this.constraint.namespace}get moduleKey(){return this.fqn.replace(/\//gi,"_")}},pI=class extends tu{get isModule(){return!0}get isProvider(){return!1}get srcMakName(){switch(this.targetLanguage){case"go":return this.name.replace(/-/gi,"_");case"java":case"csharp":case"python":return this.simplifiedFqn;default:return this.simplifiedName}}get trackingPayload(){return{name:this.name,fullName:this.fqn,version:this.version,type:"module"}}typesPath(t){return`modules/${t}`}get simplifiedName(){var t;return((t=this.namespace)==null?void 0:t.replace(/\//gi,".").replace(/-/gi,"_"))??this.name}get simplifiedFqn(){return this.fqn.replace(/\//gi,".").replace(/-/gi,"_")}},fI=class extends tu{get isModule(){return!1}get isProvider(){return!0}get srcMakName(){switch(this.targetLanguage){case"java":return this.isNullProvider?"nullprovider":this.simplifiedName;case"csharp":return this.isNullProvider?"Providers.Null":this.simplifiedName;case"python":return this.simplifiedName;case"go":return this.name.replace(/-/gi,"_");default:return this.constraint.fqn}}get trackingPayload(){return{name:this.name,fullName:this.source,version:this.version,type:"provider"}}typesPath(t){return`providers/${t}/index`}get isNullProvider(){return this.constraint.name==="null"}get simplifiedName(){return this.name.replace(/\//gi,".").replace(/-/gi,"_")}}});var fK={};Ht(fK,{Errors:()=>Jy,IsErrorType:()=>lle});async function ule(e,t){let n={command:e,product:"cdktf",version:`${ho}`,dateTime:new Date,payload:t};await mI(n)}function lle(e,t){return e&&e.__type===t}function Ly(e,t){return(n,r=new Error,i)=>{ule(t,{...i,message:n,type:e});let o=new Error(`${e} Error: ${n}`);return Object.entries(i||{}).forEach(([s,a])=>{o[s]=a}),o.__type=e,o.stack=r.stack,o}}var pK,hI,Jy,zy=We(()=>{"use strict";xy();$c();pK=J(ld());hI="unknown",Jy={Internal:Ly("Internal",hI),Usage:Ly("Usage",hI),External:Ly("External",hI),setScope(e){hI=e,pK.configureScope(t=>t.setTransactionName(e))}}});var CK={};Ht(CK,{terraformBinaryName:()=>hK,terraformVersion:()=>Oy});var hK,Oy,Dy=We(()=>{"use strict";zy();Ns();hK=process.env.TERRAFORM_BINARY_NAME||"terraform",Oy=ft(hK,["version","-json"],{}).then(e=>JSON.parse(e).terraform_version).catch(e=>Jy.Usage(`Unknown: Error loading terraform version ${e}`,e))});var BK={};Ht(BK,{getDependencyInformationFromLine:()=>yK,getGradleDependencies:()=>bK,getGradlePackageVersion:()=>jy,getGradlePackageVersionFromBuild:()=>GK,isGradleProject:()=>My});function My(e){let t=qy.default.join(e,"build.gradle");try{return nu.default.accessSync(t,nu.default.constants.R_OK|nu.default.constants.W_OK),!0}catch{return ee.debug(`No build.gradle found at ${t}`),!1}}async function bK(){let e;try{e=await ft("gradle",["dependencies","--console=plain"],{env:process.env})}catch(m){ee.debug(`Unable to run 'gradle dependencies': ${m}`);return}let t=e.split(/\r\n|\r|\n/),n=t.findIndex(m=>m.includes("implementation - "));if(n===-1){ee.debug(`Unable to find implementation section in output of 'gradle dependencies': ${e}`);return}let r=/^\s*$/,i=t.slice(n+1),o=i.findIndex(m=>r.test(m)),s=i.slice(0,o),a=t.findIndex(m=>m.includes("api - "));if(a===-1){ee.debug(`Unable to find api section in output of 'gradle dependencies': ${e}`);return}let c=t.slice(a+1),l=c.findIndex(m=>r.test(m)),u=c.slice(0,l),d=/^\s*[+\\-]+\s*/,g=/\s+\([nc*]\)\s*$/;return[...s,...u].filter(m=>m!=="No dependencies").map(m=>m.replace(d,"").replace(g,""))}function yK(e){let t=/^\s*([^:]+):([^:]+)(?::([^\s]+))?/,n=e.match(t);if(!n){ee.debug("Unexpected format for gradle build. Please file an issue at https://cdk.tf/bug");return}return n[3]===void 0?{group:"",name:n[1],version:n[2]}:{group:n[1],name:n[2],version:n[3]}}async function jy(e){let n={jsii:"jsii-runtime"}[e]||e;ee.debug("Running 'gradle dependencies' to find package version",n);let r=await bK();if(!r||r.length===0)return;for(let o of r)if(o.includes(`:${n}:`)){let s=yK(o);return s?s.version:void 0}let i=await GK(e);if(i)return i.version}async function GK(e){let t=qy.default.join(process.cwd(),"build.gradle"),r=(await nu.default.readFile(t,"utf-8")).split(/\r\n|\r|\n/),i=/^\s*dependencies\s*\{/i;if(r.findIndex(g=>i.test(g))===-1){ee.debug("Unable to find dependencies section in output build.gradle");return}let s=r.findIndex(g=>g.includes(e));if(s===-1){ee.debug(`Unable to find package ${e} in output build.gradle`);return}let a=r[s],l=new RegExp(`([^:]+):${e}(?::([^\\s]+))?`,"i").exec(a);if(l)return{group:l[1],name:e,version:l[2]||""};let d=new RegExp(`java/(.*)/${e}/([^/]+)/.*\\.jar`,"i").exec(a);if(d)return{group:d[1].replace(/\//g,"."),name:e,version:d[2]}}var qy,nu,Py=We(()=>{"use strict";qy=J(require("path")),nu=J(co());po();Ns()});var XK={};Ht(XK,{collectDebugInformation:()=>ble,getDotnetVersion:()=>SK,getGoVersion:()=>HK,getGradleVersion:()=>VK,getJavaVersion:()=>WK,getLanguage:()=>vK,getMavenVersion:()=>RK,getNodeVersion:()=>YK,getPackageVersion:()=>CI,getPipVersion:()=>wK,getPipenvVersion:()=>EK,getPythonVersion:()=>NK});function vK(e=process.cwd()){try{return require(AK.resolve(e,"cdktf.json")).language}catch{ee.debug(`Unable to detect language in ${e}`);return}}async function jn(e,t){let n=()=>{};try{return(await ft(e,[t],{env:process.env,stdio:[void 0,void 0,"ignore"]},n,n)).trim().replace(/\r?\n|\r/g,"")}catch(r){ee.debug(`Failed to run ${e} ${t}: ${r}`);return}}function SK(){return jn("dotnet","--version")}function WK(){return jn("java","-version")}function RK(){return jn("mvn","--version")}function VK(){return jn("gradle","--version")}async function NK(){return await jn("python3","--version")||await jn("python","--version")}function wK(){return jn("pip","--version")}function EK(){return jn("pipenv","--version")}function HK(){return jn("go","version")}function YK(){return jn("node","--version")}async function gle(e){return await(0,ZK.pathExists)("pnpm-lock.yaml")?dle(e):Ile(e)}async function dle(e){var r,i,o;let t;try{t=await ft("pnpm",["list",e,"--json"],{env:{...process.env}})}catch(s){ee.debug(`Unable to run 'pnpm list ${e} --json': ${s}`);return}let n;try{n=JSON.parse(t)}catch(s){ee.debug(`Unable to parse output of 'pnpm list ${e} --json': ${s}`);return}if(!n||!Array.isArray(n)||n.length===0||!((o=(i=(r=n[0])==null?void 0:r.dependencies)==null?void 0:i[e])!=null&&o.version)){ee.debug(`Unable to find '${e}' in 'pnpm list ${e} --json': ${t}`);return}return n[0].dependencies[e].version}async function Ile(e){let t;try{t=await ft("npm",["list",e,"--json"],{env:{...process.env}})}catch(r){ee.debug(`Unable to run 'npm list ${e} --json': ${r}`);return}let n;try{n=JSON.parse(t)}catch(r){ee.debug(`Unable to parse output of 'npm list ${e} --json': ${r}`);return}if(!n.dependencies||!n.dependencies[e]||!n.dependencies[e].version){ee.debug(`Unable to find '${e}' in 'npm list ${e} --json': ${t}`);return}return n.dependencies[e].version}async function mle(e){let t;try{t=await ft("pipenv",["run","pip","show",e],{env:process.env})}catch(i){ee.debug(`Unable to run 'pipenv run pip show ${e}': ${i}`)}if(!t)try{t=await ft("pip",["show",e],{env:process.env})}catch(i){ee.debug(`Unable to run 'pip show ${e}': ${i}`)}if(!t)return;let n=t.split(/\r\n|\r|\n/).find(i=>i.startsWith("Version:"));if(!n){ee.debug(`Unable to find version in output of 'pipenv run pip show ${e}' / 'pip show ${e}': ${t}`);return}return n.split(":")[1].trim()}async function ple(e){let n={jsii:"Amazon.JSII.Runtime",constructs:"Constructs",cdktf:"HashiCorp.Cdktf"}[e]||e,r;try{r=await ft("dotnet",["list","package","--include-transitive"],{env:process.env})}catch(o){ee.debug(`Unable to run 'dotnet list package --include-transitive': ${o}`);return}let i=r.split(/\r\n|\r|\n/).find(o=>o.includes(`> ${n}`));if(!i){ee.debug(`Unable to find version for '${n}' in output of 'dotnet list package --include-transitive': ${r}`);return}return i.split(" ").reverse().find(o=>o!=="")}async function fle(e){var o;let n={jsii:"jsii-runtime-go",cdktf:"github.com/hashicorp/terraform-cdk-go"}[e]||e,r;try{r=await ft("go",["list","-m","all"],{env:process.env})}catch(s){ee.debug(`Unable to run 'go list -m all': ${s}`);return}let i=r.split(/\r\n|\r|\n/).find(s=>s.includes(n));if(!i){ee.debug(`Unable to find version for '${n}' in output of 'go list -m all': ${r}`);return}return i.includes("=>")&&(ee.debug(`Found local version for '${n}': ${i}`),i=i.split("=>")[0].trim()),(o=i.split(" ").pop())==null?void 0:o.replace("v","")}async function hle(e){let n={jsii:"jsii-runtime"}[e]||e,r;try{r=await ft("mvn",["dependency:list"],{env:process.env})}catch(u){ee.debug(`Unable to run 'mvn dependency:list': ${u}`);return}let i=r.split("The following files have been resolved")[1];if(!i){ee.debug(`Unable to find resolution passage in output of 'mvn dependency:list': ${r}`);return}let o=i.split(/\r\n|\r|\n/).find(u=>u.includes(`${n}:`));if(!o){ee.debug(`Unable to find version for '${n}' in output of 'mvn dependency:list': ${r}`);return}let s=`${n}:jar:`,a=o.indexOf(s)+s.length,l=o.indexOf(":compile");return o.substring(a,l)}async function Cle(e){return My("./")?jy(e):hle(e)}async function CI(e,t){let n=async()=>{};return await({typescript:gle,python:mle,go:fle,csharp:ple,java:Cle}[e]||n)(t)??void 0}async function ble(){let e={},t=vK();e.language=t??null,e["cdktf-cli"]=ho;let n=YK();if(e.node=await n??null,t){let r=CI(t,"cdktf"),i=CI(t,"constructs"),o=CI(t,"jsii");e.cdktf=await r??null,e.constructs=await i??null,e.jsii=await o??null}switch(e.terraform=await Oy,e.arch=ws.arch(),e.os=`${ws.platform()} ${ws.release()}`,t){case"python":{let r=NK(),i=wK(),o=EK();e.python=await r??null,e.pip=await i??null,e.pipenv=await o??null}break;case"java":{let r=WK(),i=RK(),o=VK();e.java=await r??null,e.maven=await i??null,e.gradle=await o??null}break;case"csharp":e.dotnet=await SK()??null;break;case"go":e.go=await HK()??null;break}return e}var AK,ws,ZK,_K=We(()=>{"use strict";AK=J(require("path")),ws=J(require("os"));po();Ns();Dy();$c();ZK=J(co());Py()});var yle={};var FK=We(()=>{"use strict"});var kK={};Ht(kK,{isAttributeNestedType:()=>TK,isNestedTypeAttribute:()=>Gle});function TK(e){return typeof e=="object"&&!Array.isArray(e)&&typeof e.nesting_mode=="string"&&(typeof e.attributes=="object"||typeof e.attributes>"u")}function Gle(e){return typeof e.nested_type<"u"&&TK(e.nested_type)}var KK=We(()=>{"use strict"});var ve=I(Ye=>{"use strict";var Ble=Ye&&Ye.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Et=Ye&&Ye.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Ble(t,e,n)};Object.defineProperty(Ye,"__esModule",{value:!0});Et((xy(),ht(dK)),Ye);Et((mK(),ht(IK)),Ye);Et((cI(),ht(Fy)),Ye);Et((_K(),ht(XK)),Ye);Et((Ky(),ht(sK)),Ye);Et((zy(),ht(fK)),Ye);Et((Py(),ht(BK)),Ye);Et((po(),ht(nK)),Ye);Et((FK(),ht(yle)),Ye);Et((KK(),ht(kK)),Ye);Et((py(),ht(HF)),Ye);Et((Dy(),ht(CK)),Ye);Et((Ns(),ht($k)),Ye);Et(($c(),ht(iK)),Ye)});var xK=I((HCe,Qy)=>{"use strict";var UK=require("fs");Qy.exports=e=>new Promise(t=>{UK.access(e,n=>{t(!n)})});Qy.exports.sync=e=>{try{return UK.accessSync(e),!0}catch{return!1}}});var JK=I((YCe,$y)=>{"use strict";var LK=(e,...t)=>new Promise(n=>{n(e(...t))});$y.exports=LK;$y.exports.default=LK});var OK=I((XCe,eG)=>{"use strict";var Ale=JK(),zK=e=>{if(!((Number.isInteger(e)||e===1/0)&&e>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let t=[],n=0,r=()=>{n--,t.length>0&&t.shift()()},i=(a,c,...l)=>{n++;let u=Ale(a,...l);c(u),u.then(r,r)},o=(a,c,...l)=>{n<e?i(a,c,...l):t.push(i.bind(null,a,c,...l))},s=(a,...c)=>new Promise(l=>o(a,l,...c));return Object.defineProperties(s,{activeCount:{get:()=>n},pendingCount:{get:()=>t.length},clearQueue:{value:()=>{t.length=0}}}),s};eG.exports=zK;eG.exports.default=zK});var MK=I((_Ce,qK)=>{"use strict";var DK=OK(),bI=class extends Error{constructor(t){super(),this.value=t}},Zle=(e,t)=>Promise.resolve(e).then(t),vle=e=>Promise.all(e).then(t=>t[1]===!0&&Promise.reject(new bI(t[0])));qK.exports=(e,t,n)=>{n=Object.assign({concurrency:1/0,preserveOrder:!0},n);let r=DK(n.concurrency),i=[...e].map(s=>[s,r(Zle,s,t)]),o=DK(n.preserveOrder?1:1/0);return Promise.all(i.map(s=>o(vle,s))).then(()=>{}).catch(s=>s instanceof bI?s.value:Promise.reject(s))}});var QK=I((FCe,tG)=>{"use strict";var jK=require("path"),PK=xK(),Sle=MK();tG.exports=(e,t)=>(t=Object.assign({cwd:process.cwd()},t),Sle(e,n=>PK(jK.resolve(t.cwd,n)),t));tG.exports.sync=(e,t)=>{t=Object.assign({cwd:process.cwd()},t);for(let n of e)if(PK.sync(jK.resolve(t.cwd,n)))return n}});var eU=I((TCe,nG)=>{"use strict";var Ii=require("path"),$K=QK();nG.exports=(e,t={})=>{let n=Ii.resolve(t.cwd||""),{root:r}=Ii.parse(n),i=[].concat(e);return new Promise(o=>{(function s(a){$K(i,{cwd:a}).then(c=>{c?o(Ii.join(a,c)):a===r?o(null):s(Ii.dirname(a))})})(n)})};nG.exports.sync=(e,t={})=>{let n=Ii.resolve(t.cwd||""),{root:r}=Ii.parse(n),i=[].concat(e);for(;;){let o=$K.sync(i,{cwd:n});if(o)return Ii.join(n,o);if(n===r)return null;n=Ii.dirname(n)}}});var nU=I((kCe,rG)=>{"use strict";var tU=eU();rG.exports=async({cwd:e}={})=>tU("package.json",{cwd:e});rG.exports.sync=({cwd:e}={})=>tU.sync("package.json",{cwd:e})});var GI,yI,iG,rU,Wle,de,ot=We(()=>{"use strict";GI=J(Cu()),yI=J(require("path")),iG=J(nU()),rU=()=>{let e=iG.sync({cwd:__dirname});if(!e)throw new Error("unable to find package.json");return JSON.parse(GI.readFileSync(e,"utf-8"))},Wle=()=>{let e=iG.sync({cwd:__dirname});if(!e)throw new Error("unable to find package.json");return yI.default.dirname(e)},de=()=>{let e=yI.default.join(__dirname,"..","handlers.js");return GI.existsSync(e)?require(e):require(yI.default.join(Wle(),"bundle","bin","cmds","handlers.js"))}});var se,st=We(()=>{"use strict";se=class{constructor(){this.handler=async t=>{t.getYargsCompletions||await this.handleCommand(t)}}}});var sU=I((JCe,oU)=>{"use strict";ot();var iU=J(ve());st();var Rle=rU(),oG=class extends se{constructor(){super(...arguments);this.command="init";this.describe="Create a new cdktf project from a template.";this.builder=n=>n.showHelpOnFail(!0).option("template",{type:"string",desc:"The template to be used to create a new project. Either URL to zip file or one of the built-in templates."}).option("project-name",{type:"string",desc:"The name of the project."}).option("project-description",{type:"string",desc:"The description of the project."}).option("dist",{type:"string",desc:'Install dependencies from a "dist" directory (for development)'}).option("local",{type:"boolean",desc:"Use local state storage for generated Terraform.",default:!1}).option("cdktf-version",{type:"string",desc:"The cdktf version to use while creating a new project.",default:Rle.version}).option("from-terraform-project",{type:"string",desc:"Use a terraform project as the basis, CDK constructs will be generated based on the .tf files in the path"}).option("enable-crash-reporting",{type:"boolean",desc:"Enable crash reporting for the CLI, refer to https://cdk.tf/crash-reporting for more details"}).option("providers",{describe:"Providers to add to your project",type:"array",default:[]}).option("providers-force-local",{type:"boolean",desc:"Force local installation of provider specified in init"}).option("tfe-hostname",{type:"string",desc:"The hostname of the Terraform Enterprise instance to use for remote state storage"}).strict()}async handleCommand(n){iU.Errors.setScope("init"),await de().init(n)}};oU.exports=new oG});var aG=I((DCe,uU)=>{"use strict";var BI=J(ve());ot();var cU=J(ve());st();var aU=(0,BI.readConfigSync)(),sG=class extends se{constructor(){super(...arguments);this.command="get";this.describe="Generate CDK Constructs for Terraform providers and modules.";this.builder=n=>n.showHelpOnFail(!0).option("output",{default:aU.codeMakerOutput,type:"string",desc:"Output directory for generated Constructs",alias:"o"}).option("language",{default:aU.language,required:!0,type:"string",desc:"Output programming language",alias:"l",choices:BI.LANGUAGES}).option("force",{default:!1,type:"boolean",desc:"Regenerates all generated constructs"}).option("parallelism",{type:"number",required:!1,desc:"Number of concurrently generated provider / module bindings. Only applies for languages that are not Typescript (translated by JSII). Defaults to infinity, denoted by -1",default:-1}).option("show-performance-info",{type:"boolean",required:!1,desc:"Shows performance information after generation"})}async handleCommand(n){cU.Errors.setScope("get"),await de().get(n)}};uU.exports=new sG});var mU=I((jCe,IU)=>{"use strict";var lU=J(ve());st();ot();var gU=J(require("path")),dU=J(Cu());function Vle(e=process.cwd()){try{let t=gU.join(e,"cdktf.json");return dU.readJsonSync(t)}catch{return}}var cG=class extends se{constructor(){super(...arguments);this.command="convert";this.describe="Converts a single file of HCL configuration to CDK for Terraform. Takes the file to be converted on stdin.";this.builder=n=>{var r;return n.example("cat main.tf | cdktf convert  --provider integrations/github","Takes the HCL content of main.tf and converts it to CDK for Terraform content and prints it").example("cat main.tf | cdktf convert --provider hashicorp/aws > imported.ts","Takes the HCL content of main.tf and converts it to CDK for Terraform content in imported.ts").example("cat main.tf | cdktf convert --provider 'hashicorp/aws@ ~>3.62.0' 'integrations/github@ ~>4.16.0' --language python > imported.py","Takes the HCL content of main.tf and converts it to CDK for Terraform content in imported.py").option("language",{choices:["typescript","python","csharp","java","go"],default:((r=Vle())==null?void 0:r.language)||"typescript"}).option("provider",{describe:"The conversion needs to know which providers are used in addition to the ones in your cdktf.json file. We search for a cdktf.json below your current working directory.",type:"array",default:[]}).option("stack",{describe:"Wrap the generated code within a stack class",type:"boolean",default:!1}).showHelpOnFail(!0)}}async handleCommand(n){lU.Errors.setScope("convert");let r=de();n.withProject!==void 0&&(n.language==="typescript"?n.withProject=!1:n.withProject=!0),await r.convert(n)}};IU.exports=new cG});var bU=I(($Ce,CU)=>{"use strict";var fU=J(ve());ot();var hU=J(ve());st();var pU=(0,fU.readConfigSync)(),uG=class extends se{constructor(){super(...arguments);this.command="deploy [stacks...]";this.describe="Deploy the given stacks";this.aliases=["apply"];this.builder=n=>n.positional("stacks",{desc:"Deploy stacks matching the given ids. Required when more than one stack is present in the app",type:"string"}).option("app",{default:pU.app,required:!0,desc:"Command to use in order to execute cdktf app",alias:"a"}).option("output",{default:pU.output,required:!0,desc:"Output directory for the synthesized Terraform config",alias:"o"}).option("auto-approve",{type:"boolean",default:!1,required:!1,desc:"Auto approve"}).option("outputs-file",{type:"string",required:!1,desc:"Path to file where stack outputs will be written as JSON",requiresArg:!0}).option("outputs-file-include-sensitive-outputs",{type:"boolean",required:!1,desc:"Whether to include sensitive outputs in the output file",default:!1}).option("ignore-missing-stack-dependencies",{type:"boolean",required:!1,desc:"Don't check if all stacks specified in the command have their dependencies included as well",default:!1}).option("parallelism",{type:"number",required:!1,desc:"Number of concurrent CDKTF stacks to run. Defaults to infinity, denoted by -1",default:-1}).option("refresh-only",{default:!1,required:!1,boolean:!0,desc:'Select the "refresh only" planning mode, which checks whether remote objects still match the outcome of the most recent Terraform apply but does not propose any actions to undo any changes made outside of Terraform.'}).option("terraform-parallelism",{type:"number",required:!1,desc:"Forwards value as the `-parallelism` flag to Terraform. By default, the this flag is not forwarded to Terraform. Note: This flag is not supported by remote / cloud backend",default:-1}).option("no-color",{type:"boolean",default:process.env.FORCE_COLOR==="0",required:!1,desc:"Disables terminal formatting sequences in the output."}).option("migrate-state",{type:"boolean",default:!1,required:!1,desc:"Pass this flag after switching state backends to approve a state migration for all targeted stacks"}).option("var",{type:"array",default:[],required:!1,desc:"Set a value for one of the input variables in the stack or stacks to apply. Use this option more than once to set more than one variable."}).option("var-file",{type:"array",default:[],required:!1,desc:"Load variable values from the given file, in addition to the default files terraform.tfvars and *.auto.tfvars. Use this option more than once to include more than one variables file."}).option("skip-synth",{type:"boolean",default:!1,required:!1,desc:"Skip synthesis of the application, assume the synthesized Terraform code is already present and up to date"}).showHelpOnFail(!0)}async handleCommand(n){hU.Errors.setScope("deploy"),await de().deploy(n)}};CU.exports=new uG});var ZU=I((nbe,AU)=>{"use strict";var GU=J(ve());ot();var BU=J(ve());st();var yU=(0,GU.readConfigSync)(),lG=class extends se{constructor(){super(...arguments);this.command="destroy [stacks..]";this.describe="Destroy the given stacks";this.builder=n=>n.positional("stacks",{desc:"Destroy stacks matching the given ids. Required when more than one stack is present in the app",type:"string"}).option("app",{default:yU.app,required:!0,desc:"Command to use in order to execute cdktf app",alias:"a"}).option("output",{default:yU.output,required:!0,desc:"Output directory for the synthesized Terraform config",alias:"o"}).option("auto-approve",{type:"boolean",default:!1,required:!1,desc:"Auto approve"}).option("ignore-missing-stack-dependencies",{type:"boolean",required:!1,desc:"Don't check if all stacks specified in the command have their dependencies included as well",default:!1}).option("parallelism",{type:"number",required:!1,desc:"Number of concurrent CDKTF stacks to run. Defaults to infinity, denoted by -1",default:-1}).option("terraform-parallelism",{type:"number",required:!1,desc:"Forwards value as the `-parallelism` flag to Terraform. By default, the this flag is not forwarded to Terraform. Note: This flag is not supported by remote / cloud backend",default:-1}).option("var",{type:"array",default:[],required:!1,desc:"Set a value for one of the input variables in the stack or stacks to apply. Use this option more than once to set more than one variable."}).option("var-file",{type:"array",default:[],required:!1,desc:"Load variable values from the given file, in addition to the default files terraform.tfvars and *.auto.tfvars. Use this option more than once to include more than one variables file."}).option("no-color",{type:"boolean",default:process.env.FORCE_COLOR==="0",required:!1,desc:"Disables terminal formatting sequences in the output."}).option("migrate-state",{type:"boolean",default:!1,required:!1,desc:"Pass this flag after switching state backends to approve a state migration for all targeted stacks"}).option("skip-synth",{type:"boolean",default:!1,required:!1,desc:"Skip synthesis of the application, assume the synthesized Terraform code is already present and up to date"}).showHelpOnFail(!0)}async handleCommand(n){BU.Errors.setScope("destroy"),await de().destroy(n)}};AU.exports=new lG});var VU=I((obe,RU)=>{"use strict";var SU=J(ve());ot();var WU=J(ve());st();var vU=(0,SU.readConfigSync)(),gG=class extends se{constructor(){super(...arguments);this.command="diff [stack]";this.describe="Perform a diff (terraform plan) for the given stack";this.aliases=["plan"];this.builder=n=>n.positional("stack",{desc:"Diff stack which matches the given id only. Required when more than one stack is present in the app",type:"string"}).option("app",{default:vU.app,required:!0,desc:"Command to use in order to execute cdktf app",alias:"a"}).option("output",{default:vU.output,required:!0,desc:"Output directory for the synthesized Terraform config",alias:"o"}).option("refresh-only",{default:!1,required:!1,boolean:!0,desc:'Select the "refresh only" planning mode, which checks whether remote objects still match the outcome of the most recent Terraform apply but does not propose any actions to undo any changes made outside of Terraform.'}).option("terraform-parallelism",{type:"number",required:!1,desc:"Forwards value as the `-parallelism` flag to Terraform. By default, the this flag is not forwarded to Terraform. Note: This flag is not supported by remote / cloud backend",default:-1}).option("var",{type:"array",default:[],required:!1,desc:"Set a value for one of the input variables in the stack. Use this option more than once to set more than one variable."}).option("var-file",{type:"array",default:[],required:!1,desc:"Load variable values from the given file, in addition to the default files terraform.tfvars and *.auto.tfvars. Use this option more than once to include more than one variables file."}).option("no-color",{type:"boolean",default:process.env.FORCE_COLOR==="0",required:!1,desc:"Disables terminal formatting sequences in the output."}).option("migrate-state",{type:"boolean",default:!1,required:!1,desc:"Pass this flag after switching state backends to approve a state migration for the targeted stack"}).option("skip-synth",{type:"boolean",default:!1,required:!1,desc:"Skip synthesis of the application, assume the synthesized Terraform code is already present and up to date"}).showHelpOnFail(!0)}async handleCommand(n){WU.Errors.setScope("diff"),await de().diff(n)}};RU.exports=new gG});var EU=I((cbe,wU)=>{"use strict";ot();var AI=J(ve());st();var NU=(0,AI.readConfigSync)(),dG=class extends se{constructor(){super(...arguments);this.command="list";this.describe="List stacks in app.";this.builder=n=>n.option("app",{default:NU.app,desc:"Command to use in order to execute cdktf app",alias:"a"}).option("output",{default:NU.output,desc:"Output directory for the synthesized Terraform config",alias:"o"}).showHelpOnFail(!0)}async handleCommand(n){AI.Errors.setScope("list"),await de().list(n)}};wU.exports=new dG});var XU=I((gbe,YU)=>{"use strict";ot();var HU=J(ve());st();var IG=class extends se{constructor(){super(...arguments);this.command="login";this.describe="Retrieves an API token to connect to Terraform Cloud or Terraform Enterprise.";this.builder=n=>n.showHelpOnFail(!0).option("tfe-hostname",{string:!0,requiresArg:!0,describe:"The Terraform Enterprise hostname to authenticate against. If you use Terraform Cloud you can leave this on the default.",default:"app.terraform.io"}).example("cdktf login","Takes you through the interactive login process").example("cdktf login --tfe-hostname tfe.my-company.com","Takes you through the interactive login process on your companies Terraform Enterprise instance.").example("cat my-token.txt | cdktf login","Uses a locally stored token directly, instead of going through the interactive login process").strict()}async handleCommand(n){HU.Errors.setScope("login"),await de().login(n)}};YU.exports=new IG});var FU=I((mbe,_U)=>{"use strict";var Es=J(ve());ot();st();var mG=(0,Es.readConfigSync)(),pG=class extends se{constructor(){super(...arguments);this.command="synth";this.describe="Synthesizes Terraform code for the given app in a directory.";this.aliases=["synthesize"];this.builder=n=>n.option("app",{default:mG.app,desc:"Command to use in order to execute cdktf app",alias:"a"}).option("output",{default:mG.output,desc:"Output directory for the synthesized Terraform config",alias:"o"}).option("check-code-maker-output",{type:"boolean",desc:"Should `codeMakerOutput` existence check be performed? By default it will be checked if providers or modules are configured.",default:(0,Es.shouldCheckCodeMakerOutput)(mG)}).option("hcl",{type:"boolean",desc:"Should the output be in HCL format?",default:!1}).showHelpOnFail(!0)}async handleCommand(n){Es.Errors.setScope("synth"),await de().synth(n)}};_U.exports=new pG});var xU=I((hbe,UU)=>{"use strict";var kU=J(ve());ot();var KU=J(ve());st();var TU=(0,kU.readConfigSync)(),fG=class extends se{constructor(){super(...arguments);this.command="watch [stacks..]";this.describe="[experimental] Watch for file changes and automatically trigger a deploy";this.builder=n=>n.positional("stacks",{desc:"Deploy stacks matching the given ids. Required when more than one stack is present in the app",type:"string"}).option("app",{default:TU.app,required:!0,desc:"Command to use in order to execute cdktf app",alias:"a"}).option("output",{default:TU.output,required:!0,desc:"Output directory for the synthesized Terraform config",alias:"o"}).option("auto-approve",{type:"boolean",default:!1,required:!1,desc:"Auto approve"}).option("parallelism",{type:"number",required:!1,desc:"Number of concurrent CDKTF stacks to run. Defaults to infinity, denoted by -1",default:-1}).option("terraform-parallelism",{type:"number",required:!1,desc:"Forwards value as the `-parallelism` flag to Terraform. By default, the this flag is not forwarded to Terraform. Note: This flag is not supported by remote / cloud backend",default:-1}).showHelpOnFail(!0)}async handleCommand(n){KU.Errors.setScope("watch"),await de().watch(n)}};UU.exports=new fG});var zU=I((ybe,JU)=>{"use strict";var ZI=J(ve());ot();st();var LU=(0,ZI.readConfigSync)(),hG=class extends se{constructor(){super(...arguments);this.command="output [stacks..]";this.describe="Prints the output of stacks";this.aliases=["outputs"];this.builder=n=>n.positional("stacks",{desc:"Get outputs of the stacks matching the given ids. Required when more than one stack is present in the app",type:"string"}).option("app",{default:LU.app,required:!0,desc:"Command to use in order to execute cdktf app",alias:"a"}).option("output",{default:LU.output,required:!0,desc:"Output directory for the synthesized Terraform config",alias:"o"}).option("outputs-file",{type:"string",required:!1,desc:"Path to file where stack outputs will be written as JSON",requiresArg:!0}).option("outputs-file-include-sensitive-outputs",{type:"boolean",required:!1,desc:"Whether to include sensitive outputs in the output file",default:!1}).option("skip-synth",{type:"boolean",default:!1,required:!1,desc:"Skip synthesis of the application, assume the synthesized Terraform code is already present and up to date"}).showHelpOnFail(!0)}async handleCommand(n){ZI.Errors.setScope("output"),await de().output(n)}};JU.exports=new hG});var qU=I((Abe,DU)=>{"use strict";ot();var OU=J(ve());st();var CG=class extends se{constructor(){super(...arguments);this.command="debug";this.describe="Get debug information about the current project and environment";this.builder=n=>n.showHelpOnFail(!0).option("json",{default:!1,type:"boolean",desc:"If set, output will be in JSON format."})}async handleCommand(n){OU.Errors.setScope("debug"),await de().debug(n)}};DU.exports=new CG});var PU=I((Sbe,jU)=>{"use strict";ot();var MU=J(ve());st();var bG=class extends se{constructor(){super(...arguments);this.command="add <provider...>";this.describe="Add one or more Terraform providers to your project.";this.builder=n=>n.showHelpOnFail(!0).positional("provider",{type:"string",desc:"Name of the provider to add. Can include a version constraint (e.g. aws@~>4.0).",required:!0}).option("force-local",{type:"boolean",desc:"force local provider installation, even if pre-built provider exists"})}async handleCommand(n){MU.Errors.setScope("provider add"),await de().providerAdd(n)}};jU.exports=new bG});var ex=I((Vbe,$U)=>{"use strict";ot();var QU=J(ve());st();var yG=class extends se{constructor(){super(...arguments);this.command="upgrade <provider...>";this.describe=`Upgrade one or more Terraform providers in your project to the newest version compatible with your CDKTF version.
    If your project has the associated pre-built provider already installed, CDKTF updates the pre-built provider. Otherwise, CDKTF adds the specified provider to the cdktf.json configuration file and generates local provider bindings.`;this.builder=n=>n.showHelpOnFail(!0).positional("provider",{type:"string",desc:"Name of the provider to upgrade. Can include a version constraint (e.g. aws@~>4.0).",required:!0})}async handleCommand(n){QU.Errors.setScope("provider upgrade"),await de().providerUpgrade(n)}};$U.exports=new yG});var rx=I((Ebe,nx)=>{"use strict";ot();var tx=J(ve());st();var GG=class extends se{constructor(){super(...arguments);this.command="list [flags]";this.describe="List installed providers";this.builder=n=>n.showHelpOnFail(!0).option("json",{type:"boolean",default:!1,desc:"get providers list as json"})}async handleCommand(n){tx.Errors.setScope("provider list"),await de().providerList(n)}};nx.exports=new GG});var sx=I((Hbe,ox)=>{"use strict";var ix=J(require("yargs")),BG=class{constructor(){this.command="provider";this.describe="A set of subcommands that facilitates provider management";this.builder=t=>t.command(aG()).command(PU()).command(ex()).command(rx());this.handler=()=>{ix.default.showHelp()}}};ox.exports=new BG});var mi=J(require("yargs")),ax=J(require("path")),cx=J(require("os")),vI=J(Cu()),ux=J(ld()),Zr=J(ve());process.env.NODE_ENV=process.env.NODE_ENV||"production";var Nle=()=>{let e=process.env.TF_PLUGIN_CACHE_DIR||ax.join(cx.homedir(),".terraform.d","plugin-cache");return vI.existsSync(e)||vI.mkdirpSync(e),e};Zr.CDKTF_DISABLE_PLUGIN_CACHE_ENV||(process.env.TF_PLUGIN_CACHE_DIR=Nle());var wle=function(e,t,n,r){t._.includes("diff")||t._.includes("deploy")||t._.includes("plan")||t._.includes("apply")?n(async(i,o)=>{let s=[];try{let a=await(0,Zr.readCDKTFManifest)();s.push(...Object.values(a.stacks).map(c=>`${c.name}:target stack "${c.name}"`))}finally{r([...o,...s])}}):n()};mi.command(sU()).command(aG()).command(mU()).command(bU()).command(ZU()).command(VU()).command(EU()).command(XU()).command(FU()).command(xU()).command(zU()).command(qU()).command(sx()).recommendCommands().exitProcess(!1).wrap(mi.terminalWidth()).showHelpOnFail(!1).env("CDKTF").epilogue('Options can be specified via environment variables with the "CDKTF_" prefix (e.g. "CDKTF_OUTPUT")').help().alias("h","help").option("experimental-provider-schema-cache-path",{type:"string",default:!1,required:!1,desc:"An experimental schema cache that can be used to improve the speed of cdktf get and convert. Supported using the env CDKTF_EXPERIMENTAL_PROVIDER_SCHEMA_CACHE_PATH."}).option("disable-plugin-cache-env",{type:"boolean",default:!1,required:!1,desc:"Dont set TF_PLUGIN_CACHE_DIR automatically. This is useful when the plugin cache is configured differently. Supported using the env CDKTF_DISABLE_PLUGIN_CACHE_ENV."}).option("log-level",{type:"string",required:!1,desc:"Which log level should be written. Only supported via setting the env CDKTF_LOG_LEVEL"}).option("log-file-directory",{require:!1,desc:"The directory path where CDKTF should create `cdktf.log` and print logs at the `debug` level. If not set, CDKTF writes logs to standard out at the level specified in `CDKTF_LOG_LEVEL`. Only supported via setting the env CDKTF_LOG_FILE_DIRECTORY"}).option("context-json",{required:!1,hidden:!0,desc:"Used internally for env variable"}).completion("completion",wle).parserConfiguration({"boolean-negation":!1}).command({command:"*",handler:e=>{let t=e._[0];t!=="completion"&&(console.error(t?`Could not find command "${t}", here are all available ones:`:"Please pass a command to cdktf, here are all available ones:"),mi.showHelp(),process.exit(1))}}).fail(async(e,t)=>{if(mi.exit(1,t),e&&console.log(e),(0,Zr.IsErrorType)(t,"Usage")||(0,Zr.IsErrorType)(t,"External"))console.error(t.message);else if(t){console.error(t.message),console.error(t.stack),console.error("Collecting Debug Information...");let n=await(0,Zr.collectDebugInformation)();console.error("Debug Information:"),Object.entries(n).forEach(([r,i])=>{console.log(`${r}: ${i===null?"null":i}`)})}await ux.close(4e3),process.exit(1)}).argv;
/*! Bundled license information:

@sentry/node/cjs/integrations/anr/worker-script.js:
  (*! @sentry/node 7.119.2 (9211bd4) | https://github.com/getsentry/sentry-javascript *)

localforage/dist/localforage.js:
  (*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  *)
*/
//# sourceMappingURL=cdktf.js.map
